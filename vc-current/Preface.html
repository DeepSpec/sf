<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="common/css/sf.css" rel="stylesheet" type="text/css" />
<title>Preface</title>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/vc.css" rel="stylesheet" type="text/css"/>
</head>

<body>

<div id="page">

<div id="header">
<div id='logoinheader'><a href='https://softwarefoundations.cis.upenn.edu'>
<img src='common/media/image/sf_logo_sm.png' alt='Software Foundations Logo'></a></div>
<div class='booktitleinheader'><a href='index.html'>Volume 5: Verifiable C</a></div>
<ul id='menu'>
   <li class='section_name'><a href='toc.html'>Table of Contents</a></li>
   <li class='section_name'><a href='coqindex.html'>Index</a></li>
</ul>
</div>

<div id="main">

<h1 class="libtitle">Preface</h1>


<div class="doc">

<div class="paragraph"> </div>

<a id="lab1"></a><h1 class="section">Welcome</h1>

<div class="paragraph"> </div>

 Here's a good way to build formally verified correct software:
<ul class="doclist">
<li> Write your program in an expressive language with a good proof
      theory (the Gallina language embedded in Coq's logic).

</li>
<li> Prove it correct in Coq.

</li>
<li> Extract it to ML and compile it with an optimizing ML compiler.

</li>
</ul>

<div class="paragraph"> </div>

    Unfortunately, for some applications you cannot afford to use a
    higher-order garbage-collected functional programming language
    such as Gallina or ML.  Perhaps you are writing an
    operating-system kernel, or a bit-shuffling cryptographic
    primitive, or the runtime system and garbage-collector of your
    functional language!  In those cases, you might want to use a
    low-level imperative systems programming language such as C.

<div class="paragraph"> </div>

    But you still want your OS, or crypto, or GC, to be correct!  So
    you should use machine-checked program verification in Coq.  For
    that purpose, you can use <i>Verifiable C</i>, a program logic and
    proof system for C.

<div class="paragraph"> </div>

    What is a program logic?  One example of a program logic is the
    Hoare logic that you studied in the <i>Programming Language
    Foundations</i> volume of this series.  (If you have not done so
    already, study the Hoare and Hoare2 chapters of that volume, and
    do the exercises.)

<div class="paragraph"> </div>

    Verifiable C is based on a 21st-century version of Hoare logic
    called <i>higher-order impredicative concurrent separation logic</i>.
    Back in the 20th century, computer scientists discovered that
    Hoare Logic was not very good at verifying programs with pointer
    data structures; so <i>separation logic</i> was developed.  Hoare Logic
    was clumsy at verifying concurrent programs, so <i>concurrent
    separation logic</i> was developed.  Hoare Logic could not handle
    higher-order object-oriented programming patterns or
    function-closures, so <i>higher-order impredicative program logics</i>
    were developed.

<div class="paragraph"> </div>

    This electronic book is Volume 5 of the <i>Software Foundations</i>
    series, which presents the mathematical underpinnings of reliable
    software.  The principal novelty of <i>Software Foundations</i> is that
    it is one hundred percent formalized and machine-checked: the
    entire text is literally a script for Coq.  It is intended to be
    read alongside an interactive session with Coq.  All the details
    in the text are fully formalized in Coq, and the exercises are
    designed to be worked using Coq.

<div class="paragraph"> </div>

    Before studying this volume, you should be a competent user of
    Coq:
<ul class="doclist">
<li> Study <i>Software Foundations Volume 1</i> (Logical Foundations), and
      do the exercises!

</li>
<li> Study the Hoare and Hoare2 chapters of <i>Software Foundations
      Volume 2</i> (Programming Language Foundations), and do the
      exercises!

</li>
<li> Study the Sort, SearchTree, and ADT chapters of <i>Software
      Foundations Volume 3</i> (Verified Functional Algorithms), and do
      the exercises!

</li>
</ul>

<div class="paragraph"> </div>

    You will also need a working knowledge of the C programming language. 
<div class="paragraph"> </div>

<a id="lab2"></a><h1 class="section">Practicalities</h1>

<div class="paragraph"> </div>

<a id="lab3"></a><h2 class="section">System Requirements</h2>

<div class="paragraph"> </div>

 Coq runs on Windows, Linux, and OS X.  The Preface of Volume 1
   describes the Coq installation you will need.  This edition was
   built with Coq 8.13.0.

<div class="paragraph"> </div>

   You will need VST 2.8 installed.  You can do that either by installing
   it as part of the standard "Coq Platform" that is released with each
   new version of Coq, or using opam (the package is named coq-vst).
   At the end of this chapter is a test to make sure you have the right
   version of VST installed.

<div class="paragraph"> </div>

   <i>IF YOU USE OPAM</i>, you can install Coq and CoqIDE using the
     instructions at <a href='https://coq.inria.fr/opam-using.html'>https://coq.inria.fr/opam-using.html</a>
   and then continue with,
<ul class="doclist">
<li> opam update   (<i>as necessary</i>)

</li>
<li> opam install coq-vst.2.8 (<i>this will take 30 minutes or more</i>)

</li>
</ul>

<div class="paragraph"> </div>

   <i>You do not need to install CompCert clightgen</i> to do the exercises
   in this volume.  But if you wish to modify and reparse the .c files,
   or verify C programs of your own, install the CompCert verified
   optimizing C compiler.  You can get CompCert in the standard "Coq Package"
   or by opam (the package is named coq-compcert). 
<div class="paragraph"> </div>

<a id="lab4"></a><h2 class="section">Downloading the Coq Files</h2>

<div class="paragraph"> </div>

 A tar file containing the full sources for the "release version"
    of this book (as a collection of Coq scripts and HTML files) is
    available at <a href="https://softwarefoundations.cis.upenn.edu"><span class="inlineref" <a href='https://softwarefoundations.cis.upenn.edu</span></a>.'>https://softwarefoundations.cis.upenn.edu</span></a>.</a>

<div class="paragraph"> </div>

    (If you are using the book as part of a class, your professor may
    give you access to a locally modified version of the files, which
    you should use instead of the release version.) 
<div class="paragraph"> </div>

<a id="lab5"></a><h2 class="section">Installation</h2>

<div class="paragraph"> </div>

 Unpack the <span class="inlinecode"><span class="id" title="var">vc.tgz</span></span> tar file into a vc directory.
    In this <span class="inlinecode"><span class="id" title="var">vc</span></span> directory, the <span class="inlinecode"><span class="id" title="var">make</span></span> command builds it. 
<div class="paragraph"> </div>

<a id="lab6"></a><h2 class="section">Exercises</h2>

<div class="paragraph"> </div>

 Each chapter includes exercises.  Each is marked with a
    "star rating," which can be interpreted as follows:

<div class="paragraph"> </div>

<ul class="doclist">
<li> One star: easy exercises that underscore points in the text
         and that, for most readers, should take only a minute or two.
         Get in the habit of working these as you reach them.

<div class="paragraph"> </div>


</li>
<li> Two stars: straightforward exercises (five or ten minutes).

<div class="paragraph"> </div>


</li>
<li> Three stars: exercises requiring a bit of thought (ten
         minutes to half an hour).

<div class="paragraph"> </div>


</li>
<li> Four and five stars: more difficult exercises (half an hour
         and up).

</li>
</ul>

<div class="paragraph"> </div>

   <font color="red"> <i>Please do not post solutions to the exercises in any public place</i>: </font>
    Software Foundations is widely used both for self-study and for
    university courses.  Having solutions easily available makes it
    much less useful for courses, which typically have graded homework
    assignments.  The authors especially request that readers not post
    solutions to the exercises anyplace where they can be found by
    search engines. 
<div class="paragraph"> </div>

<a id="lab7"></a><h2 class="section">Recommended Citation Format</h2>

<div class="paragraph"> </div>

 If you want to refer to this volume in your own writing, please
    do so as follows:
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;@<span class="id" title="var">book</span>            {<span class="id" title="var">Appel</span>:<span class="id" title="var">SF<sub>5</sub></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">author</span>       =   {<span class="id" title="var">Andrew</span> <span class="id" title="var">W</span>. <span class="id" title="var">Appel</span>, <span class="id" title="var">Lennart</span> <span class="id" title="var">Beringer</span>, <span class="id" title="var">and</span> <span class="id" title="var">Qinxiang</span> <span class="id" title="var">Cao</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">editor</span>       =   {<span class="id" title="var">Benjamin</span> <span class="id" title="var">C</span>. <span class="id" title="var">Pierce</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">title</span>        =   "Verifiable C",<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">series</span>       =   "Software Foundations",<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">volume</span>       =   "5",<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">year</span>         =   "2022",<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">publisher</span>    =   "Electronic textbook",<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">note</span>         =   {<span class="id" title="var">Version</span> 1.1.1, \<span class="id" title="var">URL</span>{<span class="id" title="var">http</span>://<span class="id" title="var">softwarefoundations.cis.upenn.edu</span>} },<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}
</span>
<div class="paragraph"> </div>

<a id="lab8"></a><h2 class="section">For Instructors and Contributors</h2>

<div class="paragraph"> </div>

 If you plan to use these materials in your own course, you will
    undoubtedly find things you'd like to change, improve, or add.
    Your contributions are welcome!  Please see the <a href="https://softwarefoundations.cis.upenn.edu/lf-current/Preface.html"><span class="inlineref">Preface</span></a>
    to <i>Logical Foundations</i> for instructions. 
</div>

<div class="doc">
<a id="lab9"></a><h1 class="section">Thanks</h1>

<div class="paragraph"> </div>

 Development of the <i>Software Foundations</i> series has been supported, in
    part, by the National Science Foundation under the NSF Expeditions grant
    1521523, <i>The Science of Deep Specification</i>. 
<div class="paragraph"> </div>

<a id="lab10"></a><h1 class="section">Check for the right version of VST</h1>

</div>
<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#"><span class="id" title="library">Coq.Strings.String</span></a>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">string</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">VST.veric.version</span>. <span class="comment">(*&nbsp;If&nbsp;this&nbsp;line&nbsp;fails,&nbsp;it&nbsp;means<br/>
&nbsp;&nbsp;you&nbsp;don't&nbsp;have&nbsp;a&nbsp;VST&nbsp;installed.&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="release_needed" class="idref" href="#release_needed"><span class="id" title="definition">release_needed</span></a> := "2.8".<br/>
<span class="id" title="keyword">Goal</span> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">release</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">=</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">release_needed</span></a>.<br/>
<span class="id" title="tactic">reflexivity</span> ||<br/>
<span class="id" title="keyword">let</span> <span class="id" title="var">need</span> := <span class="id" title="keyword">constr</span>:(<a class="idref" href="Preface.html#release_needed"><span class="id" title="definition">release_needed</span></a>) <span class="id" title="keyword">in</span> <span class="id" title="keyword">let</span> <span class="id" title="var">need</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">hnf</span> <span class="id" title="keyword">in</span> <span class="id" title="var">need</span> <span class="id" title="keyword">in</span><br/>
<span class="id" title="keyword">let</span> <span class="id" title="var">rel</span> := <span class="id" title="keyword">constr</span>:(<span class="id" title="definition">release</span>) <span class="id" title="keyword">in</span> <span class="id" title="keyword">let</span> <span class="id" title="var">rel</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">hnf</span> <span class="id" title="keyword">in</span> <span class="id" title="var">rel</span> <span class="id" title="keyword">in</span><br/>
<span class="id" title="tactic">fail</span> "The wrong version of VST is installed.
You have VST version"<br/>
<span class="id" title="var">rel</span> "but this version of 'Software Foundations Volume 5: Verifiable C'"<br/>
"demands version" <span class="id" title="var">need</span> ". If possible, install VST version" <span class="id" title="var">need</span><br/>
"using the Coq Platform or using opam.  Or, if not from Coq Platform or opam,"<br/>
"for instructions about building VST from source and accessing that version,
see the README file in this directory."<br/>
"Or, instead of installing VST" <span class="id" title="var">need</span> ","<br/>
"if you want to proceed using VST version" <span class="id" title="var">rel</span> ","<br/>
"then edit the Definition release_needed in Preface.v".<br/>
<span class="id" title="keyword">Abort</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.ZArith.html#"><span class="id" title="library">ZArith</span></a>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z_scope</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Require</span> <span class="id" title="library">VC.stack</span>. <span class="comment">(*&nbsp;If&nbsp;this&nbsp;line&nbsp;fails,&nbsp;do&nbsp;'make&nbsp;stack.vo'&nbsp;*)</span><br/>
<span class="id" title="keyword">Goal</span> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">VC.stack.Info.bitsize</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">=</span></a> <a id="Unnamed_thm" class="idref" href="#Unnamed_thm"><span class="id" title="definition">VST.veric.version.bitsize</span></a>.<br/>
<span class="id" title="tactic">reflexivity</span> ||<br/>
<span class="id" title="keyword">let</span> <span class="id" title="var">b<sub>1</sub></span> := <span class="id" title="keyword">constr</span>:(<span class="id" title="definition">VST.veric.version.bitsize</span>) <span class="id" title="keyword">in</span> <span class="id" title="keyword">let</span> <span class="id" title="var">b<sub>1</sub></span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">compute</span> <span class="id" title="keyword">in</span> <span class="id" title="var">b<sub>1</sub></span> <span class="id" title="keyword">in</span><br/>
<span class="id" title="keyword">let</span> <span class="id" title="var">b<sub>2</sub></span> := <span class="id" title="keyword">constr</span>:(<span class="id" title="definition">VC.stack.Info.bitsize</span>) <span class="id" title="keyword">in</span> <span class="id" title="keyword">let</span> <span class="id" title="var">b<sub>2</sub></span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">compute</span> <span class="id" title="keyword">in</span> <span class="id" title="var">b<sub>2</sub></span> <span class="id" title="keyword">in</span><br/>
<span class="id" title="tactic">fail</span> "Your installed VST is configured to verify C programs compiled with"<br/>
&nbsp;&nbsp;<span class="id" title="var">b<sub>1</sub></span> "bit pointers,"<br/>
&nbsp;"but the .c files in the local directory have been clightgen'ed as if compiled with"<br/>
&nbsp;<span class="id" title="var">b<sub>2</sub></span> "bit pointers."<br/>
"You can fix this by executing the shell command,
"<br/>
"bash cfiles-bitsize" <span class="id" title="var">b<sub>1</sub></span> "
to install the properly configured clightgen outputs."<br/>
"It is not necessary to have clightgen installed".<br/>
<span class="id" title="keyword">Abort</span>.<br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;2022-04-18&nbsp;20:10&nbsp;*)</span><br/>
</div>
</div>

<div id="footer">
<hr/><a href="coqindex.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>