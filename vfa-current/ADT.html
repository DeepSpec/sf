<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="common/css/sf.css" rel="stylesheet" type="text/css" />
<title>ADT: Abstract Data Types</title>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/vfa.css" rel="stylesheet" type="text/css"/>
</head>

<body>

<div id="page">

<div id="header">
<div id='logoinheader'><a href='https://softwarefoundations.cis.upenn.edu'>
<img src='common/media/image/sf_logo_sm.png' alt='Software Foundations Logo'></a></div>
<div class='booktitleinheader'><a href='index.html'>Volume 3: Verified Functional Algorithms</a></div>
<ul id='menu'>
   <li class='section_name'><a href='toc.html'>Table of Contents</a></li>
   <li class='section_name'><a href='coqindex.html'>Index</a></li>
   <li class='section_name'><a href='deps.html'>Roadmap</a></li>
</ul>
</div>

<div id="main">

<h1 class="libtitle">ADT<span class="subtitle">Abstract Data Types</span></h1>

<div class="code">
</div>

<div class="doc">

<div class="paragraph"> </div>

 An <i>abstract data type</i> (ADT) can be defined as a set of values
    together with some operations.  From the perspective of formal
    verification, the specifications of those operations should also
    be a part of an ADT.

<div class="paragraph"> </div>

    When we implemented BSTs in <a href="SearchTree.html"><span class="inlineref">SearchTree</span></a>, we saw that
    maintaining a representation invariant was important to rule out
    trees that could never be constructed through operations of the
    data structure.  That invariant became a precondition for many
    operations, though there was no need for <i>clients</i> of the data
    structure to know any details of the invariant.

<div class="paragraph"> </div>

    In this chapter we'll study a little of Coq's <i>module system</i>,
    which enables hiding some details of the implementation of an ADT,
    while also exposing the formal specification of the ADT.

<div class="paragraph"> </div>

    Some prior knowledge of an ML-style module system, especially
    OCaml's, will be helpful.  Here are some sources that cover it:

<div class="paragraph"> </div>

<ul class="doclist">
<li> <i>Introduction to Objective Caml</i>, chapters 12 and 13.  Jason
      Hickey, 2008.  Available from
      <a href="https://ocaml.org/learn/books.html"><span class="inlineref">https://ocaml.org/learn/books.html</span></a>.

<div class="paragraph"> </div>


</li>
<li> The OCaml System Manual, chapter 2.  Xavier Leroy et al.,
      2020. Available from
      <a href="http://caml.inria.fr/pub/docs/manual-ocaml/"><span class="inlineref">http://caml.inria.fr/pub/docs/manual-ocaml/</span></a>.  
</li>
</ul>

</div>

<div class="doc">
<a name="lab146"></a><h1 class="section">The Table ADT</h1>

<div class="paragraph"> </div>

 An <i>association table</i> is an ADT that binds keys to values.  There
    are many other names for this concept, including <i>map</i>.  We've
    already used that name before, though, for a specific data
    structure using higher-order functions.  So for clarity in this
    chapter we use <i>table</i>.

<div class="paragraph"> </div>

    Below is a Coq <span class="inlinecode"><span class="id" title="keyword">Module</span></span> <span class="inlinecode"><span class="id" title="keyword">Type</span></span> that declares an <i>interface</i> for the
    table ADT. A <i>parameter</i> is like a definition, except it declares
    only the type of an identifier, not the value to which it is
    bound.  An <i>axiom</i> is similarly like a theorem, except no proof is
    provided. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <a name="Table"><span class="id" title="module">Table</span></a>.<br/>
</div>

<div class="doc">
A <span class="inlinecode"><span class="id" title="var">table</span></span> is a binding from keys to values. It is <i>total</i>,
      meaning it binds all keys. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="Table.table"><span class="id" title="axiom">table</span></a> : <span class="id" title="keyword">Type</span>.<br/>
</div>

<div class="doc">
Keys are natural numbers. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Table.key"><span class="id" title="definition">key</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
</div>

<div class="doc">
Values are an arbitrary type <span class="inlinecode"><span class="id" title="var">V</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="Table.V"><span class="id" title="axiom">V</span></a> : <span class="id" title="keyword">Type</span>.<br/>
</div>

<div class="doc">
The default value to which keys are bound. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="Table.default"><span class="id" title="axiom">default</span></a> : <a class="idref" href="ADT.html#Table.V"><span class="id" title="axiom">V</span></a>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">empty</span></span> is the table that binds all keys to the default value. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="Table.empty"><span class="id" title="axiom">empty</span></a> : <a class="idref" href="ADT.html#Table.table"><span class="id" title="axiom">table</span></a>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">get</span></span> <span class="inlinecode"><span class="id" title="var">k</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> is the value <span class="inlinecode"><span class="id" title="var">v</span></span> to which <span class="inlinecode"><span class="id" title="var">k</span></span> is bound in <span class="inlinecode"><span class="id" title="var">t</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="Table.get"><span class="id" title="axiom">get</span></a> : <a class="idref" href="ADT.html#Table.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#Table.table"><span class="id" title="axiom">table</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#Table.V"><span class="id" title="axiom">V</span></a>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="tactic">set</span></span> <span class="inlinecode"><span class="id" title="var">k</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> is the table that binds <span class="inlinecode"><span class="id" title="var">k</span></span> to <span class="inlinecode"><span class="id" title="var">v</span></span> and otherwise has
      the same bindings as <span class="inlinecode"><span class="id" title="var">t</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="Table.set"><span class="id" title="axiom">set</span></a> : <a class="idref" href="ADT.html#Table.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#Table.V"><span class="id" title="axiom">V</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#Table.table"><span class="id" title="axiom">table</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#Table.table"><span class="id" title="axiom">table</span></a>.<br/>
</div>

<div class="doc">
The following three axioms are an equational specification for
      the table ADT. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Table.get_empty_default"><span class="id" title="axiom">get_empty_default</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#Table.key"><span class="id" title="definition">key</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#Table.get"><span class="id" title="axiom">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#Table.empty"><span class="id" title="axiom">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#Table.default"><span class="id" title="axiom">default</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Table.get_set_same"><span class="id" title="axiom">get_set_same</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#Table.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#Table.V"><span class="id" title="axiom">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#Table.table"><span class="id" title="axiom">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#Table.get"><span class="id" title="axiom">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ADT.html#Table.set"><span class="id" title="axiom">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Table.get_set_other"><span class="id" title="axiom">get_set_other</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> <span class="id" title="var">k'</span> : <a class="idref" href="ADT.html#Table.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#Table.V"><span class="id" title="axiom">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#Table.table"><span class="id" title="axiom">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc<sub>9</sub>"><span class="id" title="notation">≠</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#Table.get"><span class="id" title="axiom">get</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> (<a class="idref" href="ADT.html#Table.set"><span class="id" title="axiom">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#Table.get"><span class="id" title="axiom">get</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#Table"><span class="id" title="module">Table</span></a>.<br/>
</div>

<div class="doc">
<a name="lab147"></a><h1 class="section">Implementing <span class="inlinecode"><span class="id" title="var">Table</span></span> with Functions</h1>

<div class="paragraph"> </div>

 We can <i>implement</i> <span class="inlinecode"><span class="id" title="var">Table</span></span> with a <span class="inlinecode"><span class="id" title="keyword">Module</span></span> that is
    parameterized on the type of values -- or, rather, parameterized
    on a module that contains such a type.  A parameterized module is
    also called a <i>functor</i>.

<div class="paragraph"> </div>

    Module type <span class="inlinecode"><span class="id" title="var">ValType</span></span> says that there must be a type named <span class="inlinecode"><span class="id" title="var">V</span></span>,
    with a default value provided: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <a name="ValType"><span class="id" title="module">ValType</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ValType.V"><span class="id" title="axiom">V</span></a> : <span class="id" title="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ValType.default"><span class="id" title="axiom">default</span></a> : <a class="idref" href="ADT.html#ValType.V"><span class="id" title="axiom">V</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#ValType"><span class="id" title="module">ValType</span></a>.<br/>
</div>

<div class="doc">
Functor <span class="inlinecode"><span class="id" title="var">FunTable</span></span> takes as input a module of type
    <span class="inlinecode"><span class="id" title="var">ValType</span></span>, which must therefore contain a type <span class="inlinecode"><span class="id" title="var">V</span></span>.  As output,
    <span class="inlinecode"><span class="id" title="var">FunTable</span></span> produces a module of type <span class="inlinecode"><span class="id" title="var">Table</span></span>.  By writing <span class="inlinecode">&lt;:</span>
    <span class="inlinecode"><span class="id" title="var">Table</span></span>, below, we ask Coq to check that the output module contains
    all the components required by <span class="inlinecode"><span class="id" title="var">Table</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="FunTable"><span class="id" title="module">FunTable</span></a> (<span class="id" title="var">VT</span> : <a class="idref" href="ADT.html#ValType"><span class="id" title="module">ValType</span></a>) &lt;: <a class="idref" href="ADT.html#Table"><span class="id" title="module">Table</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="FunTable.V"><span class="id" title="definition">V</span></a> := <a class="idref" href="ADT.html#VT.V"><span class="id" title="axiom">VT.V</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="FunTable.default"><span class="id" title="definition">default</span></a> := <a class="idref" href="ADT.html#VT.default"><span class="id" title="axiom">VT.default</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="FunTable.key"><span class="id" title="definition">key</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
</div>

<div class="doc">
A <span class="inlinecode"><span class="id" title="var">table</span></span> is a function from keys to values. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="FunTable.table"><span class="id" title="definition">table</span></a> := <a class="idref" href="ADT.html#FunTable.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#FunTable.V"><span class="id" title="definition">V</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="FunTable.empty"><span class="id" title="definition">empty</span></a> : <a class="idref" href="ADT.html#FunTable.table"><span class="id" title="definition">table</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <a class="idref" href="ADT.html#FunTable.default"><span class="id" title="definition">default</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="FunTable.get"><span class="id" title="definition">get</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#FunTable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#FunTable.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="ADT.html#FunTable.V"><span class="id" title="definition">V</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="FunTable.set"><span class="id" title="definition">set</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#FunTable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#FunTable.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#FunTable.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="ADT.html#FunTable.table"><span class="id" title="definition">table</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">k'</span> ⇒ <span class="id" title="keyword">if</span> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a>.<br/>
</div>

<div class="doc">
The implementation must prove the theorems that the interface
      specified as axioms. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="FunTable.get_empty_default"><span class="id" title="lemma">get_empty_default</span></a>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#FunTable.key"><span class="id" title="definition">key</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#FunTable.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#FunTable.empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#FunTable.default"><span class="id" title="definition">default</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#FunTable.get"><span class="id" title="definition">get</span></a>, <a class="idref" href="ADT.html#FunTable.empty"><span class="id" title="definition">empty</span></a>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="FunTable.get_set_same"><span class="id" title="lemma">get_set_same</span></a>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#FunTable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#FunTable.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#FunTable.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#FunTable.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ADT.html#FunTable.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#FunTable.get"><span class="id" title="definition">get</span></a>, <a class="idref" href="ADT.html#FunTable.set"><span class="id" title="definition">set</span></a>. <span class="id" title="var">bdall</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="FunTable.get_set_other"><span class="id" title="lemma">get_set_other</span></a>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> <span class="id" title="var">k'</span> : <a class="idref" href="ADT.html#FunTable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#FunTable.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#FunTable.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc<sub>9</sub>"><span class="id" title="notation">≠</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#FunTable.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> (<a class="idref" href="ADT.html#FunTable.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#FunTable.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#FunTable.get"><span class="id" title="definition">get</span></a>, <a class="idref" href="ADT.html#FunTable.set"><span class="id" title="definition">set</span></a>. <span class="id" title="var">bdall</span>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#FunTable"><span class="id" title="module">FunTable</span></a>.<br/>
</div>

<div class="doc">
As an example, let's instantiate <span class="inlinecode"><span class="id" title="var">FunTable</span></span> with strings as
    values. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="StringVal"><span class="id" title="module">StringVal</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="StringVal.V"><span class="id" title="definition">V</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="StringVal.default"><span class="id" title="definition">default</span></a> := ""%<span class="id" title="var">string</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#StringVal"><span class="id" title="module">StringVal</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Module</span> <a name="FunTableExamples"><span class="id" title="module">FunTableExamples</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <a name="FunTableExamples.StringFunTable"><span class="id" title="module">StringFunTable</span></a> := <a class="idref" href="ADT.html#FunTable"><span class="id" title="module">FunTable</span></a> <a class="idref" href="ADT.html#StringVal"><span class="id" title="module">StringVal</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">StringFunTable</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">string_scope</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Example</span> <a name="FunTableExamples.ex1"><span class="id" title="definition">ex<sub>1</sub></span></a> : <a class="idref" href="ADT.html#FunTableExamples.get"><span class="id" title="definition">get</span></a> 0 <a class="idref" href="ADT.html#FunTableExamples.empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> "".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Example</span> <a name="FunTableExamples.ex2"><span class="id" title="definition">ex<sub>2</sub></span></a> : <a class="idref" href="ADT.html#FunTableExamples.get"><span class="id" title="definition">get</span></a> 0 (<a class="idref" href="ADT.html#FunTableExamples.set"><span class="id" title="definition">set</span></a> 0 "A" <a class="idref" href="ADT.html#FunTableExamples.empty"><span class="id" title="definition">empty</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> "A".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Example</span> <a name="FunTableExamples.ex3"><span class="id" title="definition">ex<sub>3</sub></span></a> : <a class="idref" href="ADT.html#FunTableExamples.get"><span class="id" title="definition">get</span></a> 1 (<a class="idref" href="ADT.html#FunTableExamples.set"><span class="id" title="definition">set</span></a> 0 "A" <a class="idref" href="ADT.html#FunTableExamples.empty"><span class="id" title="definition">empty</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> "".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#FunTableExamples"><span class="id" title="module">FunTableExamples</span></a>.<br/>
</div>

<div class="doc">
<a name="lab148"></a><h4 class="section">Exercise: 2 stars, standard, optional (NatFunTableExamples)</h4>

<div class="paragraph"> </div>

 Define a module that uses <span class="inlinecode"><span class="id" title="var">FunTable</span></span> to implement a table mapping
    keys to values, where the values have type <span class="inlinecode"><span class="id" title="var">nat</span></span>, with a default of <span class="inlinecode">0</span>.
    Write unit tests to check the operation of <span class="inlinecode"><span class="id" title="var">get</span></span> and <span class="inlinecode"><span class="id" title="tactic">set</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="NatFunTableExamples"><span class="id" title="module">NatFunTableExamples</span></a>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span><br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#NatFunTableExamples"><span class="id" title="module">NatFunTableExamples</span></a>.<br/>
<font size=-2>&#9744;</font>
</div>


<div class="doc">
<a name="lab149"></a><h1 class="section">Implementing <span class="inlinecode"><span class="id" title="var">Table</span></span> with Lists</h1>

<div class="paragraph"> </div>

<a name="lab150"></a><h4 class="section">Exercise: 3 stars, standard (lists_table)</h4>

<div class="paragraph"> </div>

 Use association lists to implement <span class="inlinecode"><span class="id" title="var">Table</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="ListsTable"><span class="id" title="module">ListsTable</span></a> (<span class="id" title="var">VT</span> : <a class="idref" href="ADT.html#ValType"><span class="id" title="module">ValType</span></a>) &lt;: <a class="idref" href="ADT.html#Table"><span class="id" title="module">Table</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListsTable.V"><span class="id" title="definition">V</span></a> := <a class="idref" href="ADT.html#VT.V"><span class="id" title="axiom">VT.V</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListsTable.default"><span class="id" title="definition">default</span></a> := <a class="idref" href="ADT.html#VT.default"><span class="id" title="axiom">VT.default</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListsTable.key"><span class="id" title="definition">key</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListsTable.table"><span class="id" title="definition">table</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ADT.html#ListsTable.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b<sub>5</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="ADT.html#ListsTable.V"><span class="id" title="definition">V</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListsTable.empty"><span class="id" title="definition">empty</span></a> : <a class="idref" href="ADT.html#ListsTable.table"><span class="id" title="definition">table</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="ListsTable.get"><span class="id" title="definition">get</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ListsTable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ListsTable.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="ADT.html#ListsTable.V"><span class="id" title="definition">V</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListsTable.set"><span class="id" title="definition">set</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ListsTable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ListsTable.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ListsTable.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="ADT.html#ListsTable.table"><span class="id" title="definition">table</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="ListsTable.get_empty_default"><span class="id" title="lemma">get_empty_default</span></a>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ListsTable.key"><span class="id" title="definition">key</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ListsTable.get"><span class="id" title="axiom">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#ListsTable.empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#ListsTable.default"><span class="id" title="definition">default</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="ListsTable.get_set_same"><span class="id" title="lemma">get_set_same</span></a>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ListsTable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ListsTable.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ListsTable.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ListsTable.get"><span class="id" title="axiom">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ADT.html#ListsTable.set"><span class="id" title="axiom">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="ListsTable.get_set_other"><span class="id" title="lemma">get_set_other</span></a>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> <span class="id" title="var">k'</span> : <a class="idref" href="ADT.html#ListsTable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ListsTable.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ListsTable.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc<sub>9</sub>"><span class="id" title="notation">≠</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#ListsTable.get"><span class="id" title="axiom">get</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> (<a class="idref" href="ADT.html#ListsTable.set"><span class="id" title="axiom">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#ListsTable.get"><span class="id" title="axiom">get</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#ListsTable"><span class="id" title="module">ListsTable</span></a>.<br/>
</div>

<div class="doc">
Instantiate your table and prove the following facts. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="StringListsTableExamples"><span class="id" title="module">StringListsTableExamples</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <a name="StringListsTableExamples.StringListsTable"><span class="id" title="module">StringListsTable</span></a> := <a class="idref" href="ADT.html#ListsTable"><span class="id" title="module">ListsTable</span></a> <a class="idref" href="ADT.html#StringVal"><span class="id" title="module">StringVal</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">StringListsTable</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">string_scope</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Example</span> <a name="StringListsTableExamples.ex1"><span class="id" title="definition">ex<sub>1</sub></span></a> : <a class="idref" href="ADT.html#StringListsTableExamples.get"><span class="id" title="axiom">get</span></a> 0 <a class="idref" href="ADT.html#StringListsTableExamples.empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> "".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Example</span> <a name="StringListsTableExamples.ex2"><span class="id" title="definition">ex<sub>2</sub></span></a> : <a class="idref" href="ADT.html#StringListsTableExamples.get"><span class="id" title="axiom">get</span></a> 0 (<a class="idref" href="ADT.html#StringListsTableExamples.set"><span class="id" title="axiom">set</span></a> 0 "A" <a class="idref" href="ADT.html#StringListsTableExamples.empty"><span class="id" title="definition">empty</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> "A".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Example</span> <a name="StringListsTableExamples.ex3"><span class="id" title="definition">ex<sub>3</sub></span></a> : <a class="idref" href="ADT.html#StringListsTableExamples.get"><span class="id" title="axiom">get</span></a> 1 (<a class="idref" href="ADT.html#StringListsTableExamples.set"><span class="id" title="axiom">set</span></a> 0 "A" <a class="idref" href="ADT.html#StringListsTableExamples.empty"><span class="id" title="definition">empty</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> "".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#StringListsTableExamples"><span class="id" title="module">StringListsTableExamples</span></a>.<br/>
<font size=-2>&#9744;</font>
</div>


<div class="doc">
<a name="lab151"></a><h1 class="section">Implementing <span class="inlinecode"><span class="id" title="var">Table</span></span> with BSTs</h1>

<div class="paragraph"> </div>

 Tables implemented with functions and association lists are, of course,
    inefficient.  For a more efficient implementation, we can use BSTs. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="TreeTable"><span class="id" title="module">TreeTable</span></a> (<span class="id" title="var">VT</span> : <a class="idref" href="ADT.html#ValType"><span class="id" title="module">ValType</span></a>) &lt;: <a class="idref" href="ADT.html#Table"><span class="id" title="module">Table</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeTable.V"><span class="id" title="definition">V</span></a> := <a class="idref" href="ADT.html#VT.V"><span class="id" title="axiom">VT.V</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeTable.default"><span class="id" title="definition">default</span></a> := <a class="idref" href="ADT.html#VT.default"><span class="id" title="axiom">VT.default</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeTable.key"><span class="id" title="definition">key</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeTable.table"><span class="id" title="definition">table</span></a> := <a class="idref" href="SearchTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="ADT.html#TreeTable.V"><span class="id" title="definition">V</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeTable.empty"><span class="id" title="definition">empty</span></a> : <a class="idref" href="ADT.html#TreeTable.table"><span class="id" title="definition">table</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;@<a class="idref" href="SearchTree.html#empty_tree"><span class="id" title="definition">empty_tree</span></a> <a class="idref" href="ADT.html#TreeTable.V"><span class="id" title="definition">V</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeTable.get"><span class="id" title="definition">get</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeTable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">t</span>: <a class="idref" href="ADT.html#TreeTable.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="ADT.html#TreeTable.V"><span class="id" title="definition">V</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#lookup"><span class="id" title="definition">lookup</span></a> <a class="idref" href="ADT.html#TreeTable.default"><span class="id" title="definition">default</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeTable.set"><span class="id" title="definition">set</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeTable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeTable.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeTable.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="ADT.html#TreeTable.table"><span class="id" title="definition">table</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#insert"><span class="id" title="definition">insert</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/>
</div>

<div class="doc">
The three basic equations we proved about <span class="inlinecode"><span class="id" title="var">tree</span></span> in
      <a href="SearchTree.html"><span class="inlineref">SearchTree</span></a> make short work of the theorems we need to
      prove for <span class="inlinecode"><span class="id" title="var">Table</span></span>. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeTable.get_empty_default"><span class="id" title="lemma">get_empty_default</span></a>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeTable.key"><span class="id" title="definition">key</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeTable.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#TreeTable.empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#TreeTable.default"><span class="id" title="definition">default</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="SearchTree.html#lookup_empty"><span class="id" title="lemma">lookup_empty</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeTable.get_set_same"><span class="id" title="lemma">get_set_same</span></a>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeTable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeTable.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeTable.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeTable.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ADT.html#TreeTable.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#TreeTable.get"><span class="id" title="definition">get</span></a>, <a class="idref" href="ADT.html#TreeTable.set"><span class="id" title="definition">set</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="SearchTree.html#lookup_insert_eq"><span class="id" title="lemma">lookup_insert_eq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeTable.get_set_other"><span class="id" title="lemma">get_set_other</span></a>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> <span class="id" title="var">k'</span> : <a class="idref" href="ADT.html#TreeTable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeTable.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeTable.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc<sub>9</sub>"><span class="id" title="notation">≠</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#TreeTable.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> (<a class="idref" href="ADT.html#TreeTable.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#TreeTable.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#TreeTable.get"><span class="id" title="definition">get</span></a>, <a class="idref" href="ADT.html#TreeTable.set"><span class="id" title="definition">set</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="SearchTree.html#lookup_insert_neq"><span class="id" title="lemma">lookup_insert_neq</span></a>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#TreeTable"><span class="id" title="module">TreeTable</span></a>.<br/>
</div>

<div class="doc">
<a name="lab152"></a><h1 class="section">Tables with an <span class="inlinecode"><span class="id" title="var">elements</span></span> Operation</h1>

<div class="paragraph"> </div>

 Now let's consider a richer interface <span class="inlinecode"><span class="id" title="var">ETable</span></span> for Tables that support
    <span class="inlinecode"><span class="id" title="var">bound</span></span> and <span class="inlinecode"><span class="id" title="var">elements</span></span> operation. 
<div class="paragraph"> </div>

<a name="lab153"></a><h2 class="section">A First Attempt at <span class="inlinecode"><span class="id" title="var">ETable</span></span></h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <a name="ETable_first_attempt"><span class="id" title="module">ETable_first_attempt</span></a>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="keyword">Include</span></span>, as the name suggests, includes all the declarations
      from <span class="inlinecode"><span class="id" title="var">Table</span></span>.  Not only does that save keystrokes, it also means
      if we ever update <span class="inlinecode"><span class="id" title="var">Table</span></span> to have new operations or new types,
      they automatically get included here, too. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Include</span> <a class="idref" href="ADT.html#Table"><span class="id" title="module">Table</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETable_first_attempt.bound"><span class="id" title="axiom">bound</span></a> : <a class="idref" href="ADT.html#ETable_first_attempt.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#ETable_first_attempt.table"><span class="id" title="axiom">table</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETable_first_attempt.elements"><span class="id" title="axiom">elements</span></a> : <a class="idref" href="ADT.html#ETable_first_attempt.table"><span class="id" title="axiom">table</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ADT.html#ETable_first_attempt.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b<sub>5</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="ADT.html#ETable_first_attempt.V"><span class="id" title="axiom">V</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETable_first_attempt.elements_complete"><span class="id" title="axiom">elements_complete</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ETable_first_attempt.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ETable_first_attempt.V"><span class="id" title="axiom">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ETable_first_attempt.table"><span class="id" title="axiom">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETable_first_attempt.bound"><span class="id" title="axiom">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETable_first_attempt.get"><span class="id" title="axiom">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#ETable_first_attempt.elements"><span class="id" title="axiom">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETable_first_attempt.elements_correct"><span class="id" title="axiom">elements_correct</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ETable_first_attempt.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ETable_first_attempt.V"><span class="id" title="axiom">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ETable_first_attempt.table"><span class="id" title="axiom">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#ETable_first_attempt.elements"><span class="id" title="axiom">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETable_first_attempt.bound"><span class="id" title="axiom">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="ADT.html#ETable_first_attempt.get"><span class="id" title="axiom">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#ETable_first_attempt"><span class="id" title="module">ETable_first_attempt</span></a>.<br/>
</div>

<div class="doc">
We proved in <a href="SearchTree.html"><span class="inlineref">SearchTree</span></a> that the BST <span class="inlinecode"><span class="id" title="var">elements</span></span> operation is
    correct and complete.  So we ought to be able to implement
    <span class="inlinecode"><span class="id" title="var">ETable</span></span> with BSTs.  Let's try. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="TreeETable_first_attempt"><span class="id" title="module">TreeETable_first_attempt</span></a> (<span class="id" title="var">VT</span> : <a class="idref" href="ADT.html#ValType"><span class="id" title="module">ValType</span></a>) &lt;: <a class="idref" href="ADT.html#ETable_first_attempt"><span class="id" title="module">ETable_first_attempt</span></a>.<br/>
</div>

<div class="doc">
Include all the definitions from <span class="inlinecode"><span class="id" title="var">TreeTable</span></span>, instantiated on
      <span class="inlinecode"><span class="id" title="var">VT</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Include</span> <a class="idref" href="ADT.html#TreeTable"><span class="id" title="module">TreeTable</span></a> <a class="idref" href="ADT.html#VT"><span class="id" title="module">VT</span></a>.<br/>
</div>

<div class="doc">
Thanks to the <span class="inlinecode"><span class="id" title="keyword">Include</span></span>, we now have all the tree operations
      defined "for free" in this module.  For example: 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Check</span> <a class="idref" href="ADT.html#TreeETable_first_attempt.get"><span class="id" title="definition">get</span></a> : <a class="idref" href="ADT.html#TreeETable_first_attempt.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#TreeETable_first_attempt.table"><span class="id" title="definition">table</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#TreeETable_first_attempt.V"><span class="id" title="definition">V</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETable_first_attempt.bound"><span class="id" title="definition">bound</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETable_first_attempt.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETable_first_attempt.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#bound"><span class="id" title="definition">SearchTree.bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETable_first_attempt.elements"><span class="id" title="definition">elements</span></a> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETable_first_attempt.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ADT.html#TreeETable_first_attempt.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b<sub>5</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="ADT.html#TreeETable_first_attempt.V"><span class="id" title="definition">V</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#elements"><span class="id" title="definition">SearchTree.elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETable_first_attempt.elements_complete"><span class="id" title="lemma">elements_complete</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETable_first_attempt.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETable_first_attempt.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETable_first_attempt.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETable_first_attempt.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETable_first_attempt.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#TreeETable_first_attempt.elements"><span class="id" title="definition">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span> <span class="id" title="var">Hbound</span> <span class="id" title="var">Hlookup</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#TreeETable_first_attempt.get"><span class="id" title="definition">get</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlookup</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="tactic">pose</span></span> <span class="inlinecode"><span class="id" title="var">proof</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="keyword">as</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> is equivalent to <span class="inlinecode"><span class="id" title="tactic">assert</span></span> <span class="inlinecode">(<span class="id" title="var">H</span></span> <span class="inlinecode">:</span> <span class="inlinecode">...<span class="id" title="var">the</span></span> <span class="inlinecode"><span class="id" title="keyword">type</span></span>
        <span class="inlinecode"><span class="id" title="keyword">of</span></span> <span class="inlinecode"><span class="id" title="var">t</span>...).</span> <span class="inlinecode">{</span> <span class="inlinecode"><span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="var">t</span>.</span> <span class="inlinecode">}</span> but saves some keystrokes. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="SearchTree.html#elements_complete"><span class="id" title="axiom">SearchTree.elements_complete</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hcomplete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="SearchTree.html#elements_complete_spec"><span class="id" title="definition">elements_complete_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcomplete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcomplete</span> <span class="id" title="keyword">with</span> <a class="idref" href="ADT.html#TreeETable_first_attempt.default"><span class="id" title="definition">default</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- </div>

<div class="doc">
Stuck! We don't know that <span class="inlinecode"><span class="id" title="var">t</span></span> satisfies the BST invariant. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETable_first_attempt.elements_correct"><span class="id" title="lemma">elements_correct</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETable_first_attempt.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETable_first_attempt.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETable_first_attempt.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#TreeETable_first_attempt.elements"><span class="id" title="definition">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETable_first_attempt.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="ADT.html#TreeETable_first_attempt.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<a class="idref" href="SearchTree.html#elements_correct"><span class="id" title="axiom">SearchTree.elements_correct</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hcorrect</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="SearchTree.html#elements_correct_spec"><span class="id" title="definition">elements_correct_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcorrect</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcorrect</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- </div>

<div class="doc">
Again stuck because of the BST invariant. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#TreeETable_first_attempt"><span class="id" title="module">TreeETable_first_attempt</span></a>.<br/>
</div>

<div class="doc">
<a name="lab154"></a><h2 class="section">A Revised <span class="inlinecode"><span class="id" title="var">ETable</span></span></h2>

<div class="paragraph"> </div>

 To prove that <span class="inlinecode"><span class="id" title="var">elements</span></span> is correct, we need to know that
    trees satisfy the BST invariant. So, we declare a function
    <span class="inlinecode"><span class="id" title="var">rep_ok</span></span> in the interface, and use it as a precondition for values
    of type <span class="inlinecode"><span class="id" title="var">table</span></span>. We also add axioms to state that the ADT
    operations produce values that satisfy the representation
    invariant, i.e., it is a postcondition. And, we add a
    specification of <span class="inlinecode"><span class="id" title="var">bound</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <a name="ETable"><span class="id" title="module">ETable</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Include</span> <a class="idref" href="ADT.html#Table"><span class="id" title="module">Table</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETable.rep_ok"><span class="id" title="axiom">rep_ok</span></a> : <a class="idref" href="ADT.html#ETable.table"><span class="id" title="axiom">table</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETable.bound"><span class="id" title="axiom">bound</span></a> : <a class="idref" href="ADT.html#ETable.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#ETable.table"><span class="id" title="axiom">table</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETable.elements"><span class="id" title="axiom">elements</span></a> : <a class="idref" href="ADT.html#ETable.table"><span class="id" title="axiom">table</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ADT.html#ETable.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b<sub>5</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="ADT.html#ETable.V"><span class="id" title="axiom">V</span></a>).<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">empty</span></span> and <span class="inlinecode"><span class="id" title="tactic">set</span></span> produce valid representations. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETable.empty_ok"><span class="id" title="axiom">empty_ok</span></a> : <a class="idref" href="ADT.html#ETable.rep_ok"><span class="id" title="axiom">rep_ok</span></a> <a class="idref" href="ADT.html#ETable.empty"><span class="id" title="axiom">empty</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETable.set_ok"><span class="id" title="axiom">set_ok</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ETable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ETable.V"><span class="id" title="axiom">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ETable.table"><span class="id" title="axiom">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETable.rep_ok"><span class="id" title="axiom">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#ETable.rep_ok"><span class="id" title="axiom">rep_ok</span></a> (<a class="idref" href="ADT.html#ETable.set"><span class="id" title="axiom">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/>
</div>

<div class="doc">
The specification of <span class="inlinecode"><span class="id" title="var">bound</span></span>: 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETable.bound_empty"><span class="id" title="axiom">bound_empty</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ETable.key"><span class="id" title="definition">key</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETable.bound"><span class="id" title="axiom">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#ETable.empty"><span class="id" title="axiom">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETable.bound_set_same"><span class="id" title="axiom">bound_set_same</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ETable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ETable.V"><span class="id" title="axiom">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ETable.table"><span class="id" title="axiom">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETable.bound"><span class="id" title="axiom">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ADT.html#ETable.set"><span class="id" title="axiom">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETable.bound_set_other"><span class="id" title="axiom">bound_set_other</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> <span class="id" title="var">k'</span> : <a class="idref" href="ADT.html#ETable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ETable.V"><span class="id" title="axiom">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ETable.table"><span class="id" title="axiom">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc<sub>9</sub>"><span class="id" title="notation">≠</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#ETable.bound"><span class="id" title="axiom">bound</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> (<a class="idref" href="ADT.html#ETable.set"><span class="id" title="axiom">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#ETable.bound"><span class="id" title="axiom">bound</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/>
</div>

<div class="doc">
The specification of <span class="inlinecode"><span class="id" title="var">elements</span></span>: 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETable.elements_complete"><span class="id" title="axiom">elements_complete</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ETable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ETable.V"><span class="id" title="axiom">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ETable.table"><span class="id" title="axiom">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETable.rep_ok"><span class="id" title="axiom">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETable.bound"><span class="id" title="axiom">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETable.get"><span class="id" title="axiom">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#ETable.elements"><span class="id" title="axiom">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETable.elements_correct"><span class="id" title="axiom">elements_correct</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ETable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ETable.V"><span class="id" title="axiom">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ETable.table"><span class="id" title="axiom">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETable.rep_ok"><span class="id" title="axiom">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#ETable.elements"><span class="id" title="axiom">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETable.bound"><span class="id" title="axiom">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="ADT.html#ETable.get"><span class="id" title="axiom">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#ETable"><span class="id" title="module">ETable</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Module</span> <a name="TreeETable"><span class="id" title="module">TreeETable</span></a> (<span class="id" title="var">VT</span> : <a class="idref" href="ADT.html#ValType"><span class="id" title="module">ValType</span></a>) &lt;: <a class="idref" href="ADT.html#ETable"><span class="id" title="module">ETable</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Include</span> <a class="idref" href="ADT.html#TreeTable"><span class="id" title="module">TreeTable</span></a> <a class="idref" href="ADT.html#VT"><span class="id" title="module">VT</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETable.rep_ok"><span class="id" title="definition">rep_ok</span></a> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETable.table"><span class="id" title="definition">table</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#BST"><span class="id" title="inductive">BST</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETable.bound"><span class="id" title="definition">bound</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETable.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#bound"><span class="id" title="definition">SearchTree.bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETable.elements"><span class="id" title="definition">elements</span></a> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETable.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ADT.html#TreeETable.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b<sub>5</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="ADT.html#TreeETable.V"><span class="id" title="definition">V</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#elements"><span class="id" title="definition">SearchTree.elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETable.empty_ok"><span class="id" title="lemma">empty_ok</span></a> : <a class="idref" href="ADT.html#TreeETable.rep_ok"><span class="id" title="definition">rep_ok</span></a> <a class="idref" href="ADT.html#TreeETable.empty"><span class="id" title="definition">empty</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="SearchTree.html#empty_tree_BST"><span class="id" title="axiom">empty_tree_BST</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETable.set_ok"><span class="id" title="lemma">set_ok</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETable.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETable.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETable.rep_ok"><span class="id" title="definition">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#TreeETable.rep_ok"><span class="id" title="definition">rep_ok</span></a> (<a class="idref" href="ADT.html#TreeETable.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="SearchTree.html#insert_BST"><span class="id" title="axiom">insert_BST</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETable.bound_empty"><span class="id" title="lemma">bound_empty</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETable.key"><span class="id" title="definition">key</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETable.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#TreeETable.empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETable.bound_set_same"><span class="id" title="lemma">bound_set_same</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETable.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETable.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETable.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ADT.html#TreeETable.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#TreeETable.bound"><span class="id" title="definition">bound</span></a>, <a class="idref" href="ADT.html#TreeETable.set"><span class="id" title="definition">set</span></a>. <span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="var">bdall</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETable.bound_set_other"><span class="id" title="lemma">bound_set_other</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> <span class="id" title="var">k'</span> : <a class="idref" href="ADT.html#TreeETable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETable.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETable.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc<sub>9</sub>"><span class="id" title="notation">≠</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#TreeETable.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> (<a class="idref" href="ADT.html#TreeETable.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#TreeETable.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span> <span class="id" title="var">Hneq</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#TreeETable.bound"><span class="id" title="definition">bound</span></a>, <a class="idref" href="ADT.html#TreeETable.set"><span class="id" title="definition">set</span></a>. <span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="var">bdall</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETable.elements_complete"><span class="id" title="lemma">elements_complete</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETable.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETable.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETable.rep_ok"><span class="id" title="definition">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETable.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETable.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#TreeETable.elements"><span class="id" title="definition">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span> <span class="id" title="var">Hbound</span> <span class="id" title="var">Hlookup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <a class="idref" href="SearchTree.html#elements_complete"><span class="id" title="axiom">SearchTree.elements_complete</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">Hcomplete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="SearchTree.html#elements_complete_spec"><span class="id" title="definition">elements_complete_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcomplete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcomplete</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETable.elements_correct"><span class="id" title="lemma">elements_correct</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETable.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETable.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETable.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETable.rep_ok"><span class="id" title="definition">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#TreeETable.elements"><span class="id" title="definition">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETable.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="ADT.html#TreeETable.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <a class="idref" href="SearchTree.html#elements_correct"><span class="id" title="axiom">SearchTree.elements_correct</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">Hcorrect</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="SearchTree.html#elements_correct_spec"><span class="id" title="definition">elements_correct_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcorrect</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcorrect</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#TreeETable"><span class="id" title="module">TreeETable</span></a>.<br/>
</div>

<div class="doc">
Now we can use the table. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="StringTreeETableExample"><span class="id" title="module">StringTreeETableExample</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <a name="StringTreeETableExample.StringTreeETable"><span class="id" title="module">StringTreeETable</span></a> := <a class="idref" href="ADT.html#TreeETable"><span class="id" title="module">TreeETable</span></a> <a class="idref" href="ADT.html#StringVal"><span class="id" title="module">StringVal</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">StringTreeETable</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">string_scope</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Example</span> <a name="StringTreeETableExample.ex1"><span class="id" title="definition">ex<sub>1</sub></span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a>0<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> "A"<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#StringTreeETableExample.elements"><span class="id" title="definition">elements</span></a> (<a class="idref" href="ADT.html#StringTreeETableExample.set"><span class="id" title="definition">set</span></a> 0 "A" (<a class="idref" href="ADT.html#StringTreeETableExample.set"><span class="id" title="definition">set</span></a> 1 "B" <a class="idref" href="ADT.html#StringTreeETableExample.empty"><span class="id" title="definition">empty</span></a>))).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ADT.html#StringTreeETableExample.elements_complete"><span class="id" title="lemma">elements_complete</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span> <span class="id" title="keyword">using</span> <a class="idref" href="ADT.html#StringTreeETableExample.empty_ok"><span class="id" title="lemma">empty_ok</span></a>, <a class="idref" href="ADT.html#StringTreeETableExample.set_ok"><span class="id" title="lemma">set_ok</span></a>, <a class="idref" href="ADT.html#StringTreeETableExample.bound_set_same"><span class="id" title="lemma">bound_set_same</span></a>, <a class="idref" href="ADT.html#StringTreeETableExample.get_set_same"><span class="id" title="lemma">get_set_same</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#StringTreeETableExample"><span class="id" title="module">StringTreeETableExample</span></a>.<br/>
</div>

<div class="doc">
<a name="lab155"></a><h1 class="section">Encapsulation with the Coq Module System (Advanced)</h1>

<div class="paragraph"> </div>

 Functor <span class="inlinecode"><span class="id" title="var">TreeETable</span></span>, above, reveals internal implementation
    details that your data structures class probably taught you are
    better kept private.  For example, the constructors <span class="inlinecode"><span class="id" title="var">E</span></span> and <span class="inlinecode"><span class="id" title="var">T</span></span> of
    trees and the implementation of <span class="inlinecode"><span class="id" title="var">get</span></span> are publicly exposed: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="exposed_trees_ex"><span class="id" title="definition">exposed_trees_ex</span></a> :<br/>
&nbsp;&nbsp;(<a class="idref" href="ADT.html#get"><span class="id" title="definition">StringTreeETableExample.StringTreeETable.get</span></a> 0 (<a class="idref" href="SearchTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="SearchTree.html#E"><span class="id" title="constructor">E</span></a> 0 "A" <a class="idref" href="SearchTree.html#E"><span class="id" title="constructor">E</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> "A")%<span class="id" title="var">string</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#get"><span class="id" title="definition">StringTreeETableExample.StringTreeETable.get</span></a>. <span class="comment">(*&nbsp;we&nbsp;can&nbsp;see&nbsp;<span class="inlinecode"><span class="id" title="var">lookup</span></span>&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Like many languages, Coq makes it possible to <i>encapsulate</i>
    these details, meaning that they become hidden outside the module.
    It's a simple matter of changing the <span class="inlinecode">&lt;:</span> syntax to <span class="inlinecode">:</span> in the
    functor's type.  The only change in the implementation below is
    that one character. 
<div class="paragraph"> </div>

 The <span class="inlinecode">:</span> syntax makes the module type <i>opaque</i>: only what is
    revealed in the type is available for code outside the module to
    use.  The <span class="inlinecode">&lt;:</span> syntax, however, makes the module type
    <i>transparent</i>: the module must conform to the type, but everything
    about the module is still revealed. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="TreeETableFullyEncapsulated"><span class="id" title="module">TreeETableFullyEncapsulated</span></a> (<span class="id" title="var">VT</span> : <a class="idref" href="ADT.html#ValType"><span class="id" title="module">ValType</span></a>) : <a class="idref" href="ADT.html#ETable"><span class="id" title="module">ETable</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Include</span> <a class="idref" href="ADT.html#TreeTable"><span class="id" title="module">TreeTable</span></a> <a class="idref" href="ADT.html#VT"><span class="id" title="module">VT</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETableFullyEncapsulated.rep_ok"><span class="id" title="definition">rep_ok</span></a> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.table"><span class="id" title="definition">table</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#BST"><span class="id" title="inductive">BST</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETableFullyEncapsulated.bound"><span class="id" title="definition">bound</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#bound"><span class="id" title="definition">SearchTree.bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETableFullyEncapsulated.elements"><span class="id" title="definition">elements</span></a> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ADT.html#TreeETableFullyEncapsulated.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b<sub>5</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.V"><span class="id" title="definition">V</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#elements"><span class="id" title="definition">SearchTree.elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableFullyEncapsulated.empty_ok"><span class="id" title="lemma">empty_ok</span></a> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.rep_ok"><span class="id" title="definition">rep_ok</span></a> <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.empty"><span class="id" title="definition">empty</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="SearchTree.html#empty_tree_BST"><span class="id" title="axiom">empty_tree_BST</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableFullyEncapsulated.set_ok"><span class="id" title="lemma">set_ok</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableFullyEncapsulated.rep_ok"><span class="id" title="definition">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.rep_ok"><span class="id" title="definition">rep_ok</span></a> (<a class="idref" href="ADT.html#TreeETableFullyEncapsulated.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="SearchTree.html#insert_BST"><span class="id" title="axiom">insert_BST</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableFullyEncapsulated.bound_empty"><span class="id" title="lemma">bound_empty</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.key"><span class="id" title="definition">key</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableFullyEncapsulated.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableFullyEncapsulated.bound_set_same"><span class="id" title="lemma">bound_set_same</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableFullyEncapsulated.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ADT.html#TreeETableFullyEncapsulated.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.bound"><span class="id" title="definition">bound</span></a>, <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.set"><span class="id" title="definition">set</span></a>. <span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="var">bdall</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableFullyEncapsulated.bound_set_other"><span class="id" title="lemma">bound_set_other</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> <span class="id" title="var">k'</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc<sub>9</sub>"><span class="id" title="notation">≠</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> (<a class="idref" href="ADT.html#TreeETableFullyEncapsulated.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span> <span class="id" title="var">Hneq</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.bound"><span class="id" title="definition">bound</span></a>, <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.set"><span class="id" title="definition">set</span></a>. <span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="var">bdall</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableFullyEncapsulated.elements_complete"><span class="id" title="lemma">elements_complete</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableFullyEncapsulated.rep_ok"><span class="id" title="definition">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableFullyEncapsulated.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableFullyEncapsulated.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#TreeETableFullyEncapsulated.elements"><span class="id" title="definition">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span> <span class="id" title="var">Hbound</span> <span class="id" title="var">Hlookup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <a class="idref" href="SearchTree.html#elements_complete"><span class="id" title="axiom">SearchTree.elements_complete</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">Hcomplete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="SearchTree.html#elements_complete_spec"><span class="id" title="definition">elements_complete_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcomplete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcomplete</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableFullyEncapsulated.elements_correct"><span class="id" title="lemma">elements_correct</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableFullyEncapsulated.rep_ok"><span class="id" title="definition">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#TreeETableFullyEncapsulated.elements"><span class="id" title="definition">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableFullyEncapsulated.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="ADT.html#TreeETableFullyEncapsulated.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <a class="idref" href="SearchTree.html#elements_correct"><span class="id" title="axiom">SearchTree.elements_correct</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">Hcorrect</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="SearchTree.html#elements_correct_spec"><span class="id" title="definition">elements_correct_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcorrect</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcorrect</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#TreeETableFullyEncapsulated"><span class="id" title="module">TreeETableFullyEncapsulated</span></a>.<br/>
</div>

<div class="doc">
Unfortunately, the module is now too encapsulated to be useful: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="OverlyEncapsulatedExample"><span class="id" title="module">OverlyEncapsulatedExample</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <a name="OverlyEncapsulatedExample.StringTreeETableFullyEncapsulated"><span class="id" title="module">StringTreeETableFullyEncapsulated</span></a> := <a class="idref" href="ADT.html#TreeETableFullyEncapsulated"><span class="id" title="module">TreeETableFullyEncapsulated</span></a> <a class="idref" href="ADT.html#StringVal"><span class="id" title="module">StringVal</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">StringTreeETableFullyEncapsulated</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">string_scope</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="keyword">Example</span> <a name="OverlyEncapsulatedExample.ex1"><span class="id" title="definition">ex<sub>1</sub></span></a> : <a class="idref" href="ADT.html#OverlyEncapsulatedExample.get"><span class="id" title="axiom">get</span></a> 0 <a class="idref" href="ADT.html#OverlyEncapsulatedExample.empty"><span class="id" title="axiom">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> "".<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;fails&nbsp;with&nbsp;an&nbsp;error&nbsp;about&nbsp;<span class="inlinecode">&quot;&quot;</span>&nbsp;not&nbsp;having&nbsp;type&nbsp;<span class="inlinecode"><span class="id" title="var">V</span></span>&nbsp;*)</span><br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#OverlyEncapsulatedExample"><span class="id" title="module">OverlyEncapsulatedExample</span></a>.<br/>
</div>

<div class="doc">
The problem is that the module now hides not only the internal
    implementation, but also the value type <span class="inlinecode"><span class="id" title="var">V</span></span>. The functor was
    instantiated on <span class="inlinecode"><span class="id" title="var">StringVal</span></span>, which defines that type as <span class="inlinecode"><span class="id" title="var">string</span></span>.
    But the output of the functor has type <span class="inlinecode"><span class="id" title="var">ETable</span></span>, which doesn't
    reveal anything about <span class="inlinecode"><span class="id" title="var">V</span></span> except that it is a <span class="inlinecode"><span class="id" title="keyword">Type</span></span>. Note in the
    output of the following command how <span class="inlinecode"><span class="id" title="var">V</span></span> is printed like an axiom
    would be, indicating that nothing is known (externally) about its
    implementation: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Print</span> <a class="idref" href="ADT.html#V"><span class="id" title="axiom">OverlyEncapsulatedExample.StringTreeETableFullyEncapsulated.V</span></a>.<br/>
</div>

<div class="doc">
We need to selectively expose certain implementation details.
    We've just seen that <span class="inlinecode"><span class="id" title="var">V</span></span> should be exposed.  Along with it, we'll
    also want <span class="inlinecode"><span class="id" title="var">default</span></span> to be exposed.  We can accomplish that with an
    advanced feature of Coq's module system.  The Coq manual doesn't
    give this feature a name, but OCaml (in which Coq is implemented)
    calls it a <i>sharing constraint</i>, so we'll use that term here. A
    sharing constraint enables us to constrain definitions shared by
    modules to be the same. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <a name="SimpleTable"><span class="id" title="module">SimpleTable</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="SimpleTable.key"><span class="id" title="axiom">key</span></a> : <span class="id" title="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="SimpleTable.V"><span class="id" title="axiom">V</span></a> : <span class="id" title="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="SimpleTable.default"><span class="id" title="axiom">default</span></a> : <a class="idref" href="ADT.html#SimpleTable.V"><span class="id" title="axiom">V</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="SimpleTable.table"><span class="id" title="axiom">table</span></a> : <span class="id" title="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;omit&nbsp;everything&nbsp;else&nbsp;for&nbsp;sake&nbsp;of&nbsp;a&nbsp;simple&nbsp;example.&nbsp;*)</span><br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#SimpleTable"><span class="id" title="module">SimpleTable</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Module</span> <a name="SimpleStringTable1"><span class="id" title="module">SimpleStringTable1</span></a> : <a class="idref" href="ADT.html#SimpleTable"><span class="id" title="module">SimpleTable</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SimpleStringTable1.key"><span class="id" title="definition">key</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SimpleStringTable1.V"><span class="id" title="definition">V</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SimpleStringTable1.default"><span class="id" title="definition">default</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> := "".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SimpleStringTable1.table"><span class="id" title="definition">table</span></a> := <a class="idref" href="SearchTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="ADT.html#SimpleStringTable1.V"><span class="id" title="definition">V</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#SimpleStringTable1"><span class="id" title="module">SimpleStringTable1</span></a>.<br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;<span class="inlinecode"><span class="id" title="var">V</span></span>&nbsp;is&nbsp;abstract.&nbsp;*)</span><br/>
<span class="id" title="keyword">Print</span> <a class="idref" href="ADT.html#V"><span class="id" title="axiom">SimpleStringTable1.V</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <a name="SimpleTable2"><span class="id" title="module">SimpleTable2</span></a> := <a class="idref" href="ADT.html#SimpleTable"><span class="id" title="module">SimpleTable</span></a> <span class="id" title="keyword">with</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">V</span> := <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Module</span> <a name="SimpleStringTable2"><span class="id" title="module">SimpleStringTable2</span></a> : <a class="idref" href="ADT.html#SimpleTable2"><span class="id" title="module">SimpleTable2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SimpleStringTable2.key"><span class="id" title="definition">key</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SimpleStringTable2.V"><span class="id" title="definition">V</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SimpleStringTable2.default"><span class="id" title="definition">default</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> := "".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SimpleStringTable2.table"><span class="id" title="definition">table</span></a> := <a class="idref" href="SearchTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="ADT.html#SimpleStringTable2.V"><span class="id" title="definition">V</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#SimpleStringTable2"><span class="id" title="module">SimpleStringTable2</span></a>.<br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;<span class="inlinecode"><span class="id" title="var">V</span></span>&nbsp;is&nbsp;exposed,&nbsp;but&nbsp;<span class="inlinecode"><span class="id" title="var">default</span></span>&nbsp;is&nbsp;abstract.&nbsp;*)</span><br/>
<span class="id" title="keyword">Print</span> <a class="idref" href="ADT.html#V"><span class="id" title="axiom">SimpleStringTable2.V</span></a>.<br/>
<span class="id" title="keyword">Print</span> <a class="idref" href="ADT.html#default"><span class="id" title="axiom">SimpleStringTable2.default</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <a name="SimpleTable3"><span class="id" title="module">SimpleTable3</span></a> := <a class="idref" href="ADT.html#SimpleTable"><span class="id" title="module">SimpleTable</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">V</span> := <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">default</span> := ""%<span class="id" title="var">string</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Module</span> <a name="SimpleStringTable3"><span class="id" title="module">SimpleStringTable3</span></a> : <a class="idref" href="ADT.html#SimpleTable3"><span class="id" title="module">SimpleTable3</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SimpleStringTable3.key"><span class="id" title="definition">key</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SimpleStringTable3.V"><span class="id" title="definition">V</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SimpleStringTable3.default"><span class="id" title="definition">default</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a> := "".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SimpleStringTable3.table"><span class="id" title="definition">table</span></a> := <a class="idref" href="SearchTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="ADT.html#SimpleStringTable3.V"><span class="id" title="definition">V</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#SimpleStringTable3"><span class="id" title="module">SimpleStringTable3</span></a>.<br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;Both&nbsp;<span class="inlinecode"><span class="id" title="var">V</span></span>&nbsp;and&nbsp;<span class="inlinecode"><span class="id" title="var">default</span></span>&nbsp;are&nbsp;exposed.&nbsp;*)</span><br/>
<span class="id" title="keyword">Print</span> <a class="idref" href="ADT.html#V"><span class="id" title="axiom">SimpleStringTable3.V</span></a>.<br/>
<span class="id" title="keyword">Print</span> <a class="idref" href="ADT.html#default"><span class="id" title="axiom">SimpleStringTable3.default</span></a>.<br/>
</div>

<div class="doc">
Putting sharing constraints to use, let's expose <span class="inlinecode"><span class="id" title="var">V</span></span> and <span class="inlinecode"><span class="id" title="var">default</span></span>
    in our implementation of tree-based tables. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="TreeETableEncapsulated"><span class="id" title="module">TreeETableEncapsulated</span></a> (<span class="id" title="var">VT</span> : <a class="idref" href="ADT.html#ValType"><span class="id" title="module">ValType</span></a>) : (<a class="idref" href="ADT.html#ETable"><span class="id" title="module">ETable</span></a> <span class="id" title="keyword">with</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">V</span> := <a class="idref" href="ADT.html#VT.V"><span class="id" title="axiom">VT.V</span></a> <span class="id" title="keyword">with</span> <span class="id" title="keyword">Definition</span> <span class="id" title="var">default</span> := <a class="idref" href="ADT.html#VT.default"><span class="id" title="axiom">VT.default</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Include</span> <a class="idref" href="ADT.html#TreeTable"><span class="id" title="module">TreeTable</span></a> <a class="idref" href="ADT.html#VT"><span class="id" title="module">VT</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETableEncapsulated.rep_ok"><span class="id" title="definition">rep_ok</span></a> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.table"><span class="id" title="definition">table</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#BST"><span class="id" title="inductive">BST</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETableEncapsulated.bound"><span class="id" title="definition">bound</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#bound"><span class="id" title="definition">SearchTree.bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETableEncapsulated.elements"><span class="id" title="definition">elements</span></a> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ADT.html#TreeETableEncapsulated.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b<sub>5</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="ADT.html#TreeETableEncapsulated.V"><span class="id" title="definition">V</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#elements"><span class="id" title="definition">SearchTree.elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableEncapsulated.empty_ok"><span class="id" title="lemma">empty_ok</span></a> : <a class="idref" href="ADT.html#TreeETableEncapsulated.rep_ok"><span class="id" title="definition">rep_ok</span></a> <a class="idref" href="ADT.html#TreeETableEncapsulated.empty"><span class="id" title="definition">empty</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="SearchTree.html#empty_tree_BST"><span class="id" title="axiom">empty_tree_BST</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableEncapsulated.set_ok"><span class="id" title="lemma">set_ok</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableEncapsulated.rep_ok"><span class="id" title="definition">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#TreeETableEncapsulated.rep_ok"><span class="id" title="definition">rep_ok</span></a> (<a class="idref" href="ADT.html#TreeETableEncapsulated.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="SearchTree.html#insert_BST"><span class="id" title="axiom">insert_BST</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableEncapsulated.bound_empty"><span class="id" title="lemma">bound_empty</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.key"><span class="id" title="definition">key</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableEncapsulated.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#TreeETableEncapsulated.empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableEncapsulated.bound_set_same"><span class="id" title="lemma">bound_set_same</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableEncapsulated.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ADT.html#TreeETableEncapsulated.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#TreeETableEncapsulated.bound"><span class="id" title="definition">bound</span></a>, <a class="idref" href="ADT.html#TreeETableEncapsulated.set"><span class="id" title="definition">set</span></a>. <span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="var">bdall</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableEncapsulated.bound_set_other"><span class="id" title="lemma">bound_set_other</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> <span class="id" title="var">k'</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc<sub>9</sub>"><span class="id" title="notation">≠</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#TreeETableEncapsulated.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> (<a class="idref" href="ADT.html#TreeETableEncapsulated.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#TreeETableEncapsulated.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span> <span class="id" title="var">Hneq</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#TreeETableEncapsulated.bound"><span class="id" title="definition">bound</span></a>, <a class="idref" href="ADT.html#TreeETableEncapsulated.set"><span class="id" title="definition">set</span></a>. <span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="var">bdall</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableEncapsulated.elements_complete"><span class="id" title="lemma">elements_complete</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableEncapsulated.rep_ok"><span class="id" title="definition">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableEncapsulated.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableEncapsulated.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#TreeETableEncapsulated.elements"><span class="id" title="definition">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span> <span class="id" title="var">Hbound</span> <span class="id" title="var">Hlookup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <a class="idref" href="SearchTree.html#elements_complete"><span class="id" title="axiom">SearchTree.elements_complete</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">Hcomplete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="SearchTree.html#elements_complete_spec"><span class="id" title="definition">elements_complete_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcomplete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcomplete</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableEncapsulated.elements_correct"><span class="id" title="lemma">elements_correct</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableEncapsulated.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableEncapsulated.rep_ok"><span class="id" title="definition">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#TreeETableEncapsulated.elements"><span class="id" title="definition">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableEncapsulated.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="ADT.html#TreeETableEncapsulated.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <a class="idref" href="SearchTree.html#elements_correct"><span class="id" title="axiom">SearchTree.elements_correct</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">Hcorrect</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="SearchTree.html#elements_correct_spec"><span class="id" title="definition">elements_correct_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcorrect</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcorrect</span>; <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#TreeETableEncapsulated"><span class="id" title="module">TreeETableEncapsulated</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Module</span> <a name="NicelyEncapsulatedExample"><span class="id" title="module">NicelyEncapsulatedExample</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <a name="NicelyEncapsulatedExample.StringTreeETableEncapsulated"><span class="id" title="module">StringTreeETableEncapsulated</span></a> := <a class="idref" href="ADT.html#TreeETableEncapsulated"><span class="id" title="module">TreeETableEncapsulated</span></a> <a class="idref" href="ADT.html#StringVal"><span class="id" title="module">StringVal</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">StringTreeETableEncapsulated</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">string_scope</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Example</span> <a name="NicelyEncapsulatedExample.ex1"><span class="id" title="definition">ex<sub>1</sub></span></a> : <a class="idref" href="ADT.html#NicelyEncapsulatedExample.get"><span class="id" title="axiom">get</span></a> 0 <a class="idref" href="ADT.html#NicelyEncapsulatedExample.empty"><span class="id" title="axiom">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> "".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;can't&nbsp;directly&nbsp;simplify,&nbsp;because&nbsp;<span class="inlinecode"><span class="id" title="var">get</span></span>&nbsp;is&nbsp;encapsulated.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;But&nbsp;we&nbsp;can&nbsp;use&nbsp;the&nbsp;specifications&nbsp;exposed&nbsp;in&nbsp;the&nbsp;interface.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="ADT.html#NicelyEncapsulatedExample.get_empty_default"><span class="id" title="axiom">get_empty_default</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;can't&nbsp;fabricate&nbsp;trees&nbsp;with&nbsp;<span class="inlinecode"><span class="id" title="var">T</span></span>&nbsp;and&nbsp;<span class="inlinecode"><span class="id" title="var">E</span></span>&nbsp;anymore,&nbsp;because&nbsp;<span class="inlinecode"><span class="id" title="var">tree</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;encapsulated.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="keyword">Example</span> <a name="NicelyEncapsulatedExample.ex2"><span class="id" title="definition">ex<sub>2</sub></span></a> : <a class="idref" href="ADT.html#NicelyEncapsulatedExample.get"><span class="id" title="axiom">get</span></a> 0 (<a class="idref" href="SearchTree.html#T"><span class="id" title="constructor">T</span></a> <a class="idref" href="SearchTree.html#E"><span class="id" title="constructor">E</span></a> 0 "A" <a class="idref" href="SearchTree.html#E"><span class="id" title="constructor">E</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> "A".<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#NicelyEncapsulatedExample"><span class="id" title="module">NicelyEncapsulatedExample</span></a>.<br/>
</div>

<div class="doc">
Note what we've happily achieved: we can reason about the behavior
    of an ADT entirely from its specification, rather than depending
    on the implementation code.  This is what specification comments
    in interfaces attempt to achieve in real-world code. 
<div class="paragraph"> </div>

<a name="lab156"></a><h4 class="section">Exercise: 4 stars, advanced, optional (elements_spec)</h4>

<div class="paragraph"> </div>

 Develop a nicely-encapsulated interface and implementation of
    tree-based tables that exposes the rest of the specification of
    <span class="inlinecode"><span class="id" title="var">elements</span></span> from <a href="SearchTree.html"><span class="inlineref">SearchTree</span></a>, including the inverses of
    correctness and completenesss, sortedness, and
    non-duplication. Send us your solution, so we can include it! 
<div class="paragraph"> </div>

 <font size=-2>&#9744;</font> 
</div>

<div class="doc">
<a name="lab157"></a><h1 class="section">Model-based Specification</h1>

<div class="paragraph"> </div>

 The interfaces above have been based on equational specification
    of tables.  Let's consider model-based specifications.  Recall
    from <a href="SearchTree.html"><span class="inlineref">SearchTree</span></a> that in this style of specification, we

<div class="paragraph"> </div>

<ul class="doclist">
<li> introduce an abstraction function (or relation) that associates
      a <i>concrete value</i> of the ADT implementation with an <i>abstract
      value</i> in an already well-understood type; and

<div class="paragraph"> </div>


</li>
<li> show that the concrete and abstract operations are related in a
      sensible way. 
</li>
</ul>

<div class="paragraph"> </div>

 We begin by defining a new map operation, <span class="inlinecode"><span class="id" title="var">bound</span></span>, and redefining
    existing operations to make them more clear in the table
    specification we are about to write. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="map_update"><span class="id" title="definition">map_update</span></a> {<span class="id" title="var">V</span> : <span class="id" title="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">k</span> : <a class="idref" href="SearchTree.html#key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#V"><span class="id" title="variable">V</span></a>) (<span class="id" title="var">m</span> : <span class="id" title="definition">partial_map</span> <a class="idref" href="ADT.html#V"><span class="id" title="variable">V</span></a>) : <span class="id" title="definition">partial_map</span> <a class="idref" href="ADT.html#V"><span class="id" title="variable">V</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">update</span> <a class="idref" href="ADT.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a name="map_find"><span class="id" title="definition">map_find</span></a> {<span class="id" title="var">V</span> : <span class="id" title="keyword">Type</span>} := @<a class="idref" href="SearchTree.html#find"><span class="id" title="definition">find</span></a> <a class="idref" href="ADT.html#V"><span class="id" title="variable">V</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a name="empty_map"><span class="id" title="definition">empty_map</span></a> {<span class="id" title="var">V</span> : <span class="id" title="keyword">Type</span>} := @<span class="id" title="definition">Maps.empty</span> <a class="idref" href="ADT.html#V"><span class="id" title="variable">V</span></a>.<br/>
</div>

<div class="doc">
Now we can define an interface for tables that includes an
    abstraction function <span class="inlinecode"><span class="id" title="var">Abs</span></span>, and specifications written in terms of
    it. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <a name="ETableAbs"><span class="id" title="module">ETableAbs</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETableAbs.table"><span class="id" title="axiom">table</span></a> : <span class="id" title="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ETableAbs.key"><span class="id" title="definition">key</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETableAbs.V"><span class="id" title="axiom">V</span></a> : <span class="id" title="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETableAbs.default"><span class="id" title="axiom">default</span></a> : <a class="idref" href="ADT.html#ETableAbs.V"><span class="id" title="axiom">V</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETableAbs.empty"><span class="id" title="axiom">empty</span></a> : <a class="idref" href="ADT.html#ETableAbs.table"><span class="id" title="axiom">table</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETableAbs.get"><span class="id" title="axiom">get</span></a> : <a class="idref" href="ADT.html#ETableAbs.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#ETableAbs.table"><span class="id" title="axiom">table</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#ETableAbs.V"><span class="id" title="axiom">V</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETableAbs.set"><span class="id" title="axiom">set</span></a> : <a class="idref" href="ADT.html#ETableAbs.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#ETableAbs.V"><span class="id" title="axiom">V</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#ETableAbs.table"><span class="id" title="axiom">table</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#ETableAbs.table"><span class="id" title="axiom">table</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETableAbs.bound"><span class="id" title="axiom">bound</span></a> : <a class="idref" href="ADT.html#ETableAbs.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#ETableAbs.table"><span class="id" title="axiom">table</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETableAbs.elements"><span class="id" title="axiom">elements</span></a> : <a class="idref" href="ADT.html#ETableAbs.table"><span class="id" title="axiom">table</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ADT.html#ETableAbs.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b<sub>5</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="ADT.html#ETableAbs.V"><span class="id" title="axiom">V</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETableAbs.Abs"><span class="id" title="axiom">Abs</span></a> : <a class="idref" href="ADT.html#ETableAbs.table"><span class="id" title="axiom">table</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="definition">partial_map</span> <a class="idref" href="ADT.html#ETableAbs.V"><span class="id" title="axiom">V</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETableAbs.rep_ok"><span class="id" title="axiom">rep_ok</span></a> : <a class="idref" href="ADT.html#ETableAbs.table"><span class="id" title="axiom">table</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETableAbs.empty_ok"><span class="id" title="axiom">empty_ok</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETableAbs.rep_ok"><span class="id" title="axiom">rep_ok</span></a> <a class="idref" href="ADT.html#ETableAbs.empty"><span class="id" title="axiom">empty</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETableAbs.set_ok"><span class="id" title="axiom">set_ok</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ETableAbs.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ETableAbs.V"><span class="id" title="axiom">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ETableAbs.table"><span class="id" title="axiom">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETableAbs.rep_ok"><span class="id" title="axiom">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#ETableAbs.rep_ok"><span class="id" title="axiom">rep_ok</span></a> (<a class="idref" href="ADT.html#ETableAbs.set"><span class="id" title="axiom">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETableAbs.empty_relate"><span class="id" title="axiom">empty_relate</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETableAbs.Abs"><span class="id" title="axiom">Abs</span></a> <a class="idref" href="ADT.html#ETableAbs.empty"><span class="id" title="axiom">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#empty_map"><span class="id" title="definition">empty_map</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETableAbs.bound_relate"><span class="id" title="axiom">bound_relate</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ETableAbs.table"><span class="id" title="axiom">table</span></a>) (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ETableAbs.key"><span class="id" title="definition">key</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETableAbs.rep_ok"><span class="id" title="axiom">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#map_bound"><span class="id" title="definition">map_bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ADT.html#ETableAbs.Abs"><span class="id" title="axiom">Abs</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#ETableAbs.bound"><span class="id" title="axiom">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETableAbs.lookup_relate"><span class="id" title="axiom">lookup_relate</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ETableAbs.table"><span class="id" title="axiom">table</span></a>) (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ETableAbs.key"><span class="id" title="definition">key</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETableAbs.rep_ok"><span class="id" title="axiom">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#map_find"><span class="id" title="definition">map_find</span></a> <a class="idref" href="ADT.html#ETableAbs.default"><span class="id" title="axiom">default</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ADT.html#ETableAbs.Abs"><span class="id" title="axiom">Abs</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#ETableAbs.get"><span class="id" title="axiom">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETableAbs.insert_relate"><span class="id" title="axiom">insert_relate</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ETableAbs.table"><span class="id" title="axiom">table</span></a>) (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ETableAbs.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ETableAbs.V"><span class="id" title="axiom">V</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETableAbs.rep_ok"><span class="id" title="axiom">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#map_update"><span class="id" title="definition">map_update</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> (<a class="idref" href="ADT.html#ETableAbs.Abs"><span class="id" title="axiom">Abs</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#ETableAbs.Abs"><span class="id" title="axiom">Abs</span></a> (<a class="idref" href="ADT.html#ETableAbs.set"><span class="id" title="axiom">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETableAbs.elements_relate"><span class="id" title="axiom">elements_relate</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ETableAbs.table"><span class="id" title="axiom">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETableAbs.rep_ok"><span class="id" title="axiom">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETableAbs.Abs"><span class="id" title="axiom">Abs</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="SearchTree.html#map_of_list"><span class="id" title="definition">map_of_list</span></a> (<a class="idref" href="ADT.html#ETableAbs.elements"><span class="id" title="axiom">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#ETableAbs"><span class="id" title="module">ETableAbs</span></a>.<br/>
</div>

<div class="doc">
<a name="lab158"></a><h4 class="section">Exercise: 4 stars, standard (list_etable_abs)</h4>

<div class="paragraph"> </div>

 Implement <span class="inlinecode"><span class="id" title="var">ETableAbs</span></span> using association lists as the
    representation type. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="ListETableAbs"><span class="id" title="module">ListETableAbs</span></a> (<span class="id" title="var">VT</span> : <a class="idref" href="ADT.html#ValType"><span class="id" title="module">ValType</span></a>) &lt;: <a class="idref" href="ADT.html#ETableAbs"><span class="id" title="module">ETableAbs</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListETableAbs.V"><span class="id" title="definition">V</span></a> := <a class="idref" href="ADT.html#VT.V"><span class="id" title="axiom">VT.V</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListETableAbs.default"><span class="id" title="definition">default</span></a> := <a class="idref" href="ADT.html#VT.default"><span class="id" title="axiom">VT.default</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListETableAbs.key"><span class="id" title="definition">key</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListETableAbs.table"><span class="id" title="definition">table</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ADT.html#ListETableAbs.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b<sub>5</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="ADT.html#ListETableAbs.V"><span class="id" title="definition">V</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListETableAbs.empty"><span class="id" title="definition">empty</span></a> : <a class="idref" href="ADT.html#ListETableAbs.table"><span class="id" title="definition">table</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="ListETableAbs.get"><span class="id" title="definition">get</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ListETableAbs.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ListETableAbs.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="ADT.html#ListETableAbs.V"><span class="id" title="definition">V</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListETableAbs.set"><span class="id" title="definition">set</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ListETableAbs.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ListETableAbs.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ListETableAbs.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="ADT.html#ListETableAbs.table"><span class="id" title="definition">table</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="ListETableAbs.bound"><span class="id" title="definition">bound</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ListETableAbs.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ListETableAbs.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListETableAbs.elements"><span class="id" title="definition">elements</span></a> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ListETableAbs.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ADT.html#ListETableAbs.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b<sub>5</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="ADT.html#ListETableAbs.V"><span class="id" title="definition">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListETableAbs.Abs"><span class="id" title="definition">Abs</span></a> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ListETableAbs.table"><span class="id" title="definition">table</span></a>) : <span class="id" title="definition">partial_map</span> <a class="idref" href="ADT.html#ListETableAbs.V"><span class="id" title="definition">V</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListETableAbs.rep_ok"><span class="id" title="definition">rep_ok</span></a> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ListETableAbs.table"><span class="id" title="definition">table</span></a>) : <span class="id" title="keyword">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="ListETableAbs.empty_ok"><span class="id" title="lemma">empty_ok</span></a> : <a class="idref" href="ADT.html#ListETableAbs.rep_ok"><span class="id" title="axiom">rep_ok</span></a> <a class="idref" href="ADT.html#ListETableAbs.empty"><span class="id" title="axiom">empty</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="ListETableAbs.set_ok"><span class="id" title="lemma">set_ok</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ListETableAbs.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ListETableAbs.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ListETableAbs.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ListETableAbs.rep_ok"><span class="id" title="axiom">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#ListETableAbs.rep_ok"><span class="id" title="axiom">rep_ok</span></a> (<a class="idref" href="ADT.html#ListETableAbs.set"><span class="id" title="axiom">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="ListETableAbs.empty_relate"><span class="id" title="lemma">empty_relate</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ListETableAbs.Abs"><span class="id" title="axiom">Abs</span></a> <a class="idref" href="ADT.html#ListETableAbs.empty"><span class="id" title="axiom">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#empty_map"><span class="id" title="definition">empty_map</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="ListETableAbs.bound_relate"><span class="id" title="lemma">bound_relate</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ListETableAbs.table"><span class="id" title="definition">table</span></a>) (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ListETableAbs.key"><span class="id" title="definition">key</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ListETableAbs.rep_ok"><span class="id" title="axiom">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#map_bound"><span class="id" title="definition">map_bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ADT.html#ListETableAbs.Abs"><span class="id" title="axiom">Abs</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#ListETableAbs.bound"><span class="id" title="axiom">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="ListETableAbs.lookup_relate"><span class="id" title="lemma">lookup_relate</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ListETableAbs.table"><span class="id" title="definition">table</span></a>) (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ListETableAbs.key"><span class="id" title="definition">key</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ListETableAbs.rep_ok"><span class="id" title="axiom">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#map_find"><span class="id" title="definition">map_find</span></a> <a class="idref" href="ADT.html#ListETableAbs.default"><span class="id" title="definition">default</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ADT.html#ListETableAbs.Abs"><span class="id" title="axiom">Abs</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#ListETableAbs.get"><span class="id" title="axiom">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="ListETableAbs.insert_relate"><span class="id" title="lemma">insert_relate</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ListETableAbs.table"><span class="id" title="definition">table</span></a>) (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ListETableAbs.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ListETableAbs.V"><span class="id" title="definition">V</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ListETableAbs.rep_ok"><span class="id" title="axiom">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#map_update"><span class="id" title="definition">map_update</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> (<a class="idref" href="ADT.html#ListETableAbs.Abs"><span class="id" title="axiom">Abs</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#ListETableAbs.Abs"><span class="id" title="axiom">Abs</span></a> (<a class="idref" href="ADT.html#ListETableAbs.set"><span class="id" title="axiom">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="ListETableAbs.elements_relate"><span class="id" title="lemma">elements_relate</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ListETableAbs.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ListETableAbs.rep_ok"><span class="id" title="axiom">rep_ok</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ListETableAbs.Abs"><span class="id" title="axiom">Abs</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="SearchTree.html#map_of_list"><span class="id" title="definition">map_of_list</span></a> (<a class="idref" href="ADT.html#ListETableAbs.elements"><span class="id" title="axiom">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#ListETableAbs"><span class="id" title="module">ListETableAbs</span></a>.<br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;Instantiate&nbsp;functor&nbsp;for&nbsp;sake&nbsp;of&nbsp;autograding.&nbsp;*)</span><br/>
<span class="id" title="keyword">Module</span> <a name="StringListETableAbs"><span class="id" title="module">StringListETableAbs</span></a> := <a class="idref" href="ADT.html#ListETableAbs"><span class="id" title="module">ListETableAbs</span></a> <a class="idref" href="ADT.html#StringVal"><span class="id" title="module">StringVal</span></a>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a name="lab159"></a><h4 class="section">Exercise: 3 stars, standard, optional (TreeTableModel)</h4>
 Give an implementation of <span class="inlinecode"><span class="id" title="var">ETableAbs</span></span> using the abstraction
    function <span class="inlinecode"><span class="id" title="var">Abs</span></span> from <a href="SearchTree.html"><span class="inlineref">SearchTree</span></a>. All the proofs of the
    <span class="inlinecode"><span class="id" title="var">relate</span></span> axioms should be simple applications of the lemmas
    already proved as exercises in that chapter. 
</div>
<div class="code">

<br/>
<span class="comment">(*&nbsp;Do&nbsp;not&nbsp;modify&nbsp;the&nbsp;following&nbsp;line:&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a name="manual_grade_for_TreeTableModel"><span class="id" title="definition">manual_grade_for_TreeTableModel</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b<sub>5</sub>"><span class="id" title="notation">×</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a name="lab160"></a><h4 class="section">Exercise: 2 stars, advanced, optional (TreeTableModel')</h4>

<div class="paragraph"> </div>

 Repeat the previous exercise, this time using the alternative
    <span class="inlinecode"><span class="id" title="var">Abs'</span></span> function from <a href="SearchTree.html"><span class="inlineref">SearchTree</span></a>. Hint: Just tweak your
    solution to the previous exercise. 
<div class="paragraph"> </div>

 <font size=-2>&#9744;</font> 
</div>

<div class="doc">
<a name="lab161"></a><h1 class="section">Summary of ADT Verification</h1>

<div class="paragraph"> </div>

 With equational specifications:

<div class="paragraph"> </div>

<ul class="doclist">
<li> Define a <i>representation invariant</i> to characterize which
      values of the <i>representation type</i> are legal.  Prove that each
      operation on the representation type <i>preserves</i> the representation
      invariant.

<div class="paragraph"> </div>


</li>
<li> Using the representation invariant, verify the equational
      specification.

</li>
</ul>

<div class="paragraph"> </div>

    With model-based specifications:

<div class="paragraph"> </div>

<ul class="doclist">
<li> Define and verify preservation of the the representation invariant.

<div class="paragraph"> </div>


</li>
<li> Define an <i>abstraction function</i> that relates the
      representation type to another type that is easier to reason
      about.

<div class="paragraph"> </div>


</li>
<li> Prove that operations of the abstract and concrete types commute
      with the abstraction function. 
</li>
</ul>

</div>

<div class="doc">
<a name="lab162"></a><h1 class="section">Another ADT: Queue</h1>

<div class="paragraph"> </div>

 Here is an interface and algebraic specification for FIFO queues. To
    ensure totality, <span class="inlinecode"><span class="id" title="var">peek</span></span> takes a default value and <span class="inlinecode"><span class="id" title="var">deq</span></span> returns the
    empty queue when applied to the empty queue. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <a name="Queue"><span class="id" title="module">Queue</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="Queue.V"><span class="id" title="axiom">V</span></a> : <span class="id" title="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="Queue.queue"><span class="id" title="axiom">queue</span></a> : <span class="id" title="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="Queue.empty"><span class="id" title="axiom">empty</span></a>: <a class="idref" href="ADT.html#Queue.queue"><span class="id" title="axiom">queue</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="Queue.is_empty"><span class="id" title="axiom">is_empty</span></a> : <a class="idref" href="ADT.html#Queue.queue"><span class="id" title="axiom">queue</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="Queue.enq"><span class="id" title="axiom">enq</span></a> : <a class="idref" href="ADT.html#Queue.queue"><span class="id" title="axiom">queue</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#Queue.V"><span class="id" title="axiom">V</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#Queue.queue"><span class="id" title="axiom">queue</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="Queue.deq"><span class="id" title="axiom">deq</span></a> : <a class="idref" href="ADT.html#Queue.queue"><span class="id" title="axiom">queue</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#Queue.queue"><span class="id" title="axiom">queue</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="Queue.peek"><span class="id" title="axiom">peek</span></a> : <a class="idref" href="ADT.html#Queue.V"><span class="id" title="axiom">V</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#Queue.queue"><span class="id" title="axiom">queue</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#Queue.V"><span class="id" title="axiom">V</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Queue.is_empty_empty"><span class="id" title="axiom">is_empty_empty</span></a> : <a class="idref" href="ADT.html#Queue.is_empty"><span class="id" title="axiom">is_empty</span></a> <a class="idref" href="ADT.html#Queue.empty"><span class="id" title="axiom">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Queue.is_empty_nonempty"><span class="id" title="axiom">is_empty_nonempty</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">q</span> <span class="id" title="var">v</span>, <a class="idref" href="ADT.html#Queue.is_empty"><span class="id" title="axiom">is_empty</span></a> (<a class="idref" href="ADT.html#Queue.enq"><span class="id" title="axiom">enq</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Queue.peek_empty"><span class="id" title="axiom">peek_empty</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">d</span>, <a class="idref" href="ADT.html#Queue.peek"><span class="id" title="axiom">peek</span></a> <a class="idref" href="ADT.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="ADT.html#Queue.empty"><span class="id" title="axiom">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#d"><span class="id" title="variable">d</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Queue.peek_nonempty"><span class="id" title="axiom">peek_nonempty</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">d</span> <span class="id" title="var">q</span> <span class="id" title="var">v</span>, <a class="idref" href="ADT.html#Queue.peek"><span class="id" title="axiom">peek</span></a> <a class="idref" href="ADT.html#d"><span class="id" title="variable">d</span></a> (<a class="idref" href="ADT.html#Queue.enq"><span class="id" title="axiom">enq</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#Queue.peek"><span class="id" title="axiom">peek</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Queue.deq_empty"><span class="id" title="axiom">deq_empty</span></a> : <a class="idref" href="ADT.html#Queue.deq"><span class="id" title="axiom">deq</span></a> <a class="idref" href="ADT.html#Queue.empty"><span class="id" title="axiom">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#Queue.empty"><span class="id" title="axiom">empty</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="Queue.deq_nonempty"><span class="id" title="axiom">deq_nonempty</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">q</span> <span class="id" title="var">v</span>, <a class="idref" href="ADT.html#Queue.deq"><span class="id" title="axiom">deq</span></a> (<a class="idref" href="ADT.html#Queue.enq"><span class="id" title="axiom">enq</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <span class="id" title="keyword">if</span> <a class="idref" href="ADT.html#Queue.is_empty"><span class="id" title="axiom">is_empty</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="ADT.html#Queue.enq"><span class="id" title="axiom">enq</span></a> (<a class="idref" href="ADT.html#Queue.deq"><span class="id" title="axiom">deq</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a>) <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#Queue"><span class="id" title="module">Queue</span></a>.<br/>
</div>

<div class="doc">
<a name="lab163"></a><h4 class="section">Exercise: 3 stars, standard (list_queue)</h4>

<div class="paragraph"> </div>

 Implement that interface and verify your implementation.  As the
    representation type, use <span class="inlinecode"><span class="id" title="var">list</span></span> <span class="inlinecode"><span class="id" title="var">V</span></span>.  At least one operation will
    have to be linear time; we recommend that it be <span class="inlinecode"><span class="id" title="var">enq</span></span>. All the
    proofs should be quite easy. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="ListQueue"><span class="id" title="module">ListQueue</span></a> &lt;: <a class="idref" href="ADT.html#Queue"><span class="id" title="module">Queue</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListQueue.V"><span class="id" title="definition">V</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>. <span class="comment">(*&nbsp;for&nbsp;simplicity&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListQueue.queue"><span class="id" title="definition">queue</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ADT.html#ListQueue.V"><span class="id" title="definition">V</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListQueue.empty"><span class="id" title="definition">empty</span></a> : <a class="idref" href="ADT.html#ListQueue.queue"><span class="id" title="definition">queue</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListQueue.is_empty"><span class="id" title="definition">is_empty</span></a> (<span class="id" title="var">q</span> : <a class="idref" href="ADT.html#ListQueue.queue"><span class="id" title="definition">queue</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListQueue.enq"><span class="id" title="definition">enq</span></a> (<span class="id" title="var">q</span> : <a class="idref" href="ADT.html#ListQueue.queue"><span class="id" title="definition">queue</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ListQueue.V"><span class="id" title="definition">V</span></a>) : <a class="idref" href="ADT.html#ListQueue.queue"><span class="id" title="definition">queue</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListQueue.deq"><span class="id" title="definition">deq</span></a> (<span class="id" title="var">q</span> : <a class="idref" href="ADT.html#ListQueue.queue"><span class="id" title="definition">queue</span></a>) : <a class="idref" href="ADT.html#ListQueue.queue"><span class="id" title="definition">queue</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="ListQueue.peek"><span class="id" title="definition">peek</span></a> (<span class="id" title="var">default</span> : <a class="idref" href="ADT.html#ListQueue.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">q</span> : <a class="idref" href="ADT.html#ListQueue.queue"><span class="id" title="definition">queue</span></a>) : <a class="idref" href="ADT.html#ListQueue.V"><span class="id" title="definition">V</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;REPLACE&nbsp;THIS&nbsp;LINE&nbsp;WITH&nbsp;":=&nbsp;_your_definition_&nbsp;."&nbsp;*)</span>. <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="ListQueue.is_empty_empty"><span class="id" title="lemma">is_empty_empty</span></a> : <a class="idref" href="ADT.html#ListQueue.is_empty"><span class="id" title="axiom">is_empty</span></a> <a class="idref" href="ADT.html#ListQueue.empty"><span class="id" title="axiom">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="ListQueue.is_empty_nonempty"><span class="id" title="lemma">is_empty_nonempty</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">q</span> <span class="id" title="var">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ListQueue.is_empty"><span class="id" title="axiom">is_empty</span></a> (<a class="idref" href="ADT.html#ListQueue.enq"><span class="id" title="axiom">enq</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="ListQueue.peek_empty"><span class="id" title="lemma">peek_empty</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">d</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ListQueue.peek"><span class="id" title="axiom">peek</span></a> <a class="idref" href="ADT.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="ADT.html#ListQueue.empty"><span class="id" title="axiom">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#d"><span class="id" title="variable">d</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="ListQueue.peek_nonempty"><span class="id" title="lemma">peek_nonempty</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">d</span> <span class="id" title="var">q</span> <span class="id" title="var">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ListQueue.peek"><span class="id" title="axiom">peek</span></a> <a class="idref" href="ADT.html#d"><span class="id" title="variable">d</span></a> (<a class="idref" href="ADT.html#ListQueue.enq"><span class="id" title="axiom">enq</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#ListQueue.peek"><span class="id" title="axiom">peek</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="ListQueue.deq_empty"><span class="id" title="lemma">deq_empty</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ListQueue.deq"><span class="id" title="axiom">deq</span></a> <a class="idref" href="ADT.html#ListQueue.empty"><span class="id" title="axiom">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#ListQueue.empty"><span class="id" title="axiom">empty</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="ListQueue.deq_nonempty"><span class="id" title="lemma">deq_nonempty</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">q</span> <span class="id" title="var">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ListQueue.deq"><span class="id" title="axiom">deq</span></a> (<a class="idref" href="ADT.html#ListQueue.enq"><span class="id" title="axiom">enq</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <span class="id" title="keyword">if</span> <a class="idref" href="ADT.html#ListQueue.is_empty"><span class="id" title="axiom">is_empty</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="ADT.html#ListQueue.enq"><span class="id" title="axiom">enq</span></a> (<a class="idref" href="ADT.html#ListQueue.deq"><span class="id" title="axiom">deq</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a>) <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#ListQueue"><span class="id" title="module">ListQueue</span></a>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 Here is an interface and model-based specification for queues. We omit
    <span class="inlinecode"><span class="id" title="var">rep_ok</span></span> from it, because our intended implementation isn't going
    to require a representation invariant. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <a name="QueueAbs"><span class="id" title="module">QueueAbs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="QueueAbs.V"><span class="id" title="axiom">V</span></a> : <span class="id" title="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="QueueAbs.queue"><span class="id" title="axiom">queue</span></a> : <span class="id" title="keyword">Type</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="QueueAbs.empty"><span class="id" title="axiom">empty</span></a> : <a class="idref" href="ADT.html#QueueAbs.queue"><span class="id" title="axiom">queue</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="QueueAbs.is_empty"><span class="id" title="axiom">is_empty</span></a> : <a class="idref" href="ADT.html#QueueAbs.queue"><span class="id" title="axiom">queue</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="QueueAbs.enq"><span class="id" title="axiom">enq</span></a> : <a class="idref" href="ADT.html#QueueAbs.queue"><span class="id" title="axiom">queue</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#QueueAbs.V"><span class="id" title="axiom">V</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#QueueAbs.queue"><span class="id" title="axiom">queue</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="QueueAbs.deq"><span class="id" title="axiom">deq</span></a> : <a class="idref" href="ADT.html#QueueAbs.queue"><span class="id" title="axiom">queue</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#QueueAbs.queue"><span class="id" title="axiom">queue</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="QueueAbs.peek"><span class="id" title="axiom">peek</span></a> : <a class="idref" href="ADT.html#QueueAbs.V"><span class="id" title="axiom">V</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#QueueAbs.queue"><span class="id" title="axiom">queue</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#QueueAbs.V"><span class="id" title="axiom">V</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="QueueAbs.Abs"><span class="id" title="axiom">Abs</span></a> : <a class="idref" href="ADT.html#QueueAbs.queue"><span class="id" title="axiom">queue</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ADT.html#QueueAbs.V"><span class="id" title="axiom">V</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="QueueAbs.empty_relate"><span class="id" title="axiom">empty_relate</span></a> : <a class="idref" href="ADT.html#QueueAbs.Abs"><span class="id" title="axiom">Abs</span></a> <a class="idref" href="ADT.html#QueueAbs.empty"><span class="id" title="axiom">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="QueueAbs.enq_relate"><span class="id" title="axiom">enq_relate</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">q</span> <span class="id" title="var">v</span>,  <a class="idref" href="ADT.html#QueueAbs.Abs"><span class="id" title="axiom">Abs</span></a> (<a class="idref" href="ADT.html#QueueAbs.enq"><span class="id" title="axiom">enq</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e<sub>36</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#QueueAbs.Abs"><span class="id" title="axiom">Abs</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e<sub>36</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e<sub>36</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a><a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="QueueAbs.peek_relate"><span class="id" title="axiom">peek_relate</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">d</span> <span class="id" title="var">q</span>, <a class="idref" href="ADT.html#QueueAbs.peek"><span class="id" title="axiom">peek</span></a> <a class="idref" href="ADT.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#hd"><span class="id" title="definition">hd</span></a> <a class="idref" href="ADT.html#d"><span class="id" title="variable">d</span></a> (<a class="idref" href="ADT.html#QueueAbs.Abs"><span class="id" title="axiom">Abs</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="QueueAbs.deq_relate"><span class="id" title="axiom">deq_relate</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">q</span>, <a class="idref" href="ADT.html#QueueAbs.Abs"><span class="id" title="axiom">Abs</span></a> (<a class="idref" href="ADT.html#QueueAbs.deq"><span class="id" title="axiom">deq</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#tl"><span class="id" title="definition">tl</span></a> (<a class="idref" href="ADT.html#QueueAbs.Abs"><span class="id" title="axiom">Abs</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a>).<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#QueueAbs"><span class="id" title="module">QueueAbs</span></a>.<br/>
</div>

<div class="doc">
<a name="lab164"></a><h4 class="section">Exercise: 3 stars, standard (two_list_queue)</h4>

<div class="paragraph"> </div>

 Below is an implementation of <span class="inlinecode"><span class="id" title="var">QueueAbs</span></span> using two lists.  It
    achieves amortized constant-time performance, improving on the
    single-list implementation. Verify this implementation. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="TwoListQueueAbs"><span class="id" title="module">TwoListQueueAbs</span></a> &lt;: <a class="idref" href="ADT.html#QueueAbs"><span class="id" title="module">QueueAbs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TwoListQueueAbs.V"><span class="id" title="definition">V</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>. <span class="comment">(*&nbsp;for&nbsp;simplicity&nbsp;*)</span><br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TwoListQueueAbs.queue"><span class="id" title="definition">queue</span></a> : <span class="id" title="keyword">Type</span> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ADT.html#TwoListQueueAbs.V"><span class="id" title="definition">V</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b<sub>5</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ADT.html#TwoListQueueAbs.V"><span class="id" title="definition">V</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;<span class="inlinecode">(<span class="id" title="var">f</span>,</span> <span class="inlinecode"><span class="id" title="var">b</span>)</span>&nbsp;represents&nbsp;a&nbsp;queue&nbsp;with&nbsp;a&nbsp;front&nbsp;list&nbsp;<span class="inlinecode"><span class="id" title="var">f</span></span>&nbsp;and&nbsp;a&nbsp;back&nbsp;list<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="var">b</span></span>,&nbsp;where&nbsp;the&nbsp;back&nbsp;list&nbsp;is&nbsp;stored&nbsp;in&nbsp;reverse&nbsp;order.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TwoListQueueAbs.Abs"><span class="id" title="definition">Abs</span></a> '(<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><span class="id" title="var">f</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> : <a class="idref" href="ADT.html#TwoListQueueAbs.queue"><span class="id" title="definition">queue</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ADT.html#TwoListQueueAbs.V"><span class="id" title="definition">V</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#f"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e<sub>36</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e<sub>36</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#rev"><span class="id" title="definition">rev</span></a> <a class="idref" href="ADT.html#b"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e<sub>36</sub>"><span class="id" title="notation">)</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TwoListQueueAbs.empty"><span class="id" title="definition">empty</span></a> : <a class="idref" href="ADT.html#TwoListQueueAbs.queue"><span class="id" title="definition">queue</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TwoListQueueAbs.is_empty"><span class="id" title="definition">is_empty</span></a> (<span class="id" title="var">q</span>: <a class="idref" href="ADT.html#TwoListQueueAbs.queue"><span class="id" title="definition">queue</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TwoListQueueAbs.enq"><span class="id" title="definition">enq</span></a> '(<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><span class="id" title="var">f</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> : <a class="idref" href="ADT.html#TwoListQueueAbs.queue"><span class="id" title="definition">queue</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TwoListQueueAbs.V"><span class="id" title="definition">V</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#f"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed<sub>5</sub>"><span class="id" title="notation">::</span></a> <a class="idref" href="ADT.html#b"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TwoListQueueAbs.deq"><span class="id" title="definition">deq</span></a> (<span class="id" title="var">q</span> : <a class="idref" href="ADT.html#TwoListQueueAbs.queue"><span class="id" title="definition">queue</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#rev"><span class="id" title="definition">rev</span></a> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed<sub>5</sub>"><span class="id" title="notation">::</span></a> <span class="id" title="var">f</span> ⇒ <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><span class="id" title="var">f</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed<sub>5</sub>"><span class="id" title="notation">::</span></a> <span class="id" title="var">f</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><span class="id" title="var">f</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TwoListQueueAbs.peek"><span class="id" title="definition">peek</span></a> (<span class="id" title="var">d</span> : <a class="idref" href="ADT.html#TwoListQueueAbs.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">q</span> : <a class="idref" href="ADT.html#TwoListQueueAbs.queue"><span class="id" title="definition">queue</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="ADT.html#d"><span class="id" title="variable">d</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#rev"><span class="id" title="definition">rev</span></a> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a> ⇒ <a class="idref" href="ADT.html#d"><span class="id" title="variable">d</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">v</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed<sub>5</sub>"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><span class="id" title="var">v</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed<sub>5</sub>"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> ⇒ <span class="id" title="var">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TwoListQueueAbs.empty_relate"><span class="id" title="lemma">empty_relate</span></a> : <a class="idref" href="ADT.html#TwoListQueueAbs.Abs"><span class="id" title="definition">Abs</span></a> <a class="idref" href="ADT.html#TwoListQueueAbs.empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TwoListQueueAbs.enq_relate"><span class="id" title="lemma">enq_relate</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">q</span> <span class="id" title="var">v</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TwoListQueueAbs.Abs"><span class="id" title="definition">Abs</span></a> (<a class="idref" href="ADT.html#TwoListQueueAbs.enq"><span class="id" title="definition">enq</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e<sub>36</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#TwoListQueueAbs.Abs"><span class="id" title="definition">Abs</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e<sub>36</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e<sub>36</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a><a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TwoListQueueAbs.peek_relate"><span class="id" title="lemma">peek_relate</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">d</span> <span class="id" title="var">q</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TwoListQueueAbs.peek"><span class="id" title="definition">peek</span></a> <a class="idref" href="ADT.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#hd"><span class="id" title="definition">hd</span></a> <a class="idref" href="ADT.html#d"><span class="id" title="variable">d</span></a> (<a class="idref" href="ADT.html#TwoListQueueAbs.Abs"><span class="id" title="definition">Abs</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TwoListQueueAbs.deq_relate"><span class="id" title="lemma">deq_relate</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">q</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TwoListQueueAbs.Abs"><span class="id" title="definition">Abs</span></a> (<a class="idref" href="ADT.html#TwoListQueueAbs.deq"><span class="id" title="definition">deq</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#tl"><span class="id" title="definition">tl</span></a> (<a class="idref" href="ADT.html#TwoListQueueAbs.Abs"><span class="id" title="definition">Abs</span></a> <a class="idref" href="ADT.html#q"><span class="id" title="variable">q</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#TwoListQueueAbs"><span class="id" title="module">TwoListQueueAbs</span></a>.<br/>
<font size=-2>&#9744;</font>
</div>


<div class="doc">
<a name="lab165"></a><h1 class="section">Representation Invariants and Subset Types</h1>

<div class="paragraph"> </div>

 In specifications thus far, whenever there was a representation
    invariant that needed to be enforced we had to add it as a
    precondition and postcondition for operations.  For example, the
    correctness of the table <span class="inlinecode"><span class="id" title="var">get</span></span> operation depended on its <span class="inlinecode"><span class="id" title="var">table</span></span>
    input satisfying <span class="inlinecode"><span class="id" title="var">rep_ok</span></span>.  We had to write propositions like <span class="inlinecode"><span class="id" title="keyword">∀</span></span>
    <span class="inlinecode">(<span class="id" title="var">t</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">table</span>),</span> <span class="inlinecode"><span class="id" title="var">rep_ok</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">→</span> <span class="inlinecode">...</span>, in which we had a type <span class="inlinecode"><span class="id" title="var">table</span></span> with
    lots of values, and we got rid of some of those values by
    requiring <span class="inlinecode"><span class="id" title="var">rep_ok</span></span> to hold of them. 
<div class="paragraph"> </div>

 Coq makes it possible to directly express the requirement that
    values of a type must satisfy a proposition.  The type
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">x</span> : <span class="id" title="var">A</span> | <span class="id" title="var">P</span>}
<div class="paragraph"> </div>

</span>    is the type of all values <span class="inlinecode"><span class="id" title="var">x</span></span> of type <span class="inlinecode"><span class="id" title="var">A</span></span> that satisfy property
    <span class="inlinecode"><span class="id" title="var">P</span></span>, which itself has type <span class="inlinecode"><span class="id" title="var">A</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="keyword">Prop</span></span>.  The notation is deliberately
    suggestive of set-builder notation used in mathematics. Such types
    are known as <i>subset types</i>. 
<div class="paragraph"> </div>

<a name="lab166"></a><h2 class="section">Example: The Even Naturals</h2>

<div class="paragraph"> </div>

 We can define the subset type of even natural numbers using
    the property <span class="inlinecode"><span class="id" title="var">Nat.Even</span></span> from the standard library: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="even_nat"><span class="id" title="definition">even_nat</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">{</span></a><span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">:</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#Nat.Even"><span class="id" title="definition">Nat.Even</span></a> <a class="idref" href="ADT.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">}</span></a>.<br/>
</div>

<div class="doc">
But when we try to say that <span class="inlinecode">2</span> is an <span class="inlinecode"><span class="id" title="var">even_nat</span></span>, Coq rejects the
    definition: 
</div>
<div class="code">

<br/>
<span class="id" title="var">Fail</span> <span class="id" title="keyword">Definition</span> <a name="two"><span class="id" title="definition">two</span></a> : <a class="idref" href="ADT.html#even_nat"><span class="id" title="definition">even_nat</span></a> := 2.<br/>
</div>

<div class="doc">
The problem is that <span class="inlinecode">2</span> is a <span class="inlinecode"><span class="id" title="var">nat</span></span>, but we haven't proved <span class="inlinecode"><span class="id" title="var">Nat.Even</span></span> <span class="inlinecode">2</span>.
    The proof is easy: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a name="Even2"><span class="id" title="lemma">Even2</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#Nat.Even"><span class="id" title="definition">Nat.Even</span></a> 2.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">∃</span> 1. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Now we can provide that proof to convince Coq <span class="inlinecode"><span class="id" title="var">two</span></span> is an <span class="inlinecode"><span class="id" title="var">even_nat</span></span>.
    We can do that with function <span class="inlinecode"><span class="id" title="var">exist</span></span>, which is suggestive of
    "there exists an <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">A</span></span> such that <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span>." 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> : <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">x</span> : <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a>), <a class="idref" href="ADT.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ADT.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">{</span></a><span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">:</span></a> <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">|</span></a> <a class="idref" href="ADT.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ADT.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">}</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a name="two"><span class="id" title="definition">two</span></a> : <a class="idref" href="ADT.html#even_nat"><span class="id" title="definition">even_nat</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#Nat.Even"><span class="id" title="definition">Nat.Even</span></a> 2 <a class="idref" href="ADT.html#Even2"><span class="id" title="lemma">Even2</span></a>.<br/>
</div>

<div class="doc">
Another way of constructing <span class="inlinecode"><span class="id" title="var">two</span></span> is to enter Coq's proof scripting
    mode and use tactics.  We saw this briefly in <a href="https://softwarefoundations.cis.upenn.edu/lf-current/ProofObjects.html"><span class="inlineref">ProofObjects</span></a>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="two'"><span class="id" title="definition">two'</span></a> : <a class="idref" href="ADT.html#even_nat"><span class="id" title="definition">even_nat</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">x</span> := 2).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">∃</span> 1. <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>
</div>

<div class="doc">
That technique is often useful with subset types, because it
    helps us more easily build the proof objects, rather than have to
    write them ourselves. 
<div class="paragraph"> </div>

 A value of type <span class="inlinecode"><span class="id" title="var">even_nat</span></span> is like a "package" containing the <span class="inlinecode"><span class="id" title="var">nat</span></span>
    and the proof that the <span class="inlinecode"><span class="id" title="var">nat</span></span> is even.  We have to use functions to
    extract those components from the package. 
</div>
<div class="code">

<br/>
<span class="id" title="var">Fail</span> <span class="id" title="keyword">Example</span> <a name="plus_two"><span class="id" title="definition">plus_two</span></a> : 1 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="ADT.html#two"><span class="id" title="definition">two</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 3.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#proj1_sig"><span class="id" title="definition">proj1_sig</span></a> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">P</span> : <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>} (<span class="id" title="var">e</span> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">{</span></a><span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">:</span></a> <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">|</span></a> <a class="idref" href="ADT.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ADT.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">}</span></a>), <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <a name="plus_two"><span class="id" title="definition">plus_two</span></a> : 1 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#proj1_sig"><span class="id" title="definition">proj1_sig</span></a> <a class="idref" href="ADT.html#two"><span class="id" title="definition">two</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> 3.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#proj2_sig"><span class="id" title="definition">proj2_sig</span></a> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">P</span> : <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>} (<span class="id" title="var">e</span> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">{</span></a><span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">:</span></a> <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">|</span></a> <a class="idref" href="ADT.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ADT.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">}</span></a>), <a class="idref" href="ADT.html#P"><span class="id" title="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#proj1_sig"><span class="id" title="definition">proj1_sig</span></a> <a class="idref" href="ADT.html#e"><span class="id" title="variable">e</span></a>).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <a name="Even2'"><span class="id" title="definition">Even2'</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#Nat.Even"><span class="id" title="definition">Nat.Even</span></a> 2 := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#proj2_sig"><span class="id" title="definition">proj2_sig</span></a> <a class="idref" href="ADT.html#two"><span class="id" title="definition">two</span></a>.<br/>
</div>

<div class="doc">
<a name="lab167"></a><h2 class="section">Defining Subset Types</h2>

<div class="paragraph"> </div>

 Like nearly everything else we've seen in Coq's logic, subset
    types are actually defined in the standard library rather than
    being built-in to the language. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="SigSandbox"><span class="id" title="module">SigSandbox</span></a>.<br/>
</div>

<div class="doc">
Subset types are just a syntactic notation for <span class="inlinecode"><span class="id" title="var">sig</span></span>: 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <a name="SigSandbox.sig"><span class="id" title="inductive">sig</span></a> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> : <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="SigSandbox.exist"><span class="id" title="constructor">exist</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a>) : <a class="idref" href="ADT.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ADT.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#sig"><span class="id" title="inductive">sig</span></a> <a class="idref" href="ADT.html#P"><span class="id" title="variable">P</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Notation</span> <a name="f39e631eba9bf11166cb13d396eba6f<sub>6</sub>"><span class="id" title="notation">&quot;</span></a>{ x : A | P }" := (<a class="idref" href="ADT.html#SigSandbox.sig"><span class="id" title="inductive">sig</span></a> <span class="id" title="var">A</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">P</span>)).<br/>
</div>

<div class="doc">
The name <span class="inlinecode"><span class="id" title="var">sig</span></span> is short for the Greek capital letter sigma,
      because subset types are similar to something known in type
      theory as <i>sigma types</i>, aka <i>dependent sums</i>. 
<div class="paragraph"> </div>

 Subset types and existential quantification are quite similar.
      Recall how the latter is defined: 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <a name="SigSandbox.ex"><span class="id" title="inductive">ex</span></a> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">P</span> : <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="SigSandbox.ex_intro"><span class="id" title="constructor">ex_intro</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a>) : <a class="idref" href="ADT.html#P"><span class="id" title="variable">P</span></a> <a class="idref" href="ADT.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#ex"><span class="id" title="inductive">ex</span></a> <a class="idref" href="ADT.html#P"><span class="id" title="variable">P</span></a>.<br/>
</div>

<div class="doc">
The only difference is that <span class="inlinecode"><span class="id" title="var">sig</span></span> creates a <span class="inlinecode"><span class="id" title="keyword">Type</span></span> whereas <span class="inlinecode"><span class="id" title="var">ex</span></span>
      creates a <span class="inlinecode"><span class="id" title="keyword">Prop</span></span>.  That is, the former is computational in content,
      whereas the latter is logical.  Therefore we can pattern match
      to recover the witness from a <span class="inlinecode"><span class="id" title="var">sig</span></span>, but we cannot do the same
      with an <span class="inlinecode"><span class="id" title="var">ex</span></span>. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SigSandbox.proj1_sig"><span class="id" title="definition">proj1_sig</span></a> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">P</span> : <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>} (<span class="id" title="var">e</span> : <a class="idref" href="ADT.html#SigSandbox.sig"><span class="id" title="inductive">sig</span></a> <a class="idref" href="ADT.html#P"><span class="id" title="variable">P</span></a>) : <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ADT.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ADT.html#SigSandbox.exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> <span class="id" title="var">x</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SigSandbox.proj2_sig"><span class="id" title="definition">proj2_sig</span></a> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">P</span> : <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>} (<span class="id" title="var">e</span> : <a class="idref" href="ADT.html#SigSandbox.sig"><span class="id" title="inductive">sig</span></a> <a class="idref" href="ADT.html#P"><span class="id" title="variable">P</span></a>) : <a class="idref" href="ADT.html#P"><span class="id" title="variable">P</span></a> (<a class="idref" href="ADT.html#SigSandbox.proj1_sig"><span class="id" title="definition">proj1_sig</span></a> <a class="idref" href="ADT.html#e"><span class="id" title="variable">e</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ADT.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ADT.html#SigSandbox.exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">p</span> ⇒ <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="keyword">Definition</span> <a name="SigSandbox.proj1_ex"><span class="id" title="definition">proj1_ex</span></a> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>} {<span class="id" title="var">P</span> : <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>} (<span class="id" title="var">e</span> : <a class="idref" href="ADT.html#SigSandbox.ex"><span class="id" title="inductive">ex</span></a> <a class="idref" href="ADT.html#P"><span class="id" title="variable">P</span></a>) : <a class="idref" href="ADT.html#A"><span class="id" title="variable">A</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="ADT.html#e"><span class="id" title="variable">e</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ADT.html#SigSandbox.ex_intro"><span class="id" title="constructor">ex_intro</span></a> <span class="id" title="var">_</span> <span class="id" title="var">x</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#SigSandbox"><span class="id" title="module">SigSandbox</span></a>.<br/>
</div>

<div class="doc">
<a name="lab168"></a><h2 class="section">Example: Vectors</h2>

<div class="paragraph"> </div>

 A <i>vector</i> is a list of a known length. Type <span class="inlinecode"><span class="id" title="var">vector</span></span> <span class="inlinecode"><span class="id" title="var">X</span></span> contains
    values <span class="inlinecode">(<span class="id" title="var">xs</span>,</span> <span class="inlinecode"><span class="id" title="var">n</span>)</span> with a particular representation invariant: <span class="inlinecode"><span class="id" title="var">n</span></span>
    must be the length of <span class="inlinecode"><span class="id" title="var">xs</span></span>.  
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="vector"><span class="id" title="definition">vector</span></a> (<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#9a641341b616cd42f092b6729326423a"><span class="id" title="notation">{</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#9a641341b616cd42f092b6729326423a"><span class="id" title="notation">'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><span class="id" title="var">xs</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#9a641341b616cd42f092b6729326423a"><span class="id" title="notation">:</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ADT.html#X"><span class="id" title="variable">X</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b<sub>5</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#9a641341b616cd42f092b6729326423a"><span class="id" title="notation">|</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#length"><span class="id" title="abbreviation">length</span></a> <a class="idref" href="ADT.html#xs"><span class="id" title="variable">xs</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#9a641341b616cd42f092b6729326423a"><span class="id" title="notation">}</span></a>.<br/>
</div>

<div class="doc">
The type itself enforces the representation invariant, because a
    value of type <span class="inlinecode"><span class="id" title="var">vector</span></span> <span class="inlinecode"><span class="id" title="var">X</span></span> cannot be constructed without first
    proving that the invariant holds. 
<div class="paragraph"> </div>

<a name="lab169"></a><h4 class="section">Exercise: 1 star, standard (a_vector)</h4>

<div class="paragraph"> </div>

 Construct any vector of your choice. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a name="a_vector"><span class="id" title="definition">a_vector</span></a> : <a class="idref" href="ADT.html#vector"><span class="id" title="definition">vector</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a name="lab170"></a><h4 class="section">Exercise: 2 stars, standard (vector_cons_correct)</h4>

<div class="paragraph"> </div>

 Define a cons operation on vectors. Remember to end with
    <span class="inlinecode"><span class="id" title="keyword">Defined</span></span> rather than <span class="inlinecode"><span class="id" title="keyword">Qed</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="vector_cons"><span class="id" title="definition">vector_cons</span></a> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">x</span> : <a class="idref" href="ADT.html#X"><span class="id" title="variable">X</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#vector"><span class="id" title="definition">vector</span></a> <a class="idref" href="ADT.html#X"><span class="id" title="variable">X</span></a>) : <a class="idref" href="ADT.html#vector"><span class="id" title="definition">vector</span></a> <a class="idref" href="ADT.html#X"><span class="id" title="variable">X</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
Prove the correctness of your cons operation. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="list_of_vector"><span class="id" title="definition">list_of_vector</span></a> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#vector"><span class="id" title="definition">vector</span></a> <a class="idref" href="ADT.html#X"><span class="id" title="variable">X</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="ADT.html#X"><span class="id" title="variable">X</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#proj1_sig"><span class="id" title="definition">proj1_sig</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <a name="vector_cons_correct"><span class="id" title="lemma">vector_cons_correct</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span> : <a class="idref" href="ADT.html#X"><span class="id" title="variable">X</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#vector"><span class="id" title="definition">vector</span></a> <a class="idref" href="ADT.html#X"><span class="id" title="variable">X</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#list_of_vector"><span class="id" title="definition">list_of_vector</span></a> (<a class="idref" href="ADT.html#vector_cons"><span class="id" title="axiom">vector_cons</span></a> <a class="idref" href="ADT.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed<sub>5</sub>"><span class="id" title="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed<sub>5</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#list_of_vector"><span class="id" title="definition">list_of_vector</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed<sub>5</sub>"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a name="lab171"></a><h4 class="section">Exercise: 2 stars, standard (vector_app_correct)</h4>

<div class="paragraph"> </div>

 Define an append operation on vectors. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="vector_app"><span class="id" title="definition">vector_app</span></a> {<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>} (<span class="id" title="var">v<sub>1</sub></span> <span class="id" title="var">v<sub>2</sub></span> : <a class="idref" href="ADT.html#vector"><span class="id" title="definition">vector</span></a> <a class="idref" href="ADT.html#X"><span class="id" title="variable">X</span></a>) : <a class="idref" href="ADT.html#vector"><span class="id" title="definition">vector</span></a> <a class="idref" href="ADT.html#X"><span class="id" title="variable">X</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
</div>

<div class="doc">
Prove the correctness of your append operation. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a name="vector_app_correct"><span class="id" title="lemma">vector_app_correct</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">X</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">v<sub>1</sub></span> <span class="id" title="var">v<sub>2</sub></span> : <a class="idref" href="ADT.html#vector"><span class="id" title="definition">vector</span></a> <a class="idref" href="ADT.html#X"><span class="id" title="variable">X</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#list_of_vector"><span class="id" title="definition">list_of_vector</span></a> (<a class="idref" href="ADT.html#vector_app"><span class="id" title="axiom">vector_app</span></a> <a class="idref" href="ADT.html#v<sub>1</sub>"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="ADT.html#v<sub>2</sub>"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#list_of_vector"><span class="id" title="definition">list_of_vector</span></a> <a class="idref" href="ADT.html#v<sub>1</sub>"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e<sub>36</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="ADT.html#list_of_vector"><span class="id" title="definition">list_of_vector</span></a> <a class="idref" href="ADT.html#v<sub>2</sub>"><span class="id" title="variable">v<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a name="lab172"></a><h2 class="section">Using Subset Types to Enforce the BST Invariant</h2>

<div class="paragraph"> </div>

 Let's use subset types to reimplement tree-based tables with an
    <span class="inlinecode"><span class="id" title="var">elements</span></span> operation.  Previously we had to add <span class="inlinecode"><span class="id" title="var">rep_ok</span></span> to the
    interface and specifications.  With subset types we can eliminate
    that. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <a name="ETableSubset"><span class="id" title="module">ETableSubset</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Include</span> <a class="idref" href="ADT.html#Table"><span class="id" title="module">Table</span></a>.<br/>
</div>

<div class="doc">
Note: no <span class="inlinecode"><span class="id" title="var">rep_ok</span></span> anywhere. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETableSubset.bound"><span class="id" title="axiom">bound</span></a> : <a class="idref" href="ADT.html#ETableSubset.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#ETableSubset.table"><span class="id" title="axiom">table</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Parameter</span> <a name="ETableSubset.elements"><span class="id" title="axiom">elements</span></a> : <a class="idref" href="ADT.html#ETableSubset.table"><span class="id" title="axiom">table</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ADT.html#ETableSubset.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b<sub>5</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="ADT.html#ETableSubset.V"><span class="id" title="axiom">V</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETableSubset.bound_empty"><span class="id" title="axiom">bound_empty</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ETableSubset.key"><span class="id" title="definition">key</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETableSubset.bound"><span class="id" title="axiom">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#ETableSubset.empty"><span class="id" title="axiom">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETableSubset.bound_set_same"><span class="id" title="axiom">bound_set_same</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ETableSubset.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ETableSubset.V"><span class="id" title="axiom">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ETableSubset.table"><span class="id" title="axiom">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETableSubset.bound"><span class="id" title="axiom">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ADT.html#ETableSubset.set"><span class="id" title="axiom">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETableSubset.bound_set_other"><span class="id" title="axiom">bound_set_other</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> <span class="id" title="var">k'</span> : <a class="idref" href="ADT.html#ETableSubset.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ETableSubset.V"><span class="id" title="axiom">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ETableSubset.table"><span class="id" title="axiom">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc<sub>9</sub>"><span class="id" title="notation">≠</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#ETableSubset.bound"><span class="id" title="axiom">bound</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> (<a class="idref" href="ADT.html#ETableSubset.set"><span class="id" title="axiom">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#ETableSubset.bound"><span class="id" title="axiom">bound</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETableSubset.elements_complete"><span class="id" title="axiom">elements_complete</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ETableSubset.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ETableSubset.V"><span class="id" title="axiom">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ETableSubset.table"><span class="id" title="axiom">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETableSubset.bound"><span class="id" title="axiom">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETableSubset.get"><span class="id" title="axiom">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#ETableSubset.elements"><span class="id" title="axiom">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Axiom</span> <a name="ETableSubset.elements_correct"><span class="id" title="axiom">elements_correct</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#ETableSubset.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#ETableSubset.V"><span class="id" title="axiom">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#ETableSubset.table"><span class="id" title="axiom">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#ETableSubset.elements"><span class="id" title="axiom">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#ETableSubset.bound"><span class="id" title="axiom">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="ADT.html#ETableSubset.get"><span class="id" title="axiom">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#ETableSubset"><span class="id" title="module">ETableSubset</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Module</span> <a name="TreeETableSubset"><span class="id" title="module">TreeETableSubset</span></a> (<span class="id" title="var">VT</span> : <a class="idref" href="ADT.html#ValType"><span class="id" title="module">ValType</span></a>) &lt;: <a class="idref" href="ADT.html#ETableSubset"><span class="id" title="module">ETableSubset</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETableSubset.V"><span class="id" title="definition">V</span></a> := <a class="idref" href="ADT.html#VT.V"><span class="id" title="axiom">VT.V</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETableSubset.default"><span class="id" title="definition">default</span></a> := <a class="idref" href="ADT.html#VT.default"><span class="id" title="axiom">VT.default</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETableSubset.key"><span class="id" title="definition">key</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">table</span></span> now is required to enforce <span class="inlinecode"><span class="id" title="var">BST</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETableSubset.table"><span class="id" title="definition">table</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">{</span></a> <span class="id" title="var">t</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">:</span></a> <a class="idref" href="SearchTree.html#tree"><span class="id" title="inductive">tree</span></a> <a class="idref" href="ADT.html#TreeETableSubset.V"><span class="id" title="definition">V</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">|</span></a> <a class="idref" href="SearchTree.html#BST"><span class="id" title="inductive">BST</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">}</span></a>.<br/>
</div>

<div class="doc">
Now instead of proving separate theorems that operations return
      valid representations, the proofs are "baked in" to the
      operations. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETableSubset.empty"><span class="id" title="definition">empty</span></a> : <a class="idref" href="ADT.html#TreeETableSubset.table"><span class="id" title="definition">table</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> <a class="idref" href="SearchTree.html#empty_tree"><span class="id" title="definition">empty_tree</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="SearchTree.html#empty_tree_BST"><span class="id" title="axiom">empty_tree_BST</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
</div>

<div class="doc">
Now we insert a projection to get to the tree. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETableSubset.get"><span class="id" title="definition">get</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableSubset.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableSubset.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="ADT.html#TreeETableSubset.V"><span class="id" title="definition">V</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#lookup"><span class="id" title="definition">lookup</span></a> <a class="idref" href="ADT.html#TreeETableSubset.default"><span class="id" title="definition">default</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#proj1_sig"><span class="id" title="definition">proj1_sig</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETableSubset.set"><span class="id" title="definition">set</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableSubset.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableSubset.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableSubset.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="ADT.html#TreeETableSubset.table"><span class="id" title="definition">table</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">t</span> <span class="id" title="var">Ht</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> (<a class="idref" href="SearchTree.html#insert"><span class="id" title="definition">insert</span></a> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="SearchTree.html#insert_BST"><span class="id" title="axiom">insert_BST</span></a>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETableSubset.bound"><span class="id" title="definition">bound</span></a> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableSubset.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableSubset.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#bound"><span class="id" title="definition">SearchTree.bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#proj1_sig"><span class="id" title="definition">proj1_sig</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="TreeETableSubset.elements"><span class="id" title="definition">elements</span></a> (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableSubset.table"><span class="id" title="definition">table</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="ADT.html#TreeETableSubset.key"><span class="id" title="definition">key</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b<sub>5</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="ADT.html#TreeETableSubset.V"><span class="id" title="definition">V</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="SearchTree.html#elements"><span class="id" title="definition">elements</span></a> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Specif.html#proj1_sig"><span class="id" title="definition">proj1_sig</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableSubset.get_empty_default"><span class="id" title="lemma">get_empty_default</span></a>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableSubset.key"><span class="id" title="definition">key</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableSubset.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#TreeETableSubset.empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#TreeETableSubset.default"><span class="id" title="definition">default</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="SearchTree.html#lookup_empty"><span class="id" title="lemma">lookup_empty</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Now the rest of the proofs require minor modifications to
      destruct the table to get the tree and the representation
      invariant, and use the latter where needed. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableSubset.get_set_same"><span class="id" title="lemma">get_set_same</span></a>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableSubset.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableSubset.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableSubset.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableSubset.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ADT.html#TreeETableSubset.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#TreeETableSubset.get"><span class="id" title="definition">get</span></a>, <a class="idref" href="ADT.html#TreeETableSubset.set"><span class="id" title="definition">set</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">t</span> <span class="id" title="var">Hbst</span>]. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="SearchTree.html#lookup_insert_eq"><span class="id" title="lemma">lookup_insert_eq</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableSubset.get_set_other"><span class="id" title="lemma">get_set_other</span></a>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> <span class="id" title="var">k'</span> : <a class="idref" href="ADT.html#TreeETableSubset.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableSubset.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableSubset.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc<sub>9</sub>"><span class="id" title="notation">≠</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#TreeETableSubset.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> (<a class="idref" href="ADT.html#TreeETableSubset.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#TreeETableSubset.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#TreeETableSubset.get"><span class="id" title="definition">get</span></a>, <a class="idref" href="ADT.html#TreeETableSubset.set"><span class="id" title="definition">set</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">t</span> <span class="id" title="var">Hbst</span>]. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="SearchTree.html#lookup_insert_neq"><span class="id" title="lemma">lookup_insert_neq</span></a>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableSubset.bound_empty"><span class="id" title="lemma">bound_empty</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableSubset.key"><span class="id" title="definition">key</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableSubset.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#TreeETableSubset.empty"><span class="id" title="definition">empty</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableSubset.bound_set_same"><span class="id" title="lemma">bound_set_same</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableSubset.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableSubset.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableSubset.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableSubset.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> (<a class="idref" href="ADT.html#TreeETableSubset.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#TreeETableSubset.bound"><span class="id" title="definition">bound</span></a>, <a class="idref" href="ADT.html#TreeETableSubset.set"><span class="id" title="definition">set</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">t</span> <span class="id" title="var">Hbst</span>]. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="var">inv</span> <span class="id" title="var">Hbst</span>; <span class="id" title="var">bdall</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableSubset.bound_set_other"><span class="id" title="lemma">bound_set_other</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> <span class="id" title="var">k'</span> : <a class="idref" href="ADT.html#TreeETableSubset.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableSubset.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableSubset.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc<sub>9</sub>"><span class="id" title="notation">≠</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="ADT.html#TreeETableSubset.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> (<a class="idref" href="ADT.html#TreeETableSubset.set"><span class="id" title="definition">set</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#TreeETableSubset.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k'"><span class="id" title="variable">k'</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span> <span class="id" title="var">Hneq</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="ADT.html#TreeETableSubset.bound"><span class="id" title="definition">bound</span></a>, <a class="idref" href="ADT.html#TreeETableSubset.set"><span class="id" title="definition">set</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">t</span> <span class="id" title="var">Hbst</span>]. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">t</span>; <span class="id" title="var">inv</span> <span class="id" title="var">Hbst</span>; <span class="id" title="var">bdall</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableSubset.elements_complete"><span class="id" title="lemma">elements_complete</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableSubset.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableSubset.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableSubset.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableSubset.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableSubset.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#TreeETableSubset.elements"><span class="id" title="definition">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span> <span class="id" title="var">Hbound</span> <span class="id" title="var">Hlookup</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <a class="idref" href="SearchTree.html#elements_complete"><span class="id" title="axiom">SearchTree.elements_complete</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">Hcomplete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="SearchTree.html#elements_complete_spec"><span class="id" title="definition">elements_complete_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcomplete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcomplete</span> <span class="id" title="keyword">with</span> <a class="idref" href="ADT.html#TreeETableSubset.default"><span class="id" title="definition">default</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">t</span> <span class="id" title="var">Hbst</span>]. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Theorem</span> <a name="TreeETableSubset.elements_correct"><span class="id" title="lemma">elements_correct</span></a> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span> : <a class="idref" href="ADT.html#TreeETableSubset.key"><span class="id" title="definition">key</span></a>) (<span class="id" title="var">v</span> : <a class="idref" href="ADT.html#TreeETableSubset.V"><span class="id" title="definition">V</span></a>) (<span class="id" title="var">t</span> : <a class="idref" href="ADT.html#TreeETableSubset.table"><span class="id" title="definition">table</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#In"><span class="id" title="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c<sub>0</sub>"><span class="id" title="notation">)</span></a> (<a class="idref" href="ADT.html#TreeETableSubset.elements"><span class="id" title="definition">elements</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ADT.html#TreeETableSubset.bound"><span class="id" title="definition">bound</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="ADT.html#TreeETableSubset.get"><span class="id" title="definition">get</span></a> <a class="idref" href="ADT.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="ADT.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="ADT.html#v"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">k</span> <span class="id" title="var">v</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hin</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> <a class="idref" href="SearchTree.html#elements_correct"><span class="id" title="axiom">SearchTree.elements_correct</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">Hcorrect</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="SearchTree.html#elements_correct_spec"><span class="id" title="definition">elements_correct_spec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcorrect</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Hcorrect</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">t</span> <span class="id" title="var">Hbst</span>]. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="ADT.html#TreeETableSubset"><span class="id" title="module">TreeETableSubset</span></a>.<br/>
</div>

<div class="doc">
<a name="lab173"></a><h4 class="section">Exercise: 4 stars, advanced (ListsETable)</h4>

<div class="paragraph"> </div>

 Implement <span class="inlinecode"><span class="id" title="var">ETableSubset</span></span> using association lists that are not
    permitted to contain duplicate keys.  Enforce that representation
    invariant with a subset type.  Note that you do not have to keep
    the lists in a sorted order. The implementation of <span class="inlinecode"><span class="id" title="var">elements</span></span>
    should therefore just be quite easy: just return the association
    list.  The implementation of <span class="inlinecode"><span class="id" title="tactic">set</span></span>, though, will have to be a
    linear-time operation. 
</div>
<div class="code">

<br/>
<span class="comment">(*&nbsp;Do&nbsp;not&nbsp;modify&nbsp;the&nbsp;following&nbsp;line:&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a name="manual_grade_for_ListsETable"><span class="id" title="definition">manual_grade_for_ListsETable</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b<sub>5</sub>"><span class="id" title="notation">×</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="code">

<br/>
<span class="comment">(*&nbsp;2020-07-16&nbsp;16:32:32&nbsp;(UTC+00)&nbsp;*)</span><br/>
</div>
</div>

<div id="footer">
<hr/><a href="coqindex.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>