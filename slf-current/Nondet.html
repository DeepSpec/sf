<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="common/css/sf.css" rel="stylesheet" type="text/css" />
<title>Nondet: Triples for Nondeterministic Languages</title>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/slf.css" rel="stylesheet" type="text/css"/>
</head>

<body>

<div id="page">

<div id="header">
<div id='logoinheader'><a href='https://softwarefoundations.cis.upenn.edu'>
<img src='common/media/image/sf_logo_sm.png' alt='Software Foundations Logo'></a></div>
<div class='booktitleinheader'><a href='index.html'>Volume 6: Separation Logic Foundations</a></div>
<ul id='menu'>
   <li class='section_name'><a href='toc.html'>Table of Contents</a></li>
   <li class='section_name'><a href='coqindex.html'>Index</a></li>
   <li class='section_name'><a href='deps.html'>Roadmap</a></li>
</ul>
</div>

<div id="main">

<h1 class="libtitle">Nondet<span class="subtitle">Triples for Nondeterministic Languages</span></h1>


<div class="code">

<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">SLF</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="LibSepReference.html#"><span class="id" title="library">LibSepReference</span></a>.<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">val_scope</span>.<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">trm_scope</span>. <span class="comment">(*&nbsp;TODO:&nbsp;scope&nbsp;closed&nbsp;by&nbsp;default&nbsp;*)</span><br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">f</span> : <a class="idref" href="LibSepVar.html#var"><span class="id" title="definition">var</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">b</span> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">s</span> : <a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">t</span> : <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> : <a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">n</span> : <span class="id" title="notation">int</span>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">p</span> : <a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">h</span> : <a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> : <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">H</span> : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">Q</span> : <a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>.<br/>
</div>

<div class="doc">
<a id="lab447"></a><h1 class="section">First Pass</h1>

<div class="paragraph"> </div>

 In previous chapters, we have considered a quasi-deterministic language;
    only the addresses of allocated data could vary between two executions
    of a same term starting in a same state.

<div class="paragraph"> </div>

    In this chapter, we discuss the interpretation of Separation Logic
    triples in the more general case of non-deterministic languages.
    To that end, we extend the language with a new primitive operator
    that produces a random number: the term <span class="inlinecode"><span class="id" title="var">val_rand</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> non-deterministically
    evaluates to an integer between <span class="inlinecode">0</span> inclusive and <span class="inlinecode"><span class="id" title="var">n</span></span> exclusive.

<div class="paragraph"> </div>

    This chapter is organized as follows:

<div class="paragraph"> </div>

<ul class="doclist">
<li> Statement of a big-step semantics for non-deterministic languages

</li>
<li> Proof of reasoning rules for triples

</li>
<li> Proof of reasoning rules in weakest-precondition style

</li>
<li> Bonus section: definition of triples for non-deterministic languages
      with respect to small-step semantics.

</li>
</ul>

<div class="paragraph"> </div>

    For simplicity, we omit from the semantics the treatment of non-recursive
    functions, which can be encoded using recursive functions; and, likewise,
    omit the treatment of sequences, which can be encoded using let-bindings. 
</div>

<div class="doc">
<a id="lab448"></a><h2 class="section">Non-Deterministic Big-Step Semantics: the Predicate <span class="inlinecode"><span class="id" title="var">evaln</span></span></h2>

<div class="paragraph"> </div>

 Previously, we worked with the big-step judgment <span class="inlinecode"><span class="id" title="tactic">eval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>, which
    relates one input state (and term) with one output state (and value).
    This judgment is well-suited for a deterministic semantics, because one
    input state leads to at most one result. For a non-deterministic semantics,
    however, we need to relate one input with a set of possible results.

<div class="paragraph"> </div>

    In Coq, a set of output states can be represented as a set of pairs
    made of a state and a value, that is, <span class="inlinecode">(<span class="id" title="var">state</span>*<span class="id" title="var">val</span>)<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span><span class="id" title="keyword">Prop</span></span>. This type
    is isomorphic to the type <span class="inlinecode"><span class="id" title="var">val</span>→<span class="id" title="var">state</span>→<span class="id" title="keyword">Prop</span></span>, which corresponds exactly
    to the type of postconditions <span class="inlinecode"><span class="id" title="var">val</span>→<span class="id" title="var">hprop</span></span>. Thus, we are interested in
    setting up a judgment that relates an "input configuration", described
    by a state and a term, with a postcondition describing the set of possible
    "output configurations".

<div class="paragraph"> </div>

    The non-deterministic big-step judgment therefore takes the form
    <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>, and relates an input state <span class="inlinecode"><span class="id" title="var">s</span></span> and a term <span class="inlinecode"><span class="id" title="var">t</span></span> with a
    postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>. An output configuration consists of an output state
    <span class="inlinecode"><span class="id" title="var">s'</span></span> and an output value <span class="inlinecode"><span class="id" title="var">v</span></span> that, together, satisfy the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>,
    in the sense that <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> holds.

<div class="paragraph"> </div>

    In the context of program verification, we are not so much interested in
    characterizing exactly the set of all output configurations reachable by
    the program, but mainly interested in showing that all output
    configurations satisfy a desired postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>. For this reason, it is
    perfectly fine for the set of configurations described by <span class="inlinecode"><span class="id" title="var">Q</span></span> to over-
    approximate the set of configurations actually reachable by the program.
    We'll explain later on how to characterize the set of output configurations
    in a precise manner.

<div class="paragraph"> </div>

    The judgment <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> is defined inductively. It asserts that every
    possible execution starting from configuration <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> satisfies the
    postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>. The definition of <span class="inlinecode"><span class="id" title="var">evaln</span></span> is adapted from that of <span class="inlinecode"><span class="id" title="tactic">eval</span></span>.
    Four cases are particularly interesting.

<div class="paragraph"> </div>

<ul class="doclist">
<li> Consider the case of a value. The judgment <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> asserts that the
      value <span class="inlinecode"><span class="id" title="var">v</span></span> in the state <span class="inlinecode"><span class="id" title="var">s</span></span> satisfies the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>. The premise
      for deriving that judgment is thus that <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> must hold.

</li>
<li> Consider the case of a let-binding. <span class="inlinecode"><span class="id" title="keyword">let</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="keyword">in</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span>. The first premise
      of the evaluation rule describes the evaluation of the subterm <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span>. It
      takes the form <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>. The second premise describes the
      evaluation of the the continuation <span class="inlinecode"><span class="id" title="tactic">subst</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span> in a state <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span>, where
      the value <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span></span> and the state <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span> correspond to a configuration that can
      be produced by <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span>. In other words, <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span> are assumed to satisfy
      <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span>.

</li>
<li> Consider the case of a non-deterministic term: <span class="inlinecode"><span class="id" title="var">val_rand</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span>, evaluated in
      a state <span class="inlinecode"><span class="id" title="var">s</span></span>. The first premise of the rule requires <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">&gt;</span> <span class="inlinecode">0</span>. The second
      premise requires that, for any value <span class="inlinecode"><span class="id" title="var">n<sub>1</sub></span></span> that <span class="inlinecode"><span class="id" title="var">val_rand</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> may evaluate
      to (that is, such that <span class="inlinecode">0</span> <span class="inlinecode">≤</span> <span class="inlinecode"><span class="id" title="var">n<sub>1</sub></span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">n</span></span>), the configuration made of <span class="inlinecode"><span class="id" title="var">n<sub>1</sub></span></span> and
      <span class="inlinecode"><span class="id" title="var">s</span></span> satisfies the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>, in the sense that <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">n<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> holds.

</li>
<li> Consider the case of an allocation: <span class="inlinecode"><span class="id" title="var">val_ref</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>, evaluated in a state <span class="inlinecode"><span class="id" title="var">s</span></span>.
      The premise of the rule asserts that the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span> should hold of
      any configuration made of a fresh location <span class="inlinecode"><span class="id" title="var">p</span></span> and a state <span class="inlinecode"><span class="id" title="var">s'</span></span> obtained
      as the update of <span class="inlinecode"><span class="id" title="var">s</span></span> with a binding from <span class="inlinecode"><span class="id" title="var">p</span></span> to <span class="inlinecode"><span class="id" title="var">v</span></span>. 

</li>
</ul>
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="evaln" class="idref" href="#evaln"><span class="id" title="inductive">evaln</span></a> : <a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><span class="id" title="keyword">Prop</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="evaln_val" class="idref" href="#evaln_val"><span class="id" title="constructor">evaln_val</span></a> : <span class="id" title="keyword">∀</span> <a id="s:3" class="idref" href="#s:3"><span class="id" title="binder">s</span></a> <a id="v:4" class="idref" href="#v:4"><span class="id" title="binder">v</span></a> <a id="Q:5" class="idref" href="#Q:5"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q:5"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#v:4"><span class="id" title="variable">v</span></a> <a class="idref" href="Nondet.html#s:3"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln:1"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:3"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Nondet.html#v:4"><span class="id" title="variable">v</span></a>) <a class="idref" href="Nondet.html#Q:5"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="evaln_fix" class="idref" href="#evaln_fix"><span class="id" title="constructor">evaln_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s:6" class="idref" href="#s:6"><span class="id" title="binder">s</span></a> <a id="f:7" class="idref" href="#f:7"><span class="id" title="binder">f</span></a> <a id="x:8" class="idref" href="#x:8"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:9" class="idref" href="#t<sub>1</sub>:9"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="Q:10" class="idref" href="#Q:10"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q:10"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:7"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:8"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:9"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Nondet.html#s:6"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln:1"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:6"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_fix"><span class="id" title="constructor">trm_fix</span></a> <a class="idref" href="Nondet.html#f:7"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:8"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:9"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Nondet.html#Q:10"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="evaln_app_fix" class="idref" href="#evaln_app_fix"><span class="id" title="constructor">evaln_app_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s:11" class="idref" href="#s:11"><span class="id" title="binder">s</span></a> <a id="v<sub>1</sub>:12" class="idref" href="#v<sub>1</sub>:12"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:13" class="idref" href="#v<sub>2</sub>:13"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="f:14" class="idref" href="#f:14"><span class="id" title="binder">f</span></a> <a id="x:15" class="idref" href="#x:15"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:16" class="idref" href="#t<sub>1</sub>:16"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="Q:17" class="idref" href="#Q:17"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#v<sub>1</sub>:12"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:14"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:15"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:16"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln:1"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:11"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:15"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:13"><span class="id" title="variable">v<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#f:14"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:12"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:16"><span class="id" title="variable">t<sub>1</sub></span></a>)) <a class="idref" href="Nondet.html#Q:17"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln:1"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:11"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:12"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:13"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:17"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="evaln_let" class="idref" href="#evaln_let"><span class="id" title="constructor">evaln_let</span></a> : <span class="id" title="keyword">∀</span> <a id="Q<sub>1</sub>:18" class="idref" href="#Q<sub>1</sub>:18"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="s:19" class="idref" href="#s:19"><span class="id" title="binder">s</span></a> <a id="x:20" class="idref" href="#x:20"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:21" class="idref" href="#t<sub>1</sub>:21"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:22" class="idref" href="#t<sub>2</sub>:22"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="Q:23" class="idref" href="#Q:23"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln:1"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:19"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:21"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#Q<sub>1</sub>:18"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="v<sub>1</sub>:24" class="idref" href="#v<sub>1</sub>:24"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="s<sub>2</sub>:25" class="idref" href="#s<sub>2</sub>:25"><span class="id" title="binder">s<sub>2</sub></span></a>, <a class="idref" href="Nondet.html#Q<sub>1</sub>:18"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:24"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:25"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Nondet.html#evaln:1"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:25"><span class="id" title="variable">s<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:20"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:24"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:22"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:23"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln:1"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:19"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Nondet.html#x:20"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:21"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:22"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:23"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="evaln_if" class="idref" href="#evaln_if"><span class="id" title="constructor">evaln_if</span></a> : <span class="id" title="keyword">∀</span> <a id="s:26" class="idref" href="#s:26"><span class="id" title="binder">s</span></a> <a id="b:27" class="idref" href="#b:27"><span class="id" title="binder">b</span></a> <a id="t<sub>1</sub>:28" class="idref" href="#t<sub>1</sub>:28"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:29" class="idref" href="#t<sub>2</sub>:29"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="Q:30" class="idref" href="#Q:30"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln:1"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:26"><span class="id" title="variable">s</span></a> (<span class="id" title="keyword">if</span> <a class="idref" href="Nondet.html#b:27"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Nondet.html#t<sub>1</sub>:28"><span class="id" title="variable">t<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Nondet.html#t<sub>2</sub>:29"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:30"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln:1"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:26"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_if"><span class="id" title="constructor">trm_if</span></a> (<a class="idref" href="LibSepReference.html#val_bool"><span class="id" title="constructor">val_bool</span></a> <a class="idref" href="Nondet.html#b:27"><span class="id" title="variable">b</span></a>) <a class="idref" href="Nondet.html#t<sub>1</sub>:28"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:29"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:30"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="evaln_add" class="idref" href="#evaln_add"><span class="id" title="constructor">evaln_add</span></a> : <span class="id" title="keyword">∀</span> <a id="s:31" class="idref" href="#s:31"><span class="id" title="binder">s</span></a> <a id="n<sub>1</sub>:32" class="idref" href="#n<sub>1</sub>:32"><span class="id" title="binder">n<sub>1</sub></span></a> <a id="n<sub>2</sub>:33" class="idref" href="#n<sub>2</sub>:33"><span class="id" title="binder">n<sub>2</sub></span></a> <a id="Q:34" class="idref" href="#Q:34"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q:34"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> (<a class="idref" href="Nondet.html#n<sub>1</sub>:32"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="Nondet.html#n<sub>2</sub>:33"><span class="id" title="variable">n<sub>2</sub></span></a>)) <a class="idref" href="Nondet.html#s:31"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln:1"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:31"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_add"><span class="id" title="constructor">val_add</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:32"><span class="id" title="variable">n<sub>1</sub></span></a>) (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>2</sub>:33"><span class="id" title="variable">n<sub>2</sub></span></a>)) <a class="idref" href="Nondet.html#Q:34"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="evaln_rand" class="idref" href="#evaln_rand"><span class="id" title="constructor">evaln_rand</span></a> : <span class="id" title="keyword">∀</span> <a id="s:35" class="idref" href="#s:35"><span class="id" title="binder">s</span></a> <a id="n:36" class="idref" href="#n:36"><span class="id" title="binder">n</span></a> <a id="Q:37" class="idref" href="#Q:37"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#n:36"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;</span> 0 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="n<sub>1</sub>:38" class="idref" href="#n<sub>1</sub>:38"><span class="id" title="binder">n<sub>1</sub></span></a>, 0 <span class="id" title="notation">≤</span> <a class="idref" href="Nondet.html#n<sub>1</sub>:38"><span class="id" title="variable">n<sub>1</sub></span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="Nondet.html#n:36"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Nondet.html#Q:37"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:38"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="Nondet.html#s:35"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln:1"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:35"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_rand"><span class="id" title="constructor">val_rand</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n:36"><span class="id" title="variable">n</span></a>)) <a class="idref" href="Nondet.html#Q:37"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="evaln_ref" class="idref" href="#evaln_ref"><span class="id" title="constructor">evaln_ref</span></a> : <span class="id" title="keyword">∀</span> <a id="s:39" class="idref" href="#s:39"><span class="id" title="binder">s</span></a> <a id="v:40" class="idref" href="#v:40"><span class="id" title="binder">v</span></a> <a id="Q:41" class="idref" href="#Q:41"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="p:42" class="idref" href="#p:42"><span class="id" title="binder">p</span></a>, <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Nondet.html#s:39"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:42"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q:41"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:42"><span class="id" title="variable">p</span></a>) (<a class="idref" href="LibSepReference.html#Fmap.update"><span class="id" title="definition">Fmap.update</span></a> <a class="idref" href="Nondet.html#s:39"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:42"><span class="id" title="variable">p</span></a> <a class="idref" href="Nondet.html#v:40"><span class="id" title="variable">v</span></a>)<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln:1"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:39"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Nondet.html#v:40"><span class="id" title="variable">v</span></a>) <a class="idref" href="Nondet.html#Q:41"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="evaln_get" class="idref" href="#evaln_get"><span class="id" title="constructor">evaln_get</span></a> : <span class="id" title="keyword">∀</span> <a id="s:43" class="idref" href="#s:43"><span class="id" title="binder">s</span></a> <a id="p:44" class="idref" href="#p:44"><span class="id" title="binder">p</span></a> <a id="Q:45" class="idref" href="#Q:45"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Nondet.html#s:43"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:44"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q:45"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#Fmap.read"><span class="id" title="definition">Fmap.read</span></a> <a class="idref" href="Nondet.html#s:43"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:44"><span class="id" title="variable">p</span></a>) <a class="idref" href="Nondet.html#s:43"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln:1"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:43"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_get"><span class="id" title="constructor">val_get</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:44"><span class="id" title="variable">p</span></a>)) <a class="idref" href="Nondet.html#Q:45"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="evaln_set" class="idref" href="#evaln_set"><span class="id" title="constructor">evaln_set</span></a> : <span class="id" title="keyword">∀</span> <a id="s:46" class="idref" href="#s:46"><span class="id" title="binder">s</span></a> <a id="p:47" class="idref" href="#p:47"><span class="id" title="binder">p</span></a> <a id="v:48" class="idref" href="#v:48"><span class="id" title="binder">v</span></a> <a id="Q:49" class="idref" href="#Q:49"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Nondet.html#s:46"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:47"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q:49"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a> (<a class="idref" href="LibSepReference.html#Fmap.update"><span class="id" title="definition">Fmap.update</span></a> <a class="idref" href="Nondet.html#s:46"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:47"><span class="id" title="variable">p</span></a> <a class="idref" href="Nondet.html#v:48"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln:1"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:46"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_set"><span class="id" title="constructor">val_set</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:47"><span class="id" title="variable">p</span></a>) <a class="idref" href="Nondet.html#v:48"><span class="id" title="variable">v</span></a>) <a class="idref" href="Nondet.html#Q:49"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="evaln_free" class="idref" href="#evaln_free"><span class="id" title="constructor">evaln_free</span></a> : <span class="id" title="keyword">∀</span> <a id="s:50" class="idref" href="#s:50"><span class="id" title="binder">s</span></a> <a id="p:51" class="idref" href="#p:51"><span class="id" title="binder">p</span></a> <a id="Q:52" class="idref" href="#Q:52"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Nondet.html#s:50"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:51"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q:52"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a> (<a class="idref" href="LibSepReference.html#Fmap.remove"><span class="id" title="definition">Fmap.remove</span></a> <a class="idref" href="Nondet.html#s:50"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:51"><span class="id" title="variable">p</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln:1"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:50"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_free"><span class="id" title="constructor">val_free</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:51"><span class="id" title="variable">p</span></a>)) <a class="idref" href="Nondet.html#Q:52"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
Observe that <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> cannot hold if there exists one possible
    execution of <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> that runs into an error, i.e., that reaches a
    configuration that is stuck. This property reflects on the fact that
    the judgment <span class="inlinecode"><span class="id" title="var">evaln</span></span> asserts that every possible execution terminates
    safely. 
<div class="paragraph"> </div>

 Observe also that <span class="inlinecode"><span class="id" title="var">evaln</span></span> is covariant in the postcondition: if
    <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> holds, and <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span> is weaker than <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span>, then <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span>
    also holds. This property reflects on the fact that it is always
    possible to further over-approximate the set of possible results. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evaln_conseq" class="idref" href="#evaln_conseq"><span class="id" title="lemma">evaln_conseq</span></a> : <span class="id" title="keyword">∀</span> <a id="s:53" class="idref" href="#s:53"><span class="id" title="binder">s</span></a> <a id="t:54" class="idref" href="#t:54"><span class="id" title="binder">t</span></a> <a id="Q<sub>1</sub>:55" class="idref" href="#Q<sub>1</sub>:55"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:56" class="idref" href="#Q<sub>2</sub>:56"><span class="id" title="binder">Q<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:53"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:54"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q<sub>1</sub>:55"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q<sub>1</sub>:55"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Nondet.html#Q<sub>2</sub>:56"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:53"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:54"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q<sub>2</sub>:56"><span class="id" title="variable">Q<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">W</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">asserts</span> <span class="id" title="var">W'</span>: (<span class="id" title="keyword">∀</span> <a id="v:59" class="idref" href="#v:59"><span class="id" title="binder">v</span></a> <a id="h:60" class="idref" href="#h:60"><span class="id" title="binder">h</span></a>, <span class="id" title="var">Q<sub>1</sub></span> <a class="idref" href="Nondet.html#v:57"><span class="id" title="variable">v</span></a> <a class="idref" href="Nondet.html#h:58"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="var">Q<sub>2</sub></span> <a class="idref" href="Nondet.html#v:57"><span class="id" title="variable">v</span></a> <a class="idref" href="Nondet.html#h:58"><span class="id" title="variable">h</span></a>). { <span class="id" title="tactic">auto</span>. } <span class="id" title="tactic">clear</span> <span class="id" title="var">W</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">M</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [ <span class="id" title="var">constructors</span>* ].<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The judgment <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> can interpreted in at least five different ways:

<div class="paragraph"> </div>

<ul class="doclist">
<li> The judgment <span class="inlinecode"><span class="id" title="var">evaln</span></span> may be viewed as the natural generalization
      of <span class="inlinecode"><span class="id" title="tactic">eval</span></span>, generalizing from one output to a set of possible output.

</li>
<li> The judgment <span class="inlinecode"><span class="id" title="var">evaln</span></span> may be viewed as an inductive definition of a
      weakest-precondition judgment. Interestingly, if we swap the order of
      the arguments to <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span>, then the partial application <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>
      has type <span class="inlinecode"><span class="id" title="var">hprop</span></span>, and its interpretation matches exactly that of a
      weakest precondition for a Hoare triple. We'll formalize this claim
      further on in this chapter, and we'll point out shortly afterwards the
      difference between the rules that define <span class="inlinecode"><span class="id" title="var">evaln</span></span> and the traditional
      weakest-precondition reasoning rules.

</li>
<li> The judgment <span class="inlinecode"><span class="id" title="var">evaln</span></span> may be viewed as a CPS-version of the predicate
      <span class="inlinecode"><span class="id" title="tactic">eval</span></span>. Indeed, The output of <span class="inlinecode"><span class="id" title="tactic">eval</span></span>, made of an output value and an
      output state, are "passed on" to the continuation <span class="inlinecode"><span class="id" title="var">Q</span></span>.

</li>
<li> The judgment <span class="inlinecode"><span class="id" title="var">evaln</span></span> may be viewed as a particular form of denotational
      semantics for the language. Each program is interpreted as (i.e., mapped
      to) a set of mathematical objects, which "simply" consists of pairs of
      states and "syntactic" values. In particular, functions are interpreted
      as plain pieces of syntax (not as functions over Scott domains, as
      usually done).

</li>
<li> The judgment <span class="inlinecode"><span class="id" title="var">evaln</span></span> may be viewed as a generalized form of a typing
      relation. To make the analogy clear, let us adapt the definition of
      <span class="inlinecode"><span class="id" title="var">evaln</span></span> in two ways, and focus on the evaluation rule for let-bindings.
      First, let us get rid of the state, i.e., consider a language without
      side-effects, for simplicity.
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evaln</span> <span class="id" title="var">t<sub>1</sub></span> <span class="id" title="var">Q<sub>1</sub></span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">v<sub>1</sub></span>, <span class="id" title="var">Q<sub>1</sub></span> <span class="id" title="var">v<sub>1</sub></span> → <span class="id" title="var">evaln</span> (<span class="id" title="tactic">subst</span> <span class="id" title="var">x</span> <span class="id" title="var">v<sub>1</sub></span> <span class="id" title="var">t<sub>2</sub></span>) <span class="id" title="var">Q</span>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evaln</span> (<span class="id" title="var">trm_let</span> <span class="id" title="var">x</span> <span class="id" title="var">t<sub>1</sub></span> <span class="id" title="var">t<sub>2</sub></span>) <span class="id" title="var">Q</span>
</span>      Second, let us switch from a substitution-based semantics to an
      environment-based semantics---nothing but change of presentation.
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evaln</span> <span class="id" title="var">E</span> <span class="id" title="var">t<sub>1</sub></span> <span class="id" title="var">Q<sub>1</sub></span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">v<sub>1</sub></span>, <span class="id" title="var">Q<sub>1</sub></span> <span class="id" title="var">v<sub>1</sub></span> → <span class="id" title="var">evaln</span> ((<span class="id" title="var">x</span>,<span class="id" title="var">v<sub>1</sub></span>)::<span class="id" title="var">E</span>) <span class="id" title="var">t<sub>2</sub></span> <span class="id" title="var">Q</span>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evaln</span> <span class="id" title="var">E</span> (<span class="id" title="var">trm_let</span> <span class="id" title="var">x</span> <span class="id" title="var">t<sub>1</sub></span> <span class="id" title="var">t<sub>2</sub></span>) <span class="id" title="var">Q</span>
</span>      Now, let's consider a typing property. For example, expressing that a
      term has type <span class="inlinecode"><span class="id" title="var">int</span></span> amounts to asserting that this term produces a
      value <span class="inlinecode"><span class="id" title="var">v</span></span> of the form <span class="inlinecode"><span class="id" title="var">val_int</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> for some <span class="inlinecode"><span class="id" title="var">n</span></span>. This property may be
      captured by the postcondition <span class="inlinecode"><span class="id" title="keyword">fun</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode">⇒</span> <span class="inlinecode"><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">n</span>,</span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">val_int</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span>.
      Let us compare the previous rule with the traditional typing rule
      shown below.
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">typing</span> <span class="id" title="var">E</span> <span class="id" title="var">t<sub>1</sub></span> <span class="id" title="var">Q<sub>1</sub></span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">typing</span> ((<span class="id" title="var">x</span>,<span class="id" title="var">Q<sub>1</sub></span>)::<span class="id" title="var">E</span>) <span class="id" title="var">t<sub>2</sub></span> <span class="id" title="var">Q</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">typing</span> <span class="id" title="var">E</span> (<span class="id" title="var">trm_let</span> <span class="id" title="var">x</span> <span class="id" title="var">t<sub>1</sub></span> <span class="id" title="var">t<sub>2</sub></span>) <span class="id" title="var">Q</span>
</span>      The only difference is that the evaluation rule maps <span class="inlinecode"><span class="id" title="var">x</span></span> to any value
      <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span></span> such that <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span></span> has type <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span>, whereas the typing rule directly
      maps <span class="inlinecode"><span class="id" title="var">x</span></span> to the type <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span>. The two presentations are thus essentially
      equivalent. 
</li>
</ul>

<div class="paragraph"> </div>

 In what follows, we discuss the difference between the presentation
    of the judgment <span class="inlinecode"><span class="id" title="var">evaln</span></span>, and the rules that define a weakest
    precondition. We focus on the particular case of a let-binding. 
<div class="paragraph"> </div>

<a id="lab449"></a><h4 class="section">Exercise: 1 star, standard, optional (evaln_let')</h4>
 The rule <span class="inlinecode"><span class="id" title="var">evaln_let</span></span> shares similarities with the statement of
    the weakest-precondition style reasoning rule for let-bindings.
    Prove the following alternative statement, with a wp-style flavor. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evaln_let'" class="idref" href="#evaln_let'"><span class="id" title="lemma">evaln_let'</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:61" class="idref" href="#s<sub>1</sub>:61"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="x:62" class="idref" href="#x:62"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:63" class="idref" href="#t<sub>1</sub>:63"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:64" class="idref" href="#t<sub>2</sub>:64"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="Q:65" class="idref" href="#Q:65"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:61"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:63"><span class="id" title="variable">t<sub>1</sub></span></a> (<span class="id" title="keyword">fun</span> <a id="v<sub>1</sub>:66" class="idref" href="#v<sub>1</sub>:66"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="s<sub>2</sub>:67" class="idref" href="#s<sub>2</sub>:67"><span class="id" title="binder">s<sub>2</sub></span></a> ⇒ <a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:67"><span class="id" title="variable">s<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:62"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:66"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:64"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:65"><span class="id" title="variable">Q</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:61"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Nondet.html#x:62"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:63"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:64"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:65"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab450"></a><h4 class="section">Exercise: 2 stars, standard, optional (evaln_let_of_evaln_let')</h4>
 Reciprocally, prove that the statement considered in the inductive
    definition of <span class="inlinecode"><span class="id" title="var">evaln</span></span> is derivable from <span class="inlinecode"><span class="id" title="var">evaln_let'</span></span>. More precisely,
    prove the statement below by using <span class="inlinecode"><span class="id" title="var">evaln_let'</span></span> and <span class="inlinecode"><span class="id" title="var">evaln_conseq</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evaln_let_of_evaln_let'" class="idref" href="#evaln_let_of_evaln_let'"><span class="id" title="lemma">evaln_let_of_evaln_let'</span></a> : <span class="id" title="keyword">∀</span> <a id="Q<sub>1</sub>:68" class="idref" href="#Q<sub>1</sub>:68"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="s<sub>1</sub>:69" class="idref" href="#s<sub>1</sub>:69"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="x:70" class="idref" href="#x:70"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:71" class="idref" href="#t<sub>1</sub>:71"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:72" class="idref" href="#t<sub>2</sub>:72"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="Q:73" class="idref" href="#Q:73"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:69"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:71"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#Q<sub>1</sub>:68"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="v<sub>1</sub>:74" class="idref" href="#v<sub>1</sub>:74"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="s<sub>2</sub>:75" class="idref" href="#s<sub>2</sub>:75"><span class="id" title="binder">s<sub>2</sub></span></a>, <a class="idref" href="Nondet.html#Q<sub>1</sub>:68"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:74"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:75"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:75"><span class="id" title="variable">s<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:70"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:74"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:72"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:73"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:69"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Nondet.html#x:70"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:71"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:72"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:73"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 One way wonder whether we could have used the wp-style formulation
    of the semantics of let-bindings directly in the definition of <span class="inlinecode"><span class="id" title="var">evaln</span></span>.
    The answer is negative. Doing so would lead to an invalid inductive
    definition, involving a "non strictly positive occurrence". To check it
    out, uncomment the definition below to observe Coq's complaint.
<br/>
<span class="inlinecode">&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">evaln'</span> : <span class="id" title="var">state</span> → <span class="id" title="var">trm</span> → (<span class="id" title="var">val</span>→<span class="id" title="var">state</span>→<span class="id" title="keyword">Prop</span>) → <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">evaln'_let</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">Q<sub>1</sub></span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">x</span> <span class="id" title="var">t<sub>1</sub></span> <span class="id" title="var">t<sub>2</sub></span> <span class="id" title="var">Q</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evaln'</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">t<sub>1</sub></span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">v<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> ⇒ <span class="id" title="var">evaln'</span> <span class="id" title="var">s<sub>2</sub></span> (<span class="id" title="tactic">subst</span> <span class="id" title="var">x</span> <span class="id" title="var">v<sub>1</sub></span> <span class="id" title="var">t<sub>2</sub></span>) <span class="id" title="var">Q</span>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">evaln'</span> <span class="id" title="var">s<sub>1</sub></span> (<span class="id" title="var">trm_let</span> <span class="id" title="var">x</span> <span class="id" title="var">t<sub>1</sub></span> <span class="id" title="var">t<sub>2</sub></span>) <span class="id" title="var">Q</span>.
</span>
</div>

<div class="doc">
<a id="lab451"></a><h2 class="section">Interpretation of <span class="inlinecode"><span class="id" title="var">evaln</span></span> w.r.t. <span class="inlinecode"><span class="id" title="tactic">eval</span></span></h2>

<div class="paragraph"> </div>

 Given that <span class="inlinecode"><span class="id" title="var">evaln</span></span> describes "all possible executions" and that
    <span class="inlinecode"><span class="id" title="tactic">eval</span></span> describes "one possible execution", there must be formal
    relationships between the two predicates. These relationships are
    investigated next.

<div class="paragraph"> </div>

    Recall the big-step evaluation judgment <span class="inlinecode"><span class="id" title="tactic">eval</span></span>. It is the same
    as before, only extended with evaluation rule for the random
    number generator, namely <span class="inlinecode"><span class="id" title="var">eval_rand</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="eval" class="idref" href="#eval"><span class="id" title="inductive">eval</span></a> : <a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="eval_val" class="idref" href="#eval_val"><span class="id" title="constructor">eval_val</span></a> : <span class="id" title="keyword">∀</span> <a id="s:78" class="idref" href="#s:78"><span class="id" title="binder">s</span></a> <a id="v:79" class="idref" href="#v:79"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#eval:76"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s:78"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Nondet.html#v:79"><span class="id" title="variable">v</span></a>) <a class="idref" href="Nondet.html#s:78"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#v:79"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;| <a id="eval_fix" class="idref" href="#eval_fix"><span class="id" title="constructor">eval_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s:80" class="idref" href="#s:80"><span class="id" title="binder">s</span></a> <a id="f:81" class="idref" href="#f:81"><span class="id" title="binder">f</span></a> <a id="x:82" class="idref" href="#x:82"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:83" class="idref" href="#t<sub>1</sub>:83"><span class="id" title="binder">t<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#eval:76"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s:80"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_fix"><span class="id" title="constructor">trm_fix</span></a> <a class="idref" href="Nondet.html#f:81"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:82"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:83"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Nondet.html#s:80"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:81"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:82"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:83"><span class="id" title="variable">t<sub>1</sub></span></a>)<br/>
&nbsp;&nbsp;| <a id="eval_app_fix" class="idref" href="#eval_app_fix"><span class="id" title="constructor">eval_app_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:84" class="idref" href="#s<sub>1</sub>:84"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:85" class="idref" href="#s<sub>2</sub>:85"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="v<sub>1</sub>:86" class="idref" href="#v<sub>1</sub>:86"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:87" class="idref" href="#v<sub>2</sub>:87"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="f:88" class="idref" href="#f:88"><span class="id" title="binder">f</span></a> <a id="x:89" class="idref" href="#x:89"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:90" class="idref" href="#t<sub>1</sub>:90"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="v:91" class="idref" href="#v:91"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#v<sub>1</sub>:86"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:88"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:89"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:90"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#eval:76"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:84"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:89"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:87"><span class="id" title="variable">v<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#f:88"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:86"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:90"><span class="id" title="variable">t<sub>1</sub></span></a>)) <a class="idref" href="Nondet.html#s<sub>2</sub>:85"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#v:91"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#eval:76"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:84"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:86"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:87"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#s<sub>2</sub>:85"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#v:91"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;| <a id="eval_let" class="idref" href="#eval_let"><span class="id" title="constructor">eval_let</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:92" class="idref" href="#s<sub>1</sub>:92"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:93" class="idref" href="#s<sub>2</sub>:93"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="s<sub>3</sub>:94" class="idref" href="#s<sub>3</sub>:94"><span class="id" title="binder">s<sub>3</sub></span></a> <a id="x:95" class="idref" href="#x:95"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:96" class="idref" href="#t<sub>1</sub>:96"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:97" class="idref" href="#t<sub>2</sub>:97"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="v<sub>1</sub>:98" class="idref" href="#v<sub>1</sub>:98"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="r:99" class="idref" href="#r:99"><span class="id" title="binder">r</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#eval:76"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:92"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:96"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:93"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:98"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#eval:76"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:93"><span class="id" title="variable">s<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:95"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:98"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:97"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#s<sub>3</sub>:94"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="Nondet.html#r:99"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#eval:76"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:92"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Nondet.html#x:95"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:96"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:97"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#s<sub>3</sub>:94"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="Nondet.html#r:99"><span class="id" title="variable">r</span></a><br/>
&nbsp;&nbsp;| <a id="eval_if" class="idref" href="#eval_if"><span class="id" title="constructor">eval_if</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:100" class="idref" href="#s<sub>1</sub>:100"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:101" class="idref" href="#s<sub>2</sub>:101"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="b:102" class="idref" href="#b:102"><span class="id" title="binder">b</span></a> <a id="v:103" class="idref" href="#v:103"><span class="id" title="binder">v</span></a> <a id="t<sub>1</sub>:104" class="idref" href="#t<sub>1</sub>:104"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:105" class="idref" href="#t<sub>2</sub>:105"><span class="id" title="binder">t<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#eval:76"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:100"><span class="id" title="variable">s<sub>1</sub></span></a> (<span class="id" title="keyword">if</span> <a class="idref" href="Nondet.html#b:102"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Nondet.html#t<sub>1</sub>:104"><span class="id" title="variable">t<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Nondet.html#t<sub>2</sub>:105"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#s<sub>2</sub>:101"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#v:103"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#eval:76"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:100"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_if"><span class="id" title="constructor">trm_if</span></a> (<a class="idref" href="LibSepReference.html#val_bool"><span class="id" title="constructor">val_bool</span></a> <a class="idref" href="Nondet.html#b:102"><span class="id" title="variable">b</span></a>) <a class="idref" href="Nondet.html#t<sub>1</sub>:104"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:105"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#s<sub>2</sub>:101"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#v:103"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;| <a id="eval_add" class="idref" href="#eval_add"><span class="id" title="constructor">eval_add</span></a> : <span class="id" title="keyword">∀</span> <a id="s:106" class="idref" href="#s:106"><span class="id" title="binder">s</span></a> <a id="n<sub>1</sub>:107" class="idref" href="#n<sub>1</sub>:107"><span class="id" title="binder">n<sub>1</sub></span></a> <a id="n<sub>2</sub>:108" class="idref" href="#n<sub>2</sub>:108"><span class="id" title="binder">n<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#eval:76"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s:106"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_add"><span class="id" title="constructor">val_add</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:107"><span class="id" title="variable">n<sub>1</sub></span></a>) (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>2</sub>:108"><span class="id" title="variable">n<sub>2</sub></span></a>)) <a class="idref" href="Nondet.html#s:106"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> (<a class="idref" href="Nondet.html#n<sub>1</sub>:107"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="Nondet.html#n<sub>2</sub>:108"><span class="id" title="variable">n<sub>2</sub></span></a>))<br/>
&nbsp;&nbsp;| <a id="eval_rand" class="idref" href="#eval_rand"><span class="id" title="constructor">eval_rand</span></a> : <span class="id" title="keyword">∀</span> <a id="s:109" class="idref" href="#s:109"><span class="id" title="binder">s</span></a> <a id="n:110" class="idref" href="#n:110"><span class="id" title="binder">n</span></a> <a id="n<sub>1</sub>:111" class="idref" href="#n<sub>1</sub>:111"><span class="id" title="binder">n<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 <span class="id" title="notation">≤</span> <a class="idref" href="Nondet.html#n<sub>1</sub>:111"><span class="id" title="variable">n<sub>1</sub></span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="Nondet.html#n:110"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#eval:76"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s:109"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_rand"><span class="id" title="constructor">val_rand</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n:110"><span class="id" title="variable">n</span></a>)) <a class="idref" href="Nondet.html#s:109"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:111"><span class="id" title="variable">n<sub>1</sub></span></a>)<br/>
&nbsp;&nbsp;| <a id="eval_ref" class="idref" href="#eval_ref"><span class="id" title="constructor">eval_ref</span></a> : <span class="id" title="keyword">∀</span> <a id="s:112" class="idref" href="#s:112"><span class="id" title="binder">s</span></a> <a id="v:113" class="idref" href="#v:113"><span class="id" title="binder">v</span></a> <a id="p:114" class="idref" href="#p:114"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Nondet.html#s:112"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:114"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#eval:76"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s:112"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Nondet.html#v:113"><span class="id" title="variable">v</span></a>) (<a class="idref" href="LibSepReference.html#Fmap.update"><span class="id" title="definition">Fmap.update</span></a> <a class="idref" href="Nondet.html#s:112"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:114"><span class="id" title="variable">p</span></a> <a class="idref" href="Nondet.html#v:113"><span class="id" title="variable">v</span></a>) (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:114"><span class="id" title="variable">p</span></a>)<br/>
&nbsp;&nbsp;| <a id="eval_get" class="idref" href="#eval_get"><span class="id" title="constructor">eval_get</span></a> : <span class="id" title="keyword">∀</span> <a id="s:115" class="idref" href="#s:115"><span class="id" title="binder">s</span></a> <a id="p:116" class="idref" href="#p:116"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Nondet.html#s:115"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:116"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#eval:76"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s:115"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_get"><span class="id" title="constructor">val_get</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:116"><span class="id" title="variable">p</span></a>)) <a class="idref" href="Nondet.html#s:115"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#Fmap.read"><span class="id" title="definition">Fmap.read</span></a> <a class="idref" href="Nondet.html#s:115"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:116"><span class="id" title="variable">p</span></a>)<br/>
&nbsp;&nbsp;| <a id="eval_set" class="idref" href="#eval_set"><span class="id" title="constructor">eval_set</span></a> : <span class="id" title="keyword">∀</span> <a id="s:117" class="idref" href="#s:117"><span class="id" title="binder">s</span></a> <a id="p:118" class="idref" href="#p:118"><span class="id" title="binder">p</span></a> <a id="v:119" class="idref" href="#v:119"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Nondet.html#s:117"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:118"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#eval:76"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s:117"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_set"><span class="id" title="constructor">val_set</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:118"><span class="id" title="variable">p</span></a>) <a class="idref" href="Nondet.html#v:119"><span class="id" title="variable">v</span></a>) (<a class="idref" href="LibSepReference.html#Fmap.update"><span class="id" title="definition">Fmap.update</span></a> <a class="idref" href="Nondet.html#s:117"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:118"><span class="id" title="variable">p</span></a> <a class="idref" href="Nondet.html#v:119"><span class="id" title="variable">v</span></a>) <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a><br/>
&nbsp;&nbsp;| <a id="eval_free" class="idref" href="#eval_free"><span class="id" title="constructor">eval_free</span></a> : <span class="id" title="keyword">∀</span> <a id="s:120" class="idref" href="#s:120"><span class="id" title="binder">s</span></a> <a id="p:121" class="idref" href="#p:121"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Nondet.html#s:120"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:121"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#eval:76"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s:120"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_free"><span class="id" title="constructor">val_free</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:121"><span class="id" title="variable">p</span></a>)) (<a class="idref" href="LibSepReference.html#Fmap.remove"><span class="id" title="definition">Fmap.remove</span></a> <a class="idref" href="Nondet.html#s:120"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:121"><span class="id" title="variable">p</span></a>) <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a>.<br/>
</div>

<div class="doc">
The judgment <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> asserts that any possible execution of the
    program <span class="inlinecode">(<span class="id" title="var">t</span>,<span class="id" title="var">s</span>)</span> terminates on an output satisfying the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>.
    Thus, if one particular execution terminates on the output <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">v</span>)</span>,
    as described by the judgment <span class="inlinecode"><span class="id" title="tactic">eval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>, it must be the case
    that <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> holds. This result is formalized by the following lemma. 
<div class="paragraph"> </div>

<a id="lab452"></a><h4 class="section">Exercise: 3 stars, standard, optional (evaln_inv_eval)</h4>
 Assume <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> to hold. Prove that the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span> holds of
    any output that <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> may evaluate to according to the judgment <span class="inlinecode"><span class="id" title="tactic">eval</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evaln_inv_eval" class="idref" href="#evaln_inv_eval"><span class="id" title="lemma">evaln_inv_eval</span></a> : <span class="id" title="keyword">∀</span> <a id="s:122" class="idref" href="#s:122"><span class="id" title="binder">s</span></a> <a id="t:123" class="idref" href="#t:123"><span class="id" title="binder">t</span></a> <a id="v:124" class="idref" href="#v:124"><span class="id" title="binder">v</span></a> <a id="s':125" class="idref" href="#s':125"><span class="id" title="binder">s'</span></a> <a id="Q:126" class="idref" href="#Q:126"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:122"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:123"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:126"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#eval"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s:122"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:123"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#s':125"><span class="id" title="variable">s'</span></a> <a class="idref" href="Nondet.html#v:124"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q:126"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#v:124"><span class="id" title="variable">v</span></a> <a class="idref" href="Nondet.html#s':125"><span class="id" title="variable">s'</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 The judgment <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> asserts that any possible execution of the
    program <span class="inlinecode">(<span class="id" title="var">t</span>,<span class="id" title="var">s</span>)</span> terminates on an output satisfying the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>.
    This judgment implies, in particular, that there exists at least one
    such execution, described by a judgment of the form <span class="inlinecode"><span class="id" title="tactic">eval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>,
    where <span class="inlinecode"><span class="id" title="var">v</span></span> and <span class="inlinecode"><span class="id" title="var">s'</span></span> satisfy the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>. This second result is
    formalized by the following lemma. 
<div class="paragraph"> </div>

<a id="lab453"></a><h4 class="section">Exercise: 4 stars, standard, especially useful (evaln_inv_exists_eval)</h4>
 Assume <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> to hold. Prove that there exists an output
    <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">v</span>)</span> that <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> may evaluate to according to the judgment
    <span class="inlinecode"><span class="id" title="tactic">eval</span></span>, and that this output satisfies <span class="inlinecode"><span class="id" title="var">Q</span></span>.

<div class="paragraph"> </div>

    Hint: the proof may be carried out either with or without leveraging
    the lemma <span class="inlinecode"><span class="id" title="var">evaln_inv_eval</span></span>, proved above.

<div class="paragraph"> </div>

    Hint: for the case <span class="inlinecode"><span class="id" title="var">eval_ref</span></span>, use the following line to assert the
    existence of a fresh location:
    <span class="inlinecode"><span class="id" title="var">forwards</span>*</span> <span class="inlinecode">(<span class="id" title="var">p</span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">N</span>):</span> <span class="inlinecode">(<span class="id" title="var">exists_fresh</span></span> <span class="inlinecode"><span class="id" title="var">null</span></span> <span class="inlinecode"><span class="id" title="var">s</span>).</span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evaln_inv_exists_eval" class="idref" href="#evaln_inv_exists_eval"><span class="id" title="lemma">evaln_inv_exists_eval</span></a> : <span class="id" title="keyword">∀</span> <a id="s:127" class="idref" href="#s:127"><span class="id" title="binder">s</span></a> <a id="t:128" class="idref" href="#t:128"><span class="id" title="binder">t</span></a> <a id="Q:129" class="idref" href="#Q:129"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:127"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:128"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:129"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="s':130" class="idref" href="#s':130"><span class="id" title="binder">s'</span></a> <a id="v:131" class="idref" href="#v:131"><span class="id" title="binder">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Nondet.html#eval"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s:127"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:128"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#s':130"><span class="id" title="variable">s'</span></a> <a class="idref" href="Nondet.html#v:131"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Nondet.html#Q:129"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#v:131"><span class="id" title="variable">v</span></a> <a class="idref" href="Nondet.html#s':130"><span class="id" title="variable">s'</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 The judgment <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> associates with a program configuration
    <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> an over-approximation of its possible output configurations,
    described by <span class="inlinecode"><span class="id" title="var">Q</span></span>. For the purpose of defining of Hoare triple, working
    with over-approximation is perfectly fine. In other contexts, however,
    it might be interesting to characterize exactly the set of output
    configurations.

<div class="paragraph"> </div>

    The set of results to which a program <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> may evaluate is
    precisely characterized by the predicate <span class="inlinecode"><span class="id" title="keyword">fun</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode">⇒</span> <span class="inlinecode"><span class="id" title="tactic">eval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>.
    Let <span class="inlinecode"><span class="id" title="var">post</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> denote exactly that predicate. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="post" class="idref" href="#post"><span class="id" title="definition">post</span></a> (<a id="s:132" class="idref" href="#s:132"><span class="id" title="binder">s</span></a>:<a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a>) (<a id="t:133" class="idref" href="#t:133"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) : <a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="v:134" class="idref" href="#v:134"><span class="id" title="binder">v</span></a> <a id="s':135" class="idref" href="#s':135"><span class="id" title="binder">s'</span></a> ⇒ <a class="idref" href="Nondet.html#eval"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s:132"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:133"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#s':135"><span class="id" title="variable">s'</span></a> <a class="idref" href="Nondet.html#v:134"><span class="id" title="variable">v</span></a>.<br/>
</div>

<div class="doc">
The judgment <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">(<span class="id" title="var">post</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span>)</span> essentially captures the safety
    of the program <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span>: it asserts that all possible executions
    terminate without error.

<div class="paragraph"> </div>

    Let us prove that <span class="inlinecode"><span class="id" title="var">post</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> corresponds to the smallest possible
    post-condition for <span class="inlinecode"><span class="id" title="var">evaln</span></span>. In other words, assuming that <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>
    holds for some <span class="inlinecode"><span class="id" title="var">Q</span></span>, we can prove that <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">(<span class="id" title="var">post</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span>)</span> holds,
    and that the entailment <span class="inlinecode"><span class="id" title="var">post</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">===&gt;</span> <span class="inlinecode"><span class="id" title="var">Q</span></span> holds. This entailment
    captures the fact that <span class="inlinecode"><span class="id" title="var">post</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> denotes a smaller set of results
    than <span class="inlinecode"><span class="id" title="var">Q</span></span>. Note that <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">(<span class="id" title="var">post</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span>)</span> does not hold for a program
    for which one particular execution may diverge or get stuck. 
<div class="paragraph"> </div>

<a id="lab454"></a><h4 class="section">Exercise: 5 stars, standard, especially useful (evaln_post_of_evaln)</h4>
 Prove the fact that if <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> holds for some <span class="inlinecode"><span class="id" title="var">Q</span></span>, then it
    holds for the smallest postcondition, namely <span class="inlinecode"><span class="id" title="var">post</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span>.
    Hint: in the let-binding case, you'll need to either exploit
    <span class="inlinecode"><span class="id" title="var">evaln_inv_eval</span></span> or to provide an explicit intermediate postcondition
    for the subterm <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> that revers to <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evaln_post_of_evaln" class="idref" href="#evaln_post_of_evaln"><span class="id" title="lemma">evaln_post_of_evaln</span></a> : <span class="id" title="keyword">∀</span> <a id="s:136" class="idref" href="#s:136"><span class="id" title="binder">s</span></a> <a id="t:137" class="idref" href="#t:137"><span class="id" title="binder">t</span></a> <a id="Q:138" class="idref" href="#Q:138"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:136"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:137"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:138"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:136"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:137"><span class="id" title="variable">t</span></a> (<a class="idref" href="Nondet.html#post"><span class="id" title="definition">post</span></a> <a class="idref" href="Nondet.html#s:136"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:137"><span class="id" title="variable">t</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab455"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (evaln_inv_post_qimpl)</h4>
 Prove the fact that if <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> holds, then <span class="inlinecode"><span class="id" title="var">post</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">===&gt;</span> <span class="inlinecode"><span class="id" title="var">Q</span></span>,
    i.e. the smallest-possible postcondition entails the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>.
    Hint: the proof is only one line long. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evaln_inv_post_qimpl" class="idref" href="#evaln_inv_post_qimpl"><span class="id" title="lemma">evaln_inv_post_qimpl</span></a> : <span class="id" title="keyword">∀</span> <a id="s:139" class="idref" href="#s:139"><span class="id" title="binder">s</span></a> <a id="t:140" class="idref" href="#t:140"><span class="id" title="binder">t</span></a> <a id="Q:141" class="idref" href="#Q:141"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:139"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:140"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:141"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#post"><span class="id" title="definition">post</span></a> <a class="idref" href="Nondet.html#s:139"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:140"><span class="id" title="variable">t</span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Nondet.html#Q:141"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>


<div class="doc">
<a id="lab456"></a><h2 class="section">Triples for Non-Deterministic Big-Step Semantics</h2>

<div class="paragraph"> </div>

 A Hoare triple, written <span class="inlinecode"><span class="id" title="var">hoaren</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>, asserts that, for any input state
    <span class="inlinecode"><span class="id" title="var">s</span></span> satisfying the precondition <span class="inlinecode"><span class="id" title="var">H</span></span>, all executions of <span class="inlinecode"><span class="id" title="var">t</span></span> in that state
    <span class="inlinecode"><span class="id" title="var">s</span></span> terminate and produce an output satisfying the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="hoaren" class="idref" href="#hoaren"><span class="id" title="definition">hoaren</span></a> (<a id="t:142" class="idref" href="#t:142"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) (<a id="H:143" class="idref" href="#H:143"><span class="id" title="binder">H</span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) (<a id="Q:144" class="idref" href="#Q:144"><span class="id" title="binder">Q</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="s:145" class="idref" href="#s:145"><span class="id" title="binder">s</span></a>:<a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a>), <a class="idref" href="Nondet.html#H:143"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#s:145"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:145"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:142"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:144"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
In prior chapters, we defined a Separation Logic triple, written <span class="inlinecode"><span class="id" title="var">triplen</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>,
    by quantifying over the "rest of the word". Concretely, we used the definition
    <span class="inlinecode"><span class="id" title="keyword">∀</span></span> <span class="inlinecode">(<span class="id" title="var">H'</span>:<span class="id" title="var">hprop</span>),</span> <span class="inlinecode"><span class="id" title="var">hoare</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">(<span class="id" title="var">H</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H'</span>)</span> <span class="inlinecode">(<span class="id" title="var">Q</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*+</span> <span class="inlinecode"><span class="id" title="var">H'</span>)</span>. Doing so was necessary because
    the definition we had for <span class="inlinecode"><span class="id" title="var">hoare</span></span> did not satisfy the frame rule.

<div class="paragraph"> </div>

    It turns out that <span class="inlinecode"><span class="id" title="var">hoaren</span></span> does satisfy the frame rule. Thus, we can define
    Separation Logic triples directly as the predicate <span class="inlinecode"><span class="id" title="var">hoaren</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="triplen" class="idref" href="#triplen"><span class="id" title="definition">triplen</span></a> (<a id="t:146" class="idref" href="#t:146"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) (<a id="H:147" class="idref" href="#H:147"><span class="id" title="binder">H</span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) (<a id="Q:148" class="idref" href="#Q:148"><span class="id" title="binder">Q</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="s:149" class="idref" href="#s:149"><span class="id" title="binder">s</span></a>:<a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a>), <a class="idref" href="Nondet.html#H:147"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#s:149"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:149"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:146"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:148"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
The most important step of the proof is to argue that <span class="inlinecode"><span class="id" title="var">evaln</span></span> is stable
    by extension with a disjoint piece of heap. This proof is by induction.
    The most (and only) interesting step is that of allocation.
    In a derivation built using <span class="inlinecode"><span class="id" title="var">evaln_ref</span></span>, we are given an assumption about
    all locations <span class="inlinecode"><span class="id" title="var">p</span></span> fresh from <span class="inlinecode"><span class="id" title="var">h<sub>1</sub></span></span>. What we are trying to build is a fact
    mentioning all locations <span class="inlinecode"><span class="id" title="var">p</span></span> fresh from <span class="inlinecode"><span class="id" title="var">h<sub>1</sub></span></span> <span class="inlinecode">\<span class="id" title="var">u</span></span> <span class="inlinecode"><span class="id" title="var">h<sub>2</sub></span></span>. We are thus restricting
    the set of <span class="inlinecode"><span class="id" title="var">p</span></span> that can be considered for allocation, hence the result holds. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evaln_frame" class="idref" href="#evaln_frame"><span class="id" title="lemma">evaln_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="h<sub>1</sub>:150" class="idref" href="#h<sub>1</sub>:150"><span class="id" title="binder">h<sub>1</sub></span></a> <a id="h<sub>2</sub>:151" class="idref" href="#h<sub>2</sub>:151"><span class="id" title="binder">h<sub>2</sub></span></a> <a id="t:152" class="idref" href="#t:152"><span class="id" title="binder">t</span></a> <a id="Q:153" class="idref" href="#Q:153"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#h<sub>1</sub>:150"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t:152"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:153"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.disjoint"><span class="id" title="definition">Fmap.disjoint</span></a> <a class="idref" href="Nondet.html#h<sub>1</sub>:150"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="Nondet.html#h<sub>2</sub>:151"><span class="id" title="variable">h<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> (<a class="idref" href="Nondet.html#h<sub>1</sub>:150"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <a class="idref" href="Nondet.html#h<sub>2</sub>:151"><span class="id" title="variable">h<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#t:152"><span class="id" title="variable">t</span></a> (<a class="idref" href="Nondet.html#Q:153"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation">(</span></a><span class="id" title="notation">=</span> <a class="idref" href="Nondet.html#h<sub>2</sub>:151"><span class="id" title="variable">h<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation">)</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">HD</span>. <span class="id" title="var">gen</span> <span class="id" title="var">h<sub>2</sub></span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">M</span>; <span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [ <span class="id" title="var">hint</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>; <span class="id" title="var">constructors</span>* ].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rename</span> <span class="id" title="var">M</span> <span class="id" title="var">into</span> <span class="id" title="var">M<sub>1</sub></span>, <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">M<sub>2</sub></span>, <span class="id" title="var">IHM</span> <span class="id" title="var">into</span> <span class="id" title="var">IH<sub>1</sub></span>, <span class="id" title="var">H<sub>0</sub></span> <span class="id" title="var">into</span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specializes</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">HD</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_let"><span class="id" title="constructor">evaln_let</span></a> <span class="id" title="var">IH<sub>1</sub></span>. <span class="id" title="var">introv</span> <span class="id" title="var">HK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> (<span class="id" title="var">h<sub>1</sub>'</span>&amp;<span class="id" title="var">h<sub>2</sub>'</span>&amp;<span class="id" title="var">K<sub>1</sub>'</span>&amp;<span class="id" title="var">K<sub>2</sub>'</span>&amp;<span class="id" title="var">KD</span>&amp;<span class="id" title="var">KU</span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_inv"><span class="id" title="lemma">hstar_inv</span></a> <span class="id" title="var">HK</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="var">applys</span>* <span class="id" title="var">IH<sub>2</sub></span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rename</span> <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_ref"><span class="id" title="constructor">evaln_ref</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">Hp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#Fmap.indom_union_eq"><span class="id" title="lemma">Fmap.indom_union_eq</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">Hp</span>. <span class="id" title="var">rew_logic</span> <span class="id" title="keyword">in</span> <span class="id" title="var">Hp</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hp<sub>1</sub></span> <span class="id" title="var">Hp<sub>2</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.update_union_not_r"><span class="id" title="lemma">Fmap.update_union_not_r</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <span class="id" title="var">M</span>. } { <span class="id" title="tactic">auto</span>. } { <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.disjoint_update_not_r"><span class="id" title="lemma">Fmap.disjoint_update_not_r</span></a>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_get"><span class="id" title="constructor">evaln_get</span></a>. { <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_eq"><span class="id" title="lemma">Fmap.indom_union_eq</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.read_union_l"><span class="id" title="lemma">Fmap.read_union_l</span></a>. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_set"><span class="id" title="constructor">evaln_set</span></a>. { <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_eq"><span class="id" title="lemma">Fmap.indom_union_eq</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.update_union_l"><span class="id" title="lemma">Fmap.update_union_l</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">auto</span>. } { <span class="id" title="tactic">auto</span>. } { <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.disjoint_update_l"><span class="id" title="lemma">Fmap.disjoint_update_l</span></a>. } } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_free"><span class="id" title="constructor">evaln_free</span></a>. { <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_eq"><span class="id" title="lemma">Fmap.indom_union_eq</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.remove_disjoint_union_l"><span class="id" title="lemma">Fmap.remove_disjoint_union_l</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">auto</span>. } { <span class="id" title="tactic">auto</span>. } { <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.disjoint_remove_l"><span class="id" title="lemma">Fmap.disjoint_remove_l</span></a>. } } }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
From <span class="inlinecode"><span class="id" title="var">evaln_frame</span></span>, we can derive the standard frame rule for <span class="inlinecode"><span class="id" title="var">triplen</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triplen_frame" class="idref" href="#triplen_frame"><span class="id" title="lemma">triplen_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="t:154" class="idref" href="#t:154"><span class="id" title="binder">t</span></a> <a id="H:155" class="idref" href="#H:155"><span class="id" title="binder">H</span></a> <a id="Q:156" class="idref" href="#Q:156"><span class="id" title="binder">Q</span></a> <a id="H':157" class="idref" href="#H':157"><span class="id" title="binder">H'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> <a class="idref" href="Nondet.html#t:154"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#H:155"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:156"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> <a class="idref" href="Nondet.html#t:154"><span class="id" title="variable">t</span></a> (<a class="idref" href="Nondet.html#H:155"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H':157"><span class="id" title="variable">H'</span></a>) (<a class="idref" href="Nondet.html#Q:156"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Nondet.html#H':157"><span class="id" title="variable">H'</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">HF</span>. <span class="id" title="var">lets</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">M<sub>2</sub></span>&amp;<span class="id" title="var">MD</span>&amp;<span class="id" title="var">MU</span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_inv"><span class="id" title="lemma">hstar_inv</span></a> (<span class="id" title="definition">rm</span> <span class="id" title="var">HF</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">specializes</span> <span class="id" title="var">M</span> <span class="id" title="var">M<sub>1</sub></span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_conseq"><span class="id" title="lemma">evaln_conseq</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_frame"><span class="id" title="lemma">evaln_frame</span></a> <span class="id" title="var">M</span> <span class="id" title="var">MD</span>. } { <span class="id" title="var">xsimpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h'</span> →. <span class="id" title="var">applys</span> <span class="id" title="var">M<sub>2</sub></span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Other structural rules 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triplen_conseq" class="idref" href="#triplen_conseq"><span class="id" title="lemma">triplen_conseq</span></a> : <span class="id" title="keyword">∀</span> <a id="t:158" class="idref" href="#t:158"><span class="id" title="binder">t</span></a> <a id="H':159" class="idref" href="#H':159"><span class="id" title="binder">H'</span></a> <a id="Q':160" class="idref" href="#Q':160"><span class="id" title="binder">Q'</span></a> <a id="H:161" class="idref" href="#H:161"><span class="id" title="binder">H</span></a> <a id="Q:162" class="idref" href="#Q:162"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> <a class="idref" href="Nondet.html#t:158"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#H':159"><span class="id" title="variable">H'</span></a> <a class="idref" href="Nondet.html#Q':160"><span class="id" title="variable">Q'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#H:161"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#H':159"><span class="id" title="variable">H'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q':160"><span class="id" title="variable">Q'</span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Nondet.html#Q:162"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> <a class="idref" href="Nondet.html#t:158"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#H:161"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:162"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unfolds</span> <a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">MH</span> <span class="id" title="var">MQ</span> <span class="id" title="var">HF</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_conseq"><span class="id" title="lemma">evaln_conseq</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplen_hexists" class="idref" href="#triplen_hexists"><span class="id" title="lemma">triplen_hexists</span></a> : <span class="id" title="keyword">∀</span> <a id="t:163" class="idref" href="#t:163"><span class="id" title="binder">t</span></a> (<a id="A:164" class="idref" href="#A:164"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>) (<a id="J:165" class="idref" href="#J:165"><span class="id" title="binder">J</span></a>:<a class="idref" href="Nondet.html#A:164"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) <a id="Q:166" class="idref" href="#Q:166"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="x:167" class="idref" href="#x:167"><span class="id" title="binder">x</span></a>, <a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> <a class="idref" href="Nondet.html#t:163"><span class="id" title="variable">t</span></a> (<a class="idref" href="Nondet.html#J:165"><span class="id" title="variable">J</span></a> <a class="idref" href="Nondet.html#x:167"><span class="id" title="variable">x</span></a>) <a class="idref" href="Nondet.html#Q:166"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> <a class="idref" href="Nondet.html#t:163"><span class="id" title="variable">t</span></a> (<a class="idref" href="LibSepReference.html#SepSimplArgs.hexists"><span class="id" title="definition">hexists</span></a> <a class="idref" href="Nondet.html#J:165"><span class="id" title="variable">J</span></a>) <a class="idref" href="Nondet.html#Q:166"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> (<span class="id" title="var">x</span>&amp;<span class="id" title="var">Hh</span>). <span class="id" title="var">applys</span> <span class="id" title="var">M</span> <span class="id" title="var">Hh</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplen_hpure" class="idref" href="#triplen_hpure"><span class="id" title="lemma">triplen_hpure</span></a> : <span class="id" title="keyword">∀</span> <a id="t:168" class="idref" href="#t:168"><span class="id" title="binder">t</span></a> (<a id="P:169" class="idref" href="#P:169"><span class="id" title="binder">P</span></a>:<span class="id" title="keyword">Prop</span>) <a id="H:170" class="idref" href="#H:170"><span class="id" title="binder">H</span></a> <a id="Q:171" class="idref" href="#Q:171"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#P:169"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> <a class="idref" href="Nondet.html#t:168"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#H:170"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:171"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> <a class="idref" href="Nondet.html#t:168"><span class="id" title="variable">t</span></a> (<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#P:169"><span class="id" title="variable">P</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:170"><span class="id" title="variable">H</span></a>) <a class="idref" href="Nondet.html#Q:171"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">M<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">U</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">HP</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">E</span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hempty_inv"><span class="id" title="lemma">hempty_inv</span></a> <span class="id" title="var">HP</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#Fmap.union_empty_l"><span class="id" title="lemma">Fmap.union_empty_l</span></a>. <span class="id" title="var">applys</span>¬<span class="id" title="var">M</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Rules for term constructs 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triplen_val" class="idref" href="#triplen_val"><span class="id" title="lemma">triplen_val</span></a> : <span class="id" title="keyword">∀</span> <a id="v:172" class="idref" href="#v:172"><span class="id" title="binder">v</span></a> <a id="H:173" class="idref" href="#H:173"><span class="id" title="binder">H</span></a> <a id="Q:174" class="idref" href="#Q:174"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#H:173"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#Q:174"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#v:172"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Nondet.html#v:172"><span class="id" title="variable">v</span></a>) <a class="idref" href="Nondet.html#H:173"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:174"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_val"><span class="id" title="constructor">evaln_val</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplen_fix" class="idref" href="#triplen_fix"><span class="id" title="lemma">triplen_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="f:175" class="idref" href="#f:175"><span class="id" title="binder">f</span></a> <a id="x:176" class="idref" href="#x:176"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:177" class="idref" href="#t<sub>1</sub>:177"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="H:178" class="idref" href="#H:178"><span class="id" title="binder">H</span></a> <a id="Q:179" class="idref" href="#Q:179"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#H:178"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#Q:179"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:175"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:176"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:177"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#trm_fix"><span class="id" title="constructor">trm_fix</span></a> <a class="idref" href="Nondet.html#f:175"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:176"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:177"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Nondet.html#H:178"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:179"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_fix"><span class="id" title="constructor">evaln_fix</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplen_app_fix" class="idref" href="#triplen_app_fix"><span class="id" title="lemma">triplen_app_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="v<sub>1</sub>:180" class="idref" href="#v<sub>1</sub>:180"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:181" class="idref" href="#v<sub>2</sub>:181"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="f:182" class="idref" href="#f:182"><span class="id" title="binder">f</span></a> <a id="x:183" class="idref" href="#x:183"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:184" class="idref" href="#t<sub>1</sub>:184"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="H:185" class="idref" href="#H:185"><span class="id" title="binder">H</span></a> <a id="Q:186" class="idref" href="#Q:186"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#v<sub>1</sub>:180"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:182"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:183"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:184"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:183"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:181"><span class="id" title="variable">v<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#f:182"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:180"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:184"><span class="id" title="variable">t<sub>1</sub></span></a>)) <a class="idref" href="Nondet.html#H:185"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:186"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:180"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:181"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#H:185"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:186"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">E</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_app_fix"><span class="id" title="constructor">evaln_app_fix</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplen_let" class="idref" href="#triplen_let"><span class="id" title="lemma">triplen_let</span></a> : <span class="id" title="keyword">∀</span> <a id="x:187" class="idref" href="#x:187"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:188" class="idref" href="#t<sub>1</sub>:188"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:189" class="idref" href="#t<sub>2</sub>:189"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="H:190" class="idref" href="#H:190"><span class="id" title="binder">H</span></a> <a id="Q:191" class="idref" href="#Q:191"><span class="id" title="binder">Q</span></a> <a id="Q<sub>1</sub>:192" class="idref" href="#Q<sub>1</sub>:192"><span class="id" title="binder">Q<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:188"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#H:190"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q<sub>1</sub>:192"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="v<sub>1</sub>:193" class="idref" href="#v<sub>1</sub>:193"><span class="id" title="binder">v<sub>1</sub></span></a>, <a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:187"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:193"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:189"><span class="id" title="variable">t<sub>2</sub></span></a>) (<a class="idref" href="Nondet.html#Q<sub>1</sub>:192"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:193"><span class="id" title="variable">v<sub>1</sub></span></a>) <a class="idref" href="Nondet.html#Q:191"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Nondet.html#x:187"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:188"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:189"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#H:190"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:191"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="var">M<sub>2</sub></span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_let"><span class="id" title="constructor">evaln_let</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplen_if" class="idref" href="#triplen_if"><span class="id" title="lemma">triplen_if</span></a> : <span class="id" title="keyword">∀</span> (<a id="b:194" class="idref" href="#b:194"><span class="id" title="binder">b</span></a>:<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) <a id="t<sub>1</sub>:195" class="idref" href="#t<sub>1</sub>:195"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:196" class="idref" href="#t<sub>2</sub>:196"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="H:197" class="idref" href="#H:197"><span class="id" title="binder">H</span></a> <a id="Q:198" class="idref" href="#Q:198"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<span class="id" title="keyword">if</span> <a class="idref" href="Nondet.html#b:194"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Nondet.html#t<sub>1</sub>:195"><span class="id" title="variable">t<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Nondet.html#t<sub>2</sub>:196"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#H:197"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:198"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#trm_if"><span class="id" title="constructor">trm_if</span></a> <a class="idref" href="Nondet.html#b:194"><span class="id" title="variable">b</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:195"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:196"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#H:197"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:198"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_if"><span class="id" title="constructor">evaln_if</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Rules for primitive operations 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triplen_add" class="idref" href="#triplen_add"><span class="id" title="lemma">triplen_add</span></a> : <span class="id" title="keyword">∀</span> <a id="H:199" class="idref" href="#H:199"><span class="id" title="binder">H</span></a> <a id="n<sub>1</sub>:200" class="idref" href="#n<sub>1</sub>:200"><span class="id" title="binder">n<sub>1</sub></span></a> <a id="n<sub>2</sub>:201" class="idref" href="#n<sub>2</sub>:201"><span class="id" title="binder">n<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#val_add"><span class="id" title="constructor">val_add</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:200"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="Nondet.html#n<sub>2</sub>:201"><span class="id" title="variable">n<sub>2</sub></span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#H:199"><span class="id" title="variable">H</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="r:202" class="idref" href="#r:202"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:202"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> (<a class="idref" href="Nondet.html#n<sub>1</sub>:200"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="Nondet.html#n<sub>2</sub>:201"><span class="id" title="variable">n<sub>2</sub></span></a>)<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:199"><span class="id" title="variable">H</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_add"><span class="id" title="constructor">evaln_add</span></a>. <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_hpure_l"><span class="id" title="lemma">hstar_hpure_l</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplen_rand" class="idref" href="#triplen_rand"><span class="id" title="lemma">triplen_rand</span></a> : <span class="id" title="keyword">∀</span> <a id="n:203" class="idref" href="#n:203"><span class="id" title="binder">n</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#n:203"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;</span> 0 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#val_rand"><span class="id" title="constructor">val_rand</span></a> <a class="idref" href="Nondet.html#n:203"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#0a700e54c124035039013e87e1a2bcaa"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="r:204" class="idref" href="#r:204"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="n<sub>1</sub>:205" class="idref" href="#n<sub>1</sub>:205"><span class="id" title="binder">n<sub>1</sub></span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a>0 <span class="id" title="notation">≤</span> <a class="idref" href="Nondet.html#n<sub>1</sub>:205"><span class="id" title="variable">n<sub>1</sub></span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="Nondet.html#n:203"><span class="id" title="variable">n</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:204"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:205"><span class="id" title="variable">n<sub>1</sub></span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">N</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_rand"><span class="id" title="constructor">evaln_rand</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hempty_inv"><span class="id" title="lemma">hempty_inv</span></a> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n<sub>1</sub></span> <span class="id" title="var">H<sub>1</sub></span>. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#SepSimplArgs.hexists_intro"><span class="id" title="lemma">hexists_intro</span></a> <span class="id" title="var">n<sub>1</sub></span>. <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_hpure_l"><span class="id" title="lemma">hstar_hpure_l</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">split</span>*. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#SepSimplArgs.hpure_intro"><span class="id" title="lemma">hpure_intro</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplen_ref" class="idref" href="#triplen_ref"><span class="id" title="lemma">triplen_ref</span></a> : <span class="id" title="keyword">∀</span> <a id="H:206" class="idref" href="#H:206"><span class="id" title="binder">H</span></a> <a id="v:207" class="idref" href="#v:207"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Nondet.html#v:207"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#H:206"><span class="id" title="variable">H</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="r:208" class="idref" href="#r:208"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="p:209" class="idref" href="#p:209"><span class="id" title="binder">p</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:208"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:209"><span class="id" title="variable">p</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#p:209"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:207"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:206"><span class="id" title="variable">H</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_ref"><span class="id" title="constructor">evaln_ref</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">D</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unfolds</span> <a class="idref" href="LibSepFmap.html#update"><span class="id" title="definition">update</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hexists_intro"><span class="id" title="lemma">hexists_intro</span></a> <span class="id" title="var">p</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_hpure_l"><span class="id" title="lemma">hstar_hpure_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>*. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hsingle_intro"><span class="id" title="lemma">hsingle_intro</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepFmap.html#disjoint_single_of_not_indom"><span class="id" title="lemma">disjoint_single_of_not_indom</span></a>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplen_get" class="idref" href="#triplen_get"><span class="id" title="lemma">triplen_get</span></a> : <span class="id" title="keyword">∀</span> <a id="H:210" class="idref" href="#H:210"><span class="id" title="binder">H</span></a> <a id="v:211" class="idref" href="#v:211"><span class="id" title="binder">v</span></a> <a id="p:212" class="idref" href="#p:212"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#val_get"><span class="id" title="constructor">val_get</span></a> <a class="idref" href="Nondet.html#p:212"><span class="id" title="variable">p</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:212"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:211"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:210"><span class="id" title="variable">H</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="r:213" class="idref" href="#r:213"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:213"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Nondet.html#v:211"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:212"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:211"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:210"><span class="id" title="variable">H</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">P<sub>1</sub></span>&amp;<span class="id" title="var">P<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_inv"><span class="id" title="lemma">hstar_inv</span></a> (<span class="id" title="definition">rm</span> <span class="id" title="var">K</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">E<sub>1</sub></span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hsingle_inv"><span class="id" title="lemma">hsingle_inv</span></a> <span class="id" title="var">P<sub>1</sub></span>. <span class="id" title="var">lets</span> <span class="id" title="var">I<sub>1</sub></span>: <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a> <span class="id" title="var">p</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_get"><span class="id" title="constructor">evaln_get</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_l"><span class="id" title="lemma">Fmap.indom_union_l</span></a>. <span class="id" title="tactic">subst</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_hpure_l"><span class="id" title="lemma">hstar_hpure_l</span></a>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span> <span class="id" title="var">h<sub>1</sub></span>. <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.read_union_l"><span class="id" title="lemma">Fmap.read_union_l</span></a>. <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.read_single"><span class="id" title="lemma">Fmap.read_single</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplen_set" class="idref" href="#triplen_set"><span class="id" title="lemma">triplen_set</span></a> : <span class="id" title="keyword">∀</span> <a id="H:214" class="idref" href="#H:214"><span class="id" title="binder">H</span></a> <a id="w:215" class="idref" href="#w:215"><span class="id" title="binder">w</span></a> <a id="p:216" class="idref" href="#p:216"><span class="id" title="binder">p</span></a> <a id="v:217" class="idref" href="#v:217"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#val_set"><span class="id" title="constructor">val_set</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:216"><span class="id" title="variable">p</span></a>) <a class="idref" href="Nondet.html#v:217"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:216"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#w:215"><span class="id" title="variable">w</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:214"><span class="id" title="variable">H</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="r:218" class="idref" href="#r:218"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:218"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:216"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:217"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:214"><span class="id" title="variable">H</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">P<sub>1</sub></span>&amp;<span class="id" title="var">P<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_inv"><span class="id" title="lemma">hstar_inv</span></a> (<span class="id" title="definition">rm</span> <span class="id" title="var">K</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">E<sub>1</sub></span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hsingle_inv"><span class="id" title="lemma">hsingle_inv</span></a> <span class="id" title="var">P<sub>1</sub></span>. <span class="id" title="var">lets</span> <span class="id" title="var">I<sub>1</sub></span>: <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a> <span class="id" title="var">p</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_set"><span class="id" title="constructor">evaln_set</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_l"><span class="id" title="lemma">Fmap.indom_union_l</span></a>. <span class="id" title="tactic">subst</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_hpure_l"><span class="id" title="lemma">hstar_hpure_l</span></a>. <span class="id" title="tactic">split</span>*.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span> <span class="id" title="var">h<sub>1</sub></span>. <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.update_union_l"><span class="id" title="lemma">Fmap.update_union_l</span></a>. <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepFmap.html#update_single"><span class="id" title="lemma">update_single</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#SepSimplArgs.hsingle_intro"><span class="id" title="lemma">hsingle_intro</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#Fmap.disjoint_single_set"><span class="id" title="lemma">Fmap.disjoint_single_set</span></a> <span class="id" title="var">D</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">auto</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a>. } } }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplen_free" class="idref" href="#triplen_free"><span class="id" title="lemma">triplen_free</span></a> : <span class="id" title="keyword">∀</span> <a id="H:219" class="idref" href="#H:219"><span class="id" title="binder">H</span></a> <a id="p:220" class="idref" href="#p:220"><span class="id" title="binder">p</span></a> <a id="v:221" class="idref" href="#v:221"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#val_free"><span class="id" title="constructor">val_free</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:220"><span class="id" title="variable">p</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:220"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:221"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:219"><span class="id" title="variable">H</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="r:222" class="idref" href="#r:222"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:222"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:219"><span class="id" title="variable">H</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">P<sub>1</sub></span>&amp;<span class="id" title="var">P<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_inv"><span class="id" title="lemma">hstar_inv</span></a> (<span class="id" title="definition">rm</span> <span class="id" title="var">K</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">E<sub>1</sub></span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hsingle_inv"><span class="id" title="lemma">hsingle_inv</span></a> <span class="id" title="var">P<sub>1</sub></span>. <span class="id" title="var">lets</span> <span class="id" title="var">I<sub>1</sub></span>: <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a> <span class="id" title="var">p</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_free"><span class="id" title="constructor">evaln_free</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_l"><span class="id" title="lemma">Fmap.indom_union_l</span></a>. <span class="id" title="tactic">subst</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_hpure_l"><span class="id" title="lemma">hstar_hpure_l</span></a>. <span class="id" title="tactic">split</span>*.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span> <span class="id" title="var">h<sub>1</sub></span>. <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.remove_union_single_l"><span class="id" title="lemma">Fmap.remove_union_single_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">Dl</span>. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.disjoint_inv_not_indom_both"><span class="id" title="lemma">Fmap.disjoint_inv_not_indom_both</span></a> <span class="id" title="var">D</span> <span class="id" title="var">Dl</span>. } } }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab457"></a><h1 class="section">More Details</h1>

</div>

<div class="doc">
<a id="lab458"></a><h2 class="section">Weakest-Precondition Style Presentation.</h2>

<div class="paragraph"> </div>

 In chapter <a href="WPsem.html"><span class="inlineref">WPsem</span></a>, we discussed several possible definitions of the
    weakest-precondition operator, namely <span class="inlinecode"><span class="id" title="var">wp</span></span>, in Separation Logic. In this
    chapter, we present yet another possible definition, based on the judgment
    <span class="inlinecode"><span class="id" title="var">evaln</span></span>.

<div class="paragraph"> </div>

    Consider the judgment <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>. Assume the arguments were reordered,
    yielding the judgment <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span>. Consider now the partial application
    <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>. This partial application has type <span class="inlinecode"><span class="id" title="var">state</span>→<span class="id" title="keyword">Prop</span></span>, that is,
    <span class="inlinecode"><span class="id" title="var">hprop</span></span>. This predicate <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> denotes a predicate that characterizes
    the set of input states <span class="inlinecode"><span class="id" title="var">s</span></span> in which the evaluation (or, rather, any
    possible evaluation) of the term <span class="inlinecode"><span class="id" title="var">t</span></span> produces an output satisfying <span class="inlinecode"><span class="id" title="var">Q</span></span>.
    It thus corresponds exactly to the notion of weakest precondition for Hoare
    Logic.

<div class="paragraph"> </div>

    The judgment <span class="inlinecode"><span class="id" title="var">hoarewpns</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>, defined below, simply reorder the arguments
    of <span class="inlinecode"><span class="id" title="var">evaln</span></span> so as to produce this weakest-precondition operator. Note that
    this is a Hoare Logic style predicate, which talks about the full state. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="wpn" class="idref" href="#wpn"><span class="id" title="definition">wpn</span></a> (<a id="t:223" class="idref" href="#t:223"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) (<a id="Q:224" class="idref" href="#Q:224"><span class="id" title="binder">Q</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="s:225" class="idref" href="#s:225"><span class="id" title="binder">s</span></a> ⇒ <a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:225"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:223"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:224"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
We can check the standard equivalence <span class="inlinecode">(<span class="id" title="var">H</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">wp</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span>)</span> <span class="inlinecode">↔</span> <span class="inlinecode">(<span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span>)</span>,
    for the predicates <span class="inlinecode"><span class="id" title="var">wpn</span></span> and <span class="inlinecode"><span class="id" title="var">triplen</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="wpn_equiv" class="idref" href="#wpn_equiv"><span class="id" title="lemma">wpn_equiv</span></a> : <span class="id" title="keyword">∀</span> <a id="H:226" class="idref" href="#H:226"><span class="id" title="binder">H</span></a> <a id="t:227" class="idref" href="#t:227"><span class="id" title="binder">t</span></a> <a id="Q:228" class="idref" href="#Q:228"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#H:226"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> <a class="idref" href="Nondet.html#t:227"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:228"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> <a class="idref" href="Nondet.html#t:227"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#H:226"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:228"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">unfolds</span> <a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a>, <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a>. <span class="id" title="var">iff</span> <span class="id" title="var">M</span>; <span class="id" title="var">autos</span>*. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Remark: as mentioned in the chapter <a href="WPsem.html"><span class="inlineref">WPsem</span></a>, it is possible to define
    the predicate <span class="inlinecode"><span class="id" title="var">triplen</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> as <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">wpn</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>, that is, to define
    <span class="inlinecode"><span class="id" title="var">triplen</span></span> as a notion derived from <span class="inlinecode"><span class="id" title="var">wpn</span></span> and <span class="inlinecode"><span class="id" title="var">wpn</span></span>. 
</div>

<div class="doc">
<a id="lab459"></a><h2 class="section">WP-Style Rules for a Non-Deterministic Semantics.</h2>

<div class="paragraph"> </div>

 Given that the semantics expressed by the predicate <span class="inlinecode"><span class="id" title="var">evaln</span></span> has a weakest-
    precondition flavor, there are good chances that deriving weakest-
    precondition style reasoning rules from <span class="inlinecode"><span class="id" title="var">evaln</span></span> could be even easier than
    deriving the rules for <span class="inlinecode"><span class="id" title="var">triplen</span></span>. Thus, let us investigate whether this is
    indeed the case, by stating and proving reasoning rules for the judgment
    <span class="inlinecode"><span class="id" title="var">wpn</span></span>. 
<div class="paragraph"> </div>

 Structural rules 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="wpn_frame" class="idref" href="#wpn_frame"><span class="id" title="lemma">wpn_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="t:229" class="idref" href="#t:229"><span class="id" title="binder">t</span></a> <a id="H:230" class="idref" href="#H:230"><span class="id" title="binder">H</span></a> <a id="Q:231" class="idref" href="#Q:231"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> <a class="idref" href="Nondet.html#t:229"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:231"><span class="id" title="variable">Q</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:230"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> <a class="idref" href="Nondet.html#t:229"><span class="id" title="variable">t</span></a> (<a class="idref" href="Nondet.html#Q:231"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Nondet.html#H:230"><span class="id" title="variable">H</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">HF</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">M<sub>2</sub></span>&amp;<span class="id" title="var">MD</span>&amp;<span class="id" title="var">MU</span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_inv"><span class="id" title="lemma">hstar_inv</span></a> (<span class="id" title="definition">rm</span> <span class="id" title="var">HF</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_conseq"><span class="id" title="lemma">evaln_conseq</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_frame"><span class="id" title="lemma">evaln_frame</span></a> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="var">MD</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">xsimpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h'</span> →. <span class="id" title="var">applys</span> <span class="id" title="var">M<sub>2</sub></span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpn_conseq" class="idref" href="#wpn_conseq"><span class="id" title="lemma">wpn_conseq</span></a> : <span class="id" title="keyword">∀</span> <a id="t:232" class="idref" href="#t:232"><span class="id" title="binder">t</span></a> <a id="Q<sub>1</sub>:233" class="idref" href="#Q<sub>1</sub>:233"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:234" class="idref" href="#Q<sub>2</sub>:234"><span class="id" title="binder">Q<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q<sub>1</sub>:233"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Nondet.html#Q<sub>2</sub>:234"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> <a class="idref" href="Nondet.html#t:232"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q<sub>1</sub>:233"><span class="id" title="variable">Q<sub>1</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> <a class="idref" href="Nondet.html#t:232"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q<sub>2</sub>:234"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">W</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_conseq"><span class="id" title="lemma">evaln_conseq</span></a> <span class="id" title="var">K</span> <span class="id" title="var">W</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Derived structural rules 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="wpn_ramified" class="idref" href="#wpn_ramified"><span class="id" title="lemma">wpn_ramified</span></a> : <span class="id" title="keyword">∀</span> <a id="t:235" class="idref" href="#t:235"><span class="id" title="binder">t</span></a> <a id="Q<sub>1</sub>:236" class="idref" href="#Q<sub>1</sub>:236"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:237" class="idref" href="#Q<sub>2</sub>:237"><span class="id" title="binder">Q<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> <a class="idref" href="Nondet.html#t:235"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q<sub>1</sub>:236"><span class="id" title="variable">Q<sub>1</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#Q<sub>1</sub>:236"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#5609a52f091556b9923d5758aa61f543"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span></a> <a class="idref" href="Nondet.html#Q<sub>2</sub>:237"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> <a class="idref" href="Nondet.html#t:235"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q<sub>2</sub>:237"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_trans"><span class="id" title="lemma">himpl_trans</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#wpn_frame"><span class="id" title="lemma">wpn_frame</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#wpn_conseq"><span class="id" title="lemma">wpn_conseq</span></a>. <span class="id" title="var">xsimpl</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpn_conseq_frame" class="idref" href="#wpn_conseq_frame"><span class="id" title="lemma">wpn_conseq_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="t:238" class="idref" href="#t:238"><span class="id" title="binder">t</span></a> <a id="H:239" class="idref" href="#H:239"><span class="id" title="binder">H</span></a> <a id="Q<sub>1</sub>:240" class="idref" href="#Q<sub>1</sub>:240"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:241" class="idref" href="#Q<sub>2</sub>:241"><span class="id" title="binder">Q<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q<sub>1</sub>:240"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Nondet.html#H:239"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Nondet.html#Q<sub>2</sub>:241"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> <a class="idref" href="Nondet.html#t:238"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q<sub>1</sub>:240"><span class="id" title="variable">Q<sub>1</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:239"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> <a class="idref" href="Nondet.html#t:238"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q<sub>2</sub>:241"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="LibSepReference.html#SepSimplArgs.qwand_equiv"><span class="id" title="lemma">qwand_equiv</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">M</span>. <span class="id" title="var">xchange</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#wpn_ramified"><span class="id" title="lemma">wpn_ramified</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpn_ramified_trans" class="idref" href="#wpn_ramified_trans"><span class="id" title="lemma">wpn_ramified_trans</span></a> : <span class="id" title="keyword">∀</span> <a id="t:242" class="idref" href="#t:242"><span class="id" title="binder">t</span></a> <a id="H:243" class="idref" href="#H:243"><span class="id" title="binder">H</span></a> <a id="Q<sub>1</sub>:244" class="idref" href="#Q<sub>1</sub>:244"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:245" class="idref" href="#Q<sub>2</sub>:245"><span class="id" title="binder">Q<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#H:243"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> <a class="idref" href="Nondet.html#t:242"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q<sub>1</sub>:244"><span class="id" title="variable">Q<sub>1</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#Q<sub>1</sub>:244"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#5609a52f091556b9923d5758aa61f543"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span></a> <a class="idref" href="Nondet.html#Q<sub>2</sub>:245"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#H:243"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> <a class="idref" href="Nondet.html#t:242"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q<sub>2</sub>:245"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">xchange</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#wpn_ramified"><span class="id" title="lemma">wpn_ramified</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Rules for term constructs 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="wpn_val" class="idref" href="#wpn_val"><span class="id" title="lemma">wpn_val</span></a> : <span class="id" title="keyword">∀</span> <a id="v:246" class="idref" href="#v:246"><span class="id" title="binder">v</span></a> <a id="Q:247" class="idref" href="#Q:247"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q:247"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#v:246"><span class="id" title="variable">v</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> (<a class="idref" href="LibSepReference.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Nondet.html#v:246"><span class="id" title="variable">v</span></a>) <a class="idref" href="Nondet.html#Q:247"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_val"><span class="id" title="constructor">evaln_val</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpn_fix" class="idref" href="#wpn_fix"><span class="id" title="lemma">wpn_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="f:248" class="idref" href="#f:248"><span class="id" title="binder">f</span></a> <a id="x:249" class="idref" href="#x:249"><span class="id" title="binder">x</span></a> <a id="t:250" class="idref" href="#t:250"><span class="id" title="binder">t</span></a> <a id="Q:251" class="idref" href="#Q:251"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q:251"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:248"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:249"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t:250"><span class="id" title="variable">t</span></a>) <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> (<a class="idref" href="LibSepReference.html#trm_fix"><span class="id" title="constructor">trm_fix</span></a> <a class="idref" href="Nondet.html#f:248"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:249"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t:250"><span class="id" title="variable">t</span></a>) <a class="idref" href="Nondet.html#Q:251"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_fix"><span class="id" title="constructor">evaln_fix</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpn_app_fix" class="idref" href="#wpn_app_fix"><span class="id" title="lemma">wpn_app_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="f:252" class="idref" href="#f:252"><span class="id" title="binder">f</span></a> <a id="x:253" class="idref" href="#x:253"><span class="id" title="binder">x</span></a> <a id="v<sub>1</sub>:254" class="idref" href="#v<sub>1</sub>:254"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:255" class="idref" href="#v<sub>2</sub>:255"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="t<sub>1</sub>:256" class="idref" href="#t<sub>1</sub>:256"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="Q:257" class="idref" href="#Q:257"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#v<sub>1</sub>:254"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:252"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:253"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:256"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:253"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:255"><span class="id" title="variable">v<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#f:252"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:254"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:256"><span class="id" title="variable">t<sub>1</sub></span></a>)) <a class="idref" href="Nondet.html#Q:257"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:254"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:255"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:257"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_app_fix"><span class="id" title="constructor">evaln_app_fix</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpn_let" class="idref" href="#wpn_let"><span class="id" title="lemma">wpn_let</span></a> : <span class="id" title="keyword">∀</span> <a id="x:258" class="idref" href="#x:258"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:259" class="idref" href="#t<sub>1</sub>:259"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:260" class="idref" href="#t<sub>2</sub>:260"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="Q:261" class="idref" href="#Q:261"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:259"><span class="id" title="variable">t<sub>1</sub></span></a> (<span class="id" title="keyword">fun</span> <a id="v:262" class="idref" href="#v:262"><span class="id" title="binder">v</span></a> ⇒ <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:258"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v:262"><span class="id" title="variable">v</span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:260"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:261"><span class="id" title="variable">Q</span></a>)<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Nondet.html#x:258"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:259"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:260"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:261"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_let"><span class="id" title="constructor">evaln_let</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpn_if" class="idref" href="#wpn_if"><span class="id" title="lemma">wpn_if</span></a> : <span class="id" title="keyword">∀</span> <a id="b:263" class="idref" href="#b:263"><span class="id" title="binder">b</span></a> <a id="t<sub>1</sub>:264" class="idref" href="#t<sub>1</sub>:264"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:265" class="idref" href="#t<sub>2</sub>:265"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="Q:266" class="idref" href="#Q:266"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> (<span class="id" title="keyword">if</span> <a class="idref" href="Nondet.html#b:263"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Nondet.html#t<sub>1</sub>:264"><span class="id" title="variable">t<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Nondet.html#t<sub>2</sub>:265"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:266"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> (<a class="idref" href="LibSepReference.html#trm_if"><span class="id" title="constructor">trm_if</span></a> <a class="idref" href="Nondet.html#b:263"><span class="id" title="variable">b</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:264"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:265"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:266"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_if"><span class="id" title="constructor">evaln_if</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Rules for primitives. We state their specifications following the
    presentation described near the end of chapter <a href="Wand.html"><span class="inlineref">Wand</span></a>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="wpn_add" class="idref" href="#wpn_add"><span class="id" title="lemma">wpn_add</span></a> : <span class="id" title="keyword">∀</span> <a id="Q:267" class="idref" href="#Q:267"><span class="id" title="binder">Q</span></a> <a id="n<sub>1</sub>:268" class="idref" href="#n<sub>1</sub>:268"><span class="id" title="binder">n<sub>1</sub></span></a> <a id="n<sub>2</sub>:269" class="idref" href="#n<sub>2</sub>:269"><span class="id" title="binder">n<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#Q:267"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> (<a class="idref" href="Nondet.html#n<sub>1</sub>:268"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="Nondet.html#n<sub>2</sub>:269"><span class="id" title="variable">n<sub>2</sub></span></a>))<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> (<a class="idref" href="LibSepReference.html#val_add"><span class="id" title="constructor">val_add</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:268"><span class="id" title="variable">n<sub>1</sub></span></a>) (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>2</sub>:269"><span class="id" title="variable">n<sub>2</sub></span></a>)) <a class="idref" href="Nondet.html#Q:267"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unfolds</span> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_add"><span class="id" title="constructor">evaln_add</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpn_rand" class="idref" href="#wpn_rand"><span class="id" title="lemma">wpn_rand</span></a> : <span class="id" title="keyword">∀</span> <a id="Q:270" class="idref" href="#Q:270"><span class="id" title="binder">Q</span></a> <a id="n:271" class="idref" href="#n:271"><span class="id" title="binder">n</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#n:271"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;</span> 0 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">∀</span></a> <a id="n<sub>1</sub>:272" class="idref" href="#n<sub>1</sub>:272"><span class="id" title="binder">n<sub>1</sub></span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a>0 <span class="id" title="notation">≤</span> <a class="idref" href="Nondet.html#n<sub>1</sub>:272"><span class="id" title="variable">n<sub>1</sub></span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="Nondet.html#n:271"><span class="id" title="variable">n</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Nondet.html#Q:270"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:272"><span class="id" title="variable">n<sub>1</sub></span></a>)<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> (<a class="idref" href="LibSepReference.html#val_rand"><span class="id" title="constructor">val_rand</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n:271"><span class="id" title="variable">n</span></a>)) <a class="idref" href="Nondet.html#Q:270"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unfolds</span> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a>. <span class="id" title="var">introv</span> <span class="id" title="var">N</span>. <span class="id" title="var">xsimpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_rand"><span class="id" title="constructor">evaln_rand</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">n<sub>1</sub></span> <span class="id" title="var">H<sub>1</sub></span>. <span class="id" title="var">lets</span> <span class="id" title="var">K'</span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hforall_inv"><span class="id" title="lemma">hforall_inv</span></a> <span class="id" title="var">K</span> <span class="id" title="var">n<sub>1</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#SepSimplArgs.hwand_hpure_l"><span class="id" title="lemma">hwand_hpure_l</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">K'</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpn_ref" class="idref" href="#wpn_ref"><span class="id" title="lemma">wpn_ref</span></a> : <span class="id" title="keyword">∀</span> <a id="Q:273" class="idref" href="#Q:273"><span class="id" title="binder">Q</span></a> <a id="v:274" class="idref" href="#v:274"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">∀</span></a> <a id="p:275" class="idref" href="#p:275"><span class="id" title="binder">p</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:275"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:274"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Nondet.html#Q:273"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:275"><span class="id" title="variable">p</span></a>)<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Nondet.html#v:274"><span class="id" title="variable">v</span></a>) <a class="idref" href="Nondet.html#Q:273"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unfolds</span> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_ref"><span class="id" title="constructor">evaln_ref</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">D</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">K'</span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hforall_inv"><span class="id" title="lemma">hforall_inv</span></a> (<span class="id" title="definition">rm</span> <span class="id" title="var">K</span>) <span class="id" title="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hwand_inv"><span class="id" title="lemma">hwand_inv</span></a> (<a class="idref" href="LibSepFmap.html#single"><span class="id" title="definition">single</span></a> <span class="id" title="var">p</span> <span class="id" title="var">v</span>) <span class="id" title="var">K'</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hsingle_intro"><span class="id" title="lemma">hsingle_intro</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepFmap.html#disjoint_single_of_not_indom"><span class="id" title="lemma">disjoint_single_of_not_indom</span></a>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpn_get" class="idref" href="#wpn_get"><span class="id" title="lemma">wpn_get</span></a> : <span class="id" title="keyword">∀</span> <a id="v:276" class="idref" href="#v:276"><span class="id" title="binder">v</span></a> <a id="p:277" class="idref" href="#p:277"><span class="id" title="binder">p</span></a> <a id="Q:278" class="idref" href="#Q:278"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:277"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:276"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:277"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:276"><span class="id" title="variable">v</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Nondet.html#Q:278"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#v:276"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> (<a class="idref" href="LibSepReference.html#val_get"><span class="id" title="constructor">val_get</span></a> <a class="idref" href="Nondet.html#p:277"><span class="id" title="variable">p</span></a>) <a class="idref" href="Nondet.html#Q:278"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unfolds</span> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">P<sub>1</sub></span>&amp;<span class="id" title="var">P<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_inv"><span class="id" title="lemma">hstar_inv</span></a> (<span class="id" title="definition">rm</span> <span class="id" title="var">K</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">forwards</span>*: <a class="idref" href="LibSepReference.html#SepSimplArgs.hwand_inv"><span class="id" title="lemma">hwand_inv</span></a> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">P<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">E<sub>1</sub></span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hsingle_inv"><span class="id" title="lemma">hsingle_inv</span></a> <span class="id" title="var">P<sub>1</sub></span>. <span class="id" title="var">lets</span> <span class="id" title="var">I<sub>1</sub></span>: <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a> <span class="id" title="var">p</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_get"><span class="id" title="constructor">evaln_get</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_l"><span class="id" title="lemma">Fmap.indom_union_l</span></a>. <span class="id" title="tactic">subst</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span> <span class="id" title="var">h<sub>1</sub></span>. <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.read_union_l"><span class="id" title="lemma">Fmap.read_union_l</span></a>. <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.read_single"><span class="id" title="lemma">Fmap.read_single</span></a>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpn_set" class="idref" href="#wpn_set"><span class="id" title="lemma">wpn_set</span></a> : <span class="id" title="keyword">∀</span> <a id="v:279" class="idref" href="#v:279"><span class="id" title="binder">v</span></a> <a id="w:280" class="idref" href="#w:280"><span class="id" title="binder">w</span></a> <a id="p:281" class="idref" href="#p:281"><span class="id" title="binder">p</span></a> <a id="Q:282" class="idref" href="#Q:282"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:281"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:279"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:281"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#w:280"><span class="id" title="variable">w</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Nondet.html#Q:282"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> (<a class="idref" href="LibSepReference.html#val_set"><span class="id" title="constructor">val_set</span></a> <a class="idref" href="Nondet.html#p:281"><span class="id" title="variable">p</span></a> <a class="idref" href="Nondet.html#w:280"><span class="id" title="variable">w</span></a>) <a class="idref" href="Nondet.html#Q:282"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unfolds</span> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">P<sub>1</sub></span>&amp;<span class="id" title="var">P<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_inv"><span class="id" title="lemma">hstar_inv</span></a> (<span class="id" title="definition">rm</span> <span class="id" title="var">K</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">E<sub>1</sub></span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hsingle_inv"><span class="id" title="lemma">hsingle_inv</span></a> <span class="id" title="var">P<sub>1</sub></span>. <span class="id" title="var">lets</span> <span class="id" title="var">I<sub>1</sub></span>: <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a> <span class="id" title="var">p</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">forwards</span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hwand_inv"><span class="id" title="lemma">hwand_inv</span></a> (<a class="idref" href="LibSepFmap.html#single"><span class="id" title="definition">single</span></a> <span class="id" title="var">p</span> <span class="id" title="var">w</span>) <span class="id" title="var">P<sub>2</sub></span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hsingle_intro"><span class="id" title="lemma">hsingle_intro</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span> <span class="id" title="var">h<sub>1</sub></span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#Fmap.disjoint_single_set"><span class="id" title="lemma">Fmap.disjoint_single_set</span></a> <span class="id" title="var">D</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_set"><span class="id" title="constructor">evaln_set</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_l"><span class="id" title="lemma">Fmap.indom_union_l</span></a>. <span class="id" title="tactic">subst</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span> <span class="id" title="var">h<sub>1</sub></span>. <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.update_union_l"><span class="id" title="lemma">Fmap.update_union_l</span></a>. <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepFmap.html#update_single"><span class="id" title="lemma">update_single</span></a>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpn_free" class="idref" href="#wpn_free"><span class="id" title="lemma">wpn_free</span></a> : <span class="id" title="keyword">∀</span> <a id="v:283" class="idref" href="#v:283"><span class="id" title="binder">v</span></a> <a id="p:284" class="idref" href="#p:284"><span class="id" title="binder">p</span></a> <a id="Q:285" class="idref" href="#Q:285"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:284"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:283"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#Q:285"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> (<a class="idref" href="LibSepReference.html#val_free"><span class="id" title="constructor">val_free</span></a> <a class="idref" href="Nondet.html#p:284"><span class="id" title="variable">p</span></a>) <a class="idref" href="Nondet.html#Q:285"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unfolds</span> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">P<sub>1</sub></span>&amp;<span class="id" title="var">P<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_inv"><span class="id" title="lemma">hstar_inv</span></a> (<span class="id" title="definition">rm</span> <span class="id" title="var">K</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">E<sub>1</sub></span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hsingle_inv"><span class="id" title="lemma">hsingle_inv</span></a> <span class="id" title="var">P<sub>1</sub></span>. <span class="id" title="var">lets</span> <span class="id" title="var">I<sub>1</sub></span>: <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a> <span class="id" title="var">p</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys_eq</span> <a class="idref" href="Nondet.html#evaln_free"><span class="id" title="constructor">evaln_free</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_l"><span class="id" title="lemma">Fmap.indom_union_l</span></a>. <span class="id" title="tactic">subst</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span> <span class="id" title="var">h<sub>1</sub></span>. <span class="id" title="tactic">rewrite</span>¬<a class="idref" href="LibSepReference.html#Fmap.remove_union_single_l"><span class="id" title="lemma">Fmap.remove_union_single_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Dl</span>. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.disjoint_inv_not_indom_both"><span class="id" title="lemma">Fmap.disjoint_inv_not_indom_both</span></a> <span class="id" title="var">D</span> <span class="id" title="var">Dl</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Rules for primitives, alternative presentation using triples. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triplen_add'" class="idref" href="#triplen_add'"><span class="id" title="lemma">triplen_add'</span></a> : <span class="id" title="keyword">∀</span> <a id="n<sub>1</sub>:286" class="idref" href="#n<sub>1</sub>:286"><span class="id" title="binder">n<sub>1</sub></span></a> <a id="n<sub>2</sub>:287" class="idref" href="#n<sub>2</sub>:287"><span class="id" title="binder">n<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#val_add"><span class="id" title="constructor">val_add</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:286"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="Nondet.html#n<sub>2</sub>:287"><span class="id" title="variable">n<sub>2</sub></span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#0a700e54c124035039013e87e1a2bcaa"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="r:288" class="idref" href="#r:288"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:288"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> (<a class="idref" href="Nondet.html#n<sub>1</sub>:286"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="Nondet.html#n<sub>2</sub>:287"><span class="id" title="variable">n<sub>2</sub></span></a>)<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Nondet.html#wpn_equiv"><span class="id" title="lemma">wpn_equiv</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_trans"><span class="id" title="lemma">himpl_trans</span></a>; [| <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#wpn_add"><span class="id" title="lemma">wpn_add</span></a> ]. <span class="id" title="var">xsimpl</span>*.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplen_rand'" class="idref" href="#triplen_rand'"><span class="id" title="lemma">triplen_rand'</span></a> : <span class="id" title="keyword">∀</span> <a id="n:289" class="idref" href="#n:289"><span class="id" title="binder">n</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#n:289"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;</span> 0 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#val_rand"><span class="id" title="constructor">val_rand</span></a> <a class="idref" href="Nondet.html#n:289"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#0a700e54c124035039013e87e1a2bcaa"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="r:290" class="idref" href="#r:290"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="n<sub>1</sub>:291" class="idref" href="#n<sub>1</sub>:291"><span class="id" title="binder">n<sub>1</sub></span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a>0 <span class="id" title="notation">≤</span> <a class="idref" href="Nondet.html#n<sub>1</sub>:291"><span class="id" title="variable">n<sub>1</sub></span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="Nondet.html#n:289"><span class="id" title="variable">n</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:290"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:291"><span class="id" title="variable">n<sub>1</sub></span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">N</span>. <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Nondet.html#wpn_equiv"><span class="id" title="lemma">wpn_equiv</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_trans"><span class="id" title="lemma">himpl_trans</span></a>; [| <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#wpn_rand"><span class="id" title="lemma">wpn_rand</span></a> ]. <span class="id" title="var">xsimpl</span>*.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplen_ref'" class="idref" href="#triplen_ref'"><span class="id" title="lemma">triplen_ref'</span></a> : <span class="id" title="keyword">∀</span> <a id="v:292" class="idref" href="#v:292"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Nondet.html#v:292"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#0a700e54c124035039013e87e1a2bcaa"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="r:293" class="idref" href="#r:293"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="p:294" class="idref" href="#p:294"><span class="id" title="binder">p</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:293"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:294"><span class="id" title="variable">p</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#p:294"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:292"><span class="id" title="variable">v</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Nondet.html#wpn_equiv"><span class="id" title="lemma">wpn_equiv</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_trans"><span class="id" title="lemma">himpl_trans</span></a>; [| <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#wpn_ref"><span class="id" title="lemma">wpn_ref</span></a> ]. <span class="id" title="var">xsimpl</span>*.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplen_get'" class="idref" href="#triplen_get'"><span class="id" title="lemma">triplen_get'</span></a> : <span class="id" title="keyword">∀</span> <a id="v:295" class="idref" href="#v:295"><span class="id" title="binder">v</span></a> <a id="p:296" class="idref" href="#p:296"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#val_get"><span class="id" title="constructor">val_get</span></a> <a class="idref" href="Nondet.html#p:296"><span class="id" title="variable">p</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Nondet.html#p:296"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:295"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="r:297" class="idref" href="#r:297"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:297"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Nondet.html#v:295"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:296"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:295"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Nondet.html#wpn_equiv"><span class="id" title="lemma">wpn_equiv</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_trans"><span class="id" title="lemma">himpl_trans</span></a>; [| <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#wpn_get"><span class="id" title="lemma">wpn_get</span></a> ]. <span class="id" title="var">xsimpl</span>*.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplen_set'" class="idref" href="#triplen_set'"><span class="id" title="lemma">triplen_set'</span></a> : <span class="id" title="keyword">∀</span> <a id="w:298" class="idref" href="#w:298"><span class="id" title="binder">w</span></a> <a id="p:299" class="idref" href="#p:299"><span class="id" title="binder">p</span></a> <a id="v:300" class="idref" href="#v:300"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#val_set"><span class="id" title="constructor">val_set</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:299"><span class="id" title="variable">p</span></a>) <a class="idref" href="Nondet.html#v:300"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Nondet.html#p:299"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#w:298"><span class="id" title="variable">w</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <a class="idref" href="Nondet.html#p:299"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:300"><span class="id" title="variable">v</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Nondet.html#wpn_equiv"><span class="id" title="lemma">wpn_equiv</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_trans"><span class="id" title="lemma">himpl_trans</span></a>; [| <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#wpn_set"><span class="id" title="lemma">wpn_set</span></a> ]. <span class="id" title="var">xsimpl</span>*.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplen_free'" class="idref" href="#triplen_free'"><span class="id" title="lemma">triplen_free'</span></a> : <span class="id" title="keyword">∀</span> <a id="p:301" class="idref" href="#p:301"><span class="id" title="binder">p</span></a> <a id="v:302" class="idref" href="#v:302"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplen"><span class="id" title="definition">triplen</span></a> (<a class="idref" href="LibSepReference.html#val_free"><span class="id" title="constructor">val_free</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:301"><span class="id" title="variable">p</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Nondet.html#p:301"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:302"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <a class="idref" href="LibSepReference.html#0a700e54c124035039013e87e1a2bcaa"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Nondet.html#wpn_equiv"><span class="id" title="lemma">wpn_equiv</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_trans"><span class="id" title="lemma">himpl_trans</span></a>; [| <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#wpn_free"><span class="id" title="lemma">wpn_free</span></a> ]. <span class="id" title="var">xsimpl</span>*.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab460"></a><h4 class="section">Exercise: 4 stars, standard, optional (wpn_rand_of_triplen_rand)</h4>
 The proof of lemma <span class="inlinecode"><span class="id" title="var">triplen_rand</span></span> shows that a triple-based specification
    of <span class="inlinecode"><span class="id" title="var">val_rand</span></span> is derivable from a wp-style specification. In this
    exercise, we aim to prove the reciprocal. Concretely, prove the following
    specification by exploiting <span class="inlinecode"><span class="id" title="var">triplen_rand</span></span>.
    Hint: make use of <span class="inlinecode"><span class="id" title="var">wpn_equiv</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="wpn_rand_of_triplen_rand" class="idref" href="#wpn_rand_of_triplen_rand"><span class="id" title="lemma">wpn_rand_of_triplen_rand</span></a> : <span class="id" title="keyword">∀</span> <a id="n:303" class="idref" href="#n:303"><span class="id" title="binder">n</span></a> <a id="Q:304" class="idref" href="#Q:304"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#n:303"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;</span> 0 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">∀</span></a> <a id="n<sub>1</sub>:305" class="idref" href="#n<sub>1</sub>:305"><span class="id" title="binder">n<sub>1</sub></span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a>0 <span class="id" title="notation">≤</span> <a class="idref" href="Nondet.html#n<sub>1</sub>:305"><span class="id" title="variable">n<sub>1</sub></span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="Nondet.html#n:303"><span class="id" title="variable">n</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Nondet.html#Q:304"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:305"><span class="id" title="variable">n<sub>1</sub></span></a>)<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a> (<a class="idref" href="LibSepReference.html#val_rand"><span class="id" title="constructor">val_rand</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n:303"><span class="id" title="variable">n</span></a>)) <a class="idref" href="Nondet.html#Q:304"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>


<div class="doc">
<a id="lab461"></a><h1 class="section">Optional Material</h1>

<div class="paragraph"> </div>

 So far, this chapter has focused on handling non-determinism in the context
    of using a big-step semantics. In this bonus section, we investigate the
    treatment of non-determinism using a small-step semantics. Moreover, we
    establish equivalence proofs relating (non-deterministic) small-step and
    big-step semantics. 
</div>

<div class="doc">
<a id="lab462"></a><h2 class="section">Interpretation of <span class="inlinecode"><span class="id" title="var">evaln</span></span> w.r.t. <span class="inlinecode"><span class="id" title="tactic">eval</span></span> and <span class="inlinecode"><span class="id" title="var">terminates</span></span></h2>

<div class="paragraph"> </div>

 The predicate <span class="inlinecode"><span class="id" title="var">terminates</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> asserts that all executions of the
    configuration <span class="inlinecode"><span class="id" title="var">t</span>/<span class="id" title="var">s</span></span> terminate---none of them diverges or get
    stuck. Its definition is a simplified version of <span class="inlinecode"><span class="id" title="var">evaln</span></span> where all
    occurences of <span class="inlinecode"><span class="id" title="var">Q</span></span> are removed. In the rule for let-bindings,
    namely <span class="inlinecode"><span class="id" title="var">terminates_let</span></span>, the quantification over the configuration
    <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span>/<span class="id" title="var">s<sub>2</sub></span></span> is done by refering to the big-step judgment <span class="inlinecode"><span class="id" title="tactic">eval</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="terminates" class="idref" href="#terminates"><span class="id" title="inductive">terminates</span></a> : <a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="terminates_val" class="idref" href="#terminates_val"><span class="id" title="constructor">terminates_val</span></a> : <span class="id" title="keyword">∀</span> <a id="s:308" class="idref" href="#s:308"><span class="id" title="binder">s</span></a> <a id="v:309" class="idref" href="#v:309"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#terminates:306"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s:308"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Nondet.html#v:309"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;| <a id="terminates_fix" class="idref" href="#terminates_fix"><span class="id" title="constructor">terminates_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s:310" class="idref" href="#s:310"><span class="id" title="binder">s</span></a> <a id="f:311" class="idref" href="#f:311"><span class="id" title="binder">f</span></a> <a id="x:312" class="idref" href="#x:312"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:313" class="idref" href="#t<sub>1</sub>:313"><span class="id" title="binder">t<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#terminates:306"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s:310"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_fix"><span class="id" title="constructor">trm_fix</span></a> <a class="idref" href="Nondet.html#f:311"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:312"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:313"><span class="id" title="variable">t<sub>1</sub></span></a>)<br/>
&nbsp;&nbsp;| <a id="terminates_app_fix" class="idref" href="#terminates_app_fix"><span class="id" title="constructor">terminates_app_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s:314" class="idref" href="#s:314"><span class="id" title="binder">s</span></a> <a id="v<sub>1</sub>:315" class="idref" href="#v<sub>1</sub>:315"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:316" class="idref" href="#v<sub>2</sub>:316"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="f:317" class="idref" href="#f:317"><span class="id" title="binder">f</span></a> <a id="x:318" class="idref" href="#x:318"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:319" class="idref" href="#t<sub>1</sub>:319"><span class="id" title="binder">t<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#v<sub>1</sub>:315"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:317"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:318"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:319"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#terminates:306"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s:314"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:318"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:316"><span class="id" title="variable">v<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#f:317"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:315"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:319"><span class="id" title="variable">t<sub>1</sub></span></a>)) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#terminates:306"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s:314"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:315"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:316"><span class="id" title="variable">v<sub>2</sub></span></a>)<br/>
&nbsp;&nbsp;| <a id="terminates_let" class="idref" href="#terminates_let"><span class="id" title="constructor">terminates_let</span></a> : <span class="id" title="keyword">∀</span> <a id="s:320" class="idref" href="#s:320"><span class="id" title="binder">s</span></a> <a id="x:321" class="idref" href="#x:321"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:322" class="idref" href="#t<sub>1</sub>:322"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:323" class="idref" href="#t<sub>2</sub>:323"><span class="id" title="binder">t<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#terminates:306"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s:320"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:322"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="v<sub>1</sub>:324" class="idref" href="#v<sub>1</sub>:324"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="s<sub>2</sub>:325" class="idref" href="#s<sub>2</sub>:325"><span class="id" title="binder">s<sub>2</sub></span></a>, <a class="idref" href="Nondet.html#eval"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s:320"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:322"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:325"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:324"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Nondet.html#terminates:306"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:325"><span class="id" title="variable">s<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:321"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:324"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:323"><span class="id" title="variable">t<sub>2</sub></span></a>)<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#terminates:306"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s:320"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Nondet.html#x:321"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:322"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:323"><span class="id" title="variable">t<sub>2</sub></span></a>)<br/>
&nbsp;&nbsp;| <a id="terminates_if" class="idref" href="#terminates_if"><span class="id" title="constructor">terminates_if</span></a> : <span class="id" title="keyword">∀</span> <a id="s:326" class="idref" href="#s:326"><span class="id" title="binder">s</span></a> <a id="b:327" class="idref" href="#b:327"><span class="id" title="binder">b</span></a> <a id="t<sub>1</sub>:328" class="idref" href="#t<sub>1</sub>:328"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:329" class="idref" href="#t<sub>2</sub>:329"><span class="id" title="binder">t<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#terminates:306"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s:326"><span class="id" title="variable">s</span></a> (<span class="id" title="keyword">if</span> <a class="idref" href="Nondet.html#b:327"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Nondet.html#t<sub>1</sub>:328"><span class="id" title="variable">t<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Nondet.html#t<sub>2</sub>:329"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#terminates:306"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s:326"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_if"><span class="id" title="constructor">trm_if</span></a> (<a class="idref" href="LibSepReference.html#val_bool"><span class="id" title="constructor">val_bool</span></a> <a class="idref" href="Nondet.html#b:327"><span class="id" title="variable">b</span></a>) <a class="idref" href="Nondet.html#t<sub>1</sub>:328"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:329"><span class="id" title="variable">t<sub>2</sub></span></a>)<br/>
&nbsp;&nbsp;| <a id="terminates_add" class="idref" href="#terminates_add"><span class="id" title="constructor">terminates_add</span></a> : <span class="id" title="keyword">∀</span> <a id="s:330" class="idref" href="#s:330"><span class="id" title="binder">s</span></a> <a id="n<sub>1</sub>:331" class="idref" href="#n<sub>1</sub>:331"><span class="id" title="binder">n<sub>1</sub></span></a> <a id="n<sub>2</sub>:332" class="idref" href="#n<sub>2</sub>:332"><span class="id" title="binder">n<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#terminates:306"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s:330"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_add"><span class="id" title="constructor">val_add</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:331"><span class="id" title="variable">n<sub>1</sub></span></a>) (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>2</sub>:332"><span class="id" title="variable">n<sub>2</sub></span></a>))<br/>
&nbsp;&nbsp;| <a id="terminates_rand" class="idref" href="#terminates_rand"><span class="id" title="constructor">terminates_rand</span></a> : <span class="id" title="keyword">∀</span> <a id="s:333" class="idref" href="#s:333"><span class="id" title="binder">s</span></a> <a id="n:334" class="idref" href="#n:334"><span class="id" title="binder">n</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#n:334"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;</span> 0 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#terminates:306"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s:333"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_rand"><span class="id" title="constructor">val_rand</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n:334"><span class="id" title="variable">n</span></a>))<br/>
&nbsp;&nbsp;| <a id="terminates_ref" class="idref" href="#terminates_ref"><span class="id" title="constructor">terminates_ref</span></a> : <span class="id" title="keyword">∀</span> <a id="s:335" class="idref" href="#s:335"><span class="id" title="binder">s</span></a> <a id="v:336" class="idref" href="#v:336"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#terminates:306"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s:335"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Nondet.html#v:336"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;| <a id="terminates_get" class="idref" href="#terminates_get"><span class="id" title="constructor">terminates_get</span></a> : <span class="id" title="keyword">∀</span> <a id="s:337" class="idref" href="#s:337"><span class="id" title="binder">s</span></a> <a id="p:338" class="idref" href="#p:338"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Nondet.html#s:337"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:338"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#terminates:306"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s:337"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_get"><span class="id" title="constructor">val_get</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:338"><span class="id" title="variable">p</span></a>))<br/>
&nbsp;&nbsp;| <a id="terminates_set" class="idref" href="#terminates_set"><span class="id" title="constructor">terminates_set</span></a> : <span class="id" title="keyword">∀</span> <a id="s:339" class="idref" href="#s:339"><span class="id" title="binder">s</span></a> <a id="p:340" class="idref" href="#p:340"><span class="id" title="binder">p</span></a> <a id="v:341" class="idref" href="#v:341"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Nondet.html#s:339"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:340"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#terminates:306"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s:339"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_set"><span class="id" title="constructor">val_set</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:340"><span class="id" title="variable">p</span></a>) <a class="idref" href="Nondet.html#v:341"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;| <a id="terminates_free" class="idref" href="#terminates_free"><span class="id" title="constructor">terminates_free</span></a> : <span class="id" title="keyword">∀</span> <a id="s:342" class="idref" href="#s:342"><span class="id" title="binder">s</span></a> <a id="p:343" class="idref" href="#p:343"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Nondet.html#s:342"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:343"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#terminates:306"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s:342"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_free"><span class="id" title="constructor">val_free</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:343"><span class="id" title="variable">p</span></a>)).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Section</span> <a id="EvalnTerminates" class="idref" href="#EvalnTerminates"><span class="id" title="section">EvalnTerminates</span></a>.<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="Nondet.html#eval"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a>.<br/>
</div>

<div class="doc">
<a id="lab463"></a><h4 class="section">Exercise: 5 stars, standard, especially useful (evaln_iff_terminates_and_post)</h4>
 Prove that <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> is equivalent to the conjunction of
    <span class="inlinecode"><span class="id" title="var">terminates</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> and to a partial correctness result asserting that
    if an evaluation of <span class="inlinecode"><span class="id" title="var">t</span>/<span class="id" title="var">s</span></span> terminates on some result then this result
    satisfies <span class="inlinecode"><span class="id" title="var">Q</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evaln_iff_terminates_and_post" class="idref" href="#evaln_iff_terminates_and_post"><span class="id" title="lemma">evaln_iff_terminates_and_post</span></a> : <span class="id" title="keyword">∀</span> <a id="s:344" class="idref" href="#s:344"><span class="id" title="binder">s</span></a> <a id="t:345" class="idref" href="#t:345"><span class="id" title="binder">t</span></a> <a id="Q:346" class="idref" href="#Q:346"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:344"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:345"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:346"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#terminates"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s:344"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:345"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="v:347" class="idref" href="#v:347"><span class="id" title="binder">v</span></a> <a id="s':348" class="idref" href="#s':348"><span class="id" title="binder">s'</span></a>, <a class="idref" href="Nondet.html#eval"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Nondet.html#s:344"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:345"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#s':348"><span class="id" title="variable">s'</span></a> <a class="idref" href="Nondet.html#v:347"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Nondet.html#Q:346"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#v:347"><span class="id" title="variable">v</span></a> <a class="idref" href="Nondet.html#s':348"><span class="id" title="variable">s'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 Let <span class="inlinecode"><span class="id" title="var">Any</span></span> denotes the postcondition that accepts any result. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="Any" class="idref" href="#Any"><span class="id" title="definition">Any</span></a> : <a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="v:349" class="idref" href="#v:349"><span class="id" title="binder">v</span></a> <a id="s:350" class="idref" href="#s:350"><span class="id" title="binder">s</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Hint Unfold</span> <a class="idref" href="Nondet.html#Any"><span class="id" title="definition">Any</span></a>.<br/>
</div>

<div class="doc">
<a id="lab464"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (terminates_iff_evaln_any)</h4>
 Prove that <span class="inlinecode"><span class="id" title="var">terminates</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> is equivalent to <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Any</span></span>.
    Hint: exploit <span class="inlinecode"><span class="id" title="var">evaln_iff_terminates_and_post</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="terminates_iff_evaln_any" class="idref" href="#terminates_iff_evaln_any"><span class="id" title="lemma">terminates_iff_evaln_any</span></a> : <span class="id" title="keyword">∀</span> <a id="s:351" class="idref" href="#s:351"><span class="id" title="binder">s</span></a> <a id="t:352" class="idref" href="#t:352"><span class="id" title="binder">t</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#terminates"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Nondet.html#s:351"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:352"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:351"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:352"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Any"><span class="id" title="definition">Any</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="code">

<span class="id" title="keyword">End</span> <a class="idref" href="Nondet.html#EvalnTerminates"><span class="id" title="section">EvalnTerminates</span></a>.<br/>
</div>

<div class="doc">
<a id="lab465"></a><h2 class="section">Small-Step Evaluation Relation</h2>

<div class="paragraph"> </div>

 The judgment <span class="inlinecode"><span class="id" title="var">step</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode"><span class="id" title="var">t'</span></span> describes the small-step reduction relation:
    it asserts that the program configuration <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> can take one reduction
    step towards the program configuration <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">t'</span>)</span>. Its definition, shown
    below, is standard. 
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="step" class="idref" href="#step"><span class="id" title="inductive">step</span></a> : <a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Unique&nbsp;context&nbsp;rule&nbsp;*)</span><br/>
&nbsp;&nbsp;| <a id="step_let_ctx" class="idref" href="#step_let_ctx"><span class="id" title="constructor">step_let_ctx</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:355" class="idref" href="#s<sub>1</sub>:355"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:356" class="idref" href="#s<sub>2</sub>:356"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="x:357" class="idref" href="#x:357"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:358" class="idref" href="#t<sub>1</sub>:358"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>1</sub>':359" class="idref" href="#t<sub>1</sub>':359"><span class="id" title="binder">t<sub>1</sub>'</span></a> <a id="t<sub>2</sub>:360" class="idref" href="#t<sub>2</sub>:360"><span class="id" title="binder">t<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#step:353"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:355"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:358"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:356"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>':359"><span class="id" title="variable">t<sub>1</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#step:353"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:355"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Nondet.html#x:357"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:358"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:360"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#s<sub>2</sub>:356"><span class="id" title="variable">s<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Nondet.html#x:357"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>':359"><span class="id" title="variable">t<sub>1</sub>'</span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:360"><span class="id" title="variable">t<sub>2</sub></span></a>)<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Beta&nbsp;reductions&nbsp;*)</span><br/>
&nbsp;&nbsp;| <a id="step_fix" class="idref" href="#step_fix"><span class="id" title="constructor">step_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s:361" class="idref" href="#s:361"><span class="id" title="binder">s</span></a> <a id="f:362" class="idref" href="#f:362"><span class="id" title="binder">f</span></a> <a id="x:363" class="idref" href="#x:363"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:364" class="idref" href="#t<sub>1</sub>:364"><span class="id" title="binder">t<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#step:353"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s:361"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_fix"><span class="id" title="constructor">trm_fix</span></a> <a class="idref" href="Nondet.html#f:362"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:363"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:364"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Nondet.html#s:361"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:362"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:363"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:364"><span class="id" title="variable">t<sub>1</sub></span></a>)<br/>
&nbsp;&nbsp;| <a id="step_app_fix" class="idref" href="#step_app_fix"><span class="id" title="constructor">step_app_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s:365" class="idref" href="#s:365"><span class="id" title="binder">s</span></a> <a id="v<sub>1</sub>:366" class="idref" href="#v<sub>1</sub>:366"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:367" class="idref" href="#v<sub>2</sub>:367"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="f:368" class="idref" href="#f:368"><span class="id" title="binder">f</span></a> <a id="x:369" class="idref" href="#x:369"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:370" class="idref" href="#t<sub>1</sub>:370"><span class="id" title="binder">t<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#v<sub>1</sub>:366"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:368"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:369"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:370"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#step:353"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s:365"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:366"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:367"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#s:365"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:369"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:367"><span class="id" title="variable">v<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#f:368"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:366"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:370"><span class="id" title="variable">t<sub>1</sub></span></a>))<br/>
&nbsp;&nbsp;| <a id="step_if" class="idref" href="#step_if"><span class="id" title="constructor">step_if</span></a> : <span class="id" title="keyword">∀</span> <a id="s:371" class="idref" href="#s:371"><span class="id" title="binder">s</span></a> <a id="b:372" class="idref" href="#b:372"><span class="id" title="binder">b</span></a> <a id="t<sub>1</sub>:373" class="idref" href="#t<sub>1</sub>:373"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:374" class="idref" href="#t<sub>2</sub>:374"><span class="id" title="binder">t<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#step:353"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s:371"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_if"><span class="id" title="constructor">trm_if</span></a> (<a class="idref" href="LibSepReference.html#val_bool"><span class="id" title="constructor">val_bool</span></a> <a class="idref" href="Nondet.html#b:372"><span class="id" title="variable">b</span></a>) <a class="idref" href="Nondet.html#t<sub>1</sub>:373"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:374"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#s:371"><span class="id" title="variable">s</span></a> (<span class="id" title="keyword">if</span> <a class="idref" href="Nondet.html#b:372"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Nondet.html#t<sub>1</sub>:373"><span class="id" title="variable">t<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Nondet.html#t<sub>2</sub>:374"><span class="id" title="variable">t<sub>2</sub></span></a>)<br/>
&nbsp;&nbsp;| <a id="step_let" class="idref" href="#step_let"><span class="id" title="constructor">step_let</span></a> : <span class="id" title="keyword">∀</span> <a id="s:375" class="idref" href="#s:375"><span class="id" title="binder">s</span></a> <a id="x:376" class="idref" href="#x:376"><span class="id" title="binder">x</span></a> <a id="t<sub>2</sub>:377" class="idref" href="#t<sub>2</sub>:377"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="v<sub>1</sub>:378" class="idref" href="#v<sub>1</sub>:378"><span class="id" title="binder">v<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#step:353"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s:375"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Nondet.html#x:376"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:378"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:377"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#s:375"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:376"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:378"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:377"><span class="id" title="variable">t<sub>2</sub></span></a>)<br/>
<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Primitive&nbsp;operations&nbsp;*)</span><br/>
&nbsp;&nbsp;| <a id="step_add" class="idref" href="#step_add"><span class="id" title="constructor">step_add</span></a> : <span class="id" title="keyword">∀</span> <a id="s:379" class="idref" href="#s:379"><span class="id" title="binder">s</span></a> <a id="n<sub>1</sub>:380" class="idref" href="#n<sub>1</sub>:380"><span class="id" title="binder">n<sub>1</sub></span></a> <a id="n<sub>2</sub>:381" class="idref" href="#n<sub>2</sub>:381"><span class="id" title="binder">n<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#step:353"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s:379"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_add"><span class="id" title="constructor">val_add</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:380"><span class="id" title="variable">n<sub>1</sub></span></a>) (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>2</sub>:381"><span class="id" title="variable">n<sub>2</sub></span></a>)) <a class="idref" href="Nondet.html#s:379"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> (<a class="idref" href="Nondet.html#n<sub>1</sub>:380"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="Nondet.html#n<sub>2</sub>:381"><span class="id" title="variable">n<sub>2</sub></span></a>))<br/>
&nbsp;&nbsp;| <a id="step_rand" class="idref" href="#step_rand"><span class="id" title="constructor">step_rand</span></a> : <span class="id" title="keyword">∀</span> <a id="s:382" class="idref" href="#s:382"><span class="id" title="binder">s</span></a> <a id="n:383" class="idref" href="#n:383"><span class="id" title="binder">n</span></a> <a id="n<sub>1</sub>:384" class="idref" href="#n<sub>1</sub>:384"><span class="id" title="binder">n<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 <span class="id" title="notation">≤</span> <a class="idref" href="Nondet.html#n<sub>1</sub>:384"><span class="id" title="variable">n<sub>1</sub></span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="Nondet.html#n:383"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#step:353"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s:382"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_rand"><span class="id" title="constructor">val_rand</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n:383"><span class="id" title="variable">n</span></a>)) <a class="idref" href="Nondet.html#s:382"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:384"><span class="id" title="variable">n<sub>1</sub></span></a>)<br/>
&nbsp;&nbsp;| <a id="step_ref" class="idref" href="#step_ref"><span class="id" title="constructor">step_ref</span></a> : <span class="id" title="keyword">∀</span> <a id="s:385" class="idref" href="#s:385"><span class="id" title="binder">s</span></a> <a id="v:386" class="idref" href="#v:386"><span class="id" title="binder">v</span></a> <a id="p:387" class="idref" href="#p:387"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Nondet.html#s:385"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:387"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#step:353"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s:385"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Nondet.html#v:386"><span class="id" title="variable">v</span></a>) (<a class="idref" href="LibSepReference.html#Fmap.update"><span class="id" title="definition">Fmap.update</span></a> <a class="idref" href="Nondet.html#s:385"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:387"><span class="id" title="variable">p</span></a> <a class="idref" href="Nondet.html#v:386"><span class="id" title="variable">v</span></a>) (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:387"><span class="id" title="variable">p</span></a>)<br/>
&nbsp;&nbsp;| <a id="step_get" class="idref" href="#step_get"><span class="id" title="constructor">step_get</span></a> : <span class="id" title="keyword">∀</span> <a id="s:388" class="idref" href="#s:388"><span class="id" title="binder">s</span></a> <a id="p:389" class="idref" href="#p:389"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Nondet.html#s:388"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:389"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#step:353"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s:388"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_get"><span class="id" title="constructor">val_get</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:389"><span class="id" title="variable">p</span></a>)) <a class="idref" href="Nondet.html#s:388"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#Fmap.read"><span class="id" title="definition">Fmap.read</span></a> <a class="idref" href="Nondet.html#s:388"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:389"><span class="id" title="variable">p</span></a>)<br/>
&nbsp;&nbsp;| <a id="step_set" class="idref" href="#step_set"><span class="id" title="constructor">step_set</span></a> : <span class="id" title="keyword">∀</span> <a id="s:390" class="idref" href="#s:390"><span class="id" title="binder">s</span></a> <a id="p:391" class="idref" href="#p:391"><span class="id" title="binder">p</span></a> <a id="v:392" class="idref" href="#v:392"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Nondet.html#s:390"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:391"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#step:353"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s:390"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_set"><span class="id" title="constructor">val_set</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:391"><span class="id" title="variable">p</span></a>) <a class="idref" href="Nondet.html#v:392"><span class="id" title="variable">v</span></a>) (<a class="idref" href="LibSepReference.html#Fmap.update"><span class="id" title="definition">Fmap.update</span></a> <a class="idref" href="Nondet.html#s:390"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:391"><span class="id" title="variable">p</span></a> <a class="idref" href="Nondet.html#v:392"><span class="id" title="variable">v</span></a>) <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a><br/>
&nbsp;&nbsp;| <a id="step_free" class="idref" href="#step_free"><span class="id" title="constructor">step_free</span></a> : <span class="id" title="keyword">∀</span> <a id="s:393" class="idref" href="#s:393"><span class="id" title="binder">s</span></a> <a id="p:394" class="idref" href="#p:394"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Nondet.html#s:393"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:394"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#step:353"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s:393"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_free"><span class="id" title="constructor">val_free</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:394"><span class="id" title="variable">p</span></a>)) (<a class="idref" href="LibSepReference.html#Fmap.remove"><span class="id" title="definition">Fmap.remove</span></a> <a class="idref" href="Nondet.html#s:393"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#p:394"><span class="id" title="variable">p</span></a>) <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a>.<br/>
</div>

<div class="doc">
Consider a configuration <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span>, where <span class="inlinecode"><span class="id" title="var">t</span></span> is not a value. If this
    configuration cannot take any reduction step, it is said to be "stuck". 
<div class="paragraph"> </div>

 The judgment <span class="inlinecode"><span class="id" title="var">evals</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode"><span class="id" title="var">t'</span></span> corresponds to the reflexive-transitive
    closure of <span class="inlinecode"><span class="id" title="var">step</span></span>. Concretely, this judgment asserts that the configuration
    <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> can reduce in zero, one, or several evals to <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">t'</span>)</span>. 
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="evals" class="idref" href="#evals"><span class="id" title="inductive">evals</span></a> : <a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="evals_refl" class="idref" href="#evals_refl"><span class="id" title="constructor">evals_refl</span></a> : <span class="id" title="keyword">∀</span> <a id="s:397" class="idref" href="#s:397"><span class="id" title="binder">s</span></a> <a id="t:398" class="idref" href="#t:398"><span class="id" title="binder">t</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evals:395"><span class="id" title="inductive">evals</span></a> <a class="idref" href="Nondet.html#s:397"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:398"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#s:397"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:398"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;| <a id="evals_step" class="idref" href="#evals_step"><span class="id" title="constructor">evals_step</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:399" class="idref" href="#s<sub>1</sub>:399"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:400" class="idref" href="#s<sub>2</sub>:400"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="s<sub>3</sub>:401" class="idref" href="#s<sub>3</sub>:401"><span class="id" title="binder">s<sub>3</sub></span></a> <a id="t<sub>1</sub>:402" class="idref" href="#t<sub>1</sub>:402"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:403" class="idref" href="#t<sub>2</sub>:403"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="t<sub>3</sub>:404" class="idref" href="#t<sub>3</sub>:404"><span class="id" title="binder">t<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:399"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:402"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:400"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:403"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evals:395"><span class="id" title="inductive">evals</span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:400"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:403"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="Nondet.html#s<sub>3</sub>:401"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="Nondet.html#t<sub>3</sub>:404"><span class="id" title="variable">t<sub>3</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evals:395"><span class="id" title="inductive">evals</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:399"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:402"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#s<sub>3</sub>:401"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="Nondet.html#t<sub>3</sub>:404"><span class="id" title="variable">t<sub>3</sub></span></a>.<br/>
</div>

<div class="doc">
<a id="lab466"></a><h2 class="section">Small-Step Characterization of <span class="inlinecode"><span class="id" title="var">evalns</span></span>: Attempts</h2>

<div class="paragraph"> </div>

 For a non-determinstic language, <span class="inlinecode"><span class="id" title="var">evals</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode"><span class="id" title="var">t'</span></span> asserts that there
    exists one possible evaluation from <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> to <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">t'</span>)</span>. This judgment
    says nothing about all other possible evaluations.

<div class="paragraph"> </div>

    On the contrary, the predicate <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>, introduced earlier in
    this chapter, says something about all possible evaluations. More precisely,
    <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> asserts that all possible evaluations of <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> reach a
    final configuration satisfying the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>.

<div class="paragraph"> </div>

    We are thus interested in defining a judgment of the form <span class="inlinecode"><span class="id" title="var">evalns</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>,
    that is logically equivalent to <span class="inlinecode"><span class="id" title="var">evaln</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>, but whose definition is
    based on the small-step semantics. 
<div class="paragraph"> </div>

 In the particular case of a deterministic semantics, we could define
    <span class="inlinecode"><span class="id" title="var">evalns</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> in terms of the transitive evaluation relation <span class="inlinecode"><span class="id" title="var">evals</span></span>
    as follows. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="evalns_attempt_1" class="idref" href="#evalns_attempt_1"><span class="id" title="definition">evalns_attempt_1</span></a> (<a id="s:405" class="idref" href="#s:405"><span class="id" title="binder">s</span></a>:<a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a>) (<a id="t:406" class="idref" href="#t:406"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) (<a id="Q:407" class="idref" href="#Q:407"><span class="id" title="binder">Q</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="v:408" class="idref" href="#v:408"><span class="id" title="binder">v</span></a> <a id="s':409" class="idref" href="#s':409"><span class="id" title="binder">s'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Nondet.html#evals"><span class="id" title="inductive">evals</span></a> <a class="idref" href="Nondet.html#s:405"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:406"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#s':409"><span class="id" title="variable">s'</span></a> (<a class="idref" href="LibSepReference.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Nondet.html#v:408"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Nondet.html#Q:407"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#v:408"><span class="id" title="variable">v</span></a> <a class="idref" href="Nondet.html#s':409"><span class="id" title="variable">s'</span></a>.<br/>
</div>

<div class="doc">
Quiz: Before reading further, try to devise a definition of <span class="inlinecode"><span class="id" title="var">evalns</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>
    expressed in terms for the judgment <span class="inlinecode"><span class="id" title="var">evals</span></span> that applies to the general case
    of non-deterministic semantics. 
<div class="paragraph"> </div>

 Let's check out several candidate definitions for the judgment <span class="inlinecode"><span class="id" title="var">evalns</span></span>. 
<div class="paragraph"> </div>

 The definition <span class="inlinecode"><span class="id" title="var">evalns_attempt_2</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> asserts that any execution starting
    from configuration <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> and ending on a final configuration <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">v</span>)</span> is
    such that the final configuration satisfies the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>. Yet,
    this definition fails to rule out the possibility of executions that get
    stuck. Thus, it is only applicable for semantics that include
    error-propagation rules, and for which there are no stuck terms. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="evalns_attempt_2" class="idref" href="#evalns_attempt_2"><span class="id" title="definition">evalns_attempt_2</span></a> (<a id="s:410" class="idref" href="#s:410"><span class="id" title="binder">s</span></a>:<a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a>) (<a id="t:411" class="idref" href="#t:411"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) (<a id="Q:412" class="idref" href="#Q:412"><span class="id" title="binder">Q</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="v:413" class="idref" href="#v:413"><span class="id" title="binder">v</span></a> <a id="s':414" class="idref" href="#s':414"><span class="id" title="binder">s'</span></a>, <a class="idref" href="Nondet.html#evals"><span class="id" title="inductive">evals</span></a> <a class="idref" href="Nondet.html#s:410"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:411"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#s':414"><span class="id" title="variable">s'</span></a> (<a class="idref" href="LibSepReference.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Nondet.html#v:413"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Nondet.html#Q:412"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#v:413"><span class="id" title="variable">v</span></a> <a class="idref" href="Nondet.html#s':414"><span class="id" title="variable">s'</span></a>.<br/>
</div>

<div class="doc">
The definition <span class="inlinecode"><span class="id" title="var">evalns_attempt_3</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> asserts that any execution starting
    from configuration <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> and reaching a state <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">t'</span>)</span> is such that
    either <span class="inlinecode"><span class="id" title="var">t'</span></span> is a value <span class="inlinecode"><span class="id" title="var">v</span></span> and <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">v</span>)</span> satisfies the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>,
    or <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">t'</span>)</span> can take a step. Yet, this definition fails to capture the
    fact that all execution of <span class="inlinecode"><span class="id" title="var">t</span></span> should terminate. Thus, it is only useful
    for capturing partial correctness properties. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="evalns_attempt_3" class="idref" href="#evalns_attempt_3"><span class="id" title="definition">evalns_attempt_3</span></a> (<a id="s:415" class="idref" href="#s:415"><span class="id" title="binder">s</span></a>:<a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a>) (<a id="t:416" class="idref" href="#t:416"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) (<a id="Q:417" class="idref" href="#Q:417"><span class="id" title="binder">Q</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="s<sub>2</sub>:418" class="idref" href="#s<sub>2</sub>:418"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="t<sub>2</sub>:419" class="idref" href="#t<sub>2</sub>:419"><span class="id" title="binder">t<sub>2</sub></span></a>, <a class="idref" href="Nondet.html#evals"><span class="id" title="inductive">evals</span></a> <a class="idref" href="Nondet.html#s:415"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:416"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:418"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:419"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e<sub>25</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="v<sub>2</sub>:420" class="idref" href="#v<sub>2</sub>:420"><span class="id" title="binder">v<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:419"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:420"><span class="id" title="variable">v<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Nondet.html#Q:417"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:420"><span class="id" title="variable">v<sub>2</sub></span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:418"><span class="id" title="variable">s<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e<sub>25</sub>"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e<sub>25</sub>"><span class="id" title="notation">∨</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e<sub>25</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="s<sub>3</sub>:421" class="idref" href="#s<sub>3</sub>:421"><span class="id" title="binder">s<sub>3</sub></span></a> <a id="t<sub>3</sub>:422" class="idref" href="#t<sub>3</sub>:422"><span class="id" title="binder">t<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Nondet.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:418"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:419"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="Nondet.html#s<sub>3</sub>:421"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="Nondet.html#t<sub>3</sub>:422"><span class="id" title="variable">t<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e<sub>25</sub>"><span class="id" title="notation">)</span></a>.<br/>
</div>

<div class="doc">
The definition <span class="inlinecode"><span class="id" title="var">evalns_attempt_4</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> asserts that every execution prefix
    starting from <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> may be completed into an execution that does terminate
    on a configuration that satisfies the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="evalns_attempt_4" class="idref" href="#evalns_attempt_4"><span class="id" title="definition">evalns_attempt_4</span></a> (<a id="s:423" class="idref" href="#s:423"><span class="id" title="binder">s</span></a>:<a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a>) (<a id="t:424" class="idref" href="#t:424"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) (<a id="Q:425" class="idref" href="#Q:425"><span class="id" title="binder">Q</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="s<sub>2</sub>:426" class="idref" href="#s<sub>2</sub>:426"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="t<sub>2</sub>:427" class="idref" href="#t<sub>2</sub>:427"><span class="id" title="binder">t<sub>2</sub></span></a>, <a class="idref" href="Nondet.html#evals"><span class="id" title="inductive">evals</span></a> <a class="idref" href="Nondet.html#s:423"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:424"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:426"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:427"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="v<sub>3</sub>:428" class="idref" href="#v<sub>3</sub>:428"><span class="id" title="binder">v<sub>3</sub></span></a> <a id="s<sub>3</sub>:429" class="idref" href="#s<sub>3</sub>:429"><span class="id" title="binder">s<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Nondet.html#evals"><span class="id" title="inductive">evals</span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:426"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:427"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="Nondet.html#s<sub>3</sub>:429"><span class="id" title="variable">s<sub>3</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Nondet.html#v<sub>3</sub>:428"><span class="id" title="variable">v<sub>3</sub></span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Nondet.html#Q:425"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#v<sub>3</sub>:428"><span class="id" title="variable">v<sub>3</sub></span></a> <a class="idref" href="Nondet.html#s<sub>3</sub>:429"><span class="id" title="variable">s<sub>3</sub></span></a>.<br/>
</div>

<div class="doc">
Quiz: Why is <span class="inlinecode"><span class="id" title="var">evalns_attempt_4</span></span> not equivalent to <span class="inlinecode"><span class="id" title="var">evaln</span></span>? Can you find a
    counter-example program for which the property "all possible evaluations
    reach a final configuration satisfying the postcondition" does not hold? 
<div class="paragraph"> </div>

 Solution follows.

<div class="paragraph"> </div>

    Consider the following program, which does satisfy <span class="inlinecode"><span class="id" title="var">evalns_attempt_4</span></span>
    yet whose execution may diverge.

<div class="paragraph"> </div>

<span class="inlinecode-ocaml">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">f</span> () =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">val_rand</span> 2) = 0 <span class="id" title="keyword">then</span> () <span class="id" title="keyword">else</span> <span class="id" title="var">f</span> ()
</span>
<div class="paragraph"> </div>

   Consider an execution that has already performed a number of recursive
   calls. This execution may terminate in a finite number of evaluation
   evals. Indeed, the next call to <span class="inlinecode"><span class="id" title="var">val_rand</span></span> may return zero. However, not
   all executions terminate. Indeed, the execution path where all calls to
   <span class="inlinecode"><span class="id" title="var">val_rand</span></span> return <span class="inlinecode">1</span>, the program runs forever. 
<div class="paragraph"> </div>

 The key challenge is to capture the property that "every possible execution
    terminates". To that end, let's consider yet another approach, based on the
    idea of bounding the number of execution steps.

<div class="paragraph"> </div>

    The judgment <span class="inlinecode"><span class="id" title="var">nbevals</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode"><span class="id" title="var">t'</span></span>, defined below, asserts that the
    configuration <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> may reduce in exactly <span class="inlinecode"><span class="id" title="var">n</span></span> steps to <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">t'</span>)</span>.
    Its definition follows that of the judgment <span class="inlinecode"><span class="id" title="var">evals</span></span>, only with an
    extra argument for counting the number of steps. 
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="nbevals" class="idref" href="#nbevals"><span class="id" title="inductive">nbevals</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="nbevals_refl" class="idref" href="#nbevals_refl"><span class="id" title="constructor">nbevals_refl</span></a> : <span class="id" title="keyword">∀</span> <a id="s:432" class="idref" href="#s:432"><span class="id" title="binder">s</span></a> <a id="t:433" class="idref" href="#t:433"><span class="id" title="binder">t</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#nbevals:430"><span class="id" title="inductive">nbevals</span></a> 0 <a class="idref" href="Nondet.html#s:432"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:433"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#s:432"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:433"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;| <a id="nbevals_step" class="idref" href="#nbevals_step"><span class="id" title="constructor">nbevals_step</span></a> : <span class="id" title="keyword">∀</span> (<a id="n:434" class="idref" href="#n:434"><span class="id" title="binder">n</span></a>:<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="s<sub>1</sub>:435" class="idref" href="#s<sub>1</sub>:435"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:436" class="idref" href="#s<sub>2</sub>:436"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="s<sub>3</sub>:437" class="idref" href="#s<sub>3</sub>:437"><span class="id" title="binder">s<sub>3</sub></span></a> <a id="t<sub>1</sub>:438" class="idref" href="#t<sub>1</sub>:438"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:439" class="idref" href="#t<sub>2</sub>:439"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="t<sub>3</sub>:440" class="idref" href="#t<sub>3</sub>:440"><span class="id" title="binder">t<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:435"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:438"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:436"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:439"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#nbevals:430"><span class="id" title="inductive">nbevals</span></a> <a class="idref" href="Nondet.html#n:434"><span class="id" title="variable">n</span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:436"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:439"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="Nondet.html#s<sub>3</sub>:437"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="Nondet.html#t<sub>3</sub>:440"><span class="id" title="variable">t<sub>3</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#nbevals:430"><span class="id" title="inductive">nbevals</span></a> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Nondet.html#n:434"><span class="id" title="variable">n</span></a>) <a class="idref" href="Nondet.html#s<sub>1</sub>:435"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:438"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#s<sub>3</sub>:437"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="Nondet.html#t<sub>3</sub>:440"><span class="id" title="variable">t<sub>3</sub></span></a>.<br/>
</div>

<div class="doc">
Using the judgment <span class="inlinecode"><span class="id" title="var">nbevals</span></span>, we are able to bound the length of all
    executions. The judgment <span class="inlinecode"><span class="id" title="var">steps_at_most</span></span> <span class="inlinecode"><span class="id" title="var">nmax</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span>, defined below,
    asserts that there does not exist any execution starting from <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span>
    that exceeds <span class="inlinecode"><span class="id" title="var">nmax</span></span> reduction steps. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="steps_at_most" class="idref" href="#steps_at_most"><span class="id" title="definition">steps_at_most</span></a> (<a id="nmax:441" class="idref" href="#nmax:441"><span class="id" title="binder">nmax</span></a>:<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<a id="s:442" class="idref" href="#s:442"><span class="id" title="binder">s</span></a>:<a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a>) (<a id="t:443" class="idref" href="#t:443"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="n:444" class="idref" href="#n:444"><span class="id" title="binder">n</span></a>:<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="s<sub>2</sub>:445" class="idref" href="#s<sub>2</sub>:445"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="t<sub>2</sub>:446" class="idref" href="#t<sub>2</sub>:446"><span class="id" title="binder">t<sub>2</sub></span></a>, <a class="idref" href="Nondet.html#n:444"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;</span> <a class="idref" href="Nondet.html#nmax:441"><span class="id" title="variable">nmax</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#nbevals"><span class="id" title="inductive">nbevals</span></a> <a class="idref" href="Nondet.html#n:444"><span class="id" title="variable">n</span></a> <a class="idref" href="Nondet.html#s:442"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:443"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:445"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:446"><span class="id" title="variable">t<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">)</span></a>.<br/>
</div>

<div class="doc">
The judgment <span class="inlinecode"><span class="id" title="var">evalns_attempt_5</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> corresponds to the conjunction
    of the judgment <span class="inlinecode"><span class="id" title="var">evalns_attempt_3</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>, which asserts partial
    correctness, and of the judgment <span class="inlinecode"><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">nmax</span>,</span> <span class="inlinecode"><span class="id" title="var">steps_at_most</span></span> <span class="inlinecode"><span class="id" title="var">nmax</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span>,
    which asserts that there exists an upper bound to the length of all
    possible executions. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="evalns_attempt_5" class="idref" href="#evalns_attempt_5"><span class="id" title="definition">evalns_attempt_5</span></a> (<a id="s:447" class="idref" href="#s:447"><span class="id" title="binder">s</span></a>:<a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a>) (<a id="t:448" class="idref" href="#t:448"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) (<a id="Q:449" class="idref" href="#Q:449"><span class="id" title="binder">Q</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#evalns_attempt_3"><span class="id" title="definition">evalns_attempt_3</span></a> <a class="idref" href="Nondet.html#s:447"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:448"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:449"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="nmax:450" class="idref" href="#nmax:450"><span class="id" title="binder">nmax</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Nondet.html#steps_at_most"><span class="id" title="definition">steps_at_most</span></a> <a class="idref" href="Nondet.html#nmax:450"><span class="id" title="variable">nmax</span></a> <a class="idref" href="Nondet.html#s:447"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:448"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
</div>

<div class="doc">
Is the definition of <span class="inlinecode"><span class="id" title="var">evalns_attempt_5</span></span> satisfying? Not quite. First, this
    definition is fairly complex, and not so easy to work with. Second, and
    perhaps most importantly, this definition does not apply to all programming
    languages. It applies only to semantics for which each configuration admits
    at most a finite number of possible transitions.

<div class="paragraph"> </div>

    If we view the possible executions of a program as a tree, with each branch
    corresponding to a possible execution, then definition <span class="inlinecode"><span class="id" title="var">evalns_attempt_5</span></span>
    only properly captures the notion of total correctness for "finitely
    branching trees", in which every node has a finite number of branches.

<div class="paragraph"> </div>

    Concretely, the definition <span class="inlinecode"><span class="id" title="var">evalns_attempt_5</span></span> would rule out legitimate
    programs in a language that includes an "unbounded" sources of non-
    determinism. For example, consider a random number generator that applies
    to the unit argument and may return any integer value in <span class="inlinecode"><span class="id" title="var">Z</span></span>. Such an
    operator could be formalized as follows. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="val_unbounded_rand" class="idref" href="#val_unbounded_rand"><span class="id" title="axiom">val_unbounded_rand</span></a> : <a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Parameter</span> <a id="evaln_unbounded_rand" class="idref" href="#evaln_unbounded_rand"><span class="id" title="axiom">evaln_unbounded_rand</span></a> : <span class="id" title="keyword">∀</span> <a id="s:452" class="idref" href="#s:452"><span class="id" title="binder">s</span></a> <a id="Q:453" class="idref" href="#Q:453"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="n<sub>1</sub>:454" class="idref" href="#n<sub>1</sub>:454"><span class="id" title="binder">n<sub>1</sub></span></a>, <a class="idref" href="Nondet.html#Q:453"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:454"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="Nondet.html#s:452"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:452"><span class="id" title="variable">s</span></a> (<a class="idref" href="Nondet.html#val_unbounded_rand"><span class="id" title="axiom">val_unbounded_rand</span></a> <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a>) <a class="idref" href="Nondet.html#Q:453"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
Quiz: devise a counter-example program such that (1) every possible
    execution of this program does terminate, and (2) this program does not
    satisfy <span class="inlinecode"><span class="id" title="var">evalns_attempt_5</span></span> because there does not exist an upper bound on
    the length of all executions. 
<div class="paragraph"> </div>

 Solution: Consider the following program.

<div class="paragraph"> </div>

<span class="inlinecode-ocaml">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">n</span> &gt; 0 <span class="id" title="keyword">then</span> <span class="id" title="var">f</span> (<span class="id" title="var">n</span>-1) <span class="id" title="keyword">else</span> () <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span> (<span class="id" title="var">unbounded_rand</span>())
</span>    The number of execution evals can be arbitrary. Yet, any given
    program execution terminates.

<div class="paragraph"> </div>

    Arguably, a stand-alone piece of hardware does not feature such "unbounded"
    source of non-determinism, because each transition at the hardware level
    involves the manipulation of at most a finite number of bits. However, as
    soon as I/O is involved, unbounded non-determinism may arise. For example,
    a language that features an <span class="inlinecode"><span class="id" title="var">input_string</span></span> method allowing the user to
    input strings of arbitrary size is a language with a source of unbounded
    non-determinism. 
<div class="paragraph"> </div>

 Remark: the fact that <span class="inlinecode"><span class="id" title="var">evalns_attempt_5</span></span> only properly captures total
    correctness for finitely branching trees is related to a result known
    as König's lemma. This result from graph theory, in the particular case
    of trees, asserts that "every infinite tree contains either a vertex of
    infinite degree or an infinite path", or equivalently, asserts that "a
    finitely branching tree is infinite iff it has an infinite path".

<div class="paragraph"> </div>

    The contraposed statement asserts that a finitely branching tree
    (corresponding to executions in a language with bounded determinism) is
    finite (i.e., admits a bound on the depth) iff it has no infinite path
    (i.e., if all executions terminate). 
<div class="paragraph"> </div>

 In summary:

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">evalns_attempt_1</span></span> applies only to deterministic semantics.

</li>
<li> <span class="inlinecode"><span class="id" title="var">evalns_attempt_2</span></span> applies only to complete semantics, i.e.,
      semantics without stuck terms.

</li>
<li> <span class="inlinecode"><span class="id" title="var">evalns_attempt_3</span></span> captures partial correctness only, and says
      nothing about termination.

</li>
<li> <span class="inlinecode"><span class="id" title="var">evalns_attempt_4</span></span> also fails to properly capture termination.

</li>
<li> <span class="inlinecode"><span class="id" title="var">evalns_attempt_5</span></span> captures total correctness only for semantics
      that feature only bounded sources of non-determinism, i.e., with
      a finite number of possible transitions from each configuration.

</li>
</ul>

<div class="paragraph"> </div>

    Our attempts to define a judgment <span class="inlinecode"><span class="id" title="var">evalns</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> in terms of <span class="inlinecode"><span class="id" title="var">evals</span></span> or in
    terms of its depth-indexed variant <span class="inlinecode"><span class="id" title="var">nbevals</span></span> have failed. It thus appears
    necessary to search instead for a definition of <span class="inlinecode"><span class="id" title="var">evalns</span></span> expressed directly
    in terms of the one-step reduction relation <span class="inlinecode"><span class="id" title="var">step</span></span>. 
</div>

<div class="doc">
<a id="lab467"></a><h2 class="section">Small-Step Characterization of <span class="inlinecode"><span class="id" title="var">evaln</span></span>: A Solution</h2>

<div class="paragraph"> </div>

 In what follows, we present an inductive definition for <span class="inlinecode"><span class="id" title="var">evalns</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>.
    To begin with, let us consider the particular case of a deterministic
    language.

<div class="paragraph"> </div>

    The predicate <span class="inlinecode"><span class="id" title="var">evalds</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> asserts that the (deterministic) evaluation
    starting from configuration <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> produces an output satisfying the
    predicate <span class="inlinecode"><span class="id" title="var">Q</span></span>. It is defined inductively as follows.

<div class="paragraph"> </div>

<ul class="doclist">
<li> Base case: <span class="inlinecode"><span class="id" title="var">evalds</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> holds if the postcondition holds of this
      current state, that is, <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> holds.

</li>
<li> Step case: <span class="inlinecode"><span class="id" title="var">evalds</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> holds if <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> one-step reduces to the
      configuration <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">t'</span>)</span> and <span class="inlinecode"><span class="id" title="var">evalds</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode"><span class="id" title="var">t'</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> holds. 

</li>
</ul>
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="evalds" class="idref" href="#evalds"><span class="id" title="inductive">evalds</span></a> : <a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation"><span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>(</span></a><a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span></span></a><span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="evalds_val" class="idref" href="#evalds_val"><span class="id" title="constructor">evalds_val</span></a> : <span class="id" title="keyword">∀</span> <a id="s:458" class="idref" href="#s:458"><span class="id" title="binder">s</span></a> <a id="v:459" class="idref" href="#v:459"><span class="id" title="binder">v</span></a> <a id="Q:460" class="idref" href="#Q:460"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q:460"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#v:459"><span class="id" title="variable">v</span></a> <a class="idref" href="Nondet.html#s:458"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalds:456"><span class="id" title="inductive">evalds</span></a> <a class="idref" href="Nondet.html#s:458"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#v:459"><span class="id" title="variable">v</span></a> <a class="idref" href="Nondet.html#Q:460"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="evalds_step" class="idref" href="#evalds_step"><span class="id" title="constructor">evalds_step</span></a> : <span class="id" title="keyword">∀</span> <a id="s:461" class="idref" href="#s:461"><span class="id" title="binder">s</span></a> <a id="t:462" class="idref" href="#t:462"><span class="id" title="binder">t</span></a> <a id="s':463" class="idref" href="#s':463"><span class="id" title="binder">s'</span></a> <a id="t':464" class="idref" href="#t':464"><span class="id" title="binder">t'</span></a> <a id="Q:465" class="idref" href="#Q:465"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s:461"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:462"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#s':463"><span class="id" title="variable">s'</span></a> <a class="idref" href="Nondet.html#t':464"><span class="id" title="variable">t'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalds:456"><span class="id" title="inductive">evalds</span></a> <a class="idref" href="Nondet.html#s':463"><span class="id" title="variable">s'</span></a> <a class="idref" href="Nondet.html#t':464"><span class="id" title="variable">t'</span></a> <a class="idref" href="Nondet.html#Q:465"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalds:456"><span class="id" title="inductive">evalds</span></a> <a class="idref" href="Nondet.html#s:461"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:462"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:465"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
Let us now generalize the inductive definition of <span class="inlinecode"><span class="id" title="var">evalds</span></span> to the general
    case of non-deterministic semantics.

<div class="paragraph"> </div>

<ul class="doclist">
<li> Base case: it does not change, that is, <span class="inlinecode"><span class="id" title="var">evalns</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> requires <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>.

<div class="paragraph"> </div>


</li>
<li> Step case: this case needs to be refined to account for all possible
      evaluations, and not just the unique possible evaluation. There are two
      requirements. First, <span class="inlinecode"><span class="id" title="var">evalns</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> requires that the configuration
      <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> is not stuck, that is, it requires the existence of at least one
      possible reduction step. Second, <span class="inlinecode"><span class="id" title="var">evalns</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> requires that, for any
      configuration <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">t'</span>)</span> that <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> might reduce to, the property
      <span class="inlinecode"><span class="id" title="var">evalns</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode"><span class="id" title="var">t'</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> holds.

</li>
</ul>

<div class="paragraph"> </div>

    The definition of <span class="inlinecode"><span class="id" title="var">evalns</span></span> may thus be formalized as shown below. 
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="evalns" class="idref" href="#evalns"><span class="id" title="inductive">evalns</span></a> : <a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation"><span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>(</span></a><a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span></span></a><span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="evalns_val" class="idref" href="#evalns_val"><span class="id" title="constructor">evalns_val</span></a> : <span class="id" title="keyword">∀</span> <a id="s:468" class="idref" href="#s:468"><span class="id" title="binder">s</span></a> <a id="v:469" class="idref" href="#v:469"><span class="id" title="binder">v</span></a> <a id="Q:470" class="idref" href="#Q:470"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q:470"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#v:469"><span class="id" title="variable">v</span></a> <a class="idref" href="Nondet.html#s:468"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns:466"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:468"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#v:469"><span class="id" title="variable">v</span></a> <a class="idref" href="Nondet.html#Q:470"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="evalns_step" class="idref" href="#evalns_step"><span class="id" title="constructor">evalns_step</span></a> : <span class="id" title="keyword">∀</span> <a id="s:471" class="idref" href="#s:471"><span class="id" title="binder">s</span></a> <a id="t:472" class="idref" href="#t:472"><span class="id" title="binder">t</span></a> <a id="Q:473" class="idref" href="#Q:473"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="s':474" class="idref" href="#s':474"><span class="id" title="binder">s'</span></a> <a id="t':475" class="idref" href="#t':475"><span class="id" title="binder">t'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Nondet.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s:471"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:472"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#s':474"><span class="id" title="variable">s'</span></a> <a class="idref" href="Nondet.html#t':475"><span class="id" title="variable">t'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="s':476" class="idref" href="#s':476"><span class="id" title="binder">s'</span></a> <a id="t':477" class="idref" href="#t':477"><span class="id" title="binder">t'</span></a>, <a class="idref" href="Nondet.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s:471"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:472"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#s':476"><span class="id" title="variable">s'</span></a> <a class="idref" href="Nondet.html#t':477"><span class="id" title="variable">t'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Nondet.html#evalns:466"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s':476"><span class="id" title="variable">s'</span></a> <a class="idref" href="Nondet.html#t':477"><span class="id" title="variable">t'</span></a> <a class="idref" href="Nondet.html#Q:473"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns:466"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:471"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:472"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:473"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
Observe how this definition allows for <span class="inlinecode"><span class="id" title="var">evalns</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> to hold even
    for the program such as the counter-example considered for definition
    <span class="inlinecode"><span class="id" title="var">evalns_attempt_5</span></span>, i.e., the program that performs <span class="inlinecode"><span class="id" title="var">unbounded_rand</span>()</span>
    recursive calls. The judgment <span class="inlinecode"><span class="id" title="var">evalns</span></span> holds for this program, although
    there exists no bound on the depth of the corresponding derivation. This
    possibility stems from the fact that the <span class="inlinecode"><span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode"><span class="id" title="var">t'</span></span> quantification in
    constructor <span class="inlinecode"><span class="id" title="var">evalns_step</span></span> introduces an infinite branching factor in the
    derivation tree, for a language that includes the primitive operation
    <span class="inlinecode"><span class="id" title="var">unbounded_rand</span></span>. 
<div class="paragraph"> </div>

<a id="lab468"></a><h4 class="section">Exercise: 2 stars, standard, optional (evalns_val_inv)</h4>
 Prove the following inversion lemma, which asserts that
    <span class="inlinecode"><span class="id" title="var">evalns</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> implies <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evalns_val_inv" class="idref" href="#evalns_val_inv"><span class="id" title="lemma">evalns_val_inv</span></a> : <span class="id" title="keyword">∀</span> <a id="s:478" class="idref" href="#s:478"><span class="id" title="binder">s</span></a> <a id="v:479" class="idref" href="#v:479"><span class="id" title="binder">v</span></a> <a id="Q:480" class="idref" href="#Q:480"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:478"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#v:479"><span class="id" title="variable">v</span></a> <a class="idref" href="Nondet.html#Q:480"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q:480"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#v:479"><span class="id" title="variable">v</span></a> <a class="idref" href="Nondet.html#s:478"><span class="id" title="variable">s</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 In the remaining of this chapter, we present:
<ul class="doclist">
<li> a definition of Separation Logic triples based on <span class="inlinecode"><span class="id" title="var">evalns</span></span>; the
      corresponding judgment is named <span class="inlinecode"><span class="id" title="var">triplens</span></span>

</li>
<li> the proof of the reasoning rules associated with <span class="inlinecode"><span class="id" title="var">triplens</span></span>;

</li>
<li> a formal proof of equivalence between <span class="inlinecode"><span class="id" title="var">evalns</span></span> and <span class="inlinecode"><span class="id" title="var">evaln</span></span>, relating the
      small-step-based definition to the big-step-based definition introduced
      in the first part of this chapter. 

</li>
</ul>
</div>

<div class="doc">
<a id="lab469"></a><h2 class="section">Reasoning Rules for <span class="inlinecode"><span class="id" title="var">evalns</span></span></h2>

<div class="paragraph"> </div>

 Reasoning rules have a big-step flavor, thus to derive them we first need
    to derive big-step style reasoning rules for <span class="inlinecode"><span class="id" title="var">evalns</span></span>. 
<div class="paragraph"> </div>

 Again, the key step is to argue for the frame property, first for <span class="inlinecode"><span class="id" title="var">evalns</span></span>,
    then for <span class="inlinecode"><span class="id" title="var">triplens</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Section</span> <a id="EvalnsProperties" class="idref" href="#EvalnsProperties"><span class="id" title="section">EvalnsProperties</span></a>.<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="Nondet.html#step"><span class="id" title="inductive">step</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="evalns_frame" class="idref" href="#evalns_frame"><span class="id" title="lemma">evalns_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="h<sub>1</sub>:481" class="idref" href="#h<sub>1</sub>:481"><span class="id" title="binder">h<sub>1</sub></span></a> <a id="h<sub>2</sub>:482" class="idref" href="#h<sub>2</sub>:482"><span class="id" title="binder">h<sub>2</sub></span></a> <a id="t:483" class="idref" href="#t:483"><span class="id" title="binder">t</span></a> <a id="Q:484" class="idref" href="#Q:484"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#h<sub>1</sub>:481"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t:483"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:484"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.disjoint"><span class="id" title="definition">Fmap.disjoint</span></a> <a class="idref" href="Nondet.html#h<sub>1</sub>:481"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="Nondet.html#h<sub>2</sub>:482"><span class="id" title="variable">h<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> (<a class="idref" href="Nondet.html#h<sub>1</sub>:481"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <a class="idref" href="Nondet.html#h<sub>2</sub>:482"><span class="id" title="variable">h<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#t:483"><span class="id" title="variable">t</span></a> (<a class="idref" href="Nondet.html#Q:484"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation">(</span></a><span class="id" title="notation">=</span> <a class="idref" href="Nondet.html#h<sub>2</sub>:482"><span class="id" title="variable">h<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation">)</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">HD</span>. <span class="id" title="var">gen</span> <span class="id" title="var">h<sub>2</sub></span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">M</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rename</span> <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">M<sub>1</sub></span>, <span class="id" title="var">H<sub>0</sub></span> <span class="id" title="var">into</span> <span class="id" title="var">M<sub>2</sub></span>, <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">into</span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">clear</span> <span class="id" title="var">M<sub>2</sub></span> <span class="id" title="var">IH<sub>2</sub></span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">s'</span>&amp;<span class="id" title="var">t'</span>&amp;<span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">R</span>; <span class="id" title="var">tryfalse</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>; <span class="id" title="var">constructors</span>* ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">forwards</span>* (<span class="id" title="var">s'</span>&amp;<span class="id" title="var">t'</span>&amp;<span class="id" title="var">R'</span>): <span class="id" title="var">IHR</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">lets</span> (<span class="id" title="var">p'</span>&amp;<span class="id" title="var">F</span>&amp;<span class="id" title="var">_</span>): <a class="idref" href="LibSepFmap.html#exists_fresh"><span class="id" title="lemma">exists_fresh</span></a> <a class="idref" href="LibSepReference.html#null"><span class="id" title="definition">null</span></a> (<a class="idref" href="LibSepReference.html#Fmap.union"><span class="id" title="definition">Fmap.union</span></a> <span class="id" title="var">s</span> <span class="id" title="var">h<sub>2</sub></span>). <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#step_ref"><span class="id" title="constructor">step_ref</span></a> <span class="id" title="var">v</span> <span class="id" title="var">p'</span>. <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#step_get"><span class="id" title="constructor">step_get</span></a>. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_l"><span class="id" title="lemma">Fmap.indom_union_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#step_set"><span class="id" title="constructor">step_set</span></a>. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_l"><span class="id" title="lemma">Fmap.indom_union_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#step_free"><span class="id" title="constructor">step_free</span></a>. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_l"><span class="id" title="lemma">Fmap.indom_union_l</span></a>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">cuts</span> (<span class="id" title="var">s<sub>1</sub>'</span>&amp;<span class="id" title="var">E'</span>&amp;<span class="id" title="var">D'</span>&amp;<span class="id" title="var">R'</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="s<sub>1</sub>':486" class="idref" href="#s<sub>1</sub>':486"><span class="id" title="binder">s<sub>1</sub>'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">s'</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>':485"><span class="id" title="variable">s<sub>1</sub>'</span></a> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <span class="id" title="var">h<sub>2</sub></span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="LibSepReference.html#Fmap.disjoint"><span class="id" title="definition">Fmap.disjoint</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>':485"><span class="id" title="variable">s<sub>1</sub>'</span></a> <span class="id" title="var">h<sub>2</sub></span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Nondet.html#step"><span class="id" title="inductive">step</span></a> <span class="id" title="var">s</span> <span class="id" title="var">t</span> <a class="idref" href="Nondet.html#s<sub>1</sub>':485"><span class="id" title="variable">s<sub>1</sub>'</span></a> <span class="id" title="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span>. <span class="id" title="var">applys</span>* <span class="id" title="var">IH<sub>2</sub></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">M<sub>2</sub></span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">gen_eq</span> <span class="id" title="var">su</span>: (<span class="id" title="var">s</span> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <span class="id" title="var">h<sub>2</sub></span>). <span class="id" title="var">gen</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">R</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">s<sub>0</sub></span>&amp;<span class="id" title="var">t<sub>0</sub></span>&amp;<span class="id" title="var">R<sub>0</sub></span>). <span class="comment">(*&nbsp;inverts&nbsp;R<sub>0</sub>;&nbsp;tryfalse.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rename</span> <span class="id" title="var">R</span> <span class="id" title="var">into</span> <span class="id" title="var">R<sub>1</sub></span>. <span class="id" title="var">forwards</span>* (<span class="id" title="var">s<sub>1</sub>'</span>&amp;<span class="id" title="var">E</span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">R<sub>1</sub>'</span>): <span class="id" title="var">IHR</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inverts</span> <span class="id" title="var">R<sub>0</sub></span>. { <span class="id" title="tactic">eauto</span>. } { <span class="id" title="var">inverts</span> <span class="id" title="var">R<sub>1</sub></span>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rename</span> <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">D</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#Fmap.indom_union_eq"><span class="id" title="lemma">Fmap.indom_union_eq</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">D</span>. <span class="id" title="var">rew_logic</span> <span class="id" title="keyword">in</span> <span class="id" title="var">D</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">D</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">D<sub>1</sub></span>&amp;<span class="id" title="var">D<sub>2</sub></span>). <span class="id" title="var">esplit</span>. <span class="id" title="var">splits</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.update_union_not_r"><span class="id" title="lemma">Fmap.update_union_not_r</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.disjoint_update_not_r"><span class="id" title="lemma">Fmap.disjoint_update_not_r</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eauto</span>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">se</span>&amp;<span class="id" title="var">te</span>&amp;<span class="id" title="var">Re</span>). <span class="id" title="var">inverts</span> <span class="id" title="var">Re</span>; <span class="id" title="var">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.read_union_l"><span class="id" title="lemma">Fmap.read_union_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">se</span>&amp;<span class="id" title="var">te</span>&amp;<span class="id" title="var">Re</span>). <span class="id" title="var">inverts</span> <span class="id" title="var">Re</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">esplit</span>. <span class="id" title="var">splits</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.update_union_l"><span class="id" title="lemma">Fmap.update_union_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.disjoint_update_l"><span class="id" title="lemma">Fmap.disjoint_update_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eauto</span>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">se</span>&amp;<span class="id" title="var">te</span>&amp;<span class="id" title="var">Re</span>). <span class="id" title="var">inverts</span> <span class="id" title="var">Re</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">esplit</span>. <span class="id" title="var">splits</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepFmap.html#remove_disjoint_union_l"><span class="id" title="lemma">remove_disjoint_union_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.disjoint_remove_l"><span class="id" title="lemma">Fmap.disjoint_remove_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eauto</span>. } } } }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The structural rules for <span class="inlinecode"><span class="id" title="var">evalns</span></span> asserts that <span class="inlinecode"><span class="id" title="var">evalns</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> is
    covariant in the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evalns_conseq" class="idref" href="#evalns_conseq"><span class="id" title="lemma">evalns_conseq</span></a> : <span class="id" title="keyword">∀</span> <a id="s:487" class="idref" href="#s:487"><span class="id" title="binder">s</span></a> <a id="t:488" class="idref" href="#t:488"><span class="id" title="binder">t</span></a> <a id="Q:489" class="idref" href="#Q:489"><span class="id" title="binder">Q</span></a> <a id="Q':490" class="idref" href="#Q':490"><span class="id" title="binder">Q'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:487"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:488"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q':490"><span class="id" title="variable">Q'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q':490"><span class="id" title="variable">Q'</span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Nondet.html#Q:489"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:487"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:488"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:489"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">WQ</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>. <span class="id" title="var">applys</span>* <span class="id" title="var">WQ</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rename</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">into</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">HR</span>. <span class="id" title="var">applys</span>* <span class="id" title="var">IH</span>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The rules for term constructs are established next. Note that there is
    no rule stated here for the case of values, because such a rule is
    already provided by the constructor <span class="inlinecode"><span class="id" title="var">evalns_val</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evalns_fix" class="idref" href="#evalns_fix"><span class="id" title="lemma">evalns_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s:491" class="idref" href="#s:491"><span class="id" title="binder">s</span></a> <a id="f:492" class="idref" href="#f:492"><span class="id" title="binder">f</span></a> <a id="x:493" class="idref" href="#x:493"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:494" class="idref" href="#t<sub>1</sub>:494"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="Q:495" class="idref" href="#Q:495"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q:495"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:492"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:493"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:494"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Nondet.html#s:491"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:491"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_fix"><span class="id" title="constructor">trm_fix</span></a> <a class="idref" href="Nondet.html#f:492"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:493"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:494"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Nondet.html#Q:495"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="tactic">constructor</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">R</span>. { <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="evalns_app_fix" class="idref" href="#evalns_app_fix"><span class="id" title="lemma">evalns_app_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s:496" class="idref" href="#s:496"><span class="id" title="binder">s</span></a> <a id="f:497" class="idref" href="#f:497"><span class="id" title="binder">f</span></a> <a id="x:498" class="idref" href="#x:498"><span class="id" title="binder">x</span></a> <a id="v<sub>1</sub>:499" class="idref" href="#v<sub>1</sub>:499"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:500" class="idref" href="#v<sub>2</sub>:500"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="t<sub>1</sub>:501" class="idref" href="#t<sub>1</sub>:501"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="Q:502" class="idref" href="#Q:502"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#v<sub>1</sub>:499"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:497"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:498"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:501"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:496"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:498"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:500"><span class="id" title="variable">v<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#f:497"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:499"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:501"><span class="id" title="variable">t<sub>1</sub></span></a>)) <a class="idref" href="Nondet.html#Q:502"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:496"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:499"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:500"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:502"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">E</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">constructors</span>*. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">invert</span> <span class="id" title="var">R</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">intros</span>; <span class="id" title="var">false</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">introv</span> → → → → → <span class="id" title="var">R</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">E</span>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab470"></a><h4 class="section">Exercise: 5 stars, standard, especially useful (evalns_let)</h4>
 Prove the big-step reasoning rule for let-bindings for <span class="inlinecode"><span class="id" title="var">evalns</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evalns_let" class="idref" href="#evalns_let"><span class="id" title="lemma">evalns_let</span></a> : <span class="id" title="keyword">∀</span> <a id="s:503" class="idref" href="#s:503"><span class="id" title="binder">s</span></a> <a id="x:504" class="idref" href="#x:504"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:505" class="idref" href="#t<sub>1</sub>:505"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:506" class="idref" href="#t<sub>2</sub>:506"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="Q<sub>1</sub>:507" class="idref" href="#Q<sub>1</sub>:507"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q:508" class="idref" href="#Q:508"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:503"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:505"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#Q<sub>1</sub>:507"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:509" class="idref" href="#s<sub>1</sub>:509"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="v<sub>1</sub>:510" class="idref" href="#v<sub>1</sub>:510"><span class="id" title="binder">v<sub>1</sub></span></a>, <a class="idref" href="Nondet.html#Q<sub>1</sub>:507"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:510"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:509"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:509"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:504"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:510"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:506"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:508"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:503"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Nondet.html#x:504"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:505"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:506"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:508"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evalns_if" class="idref" href="#evalns_if"><span class="id" title="lemma">evalns_if</span></a> : <span class="id" title="keyword">∀</span> <a id="s:511" class="idref" href="#s:511"><span class="id" title="binder">s</span></a> <a id="b:512" class="idref" href="#b:512"><span class="id" title="binder">b</span></a> <a id="t<sub>1</sub>:513" class="idref" href="#t<sub>1</sub>:513"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:514" class="idref" href="#t<sub>2</sub>:514"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="Q:515" class="idref" href="#Q:515"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:511"><span class="id" title="variable">s</span></a> (<span class="id" title="keyword">if</span> <a class="idref" href="Nondet.html#b:512"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Nondet.html#t<sub>1</sub>:513"><span class="id" title="variable">t<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Nondet.html#t<sub>2</sub>:514"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:515"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:511"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_if"><span class="id" title="constructor">trm_if</span></a> <a class="idref" href="Nondet.html#b:512"><span class="id" title="variable">b</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:513"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:514"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:515"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">constructors</span>*. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">R</span>; <span class="id" title="var">tryfalse</span>. { <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="evalns_ref" class="idref" href="#evalns_ref"><span class="id" title="lemma">evalns_ref</span></a> : <span class="id" title="keyword">∀</span> <a id="s:516" class="idref" href="#s:516"><span class="id" title="binder">s</span></a> <a id="v:517" class="idref" href="#v:517"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:516"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Nondet.html#v:517"><span class="id" title="variable">v</span></a>) (<span class="id" title="keyword">fun</span> <a id="r:518" class="idref" href="#r:518"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="p:519" class="idref" href="#p:519"><span class="id" title="binder">p</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:518"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Nondet.html#p:519"><span class="id" title="variable">p</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#p:519"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:517"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><span class="id" title="notation">=</span> <a class="idref" href="Nondet.html#s:516"><span class="id" title="variable">s</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">forwards</span>¬(<span class="id" title="var">p</span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">N</span>): (<a class="idref" href="LibSepFmap.html#exists_fresh"><span class="id" title="lemma">exists_fresh</span></a> <a class="idref" href="LibSepReference.html#null"><span class="id" title="definition">null</span></a> <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">esplit</span>. <span class="id" title="tactic">∃</span> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <span class="id" title="var">p</span>). <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_ref"><span class="id" title="constructor">step_ref</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">R</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="LibSepFmap.html#update"><span class="id" title="definition">update</span></a>. <span class="id" title="var">applys</span>¬<a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">∃</span> <span class="id" title="var">p</span>. <span class="id" title="tactic">rewrite</span>¬<a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_hpure_l"><span class="id" title="lemma">hstar_hpure_l</span></a>. <span class="id" title="tactic">split</span>¬. { <span class="id" title="var">applys</span>¬<a class="idref" href="LibSepReference.html#SepSimplArgs.hsingle_intro"><span class="id" title="lemma">hsingle_intro</span></a>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepFmap.html#disjoint_single_of_not_indom"><span class="id" title="lemma">disjoint_single_of_not_indom</span></a>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="Nondet.html#EvalnsProperties"><span class="id" title="section">EvalnsProperties</span></a>.<br/>
</div>

<div class="doc">
<a id="lab471"></a><h2 class="section">Triples for Small-Step Semantics</h2>

<div class="paragraph"> </div>

 The judgment <span class="inlinecode"><span class="id" title="var">triplens</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> mimics the definition of <span class="inlinecode"><span class="id" title="var">hoaren</span></span>, which
    was used for defining triples with respect to the big-step judgment
    <span class="inlinecode"><span class="id" title="var">evaln</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="triplens" class="idref" href="#triplens"><span class="id" title="definition">triplens</span></a> (<a id="t:520" class="idref" href="#t:520"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) (<a id="H:521" class="idref" href="#H:521"><span class="id" title="binder">H</span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) (<a id="Q:522" class="idref" href="#Q:522"><span class="id" title="binder">Q</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="s:523" class="idref" href="#s:523"><span class="id" title="binder">s</span></a>:<a class="idref" href="LibSepReference.html#state"><span class="id" title="definition">state</span></a>), <a class="idref" href="Nondet.html#H:521"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#s:523"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:523"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:520"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:522"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
From <span class="inlinecode"><span class="id" title="var">evalns_frame</span></span>, we can derive the standard frame rule for <span class="inlinecode"><span class="id" title="var">triplens</span></span>,
    exactly like we did in the lemma <span class="inlinecode"><span class="id" title="var">triplen_frame</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triplens_frame" class="idref" href="#triplens_frame"><span class="id" title="lemma">triplens_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="t:524" class="idref" href="#t:524"><span class="id" title="binder">t</span></a> <a id="H:525" class="idref" href="#H:525"><span class="id" title="binder">H</span></a> <a id="Q:526" class="idref" href="#Q:526"><span class="id" title="binder">Q</span></a> <a id="H':527" class="idref" href="#H':527"><span class="id" title="binder">H'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> <a class="idref" href="Nondet.html#t:524"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#H:525"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:526"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> <a class="idref" href="Nondet.html#t:524"><span class="id" title="variable">t</span></a> (<a class="idref" href="Nondet.html#H:525"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H':527"><span class="id" title="variable">H'</span></a>) (<a class="idref" href="Nondet.html#Q:526"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Nondet.html#H':527"><span class="id" title="variable">H'</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">HF</span>. <span class="id" title="var">lets</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">M<sub>2</sub></span>&amp;<span class="id" title="var">MD</span>&amp;<span class="id" title="var">MU</span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_inv"><span class="id" title="lemma">hstar_inv</span></a> (<span class="id" title="definition">rm</span> <span class="id" title="var">HF</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">specializes</span> <span class="id" title="var">M</span> <span class="id" title="var">M<sub>1</sub></span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_conseq"><span class="id" title="lemma">evalns_conseq</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_frame"><span class="id" title="lemma">evalns_frame</span></a> <span class="id" title="var">M</span> <span class="id" title="var">MD</span>. } { <span class="id" title="var">xsimpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h'</span> →. <span class="id" title="var">applys</span> <span class="id" title="var">M<sub>2</sub></span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab472"></a><h2 class="section">Reasoning Rules for <span class="inlinecode"><span class="id" title="var">triplens</span></span></h2>

<div class="paragraph"> </div>

 Let's now prove reasoning rules for the Hoare triples judgment
    <span class="inlinecode"><span class="id" title="var">triplens</span></span>. 
<div class="paragraph"> </div>

 The consequence rule exploits the covariance result for <span class="inlinecode"><span class="id" title="var">evalns</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triplens_conseq" class="idref" href="#triplens_conseq"><span class="id" title="lemma">triplens_conseq</span></a> : <span class="id" title="keyword">∀</span> <a id="t:528" class="idref" href="#t:528"><span class="id" title="binder">t</span></a> <a id="H':529" class="idref" href="#H':529"><span class="id" title="binder">H'</span></a> <a id="Q':530" class="idref" href="#Q':530"><span class="id" title="binder">Q'</span></a> <a id="H:531" class="idref" href="#H:531"><span class="id" title="binder">H</span></a> <a id="Q:532" class="idref" href="#Q:532"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> <a class="idref" href="Nondet.html#t:528"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#H':529"><span class="id" title="variable">H'</span></a> <a class="idref" href="Nondet.html#Q':530"><span class="id" title="variable">Q'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#H:531"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#H':529"><span class="id" title="variable">H'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q':530"><span class="id" title="variable">Q'</span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Nondet.html#Q:532"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> <a class="idref" href="Nondet.html#t:528"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#H:531"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:532"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">MH</span> <span class="id" title="var">MQ</span> <span class="id" title="var">HF</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_conseq"><span class="id" title="lemma">evalns_conseq</span></a> <span class="id" title="var">M</span> <span class="id" title="var">MQ</span>. <span class="id" title="var">applys</span>* <span class="id" title="var">MH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The other two structural rules, which operate on the precondition, admit
    exactly the same proofs as in the previous chapters. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triplens_hexists" class="idref" href="#triplens_hexists"><span class="id" title="lemma">triplens_hexists</span></a> : <span class="id" title="keyword">∀</span> <a id="t:533" class="idref" href="#t:533"><span class="id" title="binder">t</span></a> (<a id="A:534" class="idref" href="#A:534"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>) (<a id="J:535" class="idref" href="#J:535"><span class="id" title="binder">J</span></a>:<a class="idref" href="Nondet.html#A:534"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) <a id="Q:536" class="idref" href="#Q:536"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="x:537" class="idref" href="#x:537"><span class="id" title="binder">x</span></a>, <a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> <a class="idref" href="Nondet.html#t:533"><span class="id" title="variable">t</span></a> (<a class="idref" href="Nondet.html#J:535"><span class="id" title="variable">J</span></a> <a class="idref" href="Nondet.html#x:537"><span class="id" title="variable">x</span></a>) <a class="idref" href="Nondet.html#Q:536"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> <a class="idref" href="Nondet.html#t:533"><span class="id" title="variable">t</span></a> (<a class="idref" href="LibSepReference.html#SepSimplArgs.hexists"><span class="id" title="definition">hexists</span></a> <a class="idref" href="Nondet.html#J:535"><span class="id" title="variable">J</span></a>) <a class="idref" href="Nondet.html#Q:536"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> (<span class="id" title="var">x</span>&amp;<span class="id" title="var">Hh</span>). <span class="id" title="var">applys</span> <span class="id" title="var">M</span> <span class="id" title="var">Hh</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplens_hpure" class="idref" href="#triplens_hpure"><span class="id" title="lemma">triplens_hpure</span></a> : <span class="id" title="keyword">∀</span> <a id="t:538" class="idref" href="#t:538"><span class="id" title="binder">t</span></a> (<a id="P:539" class="idref" href="#P:539"><span class="id" title="binder">P</span></a>:<span class="id" title="keyword">Prop</span>) <a id="H:540" class="idref" href="#H:540"><span class="id" title="binder">H</span></a> <a id="Q:541" class="idref" href="#Q:541"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#P:539"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> <a class="idref" href="Nondet.html#t:538"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#H:540"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:541"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> <a class="idref" href="Nondet.html#t:538"><span class="id" title="variable">t</span></a> (<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#P:539"><span class="id" title="variable">P</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:540"><span class="id" title="variable">H</span></a>) <a class="idref" href="Nondet.html#Q:541"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">M<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">U</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">HP</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">E</span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hempty_inv"><span class="id" title="lemma">hempty_inv</span></a> <span class="id" title="var">HP</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#Fmap.union_empty_l"><span class="id" title="lemma">Fmap.union_empty_l</span></a>. <span class="id" title="var">applys</span>¬<span class="id" title="var">M</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The reasoning rules for terms follow directly from the reasoning rules
    established for <span class="inlinecode"><span class="id" title="var">evalns</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triplens_val" class="idref" href="#triplens_val"><span class="id" title="lemma">triplens_val</span></a> : <span class="id" title="keyword">∀</span> <a id="v:542" class="idref" href="#v:542"><span class="id" title="binder">v</span></a> <a id="H:543" class="idref" href="#H:543"><span class="id" title="binder">H</span></a> <a id="Q:544" class="idref" href="#Q:544"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#H:543"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#Q:544"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#v:542"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> (<a class="idref" href="LibSepReference.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Nondet.html#v:542"><span class="id" title="variable">v</span></a>) <a class="idref" href="Nondet.html#H:543"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:544"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplens_fix" class="idref" href="#triplens_fix"><span class="id" title="lemma">triplens_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="f:545" class="idref" href="#f:545"><span class="id" title="binder">f</span></a> <a id="x:546" class="idref" href="#x:546"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:547" class="idref" href="#t<sub>1</sub>:547"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="H:548" class="idref" href="#H:548"><span class="id" title="binder">H</span></a> <a id="Q:549" class="idref" href="#Q:549"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#H:548"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#Q:549"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:545"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:546"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:547"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> (<a class="idref" href="LibSepReference.html#trm_fix"><span class="id" title="constructor">trm_fix</span></a> <a class="idref" href="Nondet.html#f:545"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:546"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:547"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Nondet.html#H:548"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:549"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_fix"><span class="id" title="lemma">evalns_fix</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplens_app_fix" class="idref" href="#triplens_app_fix"><span class="id" title="lemma">triplens_app_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="v<sub>1</sub>:550" class="idref" href="#v<sub>1</sub>:550"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:551" class="idref" href="#v<sub>2</sub>:551"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="f:552" class="idref" href="#f:552"><span class="id" title="binder">f</span></a> <a id="x:553" class="idref" href="#x:553"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:554" class="idref" href="#t<sub>1</sub>:554"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="H:555" class="idref" href="#H:555"><span class="id" title="binder">H</span></a> <a id="Q:556" class="idref" href="#Q:556"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#v<sub>1</sub>:550"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:552"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:553"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:554"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:553"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:551"><span class="id" title="variable">v<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#f:552"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:550"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:554"><span class="id" title="variable">t<sub>1</sub></span></a>)) <a class="idref" href="Nondet.html#H:555"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:556"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:550"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:551"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#H:555"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:556"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">E</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_app_fix"><span class="id" title="lemma">evalns_app_fix</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplens_let" class="idref" href="#triplens_let"><span class="id" title="lemma">triplens_let</span></a> : <span class="id" title="keyword">∀</span> <a id="x:557" class="idref" href="#x:557"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:558" class="idref" href="#t<sub>1</sub>:558"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:559" class="idref" href="#t<sub>2</sub>:559"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="H:560" class="idref" href="#H:560"><span class="id" title="binder">H</span></a> <a id="Q:561" class="idref" href="#Q:561"><span class="id" title="binder">Q</span></a> <a id="Q<sub>1</sub>:562" class="idref" href="#Q<sub>1</sub>:562"><span class="id" title="binder">Q<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:558"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#H:560"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q<sub>1</sub>:562"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="v<sub>1</sub>:563" class="idref" href="#v<sub>1</sub>:563"><span class="id" title="binder">v<sub>1</sub></span></a>, <a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:557"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:563"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:559"><span class="id" title="variable">t<sub>2</sub></span></a>) (<a class="idref" href="Nondet.html#Q<sub>1</sub>:562"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:563"><span class="id" title="variable">v<sub>1</sub></span></a>) <a class="idref" href="Nondet.html#Q:561"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Nondet.html#x:557"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:558"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:559"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#H:560"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:561"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="var">M<sub>2</sub></span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_let"><span class="id" title="axiom">evalns_let</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K'</span>. <span class="id" title="var">applys</span>* <span class="id" title="var">M<sub>2</sub></span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplens_if" class="idref" href="#triplens_if"><span class="id" title="lemma">triplens_if</span></a> : <span class="id" title="keyword">∀</span> (<a id="b:564" class="idref" href="#b:564"><span class="id" title="binder">b</span></a>:<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) <a id="t<sub>1</sub>:565" class="idref" href="#t<sub>1</sub>:565"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:566" class="idref" href="#t<sub>2</sub>:566"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="H:567" class="idref" href="#H:567"><span class="id" title="binder">H</span></a> <a id="Q:568" class="idref" href="#Q:568"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> (<span class="id" title="keyword">if</span> <a class="idref" href="Nondet.html#b:564"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Nondet.html#t<sub>1</sub>:565"><span class="id" title="variable">t<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Nondet.html#t<sub>2</sub>:566"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#H:567"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:568"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> (<a class="idref" href="LibSepReference.html#trm_if"><span class="id" title="constructor">trm_if</span></a> <a class="idref" href="Nondet.html#b:564"><span class="id" title="variable">b</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:565"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:566"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#H:567"><span class="id" title="variable">H</span></a> <a class="idref" href="Nondet.html#Q:568"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M<sub>1</sub></span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_if"><span class="id" title="lemma">evalns_if</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The evaluation rules for primitive operations are proved in a way that is
    extremely similar to the proofs used for the big-step case, i.e., to the
    proofs establishing the reasoning rules for <span class="inlinecode"><span class="id" title="var">hoaren</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triplens_add" class="idref" href="#triplens_add"><span class="id" title="lemma">triplens_add</span></a> : <span class="id" title="keyword">∀</span> <a id="H:569" class="idref" href="#H:569"><span class="id" title="binder">H</span></a> <a id="n<sub>1</sub>:570" class="idref" href="#n<sub>1</sub>:570"><span class="id" title="binder">n<sub>1</sub></span></a> <a id="n<sub>2</sub>:571" class="idref" href="#n<sub>2</sub>:571"><span class="id" title="binder">n<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> (<a class="idref" href="LibSepReference.html#val_add"><span class="id" title="constructor">val_add</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:570"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="Nondet.html#n<sub>2</sub>:571"><span class="id" title="variable">n<sub>2</sub></span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#H:569"><span class="id" title="variable">H</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="r:572" class="idref" href="#r:572"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:572"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> (<a class="idref" href="Nondet.html#n<sub>1</sub>:570"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="Nondet.html#n<sub>2</sub>:571"><span class="id" title="variable">n<sub>2</sub></span></a>)<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:569"><span class="id" title="variable">H</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">constructors</span>*. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">R</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>. <span class="id" title="tactic">rewrite</span>¬<a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_hpure_l"><span class="id" title="lemma">hstar_hpure_l</span></a>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplens_rand" class="idref" href="#triplens_rand"><span class="id" title="lemma">triplens_rand</span></a> : <span class="id" title="keyword">∀</span> <a id="n:573" class="idref" href="#n:573"><span class="id" title="binder">n</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#n:573"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;</span> 0 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> (<a class="idref" href="LibSepReference.html#val_rand"><span class="id" title="constructor">val_rand</span></a> <a class="idref" href="Nondet.html#n:573"><span class="id" title="variable">n</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#0a700e54c124035039013e87e1a2bcaa"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="r:574" class="idref" href="#r:574"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="n<sub>1</sub>:575" class="idref" href="#n<sub>1</sub>:575"><span class="id" title="binder">n<sub>1</sub></span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a>0 <span class="id" title="notation">≤</span> <a class="idref" href="Nondet.html#n<sub>1</sub>:575"><span class="id" title="variable">n<sub>1</sub></span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="Nondet.html#n:573"><span class="id" title="variable">n</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:574"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Nondet.html#n<sub>1</sub>:575"><span class="id" title="variable">n<sub>1</sub></span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">N</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">K</span>. <span class="id" title="var">lets</span> <span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hempty_inv"><span class="id" title="lemma">hempty_inv</span></a> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_rand"><span class="id" title="constructor">step_rand</span></a> 0. <span class="id" title="var">math</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">R</span>; <span class="id" title="var">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hexists_intro"><span class="id" title="lemma">hexists_intro</span></a> <span class="id" title="var">n<sub>1</sub></span>. <span class="id" title="tactic">rewrite</span>¬<a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_hpure_l"><span class="id" title="lemma">hstar_hpure_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>¬. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#SepSimplArgs.hpure_intro"><span class="id" title="lemma">hpure_intro</span></a>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplens_ref" class="idref" href="#triplens_ref"><span class="id" title="lemma">triplens_ref</span></a> : <span class="id" title="keyword">∀</span> <a id="H:576" class="idref" href="#H:576"><span class="id" title="binder">H</span></a> <a id="v:577" class="idref" href="#v:577"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Nondet.html#v:577"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#H:576"><span class="id" title="variable">H</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="r:578" class="idref" href="#r:578"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="p:579" class="idref" href="#p:579"><span class="id" title="binder">p</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:578"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:579"><span class="id" title="variable">p</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#p:579"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:577"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:576"><span class="id" title="variable">H</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_conseq"><span class="id" title="lemma">evalns_conseq</span></a>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_ref"><span class="id" title="lemma">evalns_ref</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">r</span>. <span class="id" title="var">xpull</span>. <span class="id" title="tactic">intros</span> ? →. <span class="id" title="var">xsimpl</span>*. <span class="id" title="tactic">intros</span> ? →. <span class="id" title="tactic">auto</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplens_get" class="idref" href="#triplens_get"><span class="id" title="lemma">triplens_get</span></a> : <span class="id" title="keyword">∀</span> <a id="H:580" class="idref" href="#H:580"><span class="id" title="binder">H</span></a> <a id="v:581" class="idref" href="#v:581"><span class="id" title="binder">v</span></a> <a id="p:582" class="idref" href="#p:582"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> (<a class="idref" href="LibSepReference.html#val_get"><span class="id" title="constructor">val_get</span></a> <a class="idref" href="Nondet.html#p:582"><span class="id" title="variable">p</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:582"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:581"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:580"><span class="id" title="variable">H</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="r:583" class="idref" href="#r:583"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:583"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Nondet.html#v:581"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:582"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:581"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:580"><span class="id" title="variable">H</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">K</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">K</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">s<sub>1</sub></span>&amp;<span class="id" title="var">s<sub>2</sub></span>&amp;<span class="id" title="var">P<sub>1</sub></span>&amp;<span class="id" title="var">P<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">U</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">E<sub>1</sub></span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hsingle_inv"><span class="id" title="lemma">hsingle_inv</span></a> <span class="id" title="var">P<sub>1</sub></span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">s</span> <span class="id" title="var">s<sub>1</sub></span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_get"><span class="id" title="constructor">step_get</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#indom_union_l"><span class="id" title="lemma">indom_union_l</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">R</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span>¬<a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_hpure_l"><span class="id" title="lemma">hstar_hpure_l</span></a>. <span class="id" title="tactic">split</span>¬.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepFmap.html#read_union_l"><span class="id" title="lemma">read_union_l</span></a>. { <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepFmap.html#read_single"><span class="id" title="lemma">read_single</span></a>. } { <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplens_set" class="idref" href="#triplens_set"><span class="id" title="lemma">triplens_set</span></a> : <span class="id" title="keyword">∀</span> <a id="H:584" class="idref" href="#H:584"><span class="id" title="binder">H</span></a> <a id="w:585" class="idref" href="#w:585"><span class="id" title="binder">w</span></a> <a id="p:586" class="idref" href="#p:586"><span class="id" title="binder">p</span></a> <a id="v:587" class="idref" href="#v:587"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> (<a class="idref" href="LibSepReference.html#val_set"><span class="id" title="constructor">val_set</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:586"><span class="id" title="variable">p</span></a>) <a class="idref" href="Nondet.html#v:587"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:586"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#w:585"><span class="id" title="variable">w</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:584"><span class="id" title="variable">H</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="r:588" class="idref" href="#r:588"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:588"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:586"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:587"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:584"><span class="id" title="variable">H</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">K</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">K</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">s<sub>1</sub></span>&amp;<span class="id" title="var">s<sub>2</sub></span>&amp;<span class="id" title="var">P<sub>1</sub></span>&amp;<span class="id" title="var">P<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">U</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">E<sub>1</sub></span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hsingle_inv"><span class="id" title="lemma">hsingle_inv</span></a> <span class="id" title="var">P<sub>1</sub></span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">s</span> <span class="id" title="var">s<sub>1</sub></span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_set"><span class="id" title="constructor">step_set</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#indom_union_l"><span class="id" title="lemma">indom_union_l</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">R</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_hpure_l"><span class="id" title="lemma">hstar_hpure_l</span></a>. <span class="id" title="tactic">split</span>¬.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepFmap.html#update_union_l"><span class="id" title="lemma">update_union_l</span></a>; [| <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepFmap.html#update_single"><span class="id" title="lemma">update_single</span></a>. <span class="id" title="var">applys</span>¬<a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>¬<a class="idref" href="LibSepReference.html#SepSimplArgs.hsingle_intro"><span class="id" title="lemma">hsingle_intro</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepFmap.html#disjoint_single_set"><span class="id" title="lemma">disjoint_single_set</span></a>. } } }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="triplens_free" class="idref" href="#triplens_free"><span class="id" title="lemma">triplens_free</span></a> : <span class="id" title="keyword">∀</span> <a id="H:589" class="idref" href="#H:589"><span class="id" title="binder">H</span></a> <a id="p:590" class="idref" href="#p:590"><span class="id" title="binder">p</span></a> <a id="v:591" class="idref" href="#v:591"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> (<a class="idref" href="LibSepReference.html#val_free"><span class="id" title="constructor">val_free</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:590"><span class="id" title="variable">p</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:590"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:591"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:589"><span class="id" title="variable">H</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="r:592" class="idref" href="#r:592"><span class="id" title="binder">r</span></a> ⇒ <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Nondet.html#r:592"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:589"><span class="id" title="variable">H</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">K</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">K</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">s<sub>1</sub></span>&amp;<span class="id" title="var">s<sub>2</sub></span>&amp;<span class="id" title="var">P<sub>1</sub></span>&amp;<span class="id" title="var">P<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">U</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">E<sub>1</sub></span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hsingle_inv"><span class="id" title="lemma">hsingle_inv</span></a> <span class="id" title="var">P<sub>1</sub></span>. <span class="id" title="tactic">subst</span> <span class="id" title="var">s</span> <span class="id" title="var">s<sub>1</sub></span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_free"><span class="id" title="constructor">step_free</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#indom_union_l"><span class="id" title="lemma">indom_union_l</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">R</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_hpure_l"><span class="id" title="lemma">hstar_hpure_l</span></a>. <span class="id" title="tactic">split</span>¬.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepFmap.html#remove_union_single_l"><span class="id" title="lemma">remove_union_single_l</span></a>. { <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">N'</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#disjoint_inv_not_indom_both"><span class="id" title="lemma">disjoint_inv_not_indom_both</span></a> <span class="id" title="var">D</span> <span class="id" title="var">N'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#indom_single"><span class="id" title="lemma">indom_single</span></a>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab473"></a><h2 class="section">Weakest-Precondition for Small-Step Semantics.</h2>

<div class="paragraph"> </div>

 The definition of <span class="inlinecode"><span class="id" title="var">wpn</span></span> can be adpated to use <span class="inlinecode"><span class="id" title="var">evalns</span></span> instead of <span class="inlinecode"><span class="id" title="var">evaln</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="wpns" class="idref" href="#wpns"><span class="id" title="definition">wpns</span></a> (<a id="t:593" class="idref" href="#t:593"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) (<a id="Q:594" class="idref" href="#Q:594"><span class="id" title="binder">Q</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="s:595" class="idref" href="#s:595"><span class="id" title="binder">s</span></a> ⇒ <a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:595"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:593"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:594"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
Structural rules 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="wpns_frame" class="idref" href="#wpns_frame"><span class="id" title="lemma">wpns_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="t:596" class="idref" href="#t:596"><span class="id" title="binder">t</span></a> <a id="H:597" class="idref" href="#H:597"><span class="id" title="binder">H</span></a> <a id="Q:598" class="idref" href="#Q:598"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> <a class="idref" href="Nondet.html#t:596"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:598"><span class="id" title="variable">Q</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Nondet.html#H:597"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> <a class="idref" href="Nondet.html#t:596"><span class="id" title="variable">t</span></a> (<a class="idref" href="Nondet.html#Q:598"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Nondet.html#H:597"><span class="id" title="variable">H</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">HF</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">M<sub>2</sub></span>&amp;<span class="id" title="var">MD</span>&amp;<span class="id" title="var">MU</span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_inv"><span class="id" title="lemma">hstar_inv</span></a> (<span class="id" title="definition">rm</span> <span class="id" title="var">HF</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_conseq"><span class="id" title="lemma">evalns_conseq</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_frame"><span class="id" title="lemma">evalns_frame</span></a> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="var">MD</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">xsimpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h'</span> →. <span class="id" title="var">applys</span> <span class="id" title="var">M<sub>2</sub></span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpns_conseq" class="idref" href="#wpns_conseq"><span class="id" title="lemma">wpns_conseq</span></a> : <span class="id" title="keyword">∀</span> <a id="t:599" class="idref" href="#t:599"><span class="id" title="binder">t</span></a> <a id="Q<sub>1</sub>:600" class="idref" href="#Q<sub>1</sub>:600"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:601" class="idref" href="#Q<sub>2</sub>:601"><span class="id" title="binder">Q<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q<sub>1</sub>:600"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Nondet.html#Q<sub>2</sub>:601"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> <a class="idref" href="Nondet.html#t:599"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q<sub>1</sub>:600"><span class="id" title="variable">Q<sub>1</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> <a class="idref" href="Nondet.html#t:599"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q<sub>2</sub>:601"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">W</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Nondet.html#wpn"><span class="id" title="definition">wpn</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_conseq"><span class="id" title="lemma">evalns_conseq</span></a> <span class="id" title="var">K</span> <span class="id" title="var">W</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpns_ramified" class="idref" href="#wpns_ramified"><span class="id" title="lemma">wpns_ramified</span></a> : <span class="id" title="keyword">∀</span> <a id="t:602" class="idref" href="#t:602"><span class="id" title="binder">t</span></a> <a id="Q<sub>1</sub>:603" class="idref" href="#Q<sub>1</sub>:603"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:604" class="idref" href="#Q<sub>2</sub>:604"><span class="id" title="binder">Q<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> <a class="idref" href="Nondet.html#t:602"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q<sub>1</sub>:603"><span class="id" title="variable">Q<sub>1</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#Q<sub>1</sub>:603"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#5609a52f091556b9923d5758aa61f543"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span></a> <a class="idref" href="Nondet.html#Q<sub>2</sub>:604"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> <a class="idref" href="Nondet.html#t:602"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q<sub>2</sub>:604"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_trans"><span class="id" title="lemma">himpl_trans</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#wpns_frame"><span class="id" title="lemma">wpns_frame</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#wpns_conseq"><span class="id" title="lemma">wpns_conseq</span></a>. <span class="id" title="var">xsimpl</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Rules for term constructs 
</div>
<div class="code">

<span class="id" title="keyword">Section</span> <a id="WpnsRules" class="idref" href="#WpnsRules"><span class="id" title="section">WpnsRules</span></a>.<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="Nondet.html#step"><span class="id" title="inductive">step</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpns_val" class="idref" href="#wpns_val"><span class="id" title="lemma">wpns_val</span></a> : <span class="id" title="keyword">∀</span> <a id="v:605" class="idref" href="#v:605"><span class="id" title="binder">v</span></a> <a id="Q:606" class="idref" href="#Q:606"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q:606"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#v:605"><span class="id" title="variable">v</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> (<a class="idref" href="LibSepReference.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Nondet.html#v:605"><span class="id" title="variable">v</span></a>) <a class="idref" href="Nondet.html#Q:606"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpns_fix" class="idref" href="#wpns_fix"><span class="id" title="lemma">wpns_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="f:607" class="idref" href="#f:607"><span class="id" title="binder">f</span></a> <a id="x:608" class="idref" href="#x:608"><span class="id" title="binder">x</span></a> <a id="t:609" class="idref" href="#t:609"><span class="id" title="binder">t</span></a> <a id="Q:610" class="idref" href="#Q:610"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#Q:610"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:607"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:608"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t:609"><span class="id" title="variable">t</span></a>) <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> (<a class="idref" href="LibSepReference.html#trm_fix"><span class="id" title="constructor">trm_fix</span></a> <a class="idref" href="Nondet.html#f:607"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:608"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t:609"><span class="id" title="variable">t</span></a>) <a class="idref" href="Nondet.html#Q:610"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_fix"><span class="id" title="lemma">evalns_fix</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpns_app_fix" class="idref" href="#wpns_app_fix"><span class="id" title="lemma">wpns_app_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="f:611" class="idref" href="#f:611"><span class="id" title="binder">f</span></a> <a id="x:612" class="idref" href="#x:612"><span class="id" title="binder">x</span></a> <a id="v<sub>1</sub>:613" class="idref" href="#v<sub>1</sub>:613"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:614" class="idref" href="#v<sub>2</sub>:614"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="t<sub>1</sub>:615" class="idref" href="#t<sub>1</sub>:615"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="Q:616" class="idref" href="#Q:616"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#v<sub>1</sub>:613"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Nondet.html#f:611"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#x:612"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:615"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:612"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:614"><span class="id" title="variable">v<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#f:611"><span class="id" title="variable">f</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:613"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:615"><span class="id" title="variable">t<sub>1</sub></span></a>)) <a class="idref" href="Nondet.html#Q:616"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:613"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Nondet.html#v<sub>2</sub>:614"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:616"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_app_fix"><span class="id" title="lemma">evalns_app_fix</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpns_let" class="idref" href="#wpns_let"><span class="id" title="lemma">wpns_let</span></a> : <span class="id" title="keyword">∀</span> <a id="x:617" class="idref" href="#x:617"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:618" class="idref" href="#t<sub>1</sub>:618"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:619" class="idref" href="#t<sub>2</sub>:619"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="Q:620" class="idref" href="#Q:620"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:618"><span class="id" title="variable">t<sub>1</sub></span></a> (<span class="id" title="keyword">fun</span> <a id="v:621" class="idref" href="#v:621"><span class="id" title="binder">v</span></a> ⇒ <a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Nondet.html#x:617"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#v:621"><span class="id" title="variable">v</span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:619"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:620"><span class="id" title="variable">Q</span></a>)<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Nondet.html#x:617"><span class="id" title="variable">x</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:618"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:619"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:620"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_let"><span class="id" title="axiom">evalns_let</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpns_if" class="idref" href="#wpns_if"><span class="id" title="lemma">wpns_if</span></a> : <span class="id" title="keyword">∀</span> <a id="b:622" class="idref" href="#b:622"><span class="id" title="binder">b</span></a> <a id="t<sub>1</sub>:623" class="idref" href="#t<sub>1</sub>:623"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:624" class="idref" href="#t<sub>2</sub>:624"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="Q:625" class="idref" href="#Q:625"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> (<span class="id" title="keyword">if</span> <a class="idref" href="Nondet.html#b:622"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Nondet.html#t<sub>1</sub>:623"><span class="id" title="variable">t<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Nondet.html#t<sub>2</sub>:624"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:625"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> (<a class="idref" href="LibSepReference.html#trm_if"><span class="id" title="constructor">trm_if</span></a> <a class="idref" href="Nondet.html#b:622"><span class="id" title="variable">b</span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:623"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:624"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Nondet.html#Q:625"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_if"><span class="id" title="lemma">evalns_if</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Rules for primitives. We state their specifications following the
    presentation described near the end of chapter <a href="Wand.html"><span class="inlineref">Wand</span></a>. 
</div>
<div class="code">

<span class="comment">(*<br/>
Lemma&nbsp;wpns_add&nbsp;:&nbsp;forall&nbsp;Q&nbsp;n<sub>1</sub>&nbsp;n<sub>2</sub>,<br/>
&nbsp;&nbsp;(Q&nbsp;(val_int&nbsp;(n<sub>1</sub>&nbsp;+&nbsp;n<sub>2</sub>)))&nbsp;==&gt;&nbsp;wpns&nbsp;(val_add&nbsp;(val_int&nbsp;n<sub>1</sub>)&nbsp;(val_int&nbsp;n<sub>2</sub>))&nbsp;Q.<br/>
Proof&nbsp;using.<br/>
&nbsp;&nbsp;unfolds&nbsp;wpns.&nbsp;intros.&nbsp;intros&nbsp;h&nbsp;K.&nbsp;applys*&nbsp;evaln_add.<br/>
Qed.<br/>
<br/>
Lemma&nbsp;wpns_rand&nbsp;:&nbsp;forall&nbsp;Q&nbsp;n,<br/>
&nbsp;&nbsp;n&nbsp;&gt;&nbsp;0&nbsp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(\forall&nbsp;n<sub>1</sub>,&nbsp;\<span class="inlinecode">0</span> <span class="inlinecode">≤</span> <span class="inlinecode"><span class="id" title="var">n<sub>1</sub></span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">n</span></span>&nbsp;<span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span>&nbsp;Q&nbsp;(val_int&nbsp;n<sub>1</sub>))<br/>
&nbsp;&nbsp;==&gt;&nbsp;wpns&nbsp;(val_rand&nbsp;(val_int&nbsp;n))&nbsp;Q.<br/>
Proof&nbsp;using.<br/>
&nbsp;&nbsp;unfolds&nbsp;wpns.&nbsp;introv&nbsp;N.&nbsp;xsimpl.&nbsp;intros&nbsp;h&nbsp;K.<br/>
&nbsp;&nbsp;applys*&nbsp;evaln_rand.&nbsp;intros&nbsp;n<sub>1</sub>&nbsp;H<sub>1</sub>.&nbsp;lets&nbsp;K':&nbsp;hforall_inv&nbsp;K&nbsp;n<sub>1</sub>.<br/>
&nbsp;&nbsp;rewrite*&nbsp;hwand_hpure_l&nbsp;in&nbsp;K'.<br/>
Qed.<br/>
TODO:<br/>
*)</span><br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;TODO:&nbsp;move&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="hwand_elim" class="idref" href="#hwand_elim"><span class="id" title="lemma">hwand_elim</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:626" class="idref" href="#H<sub>1</sub>:626"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:627" class="idref" href="#H<sub>2</sub>:627"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="h:628" class="idref" href="#h:628"><span class="id" title="binder">h</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#H<sub>1</sub>:626"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Nondet.html#H<sub>2</sub>:627"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="h<sub>1</sub>:629" class="idref" href="#h<sub>1</sub>:629"><span class="id" title="binder">h<sub>1</sub></span></a>, <a class="idref" href="LibSepReference.html#Fmap.disjoint"><span class="id" title="definition">Fmap.disjoint</span></a> <a class="idref" href="Nondet.html#h:628"><span class="id" title="variable">h</span></a> <a class="idref" href="Nondet.html#h<sub>1</sub>:629"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Nondet.html#H<sub>1</sub>:626"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Nondet.html#h<sub>1</sub>:629"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Nondet.html#H<sub>2</sub>:627"><span class="id" title="variable">H<sub>2</sub></span></a> (<a class="idref" href="Nondet.html#h<sub>1</sub>:629"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <a class="idref" href="Nondet.html#h:628"><span class="id" title="variable">h</span></a>)<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">lets</span> (<span class="id" title="var">R</span>&amp;<span class="id" title="var">_</span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hwand_equiv"><span class="id" title="lemma">hwand_equiv</span></a> (<span class="id" title="notation">=</span><span class="id" title="var">h</span>) <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">forwards</span> <span class="id" title="var">N</span>: <span class="id" title="var">R</span>. { <span class="id" title="tactic">intros</span> ? →. <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">Hh<sub>1</sub></span> <span class="id" title="var">D</span>. <span class="id" title="var">applys</span> <span class="id" title="var">N</span>. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="evalns_ref'" class="idref" href="#evalns_ref'"><span class="id" title="lemma">evalns_ref'</span></a> : <span class="id" title="keyword">∀</span> <a id="Q:630" class="idref" href="#Q:630"><span class="id" title="binder">Q</span></a> <a id="v:631" class="idref" href="#v:631"><span class="id" title="binder">v</span></a> <a id="s:632" class="idref" href="#s:632"><span class="id" title="binder">s</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">(\</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">∀</span></a> <a id="p:633" class="idref" href="#p:633"><span class="id" title="binder">p</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="Nondet.html#p:633"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:631"><span class="id" title="variable">v</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Nondet.html#Q:630"><span class="id" title="variable">Q</span></a> <a class="idref" href="Nondet.html#p:633"><span class="id" title="variable">p</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:632"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Nondet.html#v:631"><span class="id" title="variable">v</span></a>) <a class="idref" href="Nondet.html#Q:630"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">forwards</span>¬(<span class="id" title="var">p</span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">N</span>): (<a class="idref" href="LibSepFmap.html#exists_fresh"><span class="id" title="lemma">exists_fresh</span></a> <a class="idref" href="LibSepReference.html#null"><span class="id" title="definition">null</span></a> <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">esplit</span>. <span class="id" title="tactic">∃</span> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <span class="id" title="var">p</span>). <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_ref"><span class="id" title="constructor">step_ref</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">R</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hforall_specialize"><span class="id" title="lemma">hforall_specialize</span></a> <span class="id" title="var">p</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="LibSepFmap.html#update"><span class="id" title="definition">update</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#hwand_elim"><span class="id" title="lemma">hwand_elim</span></a> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="LibSepFmap.html#disjoint_sym"><span class="id" title="lemma">disjoint_sym</span></a>. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.disjoint_single_of_not_indom"><span class="id" title="lemma">Fmap.disjoint_single_of_not_indom</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hsingle_intro"><span class="id" title="lemma">hsingle_intro</span></a>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpns_ref'" class="idref" href="#wpns_ref'"><span class="id" title="lemma">wpns_ref'</span></a> : <span class="id" title="keyword">∀</span> <a id="Q:634" class="idref" href="#Q:634"><span class="id" title="binder">Q</span></a> <a id="v:635" class="idref" href="#v:635"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">∀</span></a> <a id="p:636" class="idref" href="#p:636"><span class="id" title="binder">p</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:636"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:635"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Nondet.html#Q:634"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:636"><span class="id" title="variable">p</span></a>)<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Nondet.html#v:635"><span class="id" title="variable">v</span></a>) <a class="idref" href="Nondet.html#Q:634"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_ref'"><span class="id" title="lemma">evalns_ref'</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wpns_ref" class="idref" href="#wpns_ref"><span class="id" title="lemma">wpns_ref</span></a> : <span class="id" title="keyword">∀</span> <a id="Q:637" class="idref" href="#Q:637"><span class="id" title="binder">Q</span></a> <a id="v:638" class="idref" href="#v:638"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">∀</span></a> <a id="p:639" class="idref" href="#p:639"><span class="id" title="binder">p</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Nondet.html#p:639"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Nondet.html#v:638"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Nondet.html#Q:637"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Nondet.html#p:639"><span class="id" title="variable">p</span></a>)<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Nondet.html#v:638"><span class="id" title="variable">v</span></a>) <a class="idref" href="Nondet.html#Q:637"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">unfolds</span> <a class="idref" href="Nondet.html#wpns"><span class="id" title="definition">wpns</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_conseq"><span class="id" title="lemma">evalns_conseq</span></a>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_ref"><span class="id" title="lemma">evalns_ref</span></a>. <span class="id" title="var">xpull</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? <span class="id" title="var">p</span> →. <span class="id" title="var">lets</span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hforall_specialize"><span class="id" title="lemma">hforall_specialize</span></a> <span class="id" title="var">p</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="LibSepReference.html#SepSimplArgs.hwand_equiv"><span class="id" title="lemma">hwand_equiv</span></a>. <span class="id" title="tactic">intros</span> ? →. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;TODO<br/>
Lemma&nbsp;wpns_get&nbsp;:&nbsp;forall&nbsp;v&nbsp;p&nbsp;Q,<br/>
&nbsp;&nbsp;(p&nbsp;~~&gt;&nbsp;v)&nbsp;<span class='gray-font'>\</span>*&nbsp;(p&nbsp;~~&gt;&nbsp;v&nbsp;<span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span>&nbsp;Q&nbsp;v)&nbsp;==&gt;&nbsp;wpns&nbsp;(val_get&nbsp;p)&nbsp;Q.<br/>
Proof&nbsp;using.<br/>
&nbsp;&nbsp;unfolds&nbsp;wpns.&nbsp;intros.&nbsp;intros&nbsp;h&nbsp;K.<br/>
&nbsp;&nbsp;lets&nbsp;(h<sub>1</sub>&amp;h<sub>2</sub>&amp;P<sub>1</sub>&amp;P<sub>2</sub>&amp;D&amp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>):&nbsp;hstar_inv&nbsp;(rm&nbsp;K).<br/>
&nbsp;&nbsp;forwards*:&nbsp;hwand_inv&nbsp;h<sub>1</sub>&nbsp;P<sub>2</sub>.<br/>
&nbsp;&nbsp;lets&nbsp;E<sub>1</sub>:&nbsp;hsingle_inv&nbsp;P<sub>1</sub>.&nbsp;lets&nbsp;I<sub>1</sub>:&nbsp;indom_single&nbsp;p&nbsp;v.<br/>
&nbsp;&nbsp;applys&nbsp;evaln_get.<br/>
&nbsp;&nbsp;{&nbsp;applys*&nbsp;Fmap.indom_union_l.&nbsp;subst.&nbsp;applys&nbsp;indom_single.&nbsp;}<br/>
&nbsp;&nbsp;{&nbsp;subst&nbsp;h<sub>1</sub>.&nbsp;rewrite*&nbsp;Fmap.read_union_l.&nbsp;rewrite*&nbsp;Fmap.read_single.&nbsp;}<br/>
Qed.<br/>
<br/>
Lemma&nbsp;wpns_set&nbsp;:&nbsp;forall&nbsp;v&nbsp;w&nbsp;p&nbsp;Q,<br/>
&nbsp;&nbsp;(p&nbsp;~~&gt;&nbsp;v)&nbsp;<span class='gray-font'>\</span>*&nbsp;(p&nbsp;~~&gt;&nbsp;w&nbsp;<span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span>&nbsp;Q&nbsp;val_unit)&nbsp;==&gt;&nbsp;wpns&nbsp;(val_set&nbsp;p&nbsp;w)&nbsp;Q.<br/>
Proof&nbsp;using.<br/>
&nbsp;&nbsp;unfolds&nbsp;wpns.&nbsp;intros.&nbsp;intros&nbsp;h&nbsp;K.<br/>
&nbsp;&nbsp;lets&nbsp;(h<sub>1</sub>&amp;h<sub>2</sub>&amp;P<sub>1</sub>&amp;P<sub>2</sub>&amp;D&amp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>):&nbsp;hstar_inv&nbsp;(rm&nbsp;K).<br/>
&nbsp;&nbsp;lets&nbsp;E<sub>1</sub>:&nbsp;hsingle_inv&nbsp;P<sub>1</sub>.&nbsp;lets&nbsp;I<sub>1</sub>:&nbsp;indom_single&nbsp;p&nbsp;v.<br/>
&nbsp;&nbsp;forwards:&nbsp;hwand_inv&nbsp;(single&nbsp;p&nbsp;w)&nbsp;P<sub>2</sub>.<br/>
&nbsp;&nbsp;{&nbsp;applys&nbsp;hsingle_intro.&nbsp;}<br/>
&nbsp;&nbsp;{&nbsp;subst&nbsp;h<sub>1</sub>.&nbsp;applys&nbsp;Fmap.disjoint_single_set&nbsp;D.&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;applys&nbsp;evaln_set.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;applys*&nbsp;Fmap.indom_union_l.&nbsp;subst.&nbsp;applys&nbsp;indom_single.&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;subst&nbsp;h<sub>1</sub>.&nbsp;rewrite*&nbsp;Fmap.update_union_l.&nbsp;rewrite*&nbsp;update_single.&nbsp;}&nbsp;}<br/>
Qed.<br/>
<br/>
Lemma&nbsp;wpns_free&nbsp;:&nbsp;forall&nbsp;v&nbsp;p&nbsp;Q,<br/>
&nbsp;&nbsp;(p&nbsp;~~&gt;&nbsp;v)&nbsp;<span class='gray-font'>\</span>*&nbsp;(Q&nbsp;val_unit)&nbsp;==&gt;&nbsp;wpns&nbsp;(val_free&nbsp;p)&nbsp;Q.<br/>
Proof&nbsp;using.<br/>
&nbsp;&nbsp;unfolds&nbsp;wpns.&nbsp;intros.&nbsp;intros&nbsp;h&nbsp;K.<br/>
&nbsp;&nbsp;lets&nbsp;(h<sub>1</sub>&amp;h<sub>2</sub>&amp;P<sub>1</sub>&amp;P<sub>2</sub>&amp;D&amp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>):&nbsp;hstar_inv&nbsp;(rm&nbsp;K).<br/>
&nbsp;&nbsp;lets&nbsp;E<sub>1</sub>:&nbsp;hsingle_inv&nbsp;P<sub>1</sub>.&nbsp;lets&nbsp;I<sub>1</sub>:&nbsp;indom_single&nbsp;p&nbsp;v.<br/>
&nbsp;&nbsp;applys_eq&nbsp;evaln_free.<br/>
&nbsp;&nbsp;{&nbsp;applys*&nbsp;Fmap.indom_union_l.&nbsp;subst.&nbsp;applys&nbsp;indom_single.&nbsp;}<br/>
&nbsp;&nbsp;{&nbsp;subst&nbsp;h<sub>1</sub>.&nbsp;rewrite~&nbsp;Fmap.remove_union_single_l.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;intros&nbsp;Dl.&nbsp;applys*&nbsp;Fmap.disjoint_inv_not_indom_both&nbsp;D&nbsp;Dl.&nbsp;}<br/>
Qed.<br/>
<br/>
*)</span><br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="Nondet.html#WpnsRules"><span class="id" title="section">WpnsRules</span></a>.<br/>
</div>

<div class="doc">
<a id="lab474"></a><h2 class="section">Equivalence Between Non-Deterministic Small-Step and Big-Step Sem.</h2>

<div class="paragraph"> </div>

 We end this chapter with the proof of equivalence between <span class="inlinecode"><span class="id" title="var">triplens</span></span> and
    <span class="inlinecode"><span class="id" title="var">hoaren</span></span>, establishing a formal relationship between triples defined with
    respect to a small-step semantics and those defined with respect to a
    big-step semantics. 
<div class="paragraph"> </div>

 We start by establishing the equivalence between <span class="inlinecode"><span class="id" title="var">evalns</span></span> and <span class="inlinecode"><span class="id" title="var">evaln</span></span>.
    We focus first on the direction from <span class="inlinecode"><span class="id" title="var">evalns</span></span> to <span class="inlinecode"><span class="id" title="var">evaln</span></span>. 
<div class="paragraph"> </div>

 We begin with a key lemma: if a configuration <span class="inlinecode">(<span class="id" title="var">s<sub>1</sub></span>,<span class="id" title="var">t<sub>1</sub></span>)</span> takes a step to
    <span class="inlinecode">(<span class="id" title="var">s<sub>2</sub></span>,<span class="id" title="var">t<sub>2</sub></span>)</span>, then this first configuration admits the same postconditions
    as the second configuration. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evaln_of_step_and_evaln" class="idref" href="#evaln_of_step_and_evaln"><span class="id" title="lemma">evaln_of_step_and_evaln</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:640" class="idref" href="#s<sub>1</sub>:640"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="t<sub>1</sub>:641" class="idref" href="#t<sub>1</sub>:641"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="Q:642" class="idref" href="#Q:642"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="s<sub>2</sub>:643" class="idref" href="#s<sub>2</sub>:643"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="t<sub>2</sub>:644" class="idref" href="#t<sub>2</sub>:644"><span class="id" title="binder">t<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Nondet.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:640"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:641"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:643"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:644"><span class="id" title="variable">t<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="s<sub>2</sub>:645" class="idref" href="#s<sub>2</sub>:645"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="t<sub>2</sub>:646" class="idref" href="#t<sub>2</sub>:646"><span class="id" title="binder">t<sub>2</sub></span></a>, <a class="idref" href="Nondet.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:640"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:641"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:645"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:646"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:645"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Nondet.html#t<sub>2</sub>:646"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="Nondet.html#Q:642"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s<sub>1</sub>:640"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Nondet.html#t<sub>1</sub>:641"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Nondet.html#Q:642"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> (<span class="id" title="var">s<sub>2</sub></span>&amp;<span class="id" title="var">t<sub>2</sub></span>&amp;<span class="id" title="var">R<sub>1</sub></span>) <span class="id" title="var">RS</span>. <span class="id" title="var">gen</span> <span class="id" title="var">Q</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">R<sub>1</sub></span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_let"><span class="id" title="constructor">evaln_let</span></a> (<span class="id" title="keyword">fun</span> <a id="v<sub>1</sub>:649" class="idref" href="#v<sub>1</sub>:649"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="s<sub>2</sub>:650" class="idref" href="#s<sub>2</sub>:650"><span class="id" title="binder">s<sub>2</sub></span></a> ⇒ <a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s<sub>2</sub>:648"><span class="id" title="variable">s<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <span class="id" title="var">x</span> <a class="idref" href="Nondet.html#v<sub>1</sub>:647"><span class="id" title="variable">v<sub>1</sub></span></a> <span class="id" title="var">t<sub>2</sub></span>) <span class="id" title="var">Q</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <span class="id" title="var">IHR1</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">s1b</span> <span class="id" title="var">t1b</span> <span class="id" title="var">Kb</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">forwards</span> <span class="id" title="var">M</span>: <span class="id" title="var">RS</span>. { <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#step_let_ctx"><span class="id" title="constructor">step_let_ctx</span></a> <span class="id" title="var">Kb</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">inverts</span> <span class="id" title="var">M</span> <span class="id" title="keyword">as</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="var">M<sub>2</sub></span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_conseq"><span class="id" title="lemma">evaln_conseq</span></a> <span class="id" title="var">M<sub>1</sub></span>. <span class="id" title="var">applys</span> <span class="id" title="var">M<sub>2</sub></span>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">v<sub>1</sub></span> <span class="id" title="var">s'</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span> <span class="id" title="var">K</span>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_fix"><span class="id" title="constructor">evaln_fix</span></a>. <span class="id" title="var">forwards</span> <span class="id" title="var">M</span>: <span class="id" title="var">RS</span>. { <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#step_fix"><span class="id" title="constructor">step_fix</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">inverts</span>* <span class="id" title="var">M</span>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_app_fix"><span class="id" title="constructor">evaln_app_fix</span></a>. <span class="id" title="var">forwards</span> <span class="id" title="var">M</span>: <span class="id" title="var">RS</span>. { <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_app_fix"><span class="id" title="constructor">step_app_fix</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_if"><span class="id" title="constructor">evaln_if</span></a>. <span class="id" title="var">forwards</span> <span class="id" title="var">M</span>: <span class="id" title="var">RS</span>. { <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_if"><span class="id" title="constructor">step_if</span></a>. } { <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_let"><span class="id" title="constructor">evaln_let</span></a> (<span class="id" title="keyword">fun</span> <a id="v':653" class="idref" href="#v':653"><span class="id" title="binder">v'</span></a> <a id="s':654" class="idref" href="#s':654"><span class="id" title="binder">s'</span></a> ⇒ <a class="idref" href="Nondet.html#v':651"><span class="id" title="variable">v'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">v<sub>1</sub></span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Nondet.html#s':652"><span class="id" title="variable">s'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_val"><span class="id" title="constructor">evaln_val</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> ? ? (<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>&amp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>). <span class="id" title="var">forwards</span> <span class="id" title="var">M</span>: <span class="id" title="var">RS</span>. { <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_let"><span class="id" title="constructor">step_let</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. } } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_add"><span class="id" title="constructor">evaln_add</span></a>. <span class="id" title="var">forwards</span> <span class="id" title="var">M</span>: <span class="id" title="var">RS</span>. { <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_add"><span class="id" title="constructor">step_add</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">inverts</span>* <span class="id" title="var">M</span>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_rand"><span class="id" title="constructor">evaln_rand</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">math</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">n<sub>2</sub></span> <span class="id" title="var">N<sub>2</sub></span>. <span class="id" title="var">forwards</span> <span class="id" title="var">M</span>: <span class="id" title="var">RS</span>. { <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_rand"><span class="id" title="constructor">step_rand</span></a> <span class="id" title="var">n<sub>2</sub></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">inverts</span>* <span class="id" title="var">M</span>. } } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evaln_ref"><span class="id" title="constructor">evaln_ref</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p'</span> <span class="id" title="var">D</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">forwards</span> <span class="id" title="var">M</span>: <span class="id" title="var">RS</span> <span class="id" title="var">p'</span>. { <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_ref"><span class="id" title="constructor">step_ref</span></a>. } { <span class="id" title="var">inverts</span>* <span class="id" title="var">M</span>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_get"><span class="id" title="constructor">evaln_get</span></a>. <span class="id" title="var">forwards</span> <span class="id" title="var">M</span>: <span class="id" title="var">RS</span>. { <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_get"><span class="id" title="constructor">step_get</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">inverts</span>* <span class="id" title="var">M</span>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_set"><span class="id" title="constructor">evaln_set</span></a>. <span class="id" title="var">forwards</span> <span class="id" title="var">M</span>: <span class="id" title="var">RS</span>. { <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_set"><span class="id" title="constructor">step_set</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">inverts</span>* <span class="id" title="var">M</span>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_free"><span class="id" title="constructor">evaln_free</span></a>. <span class="id" title="var">forwards</span> <span class="id" title="var">M</span>: <span class="id" title="var">RS</span>. { <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_free"><span class="id" title="constructor">step_free</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">inverts</span>* <span class="id" title="var">M</span>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
By exploiting the above lemma over all the evals of an execution, we obtain
    the fact that <span class="inlinecode"><span class="id" title="var">evalns</span></span> implies <span class="inlinecode"><span class="id" title="var">evaln</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evaln_of_evalns" class="idref" href="#evaln_of_evalns"><span class="id" title="lemma">evaln_of_evalns</span></a> : <span class="id" title="keyword">∀</span> <a id="s:655" class="idref" href="#s:655"><span class="id" title="binder">s</span></a> <a id="t:656" class="idref" href="#t:656"><span class="id" title="binder">t</span></a> <a id="Q:657" class="idref" href="#Q:657"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:655"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:656"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:657"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:655"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:656"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:657"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_val"><span class="id" title="constructor">evaln_val</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_of_step_and_evaln"><span class="id" title="lemma">evaln_of_step_and_evaln</span></a>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Let's now turn to the second direction, from <span class="inlinecode"><span class="id" title="var">evaln</span></span> to <span class="inlinecode"><span class="id" title="var">evalns</span></span>.
    The proof is carried out by induction on the big-step relation. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evalns_of_evaln" class="idref" href="#evalns_of_evaln"><span class="id" title="lemma">evalns_of_evaln</span></a> : <span class="id" title="keyword">∀</span> <a id="s:658" class="idref" href="#s:658"><span class="id" title="binder">s</span></a> <a id="t:659" class="idref" href="#t:659"><span class="id" title="binder">t</span></a> <a id="Q:660" class="idref" href="#Q:660"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a> <a class="idref" href="Nondet.html#s:658"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:659"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:660"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="Nondet.html#s:658"><span class="id" title="variable">s</span></a> <a class="idref" href="Nondet.html#t:659"><span class="id" title="variable">t</span></a> <a class="idref" href="Nondet.html#Q:660"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#step_fix"><span class="id" title="constructor">step_fix</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rename</span> <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">E</span>. <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_app_fix"><span class="id" title="constructor">step_app_fix</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">invert</span> <span class="id" title="var">K</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [ <span class="id" title="tactic">intros</span>; <span class="id" title="var">false</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">introv</span> → → → → → <span class="id" title="var">R</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">E</span>. <span class="id" title="var">applys</span> <span class="id" title="var">IHM</span>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rename</span> <span class="id" title="var">M</span> <span class="id" title="var">into</span> <span class="id" title="var">M<sub>1</sub></span>, <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">M<sub>2</sub></span>, <span class="id" title="var">IHM</span> <span class="id" title="var">into</span> <span class="id" title="var">IHM1</span>, <span class="id" title="var">H<sub>0</sub></span> <span class="id" title="var">into</span> <span class="id" title="var">IHM2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">tests</span> <span class="id" title="var">C</span>: (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="v<sub>1</sub>:662" class="idref" href="#v<sub>1</sub>:662"><span class="id" title="binder">v<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">t<sub>1</sub></span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Nondet.html#v<sub>1</sub>:661"><span class="id" title="variable">v<sub>1</sub></span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">C</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">v<sub>1</sub></span>&amp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>). <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_let"><span class="id" title="constructor">step_let</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span> <span class="id" title="keyword">as</span> <span class="id" title="var">K<sub>1</sub></span> <span class="id" title="var">K<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">inverts</span> <span class="id" title="var">K<sub>1</sub></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">inverts</span> <span class="id" title="var">IHM1</span> <span class="id" title="keyword">as</span> <span class="id" title="var">K<sub>3</sub></span> <span class="id" title="var">K<sub>4</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <span class="id" title="var">IHM2</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">K<sub>3</sub></span> <span class="id" title="keyword">as</span> (?&amp;?&amp;<span class="id" title="var">K<sub>5</sub></span>). <span class="id" title="var">inverts</span> <span class="id" title="var">K<sub>5</sub></span>. } } } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">inverts</span> <span class="id" title="var">IHM1</span> <span class="id" title="keyword">as</span> <span class="id" title="var">K<sub>3</sub></span> <span class="id" title="var">K<sub>4</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">false</span>* <span class="id" title="var">C</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">K<sub>3</sub></span> <span class="id" title="keyword">as</span> (?&amp;?&amp;<span class="id" title="var">K<sub>5</sub></span>). <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_let_ctx"><span class="id" title="constructor">step_let_ctx</span></a>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span> <span class="id" title="keyword">as</span> <span class="id" title="var">K'</span>; [|<span class="id" title="var">false</span>* <span class="id" title="var">C</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">inverts</span> <span class="id" title="var">IHM1</span> <span class="id" title="keyword">as</span> <span class="id" title="var">K<sub>5</sub></span> <span class="id" title="var">K<sub>6</sub></span>; [<span class="id" title="var">false</span>* <span class="id" title="var">C</span>|].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specializes</span> <span class="id" title="var">K<sub>6</sub></span> <span class="id" title="var">K'</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_let"><span class="id" title="axiom">evalns_let</span></a>. } } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_if"><span class="id" title="constructor">step_if</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span> <span class="id" title="var">IHM</span>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_add"><span class="id" title="constructor">step_add</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_rand"><span class="id" title="constructor">step_rand</span></a> 0. <span class="id" title="var">math</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">forwards</span>¬(<span class="id" title="var">p</span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">N</span>): (<a class="idref" href="LibSepFmap.html#exists_fresh"><span class="id" title="lemma">exists_fresh</span></a> <a class="idref" href="LibSepReference.html#null"><span class="id" title="definition">null</span></a> <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_ref"><span class="id" title="constructor">step_ref</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_get"><span class="id" title="constructor">step_get</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_set"><span class="id" title="constructor">step_set</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Nondet.html#evalns_step"><span class="id" title="constructor">evalns_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#step_free"><span class="id" title="constructor">step_free</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_val"><span class="id" title="constructor">evalns_val</span></a>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Combining the two directions, we obtain the desired equivalence between
    the big-step and the small-step characterization of total correctness. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="evalns_eq_evalns" class="idref" href="#evalns_eq_evalns"><span class="id" title="lemma">evalns_eq_evalns</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#evalns"><span class="id" title="inductive">evalns</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Nondet.html#evaln"><span class="id" title="inductive">evaln</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">extens</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span> <span class="id" title="var">Q</span>. <span class="id" title="var">iff</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evaln_of_evalns"><span class="id" title="lemma">evaln_of_evalns</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Nondet.html#evalns_of_evaln"><span class="id" title="lemma">evalns_of_evaln</span></a>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
As immediate corollary, we obtain the equivalence between the big-step and
    the small-step characterization of Hoare triples, for the general case of
    a non-deterministic language. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="phoare_eq_triplens" class="idref" href="#phoare_eq_triplens"><span class="id" title="lemma">phoare_eq_triplens</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Nondet.html#hoaren"><span class="id" title="definition">hoaren</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Nondet.html#triplens"><span class="id" title="definition">triplens</span></a>, <a class="idref" href="Nondet.html#hoaren"><span class="id" title="definition">hoaren</span></a>. <span class="id" title="tactic">rewrite</span>* <a class="idref" href="Nondet.html#evalns_eq_evalns"><span class="id" title="lemma">evalns_eq_evalns</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab475"></a><h2 class="section">Historical Notes</h2>

<div class="paragraph"> </div>

 At a very low-level, one may view a piece of hardware as being totally
    deterministic: at each tick of the processor's clock, every hardware
    component makes a transition according to non-ambiguous rules. Yet,
    complex hardware architectures are not so deterministic. For example,
    on a multicore hardware, which of two concurrent writes reaches the
    memory first is, from the perspective of a program, essentially random.
    At a higher-level, interactions with the outside world, such as user
    input, can be seen as sources of non-determinism in a program semantics.

<div class="paragraph"> </div>

    Non-deterministic semantics may be harder to reason about than
    deterministic semantics. To tame that complexity, a semantics may be
    "determinized" by parameterizing it with a trace of events, each event
    reflecting one "choice" that was made during the execution. Reasoning
    about a determinized semantics equipped with traces may, depending on
    the context, be easier or carry more information than reasoning about
    a non-deterministic semantics. Reasoning about traces is, however,
    beyond the scope of this course.

<div class="paragraph"> </div>

    The predicates <span class="inlinecode"><span class="id" title="var">evaln</span></span> (big-step) first appeared in the paper entitled
    Axiomatic Semantics for Compiler Verification, by Steven Schäfer, Sigurd
    Schneider, and Gert Smolka (CPP'2016). This predicate, as well as <span class="inlinecode"><span class="id" title="var">evalns</span></span>
    (small-step) are exploited in the paper "Integration Verification Across
    Software and Hardware for a Simple Embedded System" (PLDI'21). The meta-
    theory of these judgments is described in details in the paper:
    "Omnisemantics: Smoother Handling of Nondeterminism" (2022) by Arthur
    Charguéraud, Adam Chlipala, Andres Erbsen, and Samuel Gruetter.
    <a href='http://www.chargueraud.org/research/2022/omnisemantics/omnisemantics.pdf'>http://www.chargueraud.org/research/2022/omnisemantics/omnisemantics.pdf</a>
</div>
<div class="code">

<span class="comment">(*&nbsp;2023-11-14&nbsp;18:37&nbsp;*)</span><br/>
</div>
</div>

<div id="footer">
<hr/><a href="coqindex.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>