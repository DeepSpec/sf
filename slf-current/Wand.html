<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="common/css/sf.css" rel="stylesheet" type="text/css" />
<title>Wand: The Magic Wand and Other Operators</title>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/slf.css" rel="stylesheet" type="text/css"/>
</head>

<body>

<div id="page">

<div id="header">
<div id='logoinheader'><a href='https://softwarefoundations.cis.upenn.edu'>
<img src='common/media/image/sf_logo_sm.png' alt='Software Foundations Logo'></a></div>
<div class='booktitleinheader'><a href='index.html'>Volume 6: Separation Logic Foundations</a></div>
<ul id='menu'>
   <li class='section_name'><a href='toc.html'>Table of Contents</a></li>
   <li class='section_name'><a href='coqindex.html'>Index</a></li>
   <li class='section_name'><a href='deps.html'>Roadmap</a></li>
</ul>
</div>

<div id="main">

<h1 class="libtitle">Wand<span class="subtitle">The Magic Wand and Other Operators</span></h1>


<div class="code">

<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">SLF</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="LibSepReference.html#"><span class="id" title="library">LibSepReference</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">SLF</span> <span class="id" title="keyword">Require</span> <a class="idref" href="Repr.html#"><span class="id" title="library">Repr</span></a>.<br/>
<span class="id" title="keyword">Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">trm_scope</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">h</span> : <a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> : <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">H</span> : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">Q</span> : <a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>.<br/>
</div>

<div class="doc">
<a id="lab238"></a><h1 class="section">First Pass</h1>

<div class="paragraph"> </div>

 This chapter presents some additional Separation Logic operators:

<div class="paragraph"> </div>

<ul class="doclist">
<li> the disjunction, written <span class="inlinecode"><span class="id" title="var">hor</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>,

</li>
<li> the non-separating conjunction, written <span class="inlinecode"><span class="id" title="var">hand</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>,

</li>
<li> the "forall", named <span class="inlinecode"><span class="id" title="var">hforall</span></span> and written <span class="inlinecode">\<span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode"><span class="id" title="var">H</span></span>,

</li>
<li> the "magic wand", named <span class="inlinecode"><span class="id" title="var">hwand</span></span> and written <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>,

</li>
<li> the "magic wand for postconditions", named <span class="inlinecode"><span class="id" title="var">qwand</span></span> and written
      <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span>.

</li>
</ul>

<div class="paragraph"> </div>

    The magic wand operator has multiple uses:

<div class="paragraph"> </div>

<ul class="doclist">
<li> it is key to formulating the "ramified frame rule", a more practical rule
      for exploiting the frame and consequence properties,

</li>
<li> it will be used in the chapter <a href="WPgen.html"><span class="inlineref">WPgen</span></a> to define a
      weakest-precondition generator, and

</li>
<li> it can be useful to state the specifications for certain data structures.

</li>
</ul>

<div class="paragraph"> </div>

    This chapter is organized as follows:

<div class="paragraph"> </div>

<ul class="doclist">
<li> definition and properties of <span class="inlinecode"><span class="id" title="var">hand</span></span>, <span class="inlinecode"><span class="id" title="var">hor</span></span>, and <span class="inlinecode"><span class="id" title="var">hforall</span></span>,

</li>
<li> definition and properties of the magic wand operator,

</li>
<li> generalization of the magic wand to postconditions,

</li>
<li> extension of the <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> tactic to handle the magic wand,

</li>
<li> statement and benefits of the ramified frame rule.

</li>
</ul>

<div class="paragraph"> </div>

    The "optional material" presents several equivalent definitions for magic
    wand. 
</div>

<div class="doc">
<a id="lab239"></a><h2 class="section">Definition of the Operator <span class="inlinecode"><span class="id" title="var">hforall</span></span></h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="Hforall" class="idref" href="#Hforall"><span class="id" title="module">Hforall</span></a>.<br/>
</div>

<div class="doc">
The heap predicate <span class="inlinecode">\<span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode"><span class="id" title="var">H</span></span> holds of a heap <span class="inlinecode"><span class="id" title="var">h</span></span> that, for any possible
    value of <span class="inlinecode"><span class="id" title="var">x</span></span>, satisfies <span class="inlinecode"><span class="id" title="var">H</span></span>. It may be puzzling at first what could possibly
    be the use case for such a universal quantification, but we will see several
    examples through this chapter -- in particular the encoding of the
    non-separating conjunction (<span class="inlinecode"><span class="id" title="var">hand</span></span>) and of the magic wand on postconditions
    (<span class="inlinecode"><span class="id" title="var">qwand</span></span>).

<div class="paragraph"> </div>

    The predicate <span class="inlinecode">\<span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode"><span class="id" title="var">H</span></span> stands for <span class="inlinecode"><span class="id" title="var">hforall</span></span> <span class="inlinecode">(<span class="id" title="keyword">fun</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">⇒</span> <span class="inlinecode"><span class="id" title="var">H</span>)</span>, where the
    definition of <span class="inlinecode"><span class="id" title="var">hforall</span></span> follows the same pattern as <span class="inlinecode"><span class="id" title="var">hexists</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="Hforall.hforall" class="idref" href="#Hforall.hforall"><span class="id" title="definition">hforall</span></a> (<a id="A:1" class="idref" href="#A:1"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>) (<a id="J:2" class="idref" href="#J:2"><span class="id" title="binder">J</span></a> : <a class="idref" href="Wand.html#A:1"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="h:3" class="idref" href="#h:3"><span class="id" title="binder">h</span></a> ⇒ <span class="id" title="keyword">∀</span> <a id="x:4" class="idref" href="#x:4"><span class="id" title="binder">x</span></a>, <a class="idref" href="Wand.html#J:2"><span class="id" title="variable">J</span></a> <a class="idref" href="Wand.html#x:4"><span class="id" title="variable">x</span></a> <a class="idref" href="Wand.html#h:3"><span class="id" title="variable">h</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Notation</span> <a id="9599e060d7bd0ca837a91b902691e7b<sub>4</sub>" class="idref" href="#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">&quot;</span></a>'\forall' x<sub>1</sub> .. xn , H" :=<br/>
&nbsp;&nbsp;(<a class="idref" href="Wand.html#Hforall.hforall"><span class="id" title="definition">hforall</span></a> (<span class="id" title="keyword">fun</span> <a id="x<sub>1</sub>:5" class="idref" href="#x<sub>1</sub>:5"><span class="id" title="binder">x<sub>1</sub></span></a> ⇒ .. (<a class="idref" href="Wand.html#Hforall.hforall"><span class="id" title="definition">hforall</span></a> (<span class="id" title="keyword">fun</span> <a id="xn:6" class="idref" href="#xn:6"><span class="id" title="binder">xn</span></a> ⇒ <span class="id" title="var">H</span>)) ..))<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 39, <span class="id" title="var">x<sub>1</sub></span> <span class="id" title="var">binder</span>, <span class="id" title="var">H</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">format</span> "'[' '\forall' '/ '  x<sub>1</sub>  ..  xn , '/ '  H ']'").<br/>
</div>

<div class="doc">
To follow the rest of this chapter, it suffices to have in mind the
    introduction and elimination rules for <span class="inlinecode"><span class="id" title="var">hforall</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hforall.hforall_intro" class="idref" href="#Hforall.hforall_intro"><span class="id" title="lemma">hforall_intro</span></a> : <span class="id" title="keyword">∀</span> <a id="A:7" class="idref" href="#A:7"><span class="id" title="binder">A</span></a> (<a id="J:8" class="idref" href="#J:8"><span class="id" title="binder">J</span></a>:<a class="idref" href="Wand.html#A:7"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) <a id="h:9" class="idref" href="#h:9"><span class="id" title="binder">h</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="x:10" class="idref" href="#x:10"><span class="id" title="binder">x</span></a>, <a class="idref" href="Wand.html#J:8"><span class="id" title="variable">J</span></a> <a class="idref" href="Wand.html#x:10"><span class="id" title="variable">x</span></a> <a class="idref" href="Wand.html#h:9"><span class="id" title="variable">h</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;(<a class="idref" href="Wand.html#Hforall.hforall"><span class="id" title="definition">hforall</span></a> <a class="idref" href="Wand.html#J:8"><span class="id" title="variable">J</span></a>) <a class="idref" href="Wand.html#h:9"><span class="id" title="variable">h</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span>* <span class="id" title="var">M</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="Hforall.hforall_inv" class="idref" href="#Hforall.hforall_inv"><span class="id" title="lemma">hforall_inv</span></a> : <span class="id" title="keyword">∀</span> <a id="A:11" class="idref" href="#A:11"><span class="id" title="binder">A</span></a> (<a id="J:12" class="idref" href="#J:12"><span class="id" title="binder">J</span></a>:<a class="idref" href="Wand.html#A:11"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) <a id="h:13" class="idref" href="#h:13"><span class="id" title="binder">h</span></a>,<br/>
&nbsp;&nbsp;(<a class="idref" href="Wand.html#Hforall.hforall"><span class="id" title="definition">hforall</span></a> <a class="idref" href="Wand.html#J:12"><span class="id" title="variable">J</span></a>) <a class="idref" href="Wand.html#h:13"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="x:14" class="idref" href="#x:14"><span class="id" title="binder">x</span></a>, <a class="idref" href="Wand.html#J:12"><span class="id" title="variable">J</span></a> <a class="idref" href="Wand.html#x:14"><span class="id" title="variable">x</span></a> <a class="idref" href="Wand.html#h:13"><span class="id" title="variable">h</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span>* <span class="id" title="var">M</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The introduction rule in an entailment for <span class="inlinecode">\<span class="id" title="keyword">∀</span></span> appears below. To
    prove that a heap satisfies <span class="inlinecode">\<span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode"><span class="id" title="var">J</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span>, we must show that, for any
    <span class="inlinecode"><span class="id" title="var">x</span></span>, this heap satisfies <span class="inlinecode"><span class="id" title="var">J</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hforall.himpl_hforall_r" class="idref" href="#Hforall.himpl_hforall_r"><span class="id" title="lemma">himpl_hforall_r</span></a> : <span class="id" title="keyword">∀</span> <a id="A:15" class="idref" href="#A:15"><span class="id" title="binder">A</span></a> (<a id="J:16" class="idref" href="#J:16"><span class="id" title="binder">J</span></a>:<a class="idref" href="Wand.html#A:15"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) <a id="H:17" class="idref" href="#H:17"><span class="id" title="binder">H</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="x:18" class="idref" href="#x:18"><span class="id" title="binder">x</span></a>, <a class="idref" href="Wand.html#H:17"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#J:16"><span class="id" title="variable">J</span></a> <a class="idref" href="Wand.html#x:18"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H:17"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="Wand.html#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">∀</span></a> <a id="x:19" class="idref" href="#x:19"><span class="id" title="binder">x</span></a><a class="idref" href="Wand.html#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="Wand.html#J:16"><span class="id" title="variable">J</span></a> <a class="idref" href="Wand.html#x:19"><span class="id" title="variable">x</span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span> <span class="id" title="var">x</span>. <span class="id" title="tactic">apply</span>¬<span class="id" title="var">M</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The elimination rule in an entailment for <span class="inlinecode">\<span class="id" title="keyword">∀</span></span> appears below. Assuming
    a heap satisfies <span class="inlinecode">\<span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode"><span class="id" title="var">J</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span>, we can derive that the same heap
    satisfies <span class="inlinecode"><span class="id" title="var">J</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> for any desired value <span class="inlinecode"><span class="id" title="var">v</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hforall.hforall_specialize" class="idref" href="#Hforall.hforall_specialize"><span class="id" title="lemma">hforall_specialize</span></a> : <span class="id" title="keyword">∀</span> <a id="A:20" class="idref" href="#A:20"><span class="id" title="binder">A</span></a> (<a id="v:21" class="idref" href="#v:21"><span class="id" title="binder">v</span></a>:<a class="idref" href="Wand.html#A:20"><span class="id" title="variable">A</span></a>) (<a id="J:22" class="idref" href="#J:22"><span class="id" title="binder">J</span></a>:<a class="idref" href="Wand.html#A:20"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="Wand.html#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">∀</span></a> <a id="x:23" class="idref" href="#x:23"><span class="id" title="binder">x</span></a><a class="idref" href="Wand.html#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="Wand.html#J:22"><span class="id" title="variable">J</span></a> <a class="idref" href="Wand.html#x:23"><span class="id" title="variable">x</span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#J:22"><span class="id" title="variable">J</span></a> <a class="idref" href="Wand.html#v:21"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">K</span>. <span class="id" title="tactic">apply</span>* <span class="id" title="var">K</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The lemma <span class="inlinecode"><span class="id" title="var">hforall_specialize</span></span> can equivalently be formulated in the
    following way, which makes it easier to apply in some cases. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hforall.himpl_hforall_l" class="idref" href="#Hforall.himpl_hforall_l"><span class="id" title="lemma">himpl_hforall_l</span></a> : <span class="id" title="keyword">∀</span> <a id="A:24" class="idref" href="#A:24"><span class="id" title="binder">A</span></a> (<a id="v:25" class="idref" href="#v:25"><span class="id" title="binder">v</span></a>:<a class="idref" href="Wand.html#A:24"><span class="id" title="variable">A</span></a>) (<a id="J:26" class="idref" href="#J:26"><span class="id" title="binder">J</span></a>:<a class="idref" href="Wand.html#A:24"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) <a id="H:27" class="idref" href="#H:27"><span class="id" title="binder">H</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#J:26"><span class="id" title="variable">J</span></a> <a class="idref" href="Wand.html#v:25"><span class="id" title="variable">v</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H:27"><span class="id" title="variable">H</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="Wand.html#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">∀</span></a> <a id="x:28" class="idref" href="#x:28"><span class="id" title="binder">x</span></a><a class="idref" href="Wand.html#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="Wand.html#J:26"><span class="id" title="variable">J</span></a> <a class="idref" href="Wand.html#x:28"><span class="id" title="variable">x</span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H:27"><span class="id" title="variable">H</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_trans"><span class="id" title="lemma">himpl_trans</span></a> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#Hforall.hforall_specialize"><span class="id" title="lemma">hforall_specialize</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Universal quantifers that appear in the precondition of a triple may be
    specialized like universal quantifiers appearing on the left-hand side of an
    entailment. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hforall.triple_hforall" class="idref" href="#Hforall.triple_hforall"><span class="id" title="lemma">triple_hforall</span></a> : <span class="id" title="keyword">∀</span> <a id="A:29" class="idref" href="#A:29"><span class="id" title="binder">A</span></a> (<a id="v:30" class="idref" href="#v:30"><span class="id" title="binder">v</span></a>:<a class="idref" href="Wand.html#A:29"><span class="id" title="variable">A</span></a>) <a id="t:31" class="idref" href="#t:31"><span class="id" title="binder">t</span></a> (<a id="J:32" class="idref" href="#J:32"><span class="id" title="binder">J</span></a>:<a class="idref" href="Wand.html#A:29"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) <a id="Q:33" class="idref" href="#Q:33"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Wand.html#t:31"><span class="id" title="variable">t</span></a> (<a class="idref" href="Wand.html#J:32"><span class="id" title="variable">J</span></a> <a class="idref" href="Wand.html#v:30"><span class="id" title="variable">v</span></a>) <a class="idref" href="Wand.html#Q:33"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Wand.html#t:31"><span class="id" title="variable">t</span></a> (<a class="idref" href="Wand.html#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="Wand.html#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">∀</span></a> <a id="x:34" class="idref" href="#x:34"><span class="id" title="binder">x</span></a><a class="idref" href="Wand.html#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="Wand.html#J:32"><span class="id" title="variable">J</span></a> <a class="idref" href="Wand.html#x:34"><span class="id" title="variable">x</span></a>) <a class="idref" href="Wand.html#Q:33"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#triple_conseq"><span class="id" title="lemma">triple_conseq</span></a> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#Hforall.hforall_specialize"><span class="id" title="lemma">hforall_specialize</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.qimpl_refl"><span class="id" title="lemma">qimpl_refl</span></a>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="Wand.html#Hforall"><span class="id" title="module">Hforall</span></a>.<br/>
</div>

<div class="doc">
<a id="lab240"></a><h2 class="section">Definition of the Operator <span class="inlinecode"><span class="id" title="var">hor</span></span></h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="Hor" class="idref" href="#Hor"><span class="id" title="module">Hor</span></a>.<br/>
</div>

<div class="doc">
The heap predicate <span class="inlinecode"><span class="id" title="var">hor</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> describes a heap that satisfies <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> or
    satifies <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> (or possibly both). In other words, the heap predicate
    <span class="inlinecode"><span class="id" title="var">hor</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> lifts the disjunction operator <span class="inlinecode"><span class="id" title="var">P<sub>1</sub></span></span> <span class="inlinecode">∨</span> <span class="inlinecode"><span class="id" title="var">P<sub>2</sub></span></span> from <span class="inlinecode"><span class="id" title="keyword">Prop</span></span> to
    <span class="inlinecode"><span class="id" title="var">hprop</span></span>.

<div class="paragraph"> </div>

    The disjunction operator does not appear to be critically useful in
    practice, because it can be encoded using Coq's conditional construct, or
    using pattern matching. Nevertheless, there are situations where it proves
    handy.

<div class="paragraph"> </div>

    The heap disjunction predicate admits a direct definition as a function over
    heaps, written <span class="inlinecode"><span class="id" title="var">hor'</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="Hor.hor'" class="idref" href="#Hor.hor'"><span class="id" title="definition">hor'</span></a> (<a id="H<sub>1</sub>:35" class="idref" href="#H<sub>1</sub>:35"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:36" class="idref" href="#H<sub>2</sub>:36"><span class="id" title="binder">H<sub>2</sub></span></a> : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="h:37" class="idref" href="#h:37"><span class="id" title="binder">h</span></a> ⇒ <a class="idref" href="Wand.html#H<sub>1</sub>:35"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#h:37"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e<sub>25</sub>"><span class="id" title="notation">∨</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:36"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Wand.html#h:37"><span class="id" title="variable">h</span></a>.<br/>
</div>

<div class="doc">
An alternative definition leverages the <span class="inlinecode"><span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> quantifier. The
    definition, shown below, reads as follows: "there exists an unspecified
    boolean value <span class="inlinecode"><span class="id" title="var">b</span></span> such that if <span class="inlinecode"><span class="id" title="var">b</span></span> is true then <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> holds, else if <span class="inlinecode"><span class="id" title="var">b</span></span> is
    false then <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> holds".

<div class="paragraph"> </div>

    The benefit of this definition is that its properties can be established
    without manipulating heaps explicitly. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="Hor.hor" class="idref" href="#Hor.hor"><span class="id" title="definition">hor</span></a> (<a id="H<sub>1</sub>:38" class="idref" href="#H<sub>1</sub>:38"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:39" class="idref" href="#H<sub>2</sub>:39"><span class="id" title="binder">H<sub>2</sub></span></a> : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">(</span></a><a id="b:40" class="idref" href="#b:40"><span class="id" title="binder">b</span></a>:<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">),</span></a> <span class="id" title="keyword">if</span> <a class="idref" href="Wand.html#b:40"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Wand.html#H<sub>1</sub>:38"><span class="id" title="variable">H<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Wand.html#H<sub>2</sub>:39"><span class="id" title="variable">H<sub>2</sub></span></a>.<br/>
</div>

<div class="doc">
<a id="lab241"></a><h4 class="section">Exercise: 3 stars, standard, optional (hor_eq_hor')</h4>
 Prove the equivalence of the definitions <span class="inlinecode"><span class="id" title="var">hor</span></span> and <span class="inlinecode"><span class="id" title="var">hor'</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hor.hor_eq_hor'" class="idref" href="#Hor.hor_eq_hor'"><span class="id" title="lemma">hor_eq_hor'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#Hor.hor"><span class="id" title="definition">hor</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#Hor.hor'"><span class="id" title="definition">hor'</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 The two introduction rules for <span class="inlinecode"><span class="id" title="var">hor</span></span> assert that if <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> holds, then
    <span class="inlinecode"><span class="id" title="var">hor</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> holds; and, symmetrically, if <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> holds, then <span class="inlinecode"><span class="id" title="var">hor</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>
    holds. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hor.himpl_hor_r_l" class="idref" href="#Hor.himpl_hor_r_l"><span class="id" title="lemma">himpl_hor_r_l</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:41" class="idref" href="#H<sub>1</sub>:41"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:42" class="idref" href="#H<sub>2</sub>:42"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>1</sub>:41"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#Hor.hor"><span class="id" title="definition">hor</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:41"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:42"><span class="id" title="variable">H<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">unfolds</span> <a class="idref" href="Wand.html#Hor.hor"><span class="id" title="definition">hor</span></a>. <span class="id" title="tactic">∃</span>* <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="Hor.himpl_hor_r_r" class="idref" href="#Hor.himpl_hor_r_r"><span class="id" title="lemma">himpl_hor_r_r</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:43" class="idref" href="#H<sub>1</sub>:43"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:44" class="idref" href="#H<sub>2</sub>:44"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>2</sub>:44"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#Hor.hor"><span class="id" title="definition">hor</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:43"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:44"><span class="id" title="variable">H<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">unfolds</span> <a class="idref" href="Wand.html#Hor.hor"><span class="id" title="definition">hor</span></a>. <span class="id" title="tactic">∃</span>* <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
In practice, these rules are easier to exploit when combined with a
    transitivity step. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hor.himpl_hor_r_l_trans" class="idref" href="#Hor.himpl_hor_r_l_trans"><span class="id" title="lemma">himpl_hor_r_l_trans</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:45" class="idref" href="#H<sub>1</sub>:45"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:46" class="idref" href="#H<sub>2</sub>:46"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:47" class="idref" href="#H<sub>3</sub>:47"><span class="id" title="binder">H<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>3</sub>:47"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:45"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>3</sub>:47"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#Hor.hor"><span class="id" title="definition">hor</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:45"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:46"><span class="id" title="variable">H<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">W</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_trans"><span class="id" title="lemma">himpl_trans</span></a> <span class="id" title="var">W</span>. <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#Hor.himpl_hor_r_l"><span class="id" title="lemma">himpl_hor_r_l</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="Hor.himpl_hor_r_r_trans" class="idref" href="#Hor.himpl_hor_r_r_trans"><span class="id" title="lemma">himpl_hor_r_r_trans</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:48" class="idref" href="#H<sub>1</sub>:48"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:49" class="idref" href="#H<sub>2</sub>:49"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:50" class="idref" href="#H<sub>3</sub>:50"><span class="id" title="binder">H<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>3</sub>:50"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:49"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>3</sub>:50"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#Hor.hor"><span class="id" title="definition">hor</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:48"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:49"><span class="id" title="variable">H<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">W</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_trans"><span class="id" title="lemma">himpl_trans</span></a> <span class="id" title="var">W</span>. <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#Hor.himpl_hor_r_r"><span class="id" title="lemma">himpl_hor_r_r</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The elimination rule asserts that, if <span class="inlinecode"><span class="id" title="var">hor</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> holds, then we can perform
    a case analysis on whether it is <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> or <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> that holds. Concretely, to
    show that <span class="inlinecode"><span class="id" title="var">hor</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> entails a heap predicate <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span>, we must show both that
    <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> entails <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span> and that <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> entails <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hor.himpl_hor_l" class="idref" href="#Hor.himpl_hor_l"><span class="id" title="lemma">himpl_hor_l</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:51" class="idref" href="#H<sub>1</sub>:51"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:52" class="idref" href="#H<sub>2</sub>:52"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:53" class="idref" href="#H<sub>3</sub>:53"><span class="id" title="binder">H<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>1</sub>:51"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:53"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>2</sub>:52"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:53"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#Hor.hor"><span class="id" title="definition">hor</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:51"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:52"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:53"><span class="id" title="variable">H<sub>3</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="var">M<sub>2</sub></span>. <span class="id" title="var">unfolds</span> <a class="idref" href="Wand.html#Hor.hor"><span class="id" title="definition">hor</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_hexists_l"><span class="id" title="lemma">himpl_hexists_l</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">b</span>. <span class="id" title="var">case_if</span>*.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The operator <span class="inlinecode"><span class="id" title="var">hor</span></span> is commutative. To establish this property, it is useful
    to exploit the following lemma, called <span class="inlinecode"><span class="id" title="var">if_neg</span></span>, for swapping the two
    branches of a conditional by negating its boolean condition. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hor.if_neg" class="idref" href="#Hor.if_neg"><span class="id" title="lemma">if_neg</span></a> : <span class="id" title="keyword">∀</span> (<a id="b:54" class="idref" href="#b:54"><span class="id" title="binder">b</span></a>:<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) <a id="A:55" class="idref" href="#A:55"><span class="id" title="binder">A</span></a> (<a id="X:56" class="idref" href="#X:56"><span class="id" title="binder">X</span></a> <a id="Y:57" class="idref" href="#Y:57"><span class="id" title="binder">Y</span></a>:<a class="idref" href="Wand.html#A:55"><span class="id" title="variable">A</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="keyword">if</span> <a class="idref" href="Wand.html#b:54"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Wand.html#X:56"><span class="id" title="variable">X</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Wand.html#Y:57"><span class="id" title="variable">Y</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="keyword">if</span> <span class="id" title="definition">neg</span> <a class="idref" href="Wand.html#b:54"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Wand.html#Y:57"><span class="id" title="variable">Y</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Wand.html#X:56"><span class="id" title="variable">X</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">case_if</span>*. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab242"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (hor_comm)</h4>
 Prove that <span class="inlinecode"><span class="id" title="var">hor</span></span> is a symmetric operator. Hint: exploit <span class="inlinecode"><span class="id" title="var">hprop_op_comm</span></span> and
    <span class="inlinecode"><span class="id" title="var">if_neg</span></span> (from chapter <a href="Himpl.html"><span class="inlineref">Himpl</span></a>). 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hor.hor_comm" class="idref" href="#Hor.hor_comm"><span class="id" title="lemma">hor_comm</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:58" class="idref" href="#H<sub>1</sub>:58"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:59" class="idref" href="#H<sub>2</sub>:59"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#Hor.hor"><span class="id" title="definition">hor</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:58"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:59"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#Hor.hor"><span class="id" title="definition">hor</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:59"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:58"><span class="id" title="variable">H<sub>1</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="code">

<span class="id" title="keyword">Module</span> <a id="Hor.HorExample" class="idref" href="#Hor.HorExample"><span class="id" title="module">HorExample</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="Repr.html#"><span class="id" title="module">Repr</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">q</span> : <a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>.<br/>
</div>

<div class="doc">
<a id="lab243"></a><h4 class="section">Exercise: 4 stars, standard, especially useful (hor_comm)</h4>
 Prove that the representation predicate <span class="inlinecode"><span class="id" title="var">MList</span></span> introduced in chapter
    <a href="Repr.html"><span class="inlineref">Repr</span></a> can be equivalently characterized using the predicate <span class="inlinecode"><span class="id" title="var">hor</span></span>, as
    shown below. Hint: to prove this equivalence, do not attempt a proof by
    induction, and do not attempt to unfold <span class="inlinecode"><span class="id" title="var">MList</span></span>. Instead, work using the
    equalities <span class="inlinecode"><span class="id" title="var">MList_nil</span></span> and <span class="inlinecode"><span class="id" title="var">MList_cons</span></span>. You may want to begin the proof by
    applying <span class="inlinecode"><span class="id" title="var">himpl_antisym</span></span> and calling <span class="inlinecode"><span class="id" title="tactic">destruct</span></span> on <span class="inlinecode"><span class="id" title="var">L</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hor.HorExample.MList_using_hor" class="idref" href="#Hor.HorExample.MList_using_hor"><span class="id" title="lemma">MList_using_hor</span></a> : <span class="id" title="keyword">∀</span> <a id="L:60" class="idref" href="#L:60"><span class="id" title="binder">L</span></a> <a id="p:61" class="idref" href="#p:61"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Repr.html#MList"><span class="id" title="definition">MList</span></a> <a class="idref" href="Wand.html#L:60"><span class="id" title="variable">L</span></a> <a class="idref" href="Wand.html#p:61"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Wand.html#Hor.hor"><span class="id" title="definition">hor</span></a> (<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Wand.html#L:60"><span class="id" title="variable">L</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Wand.html#p:61"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#null"><span class="id" title="definition">null</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="x:62" class="idref" href="#x:62"><span class="id" title="binder">x</span></a> <a id="q:63" class="idref" href="#q:63"><span class="id" title="binder">q</span></a> <a id="L':64" class="idref" href="#L':64"><span class="id" title="binder">L'</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Wand.html#L:60"><span class="id" title="variable">L</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#x:62"><span class="id" title="variable">x</span></a><span class="id" title="notation">::</span><a class="idref" href="Wand.html#L':64"><span class="id" title="variable">L'</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#p:61"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#3a1f4def71aa7ea77c87b41e2bd7edb0"><span class="id" title="notation">~~~&gt;</span></a><a class="idref" href="LibSepReference.html#76933079165db105f5fb332367c5f7d<sub>8</sub>"><span class="id" title="notation">`{</span></a> <a class="idref" href="Repr.html#head"><span class="id" title="definition">head</span></a> <a class="idref" href="LibSepReference.html#76933079165db105f5fb332367c5f7d<sub>8</sub>"><span class="id" title="notation">:=</span></a> <a class="idref" href="Wand.html#x:62"><span class="id" title="variable">x</span></a><a class="idref" href="LibSepReference.html#76933079165db105f5fb332367c5f7d<sub>8</sub>"><span class="id" title="notation">;</span></a> <a class="idref" href="Repr.html#tail"><span class="id" title="definition">tail</span></a> <a class="idref" href="LibSepReference.html#76933079165db105f5fb332367c5f7d<sub>8</sub>"><span class="id" title="notation">:=</span></a> <a class="idref" href="Wand.html#q:63"><span class="id" title="variable">q</span></a><a class="idref" href="LibSepReference.html#76933079165db105f5fb332367c5f7d<sub>8</sub>"><span class="id" title="notation">}</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Repr.html#MList"><span class="id" title="definition">MList</span></a> <a class="idref" href="Wand.html#L':64"><span class="id" title="variable">L'</span></a> <a class="idref" href="Wand.html#q:63"><span class="id" title="variable">q</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="code">

<span class="id" title="keyword">End</span> <a class="idref" href="Wand.html#Hor.HorExample"><span class="id" title="module">HorExample</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Wand.html#Hor"><span class="id" title="module">Hor</span></a>.<br/>
</div>

<div class="doc">
<a id="lab244"></a><h2 class="section">Definition of the Operator <span class="inlinecode"><span class="id" title="var">hand</span></span></h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="Hand" class="idref" href="#Hand"><span class="id" title="module">Hand</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="Wand.html#Hforall"><span class="id" title="module">Hforall</span></a> <a class="idref" href="Wand.html#Hor"><span class="id" title="module">Hor</span></a>.<br/>
</div>

<div class="doc">
The heap predicate <span class="inlinecode"><span class="id" title="var">hand</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> describes a single heap that satisfies <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>
    and at the same time satifies <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>. In other words, the heap predicate
    <span class="inlinecode"><span class="id" title="var">hand</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> lifts the disjunction operator <span class="inlinecode"><span class="id" title="var">P<sub>1</sub></span></span> <span class="inlinecode">∧</span> <span class="inlinecode"><span class="id" title="var">P<sub>2</sub></span></span> from <span class="inlinecode"><span class="id" title="keyword">Prop</span></span> to
    <span class="inlinecode"><span class="id" title="var">hprop</span></span>. The heap predicate <span class="inlinecode"><span class="id" title="var">hand</span></span> admits a direct definition as a function
    over heaps. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="Hand.hand'" class="idref" href="#Hand.hand'"><span class="id" title="definition">hand'</span></a> (<a id="H<sub>1</sub>:65" class="idref" href="#H<sub>1</sub>:65"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:66" class="idref" href="#H<sub>2</sub>:66"><span class="id" title="binder">H<sub>2</sub></span></a> : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="h:67" class="idref" href="#h:67"><span class="id" title="binder">h</span></a> ⇒ <a class="idref" href="Wand.html#H<sub>1</sub>:65"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#h:67"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:66"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Wand.html#h:67"><span class="id" title="variable">h</span></a>.<br/>
</div>

<div class="doc">
An alternative definition leverages the <span class="inlinecode">\<span class="id" title="keyword">∀</span></span> quantifier. The definition
    reads as follows: "for any boolean value <span class="inlinecode"><span class="id" title="var">b</span></span>, if <span class="inlinecode"><span class="id" title="var">b</span></span> is true then <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>
    should hold, and if <span class="inlinecode"><span class="id" title="var">b</span></span> is false then <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> should hold". 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="Hand.hand" class="idref" href="#Hand.hand"><span class="id" title="definition">hand</span></a> (<a id="H<sub>1</sub>:68" class="idref" href="#H<sub>1</sub>:68"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:69" class="idref" href="#H<sub>2</sub>:69"><span class="id" title="binder">H<sub>2</sub></span></a> : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="Wand.html#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">∀</span></a> <a class="idref" href="Wand.html#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">(</span></a><a id="b:70" class="idref" href="#b:70"><span class="id" title="binder">b</span></a>:<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><a class="idref" href="Wand.html#9599e060d7bd0ca837a91b902691e7b<sub>4</sub>"><span class="id" title="notation">),</span></a> <span class="id" title="keyword">if</span> <a class="idref" href="Wand.html#b:70"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Wand.html#H<sub>1</sub>:68"><span class="id" title="variable">H<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Wand.html#H<sub>2</sub>:69"><span class="id" title="variable">H<sub>2</sub></span></a>.<br/>
</div>

<div class="doc">
<a id="lab245"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (hand_eq_hand')</h4>
 Prove the equivalence of the definitions <span class="inlinecode"><span class="id" title="var">hand</span></span> and <span class="inlinecode"><span class="id" title="var">hand'</span></span>. Use functional
    extensionality to get started. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hand.hand_eq_hand'" class="idref" href="#Hand.hand_eq_hand'"><span class="id" title="lemma">hand_eq_hand'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#Hand.hand"><span class="id" title="definition">hand</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#Hand.hand'"><span class="id" title="definition">hand'</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 The introduction and elimination rules for <span class="inlinecode"><span class="id" title="var">hand</span></span> are as follows.

<div class="paragraph"> </div>

<ul class="doclist">
<li> If "<span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>" holds, then in particular <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> holds.

</li>
<li> Symmetrically, if "<span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>" holds, then in particular <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> holds.

</li>
<li> Reciprocally, to prove that a heap predicate <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span> entails
      "<span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>", we must prove that <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span> entails <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>, and that
      <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span> satisfies <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>.

</li>
</ul>

</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hand.himpl_hand_l_r" class="idref" href="#Hand.himpl_hand_l_r"><span class="id" title="lemma">himpl_hand_l_r</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:71" class="idref" href="#H<sub>1</sub>:71"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:72" class="idref" href="#H<sub>2</sub>:72"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#Hand.hand"><span class="id" title="definition">hand</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:71"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:72"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:71"><span class="id" title="variable">H<sub>1</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">unfolds</span> <a class="idref" href="Wand.html#Hand.hand"><span class="id" title="definition">hand</span></a>. <span class="id" title="var">applys</span>* <a class="idref" href="Wand.html#Hforall.himpl_hforall_l"><span class="id" title="lemma">himpl_hforall_l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="Hand.himpl_hand_l_l" class="idref" href="#Hand.himpl_hand_l_l"><span class="id" title="lemma">himpl_hand_l_l</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:73" class="idref" href="#H<sub>1</sub>:73"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:74" class="idref" href="#H<sub>2</sub>:74"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#Hand.hand"><span class="id" title="definition">hand</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:73"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:74"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:74"><span class="id" title="variable">H<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">unfolds</span> <a class="idref" href="Wand.html#Hand.hand"><span class="id" title="definition">hand</span></a>. <span class="id" title="var">applys</span>* <a class="idref" href="Wand.html#Hforall.himpl_hforall_l"><span class="id" title="lemma">himpl_hforall_l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="Hand.himpl_hand_r" class="idref" href="#Hand.himpl_hand_r"><span class="id" title="lemma">himpl_hand_r</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:75" class="idref" href="#H<sub>1</sub>:75"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:76" class="idref" href="#H<sub>2</sub>:76"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:77" class="idref" href="#H<sub>3</sub>:77"><span class="id" title="binder">H<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>3</sub>:77"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:75"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>3</sub>:77"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:76"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>3</sub>:77"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#Hand.hand"><span class="id" title="definition">hand</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:75"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:76"><span class="id" title="variable">H<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="var">M<sub>2</sub></span> <span class="id" title="var">Hh</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">b</span>. <span class="id" title="var">case_if</span>*. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab246"></a><h4 class="section">Exercise: 1 star, standard, especially useful (hand_comm)</h4>
 Prove that <span class="inlinecode"><span class="id" title="var">hand</span></span> is symmetric. Hint: use <span class="inlinecode"><span class="id" title="var">hprop_op_comm</span></span> and
    <span class="inlinecode"><span class="id" title="tactic">rewrite</span></span> <span class="inlinecode"><span class="id" title="var">if_neg</span></span>, or a case analysis on the boolean value coming from
    <span class="inlinecode"><span class="id" title="var">hand</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hand.hand_comm" class="idref" href="#Hand.hand_comm"><span class="id" title="lemma">hand_comm</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:78" class="idref" href="#H<sub>1</sub>:78"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:79" class="idref" href="#H<sub>2</sub>:79"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#Hand.hand"><span class="id" title="definition">hand</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:78"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:79"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#Hand.hand"><span class="id" title="definition">hand</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:79"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:78"><span class="id" title="variable">H<sub>1</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="code">

<span class="id" title="keyword">End</span> <a class="idref" href="Wand.html#Hand"><span class="id" title="module">Hand</span></a>.<br/>
</div>

<div class="doc">
<a id="lab247"></a><h2 class="section">Definition of the Magic Wand Operator: <span class="inlinecode"><span class="id" title="var">hwand</span></span></h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="Hwand" class="idref" href="#Hwand"><span class="id" title="module">Hwand</span></a>.<br/>
</div>

<div class="doc">
<a id="lab248"></a><h3 class="section">Definition of <span class="inlinecode"><span class="id" title="var">hwand</span></span></h3>

<div class="paragraph"> </div>

 The magic wand operation <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>, pronounced "H<sub>1</sub> wand H<sub>2</sub>", defines a
    heap predicate such that, if we extend it with <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>, we obtain <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>.
    Formally, the following entailment holds:
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">H<sub>1</sub></span> <span class='gray-font'>\</span>* (<span class="id" title="var">H<sub>1</sub></span> <span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span> <span class="id" title="var">H<sub>2</sub></span>) ==&gt; <span class="id" title="var">H<sub>2</sub></span>.
</span>    Intuitively, if we think of the star <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> as a sort of addition,
    <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>, then we can think of <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> as the subtraction <span class="inlinecode">-<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>.
    The entailment above intuitively captures the idea that <span class="inlinecode">(-<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>
    simplifies to <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>.

<div class="paragraph"> </div>

    Note, however, that the operation <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> only makes sense if <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>
    describes a piece of heap that "can" be subtracted from <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>. Otherwise, the
    predicate <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> characterizes a heap that cannot possibly exist.
    Informally speaking, <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> must somehow be a subset of <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> for the
    subtraction <span class="inlinecode">-<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> to make sense.

<div class="paragraph"> </div>

    Another possible analogy is that of logical operators. If <span class="inlinecode"><span class="id" title="var">P<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">P<sub>2</sub></span></span> were
    propositions (of type <span class="inlinecode"><span class="id" title="keyword">Prop</span></span>), then <span class="inlinecode"><span class="id" title="var">P<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">P<sub>2</sub></span></span> would mean <span class="inlinecode"><span class="id" title="var">P<sub>1</sub></span></span> <span class="inlinecode">∧</span> <span class="inlinecode"><span class="id" title="var">P<sub>2</sub></span></span> and
    <span class="inlinecode"><span class="id" title="var">P<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">P<sub>2</sub></span></span> would mean <span class="inlinecode"><span class="id" title="var">P<sub>1</sub></span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">P<sub>2</sub></span></span>. The entailment <span class="inlinecode"><span class="id" title="var">P<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode">(<span class="id" title="var">P<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">P<sub>2</sub></span>)</span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">P<sub>2</sub></span></span>
    then corresponds to the tautology <span class="inlinecode">(<span class="id" title="var">P<sub>1</sub></span></span> <span class="inlinecode">∧</span> <span class="inlinecode">(<span class="id" title="var">P<sub>1</sub></span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">P<sub>2</sub></span>))</span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">P<sub>2</sub></span></span>.

<div class="paragraph"> </div>

    Technically, <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> holds of a heap <span class="inlinecode"><span class="id" title="var">h</span></span> if, for any heap <span class="inlinecode"><span class="id" title="var">h'</span></span> disjoint
    from <span class="inlinecode"><span class="id" title="var">h</span></span> and satisfying <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>, the union of <span class="inlinecode"><span class="id" title="var">h</span></span> and <span class="inlinecode"><span class="id" title="var">h'</span></span> satisfies <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>. The
    operator <span class="inlinecode"><span class="id" title="var">hwand</span></span>, which implements the notation <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>, may thus be
    defined as follows. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="Hwand.hwand'" class="idref" href="#Hwand.hwand'"><span class="id" title="definition">hwand'</span></a> (<a id="H<sub>1</sub>:80" class="idref" href="#H<sub>1</sub>:80"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:81" class="idref" href="#H<sub>2</sub>:81"><span class="id" title="binder">H<sub>2</sub></span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="h:82" class="idref" href="#h:82"><span class="id" title="binder">h</span></a> ⇒ <span class="id" title="keyword">∀</span> <a id="h':83" class="idref" href="#h':83"><span class="id" title="binder">h'</span></a>, <a class="idref" href="LibSepReference.html#Fmap.disjoint"><span class="id" title="definition">Fmap.disjoint</span></a> <a class="idref" href="Wand.html#h:82"><span class="id" title="variable">h</span></a> <a class="idref" href="Wand.html#h':83"><span class="id" title="variable">h'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:80"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#h':83"><span class="id" title="variable">h'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:81"><span class="id" title="variable">H<sub>2</sub></span></a> (<a class="idref" href="Wand.html#h:82"><span class="id" title="variable">h</span></a> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <a class="idref" href="Wand.html#h':83"><span class="id" title="variable">h'</span></a>).<br/>
</div>

<div class="doc">
The definition above is perfectly fine, however it is more practical to use
    an alternative, equivalent definition of <span class="inlinecode"><span class="id" title="var">hwand</span></span>, expressed in terms of
    previously introduced Separation Logic operators. Doing so enables us to
    establish all the properties of the magic wand by exploiting the tactic
    <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>, thereby conducting all the reasoning at the level of <span class="inlinecode"><span class="id" title="var">hprop</span></span>,
    rather than having to work with concrete heaps.

<div class="paragraph"> </div>

    The alternative definition asserts that <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> corresponds to some heap
    predicate, called <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span>, such that <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> starred with <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> yields <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>. In
    other words, <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> is such that <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span>)</span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>. In the definition below,
    observe how <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> is existentially quantified. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="Hwand.hwand" class="idref" href="#Hwand.hwand"><span class="id" title="definition">hwand</span></a> (<a id="H<sub>1</sub>:84" class="idref" href="#H<sub>1</sub>:84"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:85" class="idref" href="#H<sub>2</sub>:85"><span class="id" title="binder">H<sub>2</sub></span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="H<sub>0</sub>:86" class="idref" href="#H<sub>0</sub>:86"><span class="id" title="binder">H<sub>0</sub></span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:86"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:84"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:86"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:85"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Notation</span> <a id="3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>" class="idref" href="#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">&quot;</span></a>H<sub>1</sub> <span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span> H<sub>2</sub>" := (<a class="idref" href="Wand.html#Hwand.hwand"><span class="id" title="definition">hwand</span></a> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 43, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>).<br/>
</div>

<div class="doc">
<a id="lab249"></a><h3 class="section">Characteristic Equivalence for <span class="inlinecode"><span class="id" title="var">hwand</span></span></h3>

<div class="paragraph"> </div>

 The magic wand is not easy to make sense of at first. Reading its
    introduction and elimination rules may help further appreciate its meaning.

<div class="paragraph"> </div>

    The operator <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> satisfies the following equivalence. Informally
    speaking, think of <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> <span class="inlinecode">=</span> <span class="inlinecode">-<span class="id" title="var">H<sub>1</sub></span>+<span class="id" title="var">H<sub>2</sub></span></span> and <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span>+<span class="id" title="var">H<sub>0</sub></span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> being equivalent claims.
    
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hwand.hwand_equiv" class="idref" href="#Hwand.hwand_equiv"><span class="id" title="lemma">hwand_equiv</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>0</sub>:87" class="idref" href="#H<sub>0</sub>:87"><span class="id" title="binder">H<sub>0</sub></span></a> <a id="H<sub>1</sub>:88" class="idref" href="#H<sub>1</sub>:88"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:89" class="idref" href="#H<sub>2</sub>:89"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>0</sub>:87"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:88"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:89"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:88"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:87"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:89"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Wand.html#Hwand.hwand"><span class="id" title="definition">hwand</span></a>. <span class="id" title="var">iff</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">xchange</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">H</span> <span class="id" title="var">N</span>. <span class="id" title="var">xchange</span> <span class="id" title="var">N</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">xsimpl</span> <span class="id" title="var">H<sub>0</sub></span>. <span class="id" title="var">xchange</span> <span class="id" title="var">M</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Indeed, we will see below that the magic wand operator is <i>uniquely defined</i>
    by the equivalence <span class="inlinecode">(<span class="id" title="var">H<sub>0</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode">↔</span> <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span>. In other
    words, any operator that satisfies the above equivalence is provably equal
    to <span class="inlinecode"><span class="id" title="var">hwand</span></span>. 
<div class="paragraph"> </div>

 The right-to-left direction of the equivalence is an introduction rule: it
    tells what needs to be proved for constructing a magic wand <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> from
    a state <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span>.

<div class="paragraph"> </div>

    To establish that <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> entails <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>, we have to show that the
    conjunction of <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> and <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> yields <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hwand.himpl_hwand_r" class="idref" href="#Hwand.himpl_hwand_r"><span class="id" title="lemma">himpl_hwand_r</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>0</sub>:90" class="idref" href="#H<sub>0</sub>:90"><span class="id" title="binder">H<sub>0</sub></span></a> <a id="H<sub>1</sub>:91" class="idref" href="#H<sub>1</sub>:91"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:92" class="idref" href="#H<sub>2</sub>:92"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:91"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:90"><span class="id" title="variable">H<sub>0</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:92"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>0</sub>:90"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:91"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:92"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#Hwand.hwand_equiv"><span class="id" title="lemma">hwand_equiv</span></a>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The left-to-right direction of the equivalence is an elimination rule: it
    tells what can be deduced from an entailment <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> -- namely,
    if <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> is starred with <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>, then <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> can be recovered. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hwand.himpl_hwand_r_inv" class="idref" href="#Hwand.himpl_hwand_r_inv"><span class="id" title="lemma">himpl_hwand_r_inv</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>0</sub>:93" class="idref" href="#H<sub>0</sub>:93"><span class="id" title="binder">H<sub>0</sub></span></a> <a id="H<sub>1</sub>:94" class="idref" href="#H<sub>1</sub>:94"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:95" class="idref" href="#H<sub>2</sub>:95"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>0</sub>:93"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:94"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:95"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:94"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:93"><span class="id" title="variable">H<sub>0</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:95"><span class="id" title="variable">H<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#Hwand.hwand_equiv"><span class="id" title="lemma">hwand_equiv</span></a>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
This elimination rule can be equivalently reformulated in the following
    handy form: <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>, when starred with <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>, yields <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hwand.hwand_cancel" class="idref" href="#Hwand.hwand_cancel"><span class="id" title="lemma">hwand_cancel</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:96" class="idref" href="#H<sub>1</sub>:96"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:97" class="idref" href="#H<sub>2</sub>:97"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>1</sub>:96"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:96"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:97"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:97"><span class="id" title="variable">H<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#Hwand.himpl_hwand_r_inv"><span class="id" title="lemma">himpl_hwand_r_inv</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_refl"><span class="id" title="lemma">himpl_refl</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Arguments</span> <a class="idref" href="Wand.html#Hwand.hwand_cancel"><span class="id" title="lemma">hwand_cancel</span></a> : <span class="id" title="tactic">clear</span> <span class="id" title="var">implicits</span>.<br/>
</div>

<div class="doc">
<a id="lab250"></a><h3 class="section">Further Properties of <span class="inlinecode"><span class="id" title="var">hwand</span></span></h3>

<div class="paragraph"> </div>

 We next present the most important properties of the magic wand operator.
    Here, the tactic <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> is available only in a restricted form that does
    not support magic wand. (The full <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> tactic would trivially solve many
    of these lemmas, but using it here would be cheating because the
    implementation of <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> itself relies on several of these lemmas.) 
<div class="paragraph"> </div>

 The operator <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> is contravariant in <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> and covariant in <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>,
    like the implication operator <span class="inlinecode">→</span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hwand.hwand_himpl" class="idref" href="#Hwand.hwand_himpl"><span class="id" title="lemma">hwand_himpl</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:98" class="idref" href="#H<sub>1</sub>:98"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>1</sub>':99" class="idref" href="#H<sub>1</sub>':99"><span class="id" title="binder">H<sub>1</sub>'</span></a> <a id="H<sub>2</sub>:100" class="idref" href="#H<sub>2</sub>:100"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>2</sub>':101" class="idref" href="#H<sub>2</sub>':101"><span class="id" title="binder">H<sub>2</sub>'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>1</sub>':99"><span class="id" title="variable">H<sub>1</sub>'</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:98"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>2</sub>:100"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>':101"><span class="id" title="variable">H<sub>2</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:98"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:100"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>':99"><span class="id" title="variable">H<sub>1</sub>'</span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>':101"><span class="id" title="variable">H<sub>2</sub>'</span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="var">M<sub>2</sub></span>. <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#Hwand.himpl_hwand_r"><span class="id" title="lemma">himpl_hwand_r</span></a>. <span class="id" title="var">xchange</span> <span class="id" title="var">M<sub>1</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">xchange</span> (<a class="idref" href="Wand.html#Hwand.hwand_cancel"><span class="id" title="lemma">hwand_cancel</span></a> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>). <span class="id" title="var">applys</span> <span class="id" title="var">M<sub>2</sub></span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The predicates <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> and <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span> together simplify to <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span>.
    This is reminiscent of the arithmetic identity
    <span class="inlinecode">(-<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode">+</span> <span class="inlinecode">(-<span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span> <span class="inlinecode">=</span> <span class="inlinecode">(-<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span> (and to the transitivity of ordinary
    implication). 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hwand.hwand_trans_elim" class="idref" href="#Hwand.hwand_trans_elim"><span class="id" title="lemma">hwand_trans_elim</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:102" class="idref" href="#H<sub>1</sub>:102"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:103" class="idref" href="#H<sub>2</sub>:103"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:104" class="idref" href="#H<sub>3</sub>:104"><span class="id" title="binder">H<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:102"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:103"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>2</sub>:103"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:104"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:102"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:104"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#Hwand.himpl_hwand_r"><span class="id" title="lemma">himpl_hwand_r</span></a>. <span class="id" title="var">xchange</span> (<a class="idref" href="Wand.html#Hwand.hwand_cancel"><span class="id" title="lemma">hwand_cancel</span></a> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The predicate <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> holds of the empty heap. Intuitively, we can rewrite
    <span class="inlinecode">0</span> as <span class="inlinecode">-<span class="id" title="var">H</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">H</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hwand.himpl_hempty_hwand_same" class="idref" href="#Hwand.himpl_hempty_hwand_same"><span class="id" title="lemma">himpl_hempty_hwand_same</span></a> : <span class="id" title="keyword">∀</span> <a id="H:105" class="idref" href="#H:105"><span class="id" title="binder">H</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#0a700e54c124035039013e87e1a2bcaa"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H:105"><span class="id" title="variable">H</span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H:105"><span class="id" title="variable">H</span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Wand.html#Hwand.himpl_hwand_r"><span class="id" title="lemma">himpl_hwand_r</span></a>. <span class="id" title="var">xsimpl</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Let's now study the interaction of <span class="inlinecode"><span class="id" title="var">hwand</span></span> with <span class="inlinecode"><span class="id" title="var">hempty</span></span> and <span class="inlinecode"><span class="id" title="var">hpure</span></span>. 
<div class="paragraph"> </div>

 The heap predicate <span class="inlinecode"><span class='gray-font'>\</span>[]</span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> is equivalent to <span class="inlinecode"><span class="id" title="var">H</span></span>. Intuitively, we can
    rewrite <span class="inlinecode">-0+<span class="id" title="var">H</span></span> as <span class="inlinecode">+<span class="id" title="var">H</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hwand.hwand_hempty_l" class="idref" href="#Hwand.hwand_hempty_l"><span class="id" title="lemma">hwand_hempty_l</span></a> : <span class="id" title="keyword">∀</span> <a id="H:106" class="idref" href="#H:106"><span class="id" title="binder">H</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#0a700e54c124035039013e87e1a2bcaa"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H:106"><span class="id" title="variable">H</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#H:106"><span class="id" title="variable">H</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Wand.html#Hwand.hwand"><span class="id" title="definition">hwand</span></a>. <span class="id" title="var">xsimpl</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">H<sub>0</sub></span> <span class="id" title="var">M</span>. <span class="id" title="var">xchange</span> <span class="id" title="var">M</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">xsimpl</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The lemma above shows that <span class="inlinecode"><span class='gray-font'>\</span>[]</span> can be removed from the LHS of a magic
    wand.

<div class="paragraph"> </div>

    More generally, a pure predicate <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">P</span>]</span> can be removed from the LHS of a
    magic wand as long as <span class="inlinecode"><span class="id" title="var">P</span></span> is true. Formally: 
<div class="paragraph"> </div>

<a id="lab251"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (hwand_hpure_l)</h4>

</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hwand.hwand_hpure_l" class="idref" href="#Hwand.hwand_hpure_l"><span class="id" title="lemma">hwand_hpure_l</span></a> : <span class="id" title="keyword">∀</span> <a id="P:107" class="idref" href="#P:107"><span class="id" title="binder">P</span></a> <a id="H:108" class="idref" href="#H:108"><span class="id" title="binder">H</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#P:107"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Wand.html#P:107"><span class="id" title="variable">P</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H:108"><span class="id" title="variable">H</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#H:108"><span class="id" title="variable">H</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 Reciprocally, to prove that a heap satisfies <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">P</span>]</span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>, it suffices to
    prove that this heap satisfies <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> under the assumption that <span class="inlinecode"><span class="id" title="var">P</span></span> is true.
    Formally: 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hwand.himpl_hwand_hpure_r" class="idref" href="#Hwand.himpl_hwand_hpure_r"><span class="id" title="lemma">himpl_hwand_hpure_r</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:109" class="idref" href="#H<sub>1</sub>:109"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:110" class="idref" href="#H<sub>2</sub>:110"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="P:111" class="idref" href="#P:111"><span class="id" title="binder">P</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#P:111"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:109"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:110"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>1</sub>:109"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Wand.html#P:111"><span class="id" title="variable">P</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:110"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#Hwand.himpl_hwand_r"><span class="id" title="lemma">himpl_hwand_r</span></a>. <span class="id" title="var">xsimpl</span>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab252"></a><h4 class="section">Exercise: 2 stars, standard, optional (himpl_hwand_hpure_lr)</h4>
 Prove that <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">P<sub>1</sub></span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">P<sub>2</sub></span>]</span> entails <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">P<sub>1</sub></span>]</span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">P<sub>2</sub></span>]</span>. Hint: use <span class="inlinecode"><span class="id" title="var">xpull</span></span>, then
    use <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> by providing an explicit argument to indicate how the <span class="inlinecode"><span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span>
    on the right-hand side of the entailment should be instantiated. 
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="Hwand.himpl_hwand_hpure_lr" class="idref" href="#Hwand.himpl_hwand_hpure_lr"><span class="id" title="lemma">himpl_hwand_hpure_lr</span></a> : <span class="id" title="keyword">∀</span> (<a id="P<sub>1</sub>:112" class="idref" href="#P<sub>1</sub>:112"><span class="id" title="binder">P<sub>1</sub></span></a> <a id="P<sub>2</sub>:113" class="idref" href="#P<sub>2</sub>:113"><span class="id" title="binder">P<sub>2</sub></span></a>:<span class="id" title="keyword">Prop</span>),<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Wand.html#P<sub>1</sub>:112"><span class="id" title="variable">P<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Wand.html#P<sub>2</sub>:113"><span class="id" title="variable">P<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Wand.html#P<sub>1</sub>:112"><span class="id" title="variable">P<sub>1</sub></span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Wand.html#P<sub>2</sub>:113"><span class="id" title="variable">P<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 Another interesting property is that arguments on the LHS of a magic wand
    can equivalently be "curried" or "uncurried", just as a function of type
    <span class="inlinecode">(<span class="id" title="var">A</span></span> <span class="inlinecode">*</span> <span class="inlinecode"><span class="id" title="var">B</span>)</span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">C</span></span> is equivalent to a function of type <span class="inlinecode"><span class="id" title="var">A</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">B</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">C</span></span>.

<div class="paragraph"> </div>

    The heap predicates <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span>, <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode">(<span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span>, and
    <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span> are all equivalent. Intuitively, they all describe <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span>
    with the missing pieces <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>. 
<div class="paragraph"> </div>

 The equivalence between the uncurried form <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span> and the
    curried form <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode">(<span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span> is formalized by the lemma shown below.
    The third form, <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span>, follows from the commutativity
    property <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hwand.hwand_curry_eq" class="idref" href="#Hwand.hwand_curry_eq"><span class="id" title="lemma">hwand_curry_eq</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:114" class="idref" href="#H<sub>1</sub>:114"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:115" class="idref" href="#H<sub>2</sub>:115"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:116" class="idref" href="#H<sub>3</sub>:116"><span class="id" title="binder">H<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:114"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:115"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:116"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:114"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>2</sub>:115"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:116"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_antisym"><span class="id" title="lemma">himpl_antisym</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="Wand.html#Hwand.himpl_hwand_r"><span class="id" title="lemma">himpl_hwand_r</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="Wand.html#Hwand.himpl_hwand_r"><span class="id" title="lemma">himpl_hwand_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">xchange</span> (<a class="idref" href="Wand.html#Hwand.hwand_cancel"><span class="id" title="lemma">hwand_cancel</span></a> (<span class="id" title="var">H<sub>1</sub></span> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <span class="id" title="var">H<sub>2</sub></span>) <span class="id" title="var">H<sub>3</sub></span>). }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="Wand.html#Hwand.himpl_hwand_r"><span class="id" title="lemma">himpl_hwand_r</span></a>. <span class="id" title="var">xchange</span> (<a class="idref" href="Wand.html#Hwand.hwand_cancel"><span class="id" title="lemma">hwand_cancel</span></a> <span class="id" title="var">H<sub>1</sub></span> (<span class="id" title="var">H<sub>2</sub></span> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <span class="id" title="var">H<sub>3</sub></span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">xchange</span> (<a class="idref" href="Wand.html#Hwand.hwand_cancel"><span class="id" title="lemma">hwand_cancel</span></a> <span class="id" title="var">H<sub>2</sub></span> <span class="id" title="var">H<sub>3</sub></span>). }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Yet another interesting property is that the RHS of a magic wand can absorb
    resources that the magic wand is starred with.

<div class="paragraph"> </div>

    Concretely, from <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span>, we can get the predicate <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span> to be
    absorbed by the <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> in the magic wand, yielding <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode">(<span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span>. One
    way to read this: "if you own <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span> and, when given <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>, you own <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>, then,
    when given <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>, you own both <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> and <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span>." 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hwand.hstar_hwand" class="idref" href="#Hwand.hstar_hwand"><span class="id" title="lemma">hstar_hwand</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:117" class="idref" href="#H<sub>1</sub>:117"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:118" class="idref" href="#H<sub>2</sub>:118"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:119" class="idref" href="#H<sub>3</sub>:119"><span class="id" title="binder">H<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:117"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:118"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:119"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:117"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>2</sub>:118"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:119"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#Hwand.himpl_hwand_r"><span class="id" title="lemma">himpl_hwand_r</span></a>. <span class="id" title="var">xsimpl</span>. <span class="id" title="var">xchange</span> (<a class="idref" href="Wand.html#Hwand.hwand_cancel"><span class="id" title="lemma">hwand_cancel</span></a> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The reciprocal entailment is false: <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode">(<span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span> does not entail
    <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span>.

<div class="paragraph"> </div>

    To see why, instantiate <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> with <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">False</span>]</span>. The predicate
    <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">False</span>]</span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode">(<span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span> is equivalent to <span class="inlinecode"><span class="id" title="var">True</span></span>, hence imposes no
    restriction on the heap. But, to establish <span class="inlinecode">(<span class='gray-font'>\</span>[<span class="id" title="var">False</span>]</span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span>, we
    would need to exhibit a piece of heap satisfiying <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span>. 
<div class="paragraph"> </div>

<a id="lab253"></a><h4 class="section">Exercise: 1 star, standard, especially useful (himpl_hwand_hstar_same_r)</h4>
 Prove that <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> entails <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode">(<span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span>)</span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hwand.himpl_hwand_hstar_same_r" class="idref" href="#Hwand.himpl_hwand_hstar_same_r"><span class="id" title="lemma">himpl_hwand_hstar_same_r</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:120" class="idref" href="#H<sub>1</sub>:120"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:121" class="idref" href="#H<sub>2</sub>:121"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>1</sub>:120"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>2</sub>:121"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>2</sub>:121"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:120"><span class="id" title="variable">H<sub>1</sub></span></a><a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">)</span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab254"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (hwand_cancel_part)</h4>
 Prove that <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode">((<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span> simplifies to <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hwand.hwand_cancel_part" class="idref" href="#Hwand.hwand_cancel_part"><span class="id" title="lemma">hwand_cancel_part</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:122" class="idref" href="#H<sub>1</sub>:122"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:123" class="idref" href="#H<sub>2</sub>:123"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:124" class="idref" href="#H<sub>3</sub>:124"><span class="id" title="binder">H<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>1</sub>:122"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:122"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:123"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:124"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>2</sub>:123"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:124"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab255"></a><h4 class="section">Exercise: 3 stars, standard, optional (hwand_frame)</h4>
 Prove that <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> entails to <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode">(<span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span>. Hint: use
    <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hwand.hwand_frame" class="idref" href="#Hwand.hwand_frame"><span class="id" title="lemma">hwand_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:125" class="idref" href="#H<sub>1</sub>:125"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:126" class="idref" href="#H<sub>2</sub>:126"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:127" class="idref" href="#H<sub>3</sub>:127"><span class="id" title="binder">H<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>1</sub>:125"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:126"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:125"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:127"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>2</sub>:126"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:127"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab256"></a><h4 class="section">Exercise: 3 stars, standard, optional (hwand_inv)</h4>
 Prove the following inversion lemma for <span class="inlinecode"><span class="id" title="var">hwand</span></span>. This lemma essentially
    captures the fact that <span class="inlinecode"><span class="id" title="var">hwand</span></span> entails the alternative definition named
    <span class="inlinecode"><span class="id" title="var">hwand'</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Hwand.hwand_inv" class="idref" href="#Hwand.hwand_inv"><span class="id" title="lemma">hwand_inv</span></a> : <span class="id" title="keyword">∀</span> <a id="h<sub>1</sub>:128" class="idref" href="#h<sub>1</sub>:128"><span class="id" title="binder">h<sub>1</sub></span></a> <a id="h<sub>2</sub>:129" class="idref" href="#h<sub>2</sub>:129"><span class="id" title="binder">h<sub>2</sub></span></a> <a id="H<sub>1</sub>:130" class="idref" href="#H<sub>1</sub>:130"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:131" class="idref" href="#H<sub>2</sub>:131"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:130"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:131"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">h<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>1</sub>:130"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#h<sub>1</sub>:128"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.disjoint"><span class="id" title="definition">Fmap.disjoint</span></a> <a class="idref" href="Wand.html#h<sub>1</sub>:128"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="Wand.html#h<sub>2</sub>:129"><span class="id" title="variable">h<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>2</sub>:131"><span class="id" title="variable">H<sub>2</sub></span></a> (<a class="idref" href="Wand.html#h<sub>1</sub>:128"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <a class="idref" href="Wand.html#h<sub>2</sub>:129"><span class="id" title="variable">h<sub>2</sub></span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="code">

<span class="id" title="keyword">End</span> <a class="idref" href="Wand.html#Hwand"><span class="id" title="module">Hwand</span></a>.<br/>
</div>

<div class="doc">
<a id="lab257"></a><h2 class="section">Definition of the Magic Wand Operator for Postconditions: <span class="inlinecode"><span class="id" title="var">qwand</span></span></h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="Qwand" class="idref" href="#Qwand"><span class="id" title="module">Qwand</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="Wand.html#Hwand"><span class="id" title="module">Hwand</span></a>.<br/>
</div>

<div class="doc">
In what follows, we generalize the magic wand to operate on postconditions,
    introducing a heap predicate of the form <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span>, of type <span class="inlinecode"><span class="id" title="var">hprop</span></span>.

<div class="paragraph"> </div>

    Note that the magic wand between two postconditions produces a heap
    predicate, not a postcondition. 
<div class="paragraph"> </div>

 There are two ways to define the operator <span class="inlinecode"><span class="id" title="var">qwand</span></span>. The first is to follow
    the same pattern as for <span class="inlinecode"><span class="id" title="var">hwand</span></span>, that is, to quantify some heap predicate
    <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> such that <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> starred with <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> yields <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="Qwand.qwand'" class="idref" href="#Qwand.qwand'"><span class="id" title="definition">qwand'</span></a> (<a id="Q<sub>1</sub>:132" class="idref" href="#Q<sub>1</sub>:132"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:133" class="idref" href="#Q<sub>2</sub>:133"><span class="id" title="binder">Q<sub>2</sub></span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="H<sub>0</sub>:134" class="idref" href="#H<sub>0</sub>:134"><span class="id" title="binder">H<sub>0</sub></span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:134"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a> <a class="idref" href="Wand.html#Q<sub>1</sub>:132"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:134"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:133"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a>.<br/>
</div>

<div class="doc">
The second possibility is to define <span class="inlinecode"><span class="id" title="var">qwand</span></span> directly on top of <span class="inlinecode"><span class="id" title="var">hwand</span></span>, by
    means of the <span class="inlinecode"><span class="id" title="var">hforall</span></span> quantifier. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="Qwand.qwand" class="idref" href="#Qwand.qwand"><span class="id" title="definition">qwand</span></a> (<a id="Q<sub>1</sub>:135" class="idref" href="#Q<sub>1</sub>:135"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:136" class="idref" href="#Q<sub>2</sub>:136"><span class="id" title="binder">Q<sub>2</sub></span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">∀</span></a> <a id="v:137" class="idref" href="#v:137"><span class="id" title="binder">v</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:135"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#v:137"><span class="id" title="variable">v</span></a><a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>2</sub>:136"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="Wand.html#v:137"><span class="id" title="variable">v</span></a><a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation">)</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Notation</span> <a id="2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>" class="idref" href="#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation">&quot;</span></a>Q<sub>1</sub> <span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span> Q<sub>2</sub>" := (<a class="idref" href="Wand.html#Qwand.qwand"><span class="id" title="definition">qwand</span></a> <span class="id" title="var">Q<sub>1</sub></span> <span class="id" title="var">Q<sub>2</sub></span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 43).<br/>
</div>

<div class="doc">
As we establish later in this chapter, <span class="inlinecode"><span class="id" title="var">qwand</span></span> and <span class="inlinecode"><span class="id" title="var">qwand'</span></span> both define the
    same operator. We prefer taking <span class="inlinecode"><span class="id" title="var">qwand</span></span> as the definition because in
    practice instantiating the universal quantifier is the most useful way to
    exploit a magic wand between postconditions. This specialization operation
    is formalized next. This result is a direct consequence of the
    specialization result for <span class="inlinecode">\<span class="id" title="keyword">∀</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Qwand.qwand_specialize" class="idref" href="#Qwand.qwand_specialize"><span class="id" title="lemma">qwand_specialize</span></a> : <span class="id" title="keyword">∀</span> (<a id="v:138" class="idref" href="#v:138"><span class="id" title="binder">v</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a>) (<a id="Q<sub>1</sub>:139" class="idref" href="#Q<sub>1</sub>:139"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:140" class="idref" href="#Q<sub>2</sub>:140"><span class="id" title="binder">Q<sub>2</sub></span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:139"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:140"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:139"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#v:138"><span class="id" title="variable">v</span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:140"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="Wand.html#v:138"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Wand.html#Qwand.qwand"><span class="id" title="definition">qwand</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_hforall_l"><span class="id" title="lemma">himpl_hforall_l</span></a> <span class="id" title="var">v</span>. <span class="id" title="var">xsimpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The predicate <span class="inlinecode"><span class="id" title="var">qwand</span></span> satisfies numerous properties that are direct
    counterparts of the properties on <span class="inlinecode"><span class="id" title="var">hwand</span></span>. First, <span class="inlinecode"><span class="id" title="var">qwand</span></span> satisfies a
    characteristic equivalence rule. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Qwand.qwand_equiv" class="idref" href="#Qwand.qwand_equiv"><span class="id" title="lemma">qwand_equiv</span></a> : <span class="id" title="keyword">∀</span> <a id="H:141" class="idref" href="#H:141"><span class="id" title="binder">H</span></a> <a id="Q<sub>1</sub>:142" class="idref" href="#Q<sub>1</sub>:142"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:143" class="idref" href="#Q<sub>2</sub>:143"><span class="id" title="binder">Q<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Wand.html#H:141"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:142"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:143"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:142"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Wand.html#H:141"><span class="id" title="variable">H</span></a><a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:143"><span class="id" title="variable">Q<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iff</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="var">xchange</span> <span class="id" title="var">M</span>. <span class="id" title="var">xchange</span> (<a class="idref" href="Wand.html#Qwand.qwand_specialize"><span class="id" title="lemma">qwand_specialize</span></a> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">xchange</span> (<a class="idref" href="Wand.html#Hwand.hwand_cancel"><span class="id" title="lemma">hwand_cancel</span></a> (<span class="id" title="var">Q<sub>1</sub></span> <span class="id" title="var">x</span>)). }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_hforall_r"><span class="id" title="lemma">himpl_hforall_r</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#Hwand.himpl_hwand_r"><span class="id" title="lemma">himpl_hwand_r</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">xchange</span> (<span class="id" title="var">M</span> <span class="id" title="var">x</span>). }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Second, <span class="inlinecode"><span class="id" title="var">qwand</span></span> satisfies a cancellation rule. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Qwand.qwand_cancel" class="idref" href="#Qwand.qwand_cancel"><span class="id" title="lemma">qwand_cancel</span></a> : <span class="id" title="keyword">∀</span> <a id="Q<sub>1</sub>:144" class="idref" href="#Q<sub>1</sub>:144"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:145" class="idref" href="#Q<sub>2</sub>:145"><span class="id" title="binder">Q<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#Q<sub>1</sub>:144"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:144"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:145"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:145"><span class="id" title="variable">Q<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="Wand.html#Qwand.qwand_equiv"><span class="id" title="lemma">qwand_equiv</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.qimpl_refl"><span class="id" title="lemma">qimpl_refl</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Third, the operation <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span> is contravariant in <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> and covariant in
    <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Qwand.qwand_himpl" class="idref" href="#Qwand.qwand_himpl"><span class="id" title="lemma">qwand_himpl</span></a> : <span class="id" title="keyword">∀</span> <a id="Q<sub>1</sub>:146" class="idref" href="#Q<sub>1</sub>:146"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>1</sub>':147" class="idref" href="#Q<sub>1</sub>':147"><span class="id" title="binder">Q<sub>1</sub>'</span></a> <a id="Q<sub>2</sub>:148" class="idref" href="#Q<sub>2</sub>:148"><span class="id" title="binder">Q<sub>2</sub></span></a> <a id="Q<sub>2</sub>':149" class="idref" href="#Q<sub>2</sub>':149"><span class="id" title="binder">Q<sub>2</sub>'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#Q<sub>1</sub>':147"><span class="id" title="variable">Q<sub>1</sub>'</span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Wand.html#Q<sub>1</sub>:146"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#Q<sub>2</sub>:148"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>':149"><span class="id" title="variable">Q<sub>2</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:146"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:148"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>':147"><span class="id" title="variable">Q<sub>1</sub>'</span></a> <a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>':149"><span class="id" title="variable">Q<sub>2</sub>'</span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="var">M<sub>2</sub></span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="Wand.html#Qwand.qwand_equiv"><span class="id" title="lemma">qwand_equiv</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">xchange</span> (<a class="idref" href="Wand.html#Qwand.qwand_specialize"><span class="id" title="lemma">qwand_specialize</span></a> <span class="id" title="var">x</span>). <span class="id" title="var">xchange</span> <span class="id" title="var">M<sub>1</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">xchange</span> (<a class="idref" href="Wand.html#Hwand.hwand_cancel"><span class="id" title="lemma">hwand_cancel</span></a> (<span class="id" title="var">Q<sub>1</sub></span> <span class="id" title="var">x</span>)). <span class="id" title="var">xchange</span> <span class="id" title="var">M<sub>2</sub></span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Fourth the operation <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span> can absorb in its RHS resources to which
    it is starred. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Qwand.hstar_qwand" class="idref" href="#Qwand.hstar_qwand"><span class="id" title="lemma">hstar_qwand</span></a> : <span class="id" title="keyword">∀</span> <a id="Q<sub>1</sub>:150" class="idref" href="#Q<sub>1</sub>:150"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:151" class="idref" href="#Q<sub>2</sub>:151"><span class="id" title="binder">Q<sub>2</sub></span></a> <a id="H:152" class="idref" href="#H:152"><span class="id" title="binder">H</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:150"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:151"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H:152"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#Q<sub>1</sub>:150"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>2</sub>:151"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Wand.html#H:152"><span class="id" title="variable">H</span></a><a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="Wand.html#Qwand.qwand_equiv"><span class="id" title="lemma">qwand_equiv</span></a>. <span class="id" title="var">xchange</span> (@<a class="idref" href="Wand.html#Qwand.qwand_cancel"><span class="id" title="lemma">qwand_cancel</span></a> <span class="id" title="var">Q<sub>1</sub></span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab258"></a><h4 class="section">Exercise: 1 star, standard, especially useful (himpl_qwand_hstar_same_r)</h4>
 Prove that <span class="inlinecode"><span class="id" title="var">H</span></span> entails <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span> <span class="inlinecode">(<span class="id" title="var">Q</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*+</span> <span class="inlinecode"><span class="id" title="var">H</span>)</span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Qwand.himpl_qwand_hstar_same_r" class="idref" href="#Qwand.himpl_qwand_hstar_same_r"><span class="id" title="lemma">himpl_qwand_hstar_same_r</span></a> : <span class="id" title="keyword">∀</span> <a id="H:153" class="idref" href="#H:153"><span class="id" title="binder">H</span></a> <a id="Q:154" class="idref" href="#Q:154"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H:153"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#Q:154"><span class="id" title="variable">Q</span></a> <a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q:154"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Wand.html#H:153"><span class="id" title="variable">H</span></a><a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab259"></a><h4 class="section">Exercise: 2 stars, standard, optional (qwand_cancel_part)</h4>
 Prove that <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode">((<span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*+</span> <span class="inlinecode"><span class="id" title="var">H</span>)</span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span>)</span> simplifies to <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span>. Hint: use
    <span class="inlinecode"><span class="id" title="var">xchange</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="Qwand.qwand_cancel_part" class="idref" href="#Qwand.qwand_cancel_part"><span class="id" title="lemma">qwand_cancel_part</span></a> : <span class="id" title="keyword">∀</span> <a id="H:155" class="idref" href="#H:155"><span class="id" title="binder">H</span></a> <a id="Q<sub>1</sub>:156" class="idref" href="#Q<sub>1</sub>:156"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:157" class="idref" href="#Q<sub>2</sub>:157"><span class="id" title="binder">Q<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H:155"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:156"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Wand.html#H:155"><span class="id" title="variable">H</span></a><a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:157"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:156"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:157"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="code">

<span class="id" title="keyword">End</span> <a class="idref" href="Wand.html#Qwand"><span class="id" title="module">Qwand</span></a>.<br/>
</div>

<div class="doc">
<a id="lab260"></a><h2 class="section">Simplifications of Magic Wands using <span class="inlinecode"><span class="id" title="var">xsimpl</span></span></h2>

<div class="paragraph"> </div>

 We can extend the tactic <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> to recognize the magic wand and
    automatically perform a number of obvious simplifications. This extension is
    implemented in the file <span class="inlinecode"><span class="id" title="var">LibSepSimpl</span></span>, which exports the version of <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>
    illustrated here. 
</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="XsimplDemo" class="idref" href="#XsimplDemo"><span class="id" title="module">XsimplDemo</span></a>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">xsimpl</span></span> is able to spot a magic wand that cancels out. For example, if an
    iterated separating conjunction includes both <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span> and <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>, then
    these two heap predicates can be simplified into <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplDemo.xsimpl_demo_hwand_cancel" class="idref" href="#XsimplDemo.xsimpl_demo_hwand_cancel"><span class="id" title="lemma">xsimpl_demo_hwand_cancel</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:158" class="idref" href="#H<sub>1</sub>:158"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:159" class="idref" href="#H<sub>2</sub>:159"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:160" class="idref" href="#H<sub>3</sub>:160"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:161" class="idref" href="#H<sub>4</sub>:161"><span class="id" title="binder">H<sub>4</sub></span></a> <a id="H<sub>5</sub>:162" class="idref" href="#H<sub>5</sub>:162"><span class="id" title="binder">H<sub>5</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>1</sub>:158"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>2</sub>:159"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:160"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>4</sub>:161"><span class="id" title="variable">H<sub>4</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:159"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>5</sub>:162"><span class="id" title="variable">H<sub>5</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>. <span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">xsimpl</span></span> is able to simplify uncurried magic wands. For example, if an
    iterated separating conjunction includes <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>4</sub></span></span> and <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>,
    the two predicates can be simplified into <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>4</sub></span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplDemo.xsimpl_demo_hwand_cancel_partial" class="idref" href="#XsimplDemo.xsimpl_demo_hwand_cancel_partial"><span class="id" title="lemma">xsimpl_demo_hwand_cancel_partial</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:163" class="idref" href="#H<sub>1</sub>:163"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:164" class="idref" href="#H<sub>2</sub>:164"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:165" class="idref" href="#H<sub>3</sub>:165"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:166" class="idref" href="#H<sub>4</sub>:166"><span class="id" title="binder">H<sub>4</sub></span></a> <a id="H<sub>5</sub>:167" class="idref" href="#H<sub>5</sub>:167"><span class="id" title="binder">H<sub>5</sub></span></a> <a id="H<sub>6</sub>:168" class="idref" href="#H<sub>6</sub>:168"><span class="id" title="binder">H<sub>6</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:163"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:164"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:165"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>4</sub>:166"><span class="id" title="variable">H<sub>4</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>5</sub>:167"><span class="id" title="variable">H<sub>5</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:164"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>6</sub>:168"><span class="id" title="variable">H<sub>6</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>. <span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">xsimpl</span></span> automatically applies the introduction rule <span class="inlinecode"><span class="id" title="var">himpl_hwand_r</span></span> when
    the right-hand-side, after prior simplification, reduces to just a magic
    wand. In the example below, <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> is first cancelled out from both sides,
    then <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span> is moved from the RHS to the LHS. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplDemo.xsimpl_demo_himpl_hwand_r" class="idref" href="#XsimplDemo.xsimpl_demo_himpl_hwand_r"><span class="id" title="lemma">xsimpl_demo_himpl_hwand_r</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:169" class="idref" href="#H<sub>1</sub>:169"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:170" class="idref" href="#H<sub>2</sub>:170"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:171" class="idref" href="#H<sub>3</sub>:171"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:172" class="idref" href="#H<sub>4</sub>:172"><span class="id" title="binder">H<sub>4</sub></span></a> <a id="H<sub>5</sub>:173" class="idref" href="#H<sub>5</sub>:173"><span class="id" title="binder">H<sub>5</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>1</sub>:169"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:170"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:169"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>3</sub>:171"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>4</sub>:172"><span class="id" title="variable">H<sub>4</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>5</sub>:173"><span class="id" title="variable">H<sub>5</sub></span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">)</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>. <span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">xsimpl</span></span> can iterate a number of simplifications involving different magic
    wands. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplDemo.xsimpl_demo_hwand_iter" class="idref" href="#XsimplDemo.xsimpl_demo_hwand_iter"><span class="id" title="lemma">xsimpl_demo_hwand_iter</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:174" class="idref" href="#H<sub>1</sub>:174"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:175" class="idref" href="#H<sub>2</sub>:175"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:176" class="idref" href="#H<sub>3</sub>:176"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:177" class="idref" href="#H<sub>4</sub>:177"><span class="id" title="binder">H<sub>4</sub></span></a> <a id="H<sub>5</sub>:178" class="idref" href="#H<sub>5</sub>:178"><span class="id" title="binder">H<sub>5</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>4</sub>:177"><span class="id" title="variable">H<sub>4</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:176"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>5</sub>:178"><span class="id" title="variable">H<sub>5</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>2</sub>:175"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:174"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:176"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>4</sub>:177"><span class="id" title="variable">H<sub>4</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>2</sub>:175"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:174"><span class="id" title="variable">H<sub>1</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>5</sub>:178"><span class="id" title="variable">H<sub>5</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">xsimpl</span></span> can iterate simplifications on both sides. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplDemo.xsimpl_demo_hwand_iter_2" class="idref" href="#XsimplDemo.xsimpl_demo_hwand_iter_2"><span class="id" title="lemma">xsimpl_demo_hwand_iter_2</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:179" class="idref" href="#H<sub>1</sub>:179"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:180" class="idref" href="#H<sub>2</sub>:180"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:181" class="idref" href="#H<sub>3</sub>:181"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:182" class="idref" href="#H<sub>4</sub>:182"><span class="id" title="binder">H<sub>4</sub></span></a> <a id="H<sub>5</sub>:183" class="idref" href="#H<sub>5</sub>:183"><span class="id" title="binder">H<sub>5</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H<sub>1</sub>:179"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:180"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:179"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:181"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>4</sub>:182"><span class="id" title="variable">H<sub>4</sub></span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>5</sub>:183"><span class="id" title="variable">H<sub>5</sub></span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">)</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>4</sub>:182"><span class="id" title="variable">H<sub>4</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>2</sub>:180"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:181"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>5</sub>:183"><span class="id" title="variable">H<sub>5</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">xsimpl</span></span> is also able to deal with the magic wand for postconditions. In
    particular, it is able to simplify the conjunction of <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span> and
    <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> into <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplDemo.xsimpl_demo_qwand_cancel" class="idref" href="#XsimplDemo.xsimpl_demo_qwand_cancel"><span class="id" title="lemma">xsimpl_demo_qwand_cancel</span></a> : <span class="id" title="keyword">∀</span> <a id="v:184" class="idref" href="#v:184"><span class="id" title="binder">v</span></a> (<a id="Q<sub>1</sub>:185" class="idref" href="#Q<sub>1</sub>:185"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:186" class="idref" href="#Q<sub>2</sub>:186"><span class="id" title="binder">Q<sub>2</sub></span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) <a id="H<sub>1</sub>:187" class="idref" href="#H<sub>1</sub>:187"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:188" class="idref" href="#H<sub>2</sub>:188"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:185"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#5609a52f091556b9923d5758aa61f543"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:186"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:187"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:185"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#v:184"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:188"><span class="id" title="variable">H<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>. <span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">xsimpl</span></span> is able to prove entailments whose right-hand side is a magic wand.
    
</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <a id="XsimplDemo.xsimpl_hwand_frame" class="idref" href="#XsimplDemo.xsimpl_hwand_frame"><span class="id" title="lemma">xsimpl_hwand_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:189" class="idref" href="#H<sub>1</sub>:189"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:190" class="idref" href="#H<sub>2</sub>:190"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:191" class="idref" href="#H<sub>3</sub>:191"><span class="id" title="binder">H<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:189"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:190"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:189"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:191"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>2</sub>:190"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>3</sub>:191"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">)</span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;<span class="inlinecode"><span class="id" title="var">xsimpl</span></span>'s&nbsp;first&nbsp;step&nbsp;is&nbsp;to&nbsp;turn&nbsp;the&nbsp;goal&nbsp;into<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span> <span class="inlinecode">==&gt;</span> <span class="inlinecode">(<span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span>.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">xsimpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="Wand.html#XsimplDemo"><span class="id" title="module">XsimplDemo</span></a>.<br/>
</div>

<div class="doc">
<a id="lab261"></a><h2 class="section">Summary of All the Separation Logic Operators</h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="SummaryHprop" class="idref" href="#SummaryHprop"><span class="id" title="module">SummaryHprop</span></a>.<br/>
</div>

<div class="doc">
The core operators are defined as functions over heaps. 
</div>
<div class="code">

&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="SummaryHprop.hempty" class="idref" href="#SummaryHprop.hempty"><span class="id" title="definition">hempty</span></a> : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="h:192" class="idref" href="#h:192"><span class="id" title="binder">h</span></a> ⇒ (<a class="idref" href="Wand.html#h:192"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#Fmap.empty"><span class="id" title="definition">Fmap.empty</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="SummaryHprop.hsingle" class="idref" href="#SummaryHprop.hsingle"><span class="id" title="definition">hsingle</span></a> (<a id="p:193" class="idref" href="#p:193"><span class="id" title="binder">p</span></a>:<a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>) (<a id="v:194" class="idref" href="#v:194"><span class="id" title="binder">v</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="h:195" class="idref" href="#h:195"><span class="id" title="binder">h</span></a> ⇒ (<a class="idref" href="Wand.html#h:195"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#Fmap.single"><span class="id" title="definition">Fmap.single</span></a> <a class="idref" href="Wand.html#p:193"><span class="id" title="variable">p</span></a> <a class="idref" href="Wand.html#v:194"><span class="id" title="variable">v</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="SummaryHprop.hstar" class="idref" href="#SummaryHprop.hstar"><span class="id" title="definition">hstar</span></a> (<a id="H<sub>1</sub>:196" class="idref" href="#H<sub>1</sub>:196"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:197" class="idref" href="#H<sub>2</sub>:197"><span class="id" title="binder">H<sub>2</sub></span></a> : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="h:198" class="idref" href="#h:198"><span class="id" title="binder">h</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="h<sub>1</sub>:199" class="idref" href="#h<sub>1</sub>:199"><span class="id" title="binder">h<sub>1</sub></span></a> <a id="h<sub>2</sub>:200" class="idref" href="#h<sub>2</sub>:200"><span class="id" title="binder">h<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:196"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#h<sub>1</sub>:199"><span class="id" title="variable">h<sub>1</sub></span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:197"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Wand.html#h<sub>2</sub>:200"><span class="id" title="variable">h<sub>2</sub></span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="LibSepReference.html#Fmap.disjoint"><span class="id" title="definition">Fmap.disjoint</span></a> <a class="idref" href="Wand.html#h<sub>1</sub>:199"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="Wand.html#h<sub>2</sub>:200"><span class="id" title="variable">h<sub>2</sub></span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Wand.html#h:198"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#Fmap.union"><span class="id" title="definition">Fmap.union</span></a> <a class="idref" href="Wand.html#h<sub>1</sub>:199"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="Wand.html#h<sub>2</sub>:200"><span class="id" title="variable">h<sub>2</sub></span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="SummaryHprop.hexists" class="idref" href="#SummaryHprop.hexists"><span class="id" title="definition">hexists</span></a> <a id="A:201" class="idref" href="#A:201"><span class="id" title="binder">A</span></a> (<a id="J:202" class="idref" href="#J:202"><span class="id" title="binder">J</span></a>:<a class="idref" href="Wand.html#A:201"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="h:203" class="idref" href="#h:203"><span class="id" title="binder">h</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="x:204" class="idref" href="#x:204"><span class="id" title="binder">x</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Wand.html#J:202"><span class="id" title="variable">J</span></a> <a class="idref" href="Wand.html#x:204"><span class="id" title="variable">x</span></a> <a class="idref" href="Wand.html#h:203"><span class="id" title="variable">h</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="SummaryHprop.hforall" class="idref" href="#SummaryHprop.hforall"><span class="id" title="definition">hforall</span></a> (<a id="A:205" class="idref" href="#A:205"><span class="id" title="binder">A</span></a> : <span class="id" title="keyword">Type</span>) (<a id="J:206" class="idref" href="#J:206"><span class="id" title="binder">J</span></a> : <a class="idref" href="Wand.html#A:205"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="h:207" class="idref" href="#h:207"><span class="id" title="binder">h</span></a> ⇒ <span class="id" title="keyword">∀</span> <a id="x:208" class="idref" href="#x:208"><span class="id" title="binder">x</span></a>, <a class="idref" href="Wand.html#J:206"><span class="id" title="variable">J</span></a> <a class="idref" href="Wand.html#x:208"><span class="id" title="variable">x</span></a> <a class="idref" href="Wand.html#h:207"><span class="id" title="variable">h</span></a>.<br/>
</div>

<div class="doc">
The remaining operators can be defined in terms of the core operators. 
</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="SummaryHprop.ReaminingOperatorsDerived" class="idref" href="#SummaryHprop.ReaminingOperatorsDerived"><span class="id" title="module">ReaminingOperatorsDerived</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="SummaryHprop.ReaminingOperatorsDerived.hpure" class="idref" href="#SummaryHprop.ReaminingOperatorsDerived.hpure"><span class="id" title="definition">hpure</span></a> (<a id="P:209" class="idref" href="#P:209"><span class="id" title="binder">P</span></a>:<span class="id" title="keyword">Prop</span>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">(</span></a><a id="p:210" class="idref" href="#p:210"><span class="id" title="binder">p</span></a>:<a class="idref" href="Wand.html#P:209"><span class="id" title="variable">P</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">),</span></a> <a class="idref" href="LibSepReference.html#0a700e54c124035039013e87e1a2bcaa"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="SummaryHprop.ReaminingOperatorsDerived.hand" class="idref" href="#SummaryHprop.ReaminingOperatorsDerived.hand"><span class="id" title="definition">hand</span></a> (<a id="H<sub>1</sub>:211" class="idref" href="#H<sub>1</sub>:211"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:212" class="idref" href="#H<sub>2</sub>:212"><span class="id" title="binder">H<sub>2</sub></span></a> : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">∀</span></a> <a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">(</span></a><a id="b:213" class="idref" href="#b:213"><span class="id" title="binder">b</span></a>:<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">),</span></a> <span class="id" title="keyword">if</span> <a class="idref" href="Wand.html#b:213"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Wand.html#H<sub>1</sub>:211"><span class="id" title="variable">H<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Wand.html#H<sub>2</sub>:212"><span class="id" title="variable">H<sub>2</sub></span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="SummaryHprop.ReaminingOperatorsDerived.hor" class="idref" href="#SummaryHprop.ReaminingOperatorsDerived.hor"><span class="id" title="definition">hor</span></a> (<a id="H<sub>1</sub>:214" class="idref" href="#H<sub>1</sub>:214"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:215" class="idref" href="#H<sub>2</sub>:215"><span class="id" title="binder">H<sub>2</sub></span></a> : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">(</span></a><a id="b:216" class="idref" href="#b:216"><span class="id" title="binder">b</span></a>:<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">),</span></a> <span class="id" title="keyword">if</span> <a class="idref" href="Wand.html#b:216"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Wand.html#H<sub>1</sub>:214"><span class="id" title="variable">H<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Wand.html#H<sub>2</sub>:215"><span class="id" title="variable">H<sub>2</sub></span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="SummaryHprop.ReaminingOperatorsDerived.hwand" class="idref" href="#SummaryHprop.ReaminingOperatorsDerived.hwand"><span class="id" title="definition">hwand</span></a> (<a id="H<sub>1</sub>:217" class="idref" href="#H<sub>1</sub>:217"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:218" class="idref" href="#H<sub>2</sub>:218"><span class="id" title="binder">H<sub>2</sub></span></a> : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="H<sub>0</sub>:219" class="idref" href="#H<sub>0</sub>:219"><span class="id" title="binder">H<sub>0</sub></span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:219"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:217"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:219"><span class="id" title="variable">H<sub>0</sub></span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:218"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="SummaryHprop.ReaminingOperatorsDerived.qwand" class="idref" href="#SummaryHprop.ReaminingOperatorsDerived.qwand"><span class="id" title="definition">qwand</span></a> (<a id="Q<sub>1</sub>:220" class="idref" href="#Q<sub>1</sub>:220"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:221" class="idref" href="#Q<sub>2</sub>:221"><span class="id" title="binder">Q<sub>2</sub></span></a> : <a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">∀</span></a> <a id="v:222" class="idref" href="#v:222"><span class="id" title="binder">v</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:220"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#v:222"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>2</sub>:221"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="Wand.html#v:222"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">)</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="Wand.html#SummaryHprop.ReaminingOperatorsDerived"><span class="id" title="module">ReaminingOperatorsDerived</span></a>.<br/>
</div>

<div class="doc">
Of course, these derived operators could also be defined directly as
    predicate over heaps. The definitions are shown below. However, establishing
    properties of such low-level definitions requires more effort than
    establishing properties for the derived definitions shown above. Indeed,
    when operators are defined as derived operations, their properties may be
    established with help of the powerful entailment simplification tactic
    <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="SummaryHprop.ReaminingOperatorsDirect" class="idref" href="#SummaryHprop.ReaminingOperatorsDirect"><span class="id" title="module">ReaminingOperatorsDirect</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="SummaryHprop.ReaminingOperatorsDirect.hpure" class="idref" href="#SummaryHprop.ReaminingOperatorsDirect.hpure"><span class="id" title="definition">hpure</span></a> (<a id="P:223" class="idref" href="#P:223"><span class="id" title="binder">P</span></a>:<span class="id" title="keyword">Prop</span>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="h:224" class="idref" href="#h:224"><span class="id" title="binder">h</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#h:224"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#Fmap.empty"><span class="id" title="definition">Fmap.empty</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Wand.html#P:223"><span class="id" title="variable">P</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="SummaryHprop.ReaminingOperatorsDirect.hor" class="idref" href="#SummaryHprop.ReaminingOperatorsDirect.hor"><span class="id" title="definition">hor</span></a> (<a id="H<sub>1</sub>:225" class="idref" href="#H<sub>1</sub>:225"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:226" class="idref" href="#H<sub>2</sub>:226"><span class="id" title="binder">H<sub>2</sub></span></a> : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="h:227" class="idref" href="#h:227"><span class="id" title="binder">h</span></a> ⇒ <a class="idref" href="Wand.html#H<sub>1</sub>:225"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#h:227"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e<sub>25</sub>"><span class="id" title="notation">∨</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:226"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Wand.html#h:227"><span class="id" title="variable">h</span></a>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="SummaryHprop.ReaminingOperatorsDirect.hand" class="idref" href="#SummaryHprop.ReaminingOperatorsDirect.hand"><span class="id" title="definition">hand</span></a> (<a id="H<sub>1</sub>:228" class="idref" href="#H<sub>1</sub>:228"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:229" class="idref" href="#H<sub>2</sub>:229"><span class="id" title="binder">H<sub>2</sub></span></a> : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="h:230" class="idref" href="#h:230"><span class="id" title="binder">h</span></a> ⇒ <a class="idref" href="Wand.html#H<sub>1</sub>:228"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#h:230"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:229"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Wand.html#h:230"><span class="id" title="variable">h</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="SummaryHprop.ReaminingOperatorsDirect.hwand" class="idref" href="#SummaryHprop.ReaminingOperatorsDirect.hwand"><span class="id" title="definition">hwand</span></a> (<a id="H<sub>1</sub>:231" class="idref" href="#H<sub>1</sub>:231"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:232" class="idref" href="#H<sub>2</sub>:232"><span class="id" title="binder">H<sub>2</sub></span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="h:233" class="idref" href="#h:233"><span class="id" title="binder">h</span></a> ⇒ <span class="id" title="keyword">∀</span> <a id="h':234" class="idref" href="#h':234"><span class="id" title="binder">h'</span></a>, <a class="idref" href="LibSepReference.html#Fmap.disjoint"><span class="id" title="definition">Fmap.disjoint</span></a> <a class="idref" href="Wand.html#h:233"><span class="id" title="variable">h</span></a> <a class="idref" href="Wand.html#h':234"><span class="id" title="variable">h'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:231"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#h':234"><span class="id" title="variable">h'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:232"><span class="id" title="variable">H<sub>2</sub></span></a> (<a class="idref" href="Wand.html#h:233"><span class="id" title="variable">h</span></a> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <a class="idref" href="Wand.html#h':234"><span class="id" title="variable">h'</span></a>).<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="SummaryHprop.ReaminingOperatorsDirect.qwand" class="idref" href="#SummaryHprop.ReaminingOperatorsDirect.qwand"><span class="id" title="definition">qwand</span></a> (<a id="Q<sub>1</sub>:235" class="idref" href="#Q<sub>1</sub>:235"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:236" class="idref" href="#Q<sub>2</sub>:236"><span class="id" title="binder">Q<sub>2</sub></span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <a id="h:237" class="idref" href="#h:237"><span class="id" title="binder">h</span></a> ⇒ <span class="id" title="keyword">∀</span> <a id="v:238" class="idref" href="#v:238"><span class="id" title="binder">v</span></a> <a id="h':239" class="idref" href="#h':239"><span class="id" title="binder">h'</span></a>, <a class="idref" href="LibSepReference.html#Fmap.disjoint"><span class="id" title="definition">Fmap.disjoint</span></a> <a class="idref" href="Wand.html#h:237"><span class="id" title="variable">h</span></a> <a class="idref" href="Wand.html#h':239"><span class="id" title="variable">h'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Wand.html#Q<sub>1</sub>:235"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#v:238"><span class="id" title="variable">v</span></a> <a class="idref" href="Wand.html#h':239"><span class="id" title="variable">h'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:236"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="Wand.html#v:238"><span class="id" title="variable">v</span></a> (<a class="idref" href="Wand.html#h:237"><span class="id" title="variable">h</span></a> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <a class="idref" href="Wand.html#h':239"><span class="id" title="variable">h'</span></a>).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="Wand.html#SummaryHprop.ReaminingOperatorsDirect"><span class="id" title="module">ReaminingOperatorsDirect</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="Wand.html#SummaryHprop"><span class="id" title="module">SummaryHprop</span></a>.<br/>
</div>

<div class="doc">
<a id="lab262"></a><h2 class="section">The Ramified Frame Rule</h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="RamifiedFrame" class="idref" href="#RamifiedFrame"><span class="id" title="module">RamifiedFrame</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="Wand.html#Hwand"><span class="id" title="module">Hwand</span></a> <a class="idref" href="Wand.html#Qwand"><span class="id" title="module">Qwand</span></a>.<br/>
</div>

<div class="doc">
Recall the consequence-frame rule, which is used pervasively -- for example
    by the tactic <span class="inlinecode"><span class="id" title="var">xapp</span></span>, for reasoning about applications. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="RamifiedFrame.triple_conseq_frame" class="idref" href="#RamifiedFrame.triple_conseq_frame"><span class="id" title="axiom">triple_conseq_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>2</sub>:240" class="idref" href="#H<sub>2</sub>:240"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>1</sub>:241" class="idref" href="#H<sub>1</sub>:241"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="Q<sub>1</sub>:242" class="idref" href="#Q<sub>1</sub>:242"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="t:243" class="idref" href="#t:243"><span class="id" title="binder">t</span></a> <a id="H:244" class="idref" href="#H:244"><span class="id" title="binder">H</span></a> <a id="Q:245" class="idref" href="#Q:245"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Wand.html#t:243"><span class="id" title="variable">t</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:241"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#Q<sub>1</sub>:242"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H:244"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:241"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:240"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#Q<sub>1</sub>:242"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:240"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Wand.html#Q:245"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Wand.html#t:243"><span class="id" title="variable">t</span></a> <a class="idref" href="Wand.html#H:244"><span class="id" title="variable">H</span></a> <a class="idref" href="Wand.html#Q:245"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
This rule suffers from a practical issue, which we illustrate in detail on a
    concrete example further on. At a high-level, though, the problem stems from
    the fact that we need to instantiate <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> when applying the rule. Providing
    <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> by hand is not practical, thus we need to infer it. The value of <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>
    can be computed as the subtraction of <span class="inlinecode"><span class="id" title="var">H</span></span> minus <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>. The resulting value
    may then exploited in the last premise for constructing <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*+</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>. This
    transfer of information via <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> from one subgoal to another can be obtained
    by introducing an "evar" (Coq unification variable) for <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>. However this
    approach does not work well in cases where <span class="inlinecode"><span class="id" title="var">H</span></span> contains existential
    quantifiers. This is because such existential quantifiers are typically
    first extracted out of the entailment <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> by the tactic
    <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>. But these existentially quantified variables are not in the scope
    of <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>, so the instantiation of the evar associated with <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> typically
    fails. 
<div class="paragraph"> </div>

 The "ramified frame rule" exploits the magic wand operator to circumvent
    this problem, by merging the two premises <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> and
    <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*+</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode">===&gt;</span> <span class="inlinecode"><span class="id" title="var">Q</span></span> into a single premise that no longer mentions <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>. This
    replacement premise is <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode">(<span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">Q</span>)</span>. To understand where it
    comes from, observe first that the second premise <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*+</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode">===&gt;</span> <span class="inlinecode"><span class="id" title="var">Q</span></span> is
    equivalent to <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode">(<span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">Q</span>)</span>. By replacing <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> with <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>
    inside the first premise <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>, we obtain the new premise
    <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode">(<span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">Q</span>)</span>. This merge of the two entailments leads us to the
    statement of the "ramified frame rule" shown below. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="RamifiedFrame.triple_ramified_frame" class="idref" href="#RamifiedFrame.triple_ramified_frame"><span class="id" title="lemma">triple_ramified_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:247" class="idref" href="#H<sub>1</sub>:247"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="Q<sub>1</sub>:248" class="idref" href="#Q<sub>1</sub>:248"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="t:249" class="idref" href="#t:249"><span class="id" title="binder">t</span></a> <a id="H:250" class="idref" href="#H:250"><span class="id" title="binder">H</span></a> <a id="Q:251" class="idref" href="#Q:251"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Wand.html#t:249"><span class="id" title="variable">t</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:247"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#Q<sub>1</sub>:248"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H:250"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:247"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:248"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#Q:251"><span class="id" title="variable">Q</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Wand.html#t:249"><span class="id" title="variable">t</span></a> <a class="idref" href="Wand.html#H:250"><span class="id" title="variable">H</span></a> <a class="idref" href="Wand.html#Q:251"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">W</span>. <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#RamifiedFrame.triple_conseq_frame"><span class="id" title="axiom">triple_conseq_frame</span></a> (<span class="id" title="var">Q<sub>1</sub></span> <a class="idref" href="Wand.html#2ca19c75a84d0d4212be25e7f2bf54d<sub>5</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span></a> <span class="id" title="var">Q</span>) <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <span class="id" title="var">W</span>. } { <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#Qwand.qwand_cancel"><span class="id" title="lemma">qwand_cancel</span></a>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Reciprocally, we can prove that the ramified frame rule entails the
    consequence-frame rule. Hence, the ramified frame rule has the same
    expressive power as the consequence-frame rule. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="RamifiedFrame.triple_conseq_frame_of_ramified_frame" class="idref" href="#RamifiedFrame.triple_conseq_frame_of_ramified_frame"><span class="id" title="lemma">triple_conseq_frame_of_ramified_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>2</sub>:252" class="idref" href="#H<sub>2</sub>:252"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>1</sub>:253" class="idref" href="#H<sub>1</sub>:253"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="Q<sub>1</sub>:254" class="idref" href="#Q<sub>1</sub>:254"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="t:255" class="idref" href="#t:255"><span class="id" title="binder">t</span></a> <a id="H:256" class="idref" href="#H:256"><span class="id" title="binder">H</span></a> <a id="Q:257" class="idref" href="#Q:257"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Wand.html#t:255"><span class="id" title="variable">t</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:253"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#Q<sub>1</sub>:254"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H:256"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:253"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:252"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#Q<sub>1</sub>:254"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:252"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Wand.html#Q:257"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Wand.html#t:255"><span class="id" title="variable">t</span></a> <a class="idref" href="Wand.html#H:256"><span class="id" title="variable">H</span></a> <a class="idref" href="Wand.html#Q:257"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">WH</span> <span class="id" title="var">WQ</span>. <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#RamifiedFrame.triple_ramified_frame"><span class="id" title="lemma">triple_ramified_frame</span></a> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">xchange</span> <span class="id" title="var">WH</span>. <span class="id" title="var">xsimpl</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="Wand.html#Qwand.qwand_equiv"><span class="id" title="lemma">qwand_equiv</span></a>. <span class="id" title="var">applys</span> <span class="id" title="var">WQ</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab263"></a><h1 class="section">More Details</h1>

</div>

<div class="doc">
<a id="lab264"></a><h2 class="section">Benefits of the Ramified Frame Rule</h2>

<div class="paragraph"> </div>

 Earlier on, we sketched an argument claiming that the consequence-frame rule
    is not very well suited for carrying out proofs in practice, due to issues
    with working with evars for instantiating the heap predicate <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> in the
    rule. Let us come back to this point and describe the issue in depth on a
    concrete example, then show how the ramified frame rule smoothly handles
    that example. 
<div class="paragraph"> </div>

 Recall, once again, the consequence-frame rule. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="RamifiedFrame.triple_conseq_frame'" class="idref" href="#RamifiedFrame.triple_conseq_frame'"><span class="id" title="axiom">triple_conseq_frame'</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>2</sub>:258" class="idref" href="#H<sub>2</sub>:258"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>1</sub>:259" class="idref" href="#H<sub>1</sub>:259"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="Q<sub>1</sub>:260" class="idref" href="#Q<sub>1</sub>:260"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="t:261" class="idref" href="#t:261"><span class="id" title="binder">t</span></a> <a id="H:262" class="idref" href="#H:262"><span class="id" title="binder">H</span></a> <a id="Q:263" class="idref" href="#Q:263"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Wand.html#t:261"><span class="id" title="variable">t</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:259"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#Q<sub>1</sub>:260"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#H:262"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:259"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:258"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#Q<sub>1</sub>:260"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:258"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Wand.html#Q:263"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Wand.html#t:261"><span class="id" title="variable">t</span></a> <a class="idref" href="Wand.html#H:262"><span class="id" title="variable">H</span></a> <a class="idref" href="Wand.html#Q:263"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
One practical caveat with this rule is that we must resolve <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>, which
    corresponds to the difference between <span class="inlinecode"><span class="id" title="var">H</span></span> and <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>. In practice, providing
    <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> explicitly is extremely tedious. The alternative is to leave <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> as an
    evar, and count on the fact that the tactic <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>, when applied to
    <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>, will correctly instantiate <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>. This approach works in
    simple cases, but fails in particular in the case where <span class="inlinecode"><span class="id" title="var">H</span></span> contains an
    existential quantifier.

<div class="paragraph"> </div>

    For a concrete example, recall the specification of the primitive <span class="inlinecode"><span class="id" title="var">ref</span></span>,
    which allocates a reference. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="RamifiedFrame.triple_ref" class="idref" href="#RamifiedFrame.triple_ref"><span class="id" title="axiom">triple_ref</span></a> : <span class="id" title="keyword">∀</span> (<a id="v:265" class="idref" href="#v:265"><span class="id" title="binder">v</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#triple"><span class="id" title="definition">triple</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Wand.html#v:265"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#0a700e54c124035039013e87e1a2bcaa"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="LibSepReference.html#d1e35cef49ddf53b46b670034b3362a<sub>0</sub>"><span class="id" title="notation">funloc</span></a> <a id="p:268" class="idref" href="#p:268"><span class="id" title="binder">p</span></a> <a class="idref" href="LibSepReference.html#d1e35cef49ddf53b46b670034b3362a<sub>0</sub>"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Wand.html#p:266"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Wand.html#v:265"><span class="id" title="variable">v</span></a>).<br/>
</div>

<div class="doc">
Assume that wish to derive the following triple, which extends both the
    precondition and the postcondition of <span class="inlinecode"><span class="id" title="var">triple_ref</span></span> with the heap predicate
    <span class="inlinecode"><span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">l'</span></span> <span class="inlinecode"><span class="id" title="var">v'</span>,</span> <span class="inlinecode"><span class="id" title="var">l'</span></span> <span class="inlinecode">~~&gt;</span> <span class="inlinecode"><span class="id" title="var">v'</span></span>.

<div class="paragraph"> </div>

    This predicate describes the existence of some other, totally unspecified,
    reference cell. It is a bit artificial but illustrates the issue. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="RamifiedFrame.triple_ref_extended" class="idref" href="#RamifiedFrame.triple_ref_extended"><span class="id" title="lemma">triple_ref_extended</span></a> : <span class="id" title="keyword">∀</span> (<a id="v:270" class="idref" href="#v:270"><span class="id" title="binder">v</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#triple"><span class="id" title="definition">triple</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Wand.html#v:270"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="l':276" class="idref" href="#l':276"><span class="id" title="binder">l'</span></a> <a id="v':277" class="idref" href="#v':277"><span class="id" title="binder">v'</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="Wand.html#l':276"><span class="id" title="variable">l'</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Wand.html#v':277"><span class="id" title="variable">v'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="LibSepReference.html#d1e35cef49ddf53b46b670034b3362a<sub>0</sub>"><span class="id" title="notation">funloc</span></a> <a id="p:273" class="idref" href="#p:273"><span class="id" title="binder">p</span></a> <a class="idref" href="LibSepReference.html#d1e35cef49ddf53b46b670034b3362a<sub>0</sub>"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Wand.html#p:271"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Wand.html#v:270"><span class="id" title="variable">v</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="l':274" class="idref" href="#l':274"><span class="id" title="binder">l'</span></a> <a id="v':275" class="idref" href="#v':275"><span class="id" title="binder">v'</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="Wand.html#l':274"><span class="id" title="variable">l'</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Wand.html#v':275"><span class="id" title="variable">v'</span></a>).<br/>
</div>

<div class="doc">
Let's try to prove that this specification is derivable from the original
    <span class="inlinecode"><span class="id" title="var">triple_ref</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#RamifiedFrame.triple_conseq_frame"><span class="id" title="axiom">triple_conseq_frame</span></a>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;observe&nbsp;the&nbsp;evar&nbsp;<span class="inlinecode">?<span class="id" title="var">H<sub>2</sub></span></span>&nbsp;that&nbsp;appears&nbsp;in&nbsp;the&nbsp;second&nbsp;and&nbsp;third&nbsp;subgoals&nbsp;*)</span><br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#RamifiedFrame.triple_ref"><span class="id" title="axiom">triple_ref</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;here,&nbsp;<span class="inlinecode">?<span class="id" title="var">H<sub>2</sub></span></span>&nbsp;should&nbsp;in&nbsp;theory&nbsp;be&nbsp;instantiated&nbsp;with&nbsp;the&nbsp;LHS.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;but&nbsp;<span class="inlinecode"><span class="id" title="var">xsimpl</span></span>'s&nbsp;strategy&nbsp;is&nbsp;to&nbsp;first&nbsp;extract&nbsp;the&nbsp;quantifiers<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;from&nbsp;the&nbsp;LHS.&nbsp;After&nbsp;that,&nbsp;the&nbsp;instantiation&nbsp;of&nbsp;<span class="inlinecode">?<span class="id" title="var">H<sub>2</sub></span></span>&nbsp;fails,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;because&nbsp;the&nbsp;LHS&nbsp;contains&nbsp;variables&nbsp;that&nbsp;are&nbsp;not&nbsp;defined&nbsp;in<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;scope&nbsp;of&nbsp;the&nbsp;evar&nbsp;<span class="inlinecode">?<span class="id" title="var">H<sub>2</sub></span></span>&nbsp;at&nbsp;the&nbsp;time&nbsp;it&nbsp;was&nbsp;introduced.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">xsimpl</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
Now, let us apply the ramified frame rule to carry out the same proof, and
    observe how the problem does not show up. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="RamifiedFrame.triple_ref_extended'" class="idref" href="#RamifiedFrame.triple_ref_extended'"><span class="id" title="lemma">triple_ref_extended'</span></a> : <span class="id" title="keyword">∀</span> (<a id="v:278" class="idref" href="#v:278"><span class="id" title="binder">v</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#triple"><span class="id" title="definition">triple</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Wand.html#v:278"><span class="id" title="variable">v</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="l':284" class="idref" href="#l':284"><span class="id" title="binder">l'</span></a> <a id="v':285" class="idref" href="#v':285"><span class="id" title="binder">v'</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="Wand.html#l':284"><span class="id" title="variable">l'</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Wand.html#v':285"><span class="id" title="variable">v'</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="LibSepReference.html#d1e35cef49ddf53b46b670034b3362a<sub>0</sub>"><span class="id" title="notation">funloc</span></a> <a id="p:281" class="idref" href="#p:281"><span class="id" title="binder">p</span></a> <a class="idref" href="LibSepReference.html#d1e35cef49ddf53b46b670034b3362a<sub>0</sub>"><span class="id" title="notation">⇒</span></a> <a class="idref" href="Wand.html#p:279"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Wand.html#v:278"><span class="id" title="variable">v</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="l':282" class="idref" href="#l':282"><span class="id" title="binder">l'</span></a> <a id="v':283" class="idref" href="#v':283"><span class="id" title="binder">v'</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="Wand.html#l':282"><span class="id" title="variable">l'</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Wand.html#v':283"><span class="id" title="variable">v'</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#RamifiedFrame.triple_ramified_frame"><span class="id" title="lemma">triple_ramified_frame</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Wand.html#RamifiedFrame.triple_ref"><span class="id" title="axiom">triple_ref</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">xsimpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;Here&nbsp;again,&nbsp;<span class="inlinecode"><span class="id" title="var">xsimpl</span></span>'s&nbsp;strategy&nbsp;pulls&nbsp;out&nbsp;the&nbsp;existentially&nbsp;quantified<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variables&nbsp;from&nbsp;the&nbsp;LHS.&nbsp;But&nbsp;it&nbsp;works&nbsp;here&nbsp;because&nbsp;the&nbsp;remainder&nbsp;of&nbsp;the<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reasoning&nbsp;takes&nbsp;place&nbsp;in&nbsp;the&nbsp;same&nbsp;subgoal,&nbsp;in&nbsp;the&nbsp;scope&nbsp;of&nbsp;the&nbsp;extended<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coq&nbsp;context.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l'</span> <span class="id" title="var">v'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;proof&nbsp;obligation&nbsp;is&nbsp;of&nbsp;the&nbsp;form&nbsp;<span class="inlinecode">(<span class="id" title="var">l'</span></span> <span class="inlinecode">~~&gt;</span> <span class="inlinecode"><span class="id" title="var">v</span>)</span> <span class="inlinecode">==&gt;</span> <span class="inlinecode">(<span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span>)</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;which&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;<span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*+</span> <span class="inlinecode">(<span class="id" title="var">l'</span></span> <span class="inlinecode">~~&gt;</span> <span class="inlinecode"><span class="id" title="var">v</span>)</span> <span class="inlinecode">===&gt;</span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span>&nbsp;according&nbsp;to<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;lemma&nbsp;<span class="inlinecode"><span class="id" title="var">qwand_equiv</span></span>.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Wand.html#Qwand.qwand_equiv"><span class="id" title="lemma">qwand_equiv</span></a>. <span class="comment">(*&nbsp;same&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="tactic">apply</span></span> <span class="inlinecode"><span class="id" title="var">qwand_equiv</span></span>&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="var">xsimpl</span>. <span class="id" title="tactic">auto</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="Wand.html#RamifiedFrame"><span class="id" title="module">RamifiedFrame</span></a>.<br/>
</div>

<div class="doc">
<a id="lab265"></a><h2 class="section">Some Tempting, But False, Properties of the Magic Wand</h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="HwandFalse" class="idref" href="#HwandFalse"><span class="id" title="module">HwandFalse</span></a>.<br/>
<span class="id" title="keyword">Import</span> <a class="idref" href="Wand.html#Hwand"><span class="id" title="module">Hwand</span></a>.<br/>
</div>

<div class="doc">
The entailment <span class="inlinecode"><span class='gray-font'>\</span>[]</span> <span class="inlinecode">==&gt;</span> <span class="inlinecode">(<span class="id" title="var">H</span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H</span>)</span> holds for any <span class="inlinecode"><span class="id" title="var">H</span></span>. But the symmetrical
    entailement <span class="inlinecode">(<span class="id" title="var">H</span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H</span>)</span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class='gray-font'>\</span>[]</span> is false. For a counterexample, instantiate
    <span class="inlinecode"><span class="id" title="var">H</span></span> as <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">False</span>]</span>. Any heap satisfies <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">False</span>]</span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">False</span>]</span>. But only the
    empty heap satisfies <span class="inlinecode"><span class='gray-font'>\</span>[]</span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="HwandFalse.himpl_hwand_same_hempty_counterexample" class="idref" href="#HwandFalse.himpl_hwand_same_hempty_counterexample"><span class="id" title="lemma">himpl_hwand_same_hempty_counterexample</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="H:286" class="idref" href="#H:286"><span class="id" title="binder">H</span></a>, <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H:286"><span class="id" title="variable">H</span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H:286"><span class="id" title="variable">H</span></a><a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#0a700e54c124035039013e87e1a2bcaa"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">rew_logic</span>. <span class="comment">(*&nbsp;rewrite&nbsp;"not&nbsp;forall"&nbsp;as&nbsp;"exists&nbsp;not"&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">∃</span> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> (<span class="id" title="var">h</span>,<span class="id" title="var">Hh</span>): (@<a class="idref" href="LibSepReference.html#Fmap.exists_not_empty"><span class="id" title="lemma">Fmap.exists_not_empty</span></a> <a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">forwards</span> <span class="id" title="var">K</span>: <span class="id" title="var">M</span> <span class="id" title="var">h</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Wand.html#Hwand.himpl_hwand_r"><span class="id" title="lemma">himpl_hwand_r</span></a> (<span class="id" title="keyword">fun</span> <a id="h:288" class="idref" href="#h:288"><span class="id" title="binder">h</span></a> ⇒ <a class="idref" href="Wand.html#h:287"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <a class="idref" href="LibSepReference.html#Fmap.empty"><span class="id" title="definition">Fmap.empty</span></a>). <span class="id" title="var">xsimpl</span>*. }<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hempty_inv"><span class="id" title="lemma">hempty_inv</span></a> <span class="id" title="var">K</span>. <span class="id" title="var">false</span>* <span class="id" title="var">Hh</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
As another tempting yet false property of the magic wand, consider the
    converse of the cancellation lemma, that is, <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span>. It
    does not hold in general. As a counter-example, consider <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class='gray-font'>\</span>[]</span> and
    <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">False</span>]</span>. The empty heap satisfies the left-hand side of the
    entailment, but it does does not satisfy <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">False</span>]</span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode">(<span class='gray-font'>\</span>[<span class="id" title="var">False</span>]</span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class='gray-font'>\</span>[])</span>,
    because there is no way to establish <span class="inlinecode"><span class="id" title="var">False</span></span> out of thin air. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="HwandFalse.not_himpl_hwand_r_inv_reciprocal" class="idref" href="#HwandFalse.not_himpl_hwand_r_inv_reciprocal"><span class="id" title="lemma">not_himpl_hwand_r_inv_reciprocal</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="H<sub>1</sub>:289" class="idref" href="#H<sub>1</sub>:289"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:290" class="idref" href="#H<sub>2</sub>:290"><span class="id" title="binder">H<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>2</sub>:290"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:289"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:289"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#3ebbd57a07629deaf6d9bb2a03924a<sub>12</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:290"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">∃</span> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#0a700e54c124035039013e87e1a2bcaa"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">N</span>. <span class="id" title="var">forwards</span> <span class="id" title="var">K</span>: <span class="id" title="var">N</span> (<a class="idref" href="LibSepReference.html#Fmap.empty"><span class="id" title="definition">Fmap.empty</span></a>:<a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hempty_intro"><span class="id" title="lemma">hempty_intro</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_hpure_l"><span class="id" title="lemma">hstar_hpure_l</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">K</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">K</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
More generally, we should be suspicious of any entailment that introduces
    wands "out of nowhere".

<div class="paragraph"> </div>

    The entailment <span class="inlinecode"><span class="id" title="var">hwand_trans_elim</span></span>:
    <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode">(<span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span> <span class="inlinecode">==&gt;</span> <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span> is correct because,
    intuitively, the left-hand-side captures that <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">≤</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> and that <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode">≤</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span>
    for some vaguely defined notion of <span class="inlinecode">≤</span> as "being a subset of". On the
    contrary, the reciprocal entailment
    <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span> <span class="inlinecode">==&gt;</span> <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode">(<span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span>)</span> is false. Intuitively, from
    <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">≤</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span> there is no way to justify <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">≤</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> nor <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode">≤</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">End</span> <a class="idref" href="Wand.html#HwandFalse"><span class="id" title="module">HwandFalse</span></a>.<br/>
</div>

<div class="doc">
<a id="lab266"></a><h1 class="section">Optional Material</h1>

</div>

<div class="doc">
<a id="lab267"></a><h2 class="section">Equivalence Between Alternative Definitions of the Magic Wand</h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="HwandEquiv" class="idref" href="#HwandEquiv"><span class="id" title="module">HwandEquiv</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">op</span> : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>.<br/>
</div>

<div class="doc">
In what follows we prove the equivalence between the three characterizations
    of <span class="inlinecode"><span class="id" title="var">hwand</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> that we have presented:

<div class="paragraph"> </div>

    1. The definition <span class="inlinecode"><span class="id" title="var">hwand</span></span> expressed directly in terms of heaps:
    <span class="inlinecode"><span class="id" title="keyword">fun</span></span> <span class="inlinecode"><span class="id" title="var">h</span></span> <span class="inlinecode">⇒</span> <span class="inlinecode"><span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">h'</span>,</span> <span class="inlinecode"><span class="id" title="var">Fmap.disjoint</span></span> <span class="inlinecode"><span class="id" title="var">h</span></span> <span class="inlinecode"><span class="id" title="var">h'</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">h'</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode">(<span class="id" title="var">h'</span></span> <span class="inlinecode">\<span class="id" title="var">u</span></span> <span class="inlinecode"><span class="id" title="var">h</span>)</span>

<div class="paragraph"> </div>

    2. The definition <span class="inlinecode"><span class="id" title="var">hwand</span></span> expressed in terms of existing operators:
    <span class="inlinecode"><span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span>,</span> <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class='gray-font'>\</span>[</span> <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span>)</span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>]</span>

<div class="paragraph"> </div>

    3. The characterization via the equivalence <span class="inlinecode"><span class="id" title="var">hwand_equiv</span></span>:
    <span class="inlinecode"><span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>,</span> <span class="inlinecode">(<span class="id" title="var">H<sub>0</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode">↔</span> <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span>.

<div class="paragraph"> </div>

    4. The characterization via the pair of the introduction rule
    <span class="inlinecode"><span class="id" title="var">himpl_hwand_r</span></span> and the elimination rule <span class="inlinecode"><span class="id" title="var">hwand_cancel</span></span>.

<div class="paragraph"> </div>

    To prove the 4-way equivalence, we first prove the equivalence between (1)
    and (2), then prove the equivalence between (2) and (3), and finally the
    equivalence between (3) and (4). 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="HwandEquiv.hwand_characterization_1" class="idref" href="#HwandEquiv.hwand_characterization_1"><span class="id" title="definition">hwand_characterization_1</span></a> (<a id="op:291" class="idref" href="#op:291"><span class="id" title="binder">op</span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#op:291"><span class="id" title="variable">op</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="keyword">fun</span> <a id="H<sub>1</sub>:292" class="idref" href="#H<sub>1</sub>:292"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:293" class="idref" href="#H<sub>2</sub>:293"><span class="id" title="binder">H<sub>2</sub></span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="h:294" class="idref" href="#h:294"><span class="id" title="binder">h</span></a> ⇒ <span class="id" title="keyword">∀</span> <a id="h':295" class="idref" href="#h':295"><span class="id" title="binder">h'</span></a>, <a class="idref" href="LibSepReference.html#Fmap.disjoint"><span class="id" title="definition">Fmap.disjoint</span></a> <a class="idref" href="Wand.html#h:294"><span class="id" title="variable">h</span></a> <a class="idref" href="Wand.html#h':295"><span class="id" title="variable">h'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:292"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#h':295"><span class="id" title="variable">h'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:293"><span class="id" title="variable">H<sub>2</sub></span></a> (<a class="idref" href="Wand.html#h':295"><span class="id" title="variable">h'</span></a> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <a class="idref" href="Wand.html#h:294"><span class="id" title="variable">h</span></a>))<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a id="HwandEquiv.hwand_characterization_2" class="idref" href="#HwandEquiv.hwand_characterization_2"><span class="id" title="definition">hwand_characterization_2</span></a> (<a id="op:296" class="idref" href="#op:296"><span class="id" title="binder">op</span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#op:296"><span class="id" title="variable">op</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="keyword">fun</span> <a id="H<sub>1</sub>:297" class="idref" href="#H<sub>1</sub>:297"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:298" class="idref" href="#H<sub>2</sub>:298"><span class="id" title="binder">H<sub>2</sub></span></a> ⇒ <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="H<sub>0</sub>:299" class="idref" href="#H<sub>0</sub>:299"><span class="id" title="binder">H<sub>0</sub></span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:299"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:297"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:299"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:298"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a id="HwandEquiv.hwand_characterization_3" class="idref" href="#HwandEquiv.hwand_characterization_3"><span class="id" title="definition">hwand_characterization_3</span></a> (<a id="op:300" class="idref" href="#op:300"><span class="id" title="binder">op</span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="H<sub>0</sub>:301" class="idref" href="#H<sub>0</sub>:301"><span class="id" title="binder">H<sub>0</sub></span></a> <a id="H<sub>1</sub>:302" class="idref" href="#H<sub>1</sub>:302"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:303" class="idref" href="#H<sub>2</sub>:303"><span class="id" title="binder">H<sub>2</sub></span></a>, <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>0</sub>:301"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#op:300"><span class="id" title="variable">op</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:302"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:303"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:302"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:301"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:303"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a id="HwandEquiv.hwand_characterization_4" class="idref" href="#HwandEquiv.hwand_characterization_4"><span class="id" title="definition">hwand_characterization_4</span></a> (<a id="op:304" class="idref" href="#op:304"><span class="id" title="binder">op</span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="H<sub>0</sub>:305" class="idref" href="#H<sub>0</sub>:305"><span class="id" title="binder">H<sub>0</sub></span></a> <a id="H<sub>1</sub>:306" class="idref" href="#H<sub>1</sub>:306"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:307" class="idref" href="#H<sub>2</sub>:307"><span class="id" title="binder">H<sub>2</sub></span></a>, <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>1</sub>:306"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:305"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:307"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>0</sub>:305"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#op:304"><span class="id" title="variable">op</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:306"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:307"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:308" class="idref" href="#H<sub>1</sub>:308"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:309" class="idref" href="#H<sub>2</sub>:309"><span class="id" title="binder">H<sub>2</sub></span></a>, (<a class="idref" href="Wand.html#H<sub>1</sub>:308"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#op:304"><span class="id" title="variable">op</span></a> <a class="idref" href="Wand.html#H<sub>1</sub>:308"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:309"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#H<sub>2</sub>:309"><span class="id" title="variable">H<sub>2</sub></span></a>)<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
</div>

<div class="doc">
The equivalence proofs are given here for reference. The reader needs not
    follow through the details of these proofs. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="HwandEquiv.hwand_characterization_1_eq_2" class="idref" href="#HwandEquiv.hwand_characterization_1_eq_2"><span class="id" title="lemma">hwand_characterization_1_eq_2</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#HwandEquiv.hwand_characterization_1"><span class="id" title="definition">hwand_characterization_1</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#HwandEquiv.hwand_characterization_2"><span class="id" title="definition">hwand_characterization_2</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <span class="id" title="lemma">pred_ext_1</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">op</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Wand.html#HwandEquiv.hwand_characterization_1"><span class="id" title="definition">hwand_characterization_1</span></a>, <a class="idref" href="Wand.html#HwandEquiv.hwand_characterization_2"><span class="id" title="definition">hwand_characterization_2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">asserts</span> <span class="id" title="var">K</span>: (<span class="id" title="keyword">∀</span> <a id="A:312" class="idref" href="#A:312"><span class="id" title="binder">A</span></a> <a id="B:313" class="idref" href="#B:313"><span class="id" title="binder">B</span></a>, <a class="idref" href="Wand.html#A:310"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#B:311"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="var">op</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#A:310"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <span class="id" title="var">op</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#B:311"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="var">iff</span>; <span class="id" title="tactic">subst</span>*. } <span class="id" title="tactic">apply</span> <span class="id" title="var">K</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">pred_ext_3</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span> <span class="id" title="var">h</span>. <span class="id" title="var">iff</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">∃</span> (<span class="id" title="notation">=</span><span class="id" title="var">h</span>). <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_hpure_r"><span class="id" title="lemma">hstar_hpure_r</span></a>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">h<sub>3</sub></span> <span class="id" title="var">K<sub>3</sub></span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_comm"><span class="id" title="lemma">hstar_comm</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">K<sub>3</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">K<sub>3</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">K<sub>1</sub></span>&amp;<span class="id" title="var">K<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">U</span>). <span class="id" title="tactic">subst</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">h<sub>3</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">rewrites</span> (<span class="id" title="notation">&gt;&gt;</span> <a class="idref" href="LibSepFmap.html#union_comm_of_disjoint"><span class="id" title="lemma">union_comm_of_disjoint</span></a> <span class="id" title="var">D</span>). <span class="id" title="var">applys</span> <span class="id" title="var">M</span> <span class="id" title="var">D</span> <span class="id" title="var">K<sub>2</sub></span>. } }<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;This&nbsp;direction&nbsp;reproduces&nbsp;the&nbsp;proof&nbsp;of&nbsp;<span class="inlinecode"><span class="id" title="var">hwand_inv</span></span>.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">D</span> <span class="id" title="var">K<sub>1</sub></span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">M</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">H<sub>0</sub></span>&amp;<span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">M</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">h<sub>0</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">K<sub>0</sub></span>&amp;<span class="id" title="var">K<sub>2</sub></span>&amp;<span class="id" title="var">D'</span>&amp;<span class="id" title="var">U</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> (<span class="id" title="var">N</span>&amp;<span class="id" title="var">E</span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hpure_inv"><span class="id" title="lemma">hpure_inv</span></a> (<span class="id" title="definition">rm</span> <span class="id" title="var">K<sub>2</sub></span>). <span class="id" title="tactic">subst</span> <span class="id" title="var">h</span> <span class="id" title="var">h<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#Fmap.union_empty_r"><span class="id" title="lemma">Fmap.union_empty_r</span></a> <span class="id" title="keyword">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">applys</span> <span class="id" title="var">N</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a> <span class="id" title="var">K<sub>1</sub></span> <span class="id" title="var">K<sub>0</sub></span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepFmap.html#disjoint_sym"><span class="id" title="lemma">disjoint_sym</span></a> <span class="id" title="var">D</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="HwandEquiv.hwand_characterization_2_eq_3" class="idref" href="#HwandEquiv.hwand_characterization_2_eq_3"><span class="id" title="lemma">hwand_characterization_2_eq_3</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#HwandEquiv.hwand_characterization_2"><span class="id" title="definition">hwand_characterization_2</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#HwandEquiv.hwand_characterization_3"><span class="id" title="definition">hwand_characterization_3</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <span class="id" title="lemma">pred_ext_1</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">op</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Wand.html#HwandEquiv.hwand_characterization_2"><span class="id" title="definition">hwand_characterization_2</span></a>, <a class="idref" href="Wand.html#HwandEquiv.hwand_characterization_3"><span class="id" title="definition">hwand_characterization_3</span></a>. <span class="id" title="var">iff</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">intros</span>. <span class="comment">(*&nbsp;apply&nbsp;hwand_equiv.&nbsp;*)</span> <span class="id" title="var">iff</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">xchange</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">H<sub>3</sub></span> <span class="id" title="var">N</span>. <span class="id" title="var">xchange</span> <span class="id" title="var">N</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">xsimpl</span> <span class="id" title="var">H<sub>0</sub></span>. <span class="id" title="var">xchange</span> <span class="id" title="var">M</span>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="lemma">fun_ext_2</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>. <span class="id" title="tactic">apply</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_antisym"><span class="id" title="lemma">himpl_antisym</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">lets</span> (<span class="id" title="var">M</span>&amp;<span class="id" title="var">_</span>): (<span class="id" title="var">K</span> (<span class="id" title="var">op</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>) <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>). <span class="id" title="var">xsimpl</span> (<span class="id" title="var">op</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">applys</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_refl"><span class="id" title="lemma">himpl_refl</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">xsimpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">H<sub>0</sub></span> <span class="id" title="var">M</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="HwandEquiv.hwand_characterization_3_eq_4" class="idref" href="#HwandEquiv.hwand_characterization_3_eq_4"><span class="id" title="lemma">hwand_characterization_3_eq_4</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#HwandEquiv.hwand_characterization_3"><span class="id" title="definition">hwand_characterization_3</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#HwandEquiv.hwand_characterization_4"><span class="id" title="definition">hwand_characterization_4</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <span class="id" title="lemma">pred_ext_1</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">op</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Wand.html#HwandEquiv.hwand_characterization_3"><span class="id" title="definition">hwand_characterization_3</span></a>, <a class="idref" href="Wand.html#HwandEquiv.hwand_characterization_4"><span class="id" title="definition">hwand_characterization_4</span></a>. <span class="id" title="var">iff</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">apply</span> &lt;- <span class="id" title="var">K</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">M</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">K</span>. <span class="id" title="tactic">auto</span>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">K</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">K<sub>1</sub></span>&amp;<span class="id" title="var">K<sub>2</sub></span>). <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">xchange</span> <span class="id" title="var">M</span>. <span class="id" title="var">xchange</span> (<span class="id" title="var">K<sub>2</sub></span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <span class="id" title="var">K<sub>1</sub></span>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="Wand.html#HwandEquiv"><span class="id" title="module">HwandEquiv</span></a>.<br/>
</div>

<div class="doc">
<a id="lab268"></a><h2 class="section">Equivalence Results for the Magic Wand for Postconditions</h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="QwandEquiv" class="idref" href="#QwandEquiv"><span class="id" title="module">QwandEquiv</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">op</span> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>(</span></a><a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span></span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>.<br/>
</div>

<div class="doc">
In what follows we prove the equivalence between five equivalent
    characterizations of <span class="inlinecode"><span class="id" title="var">qwand</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>:

<div class="paragraph"> </div>

    1. The definition expressed directly in terms of heaps:
    <span class="inlinecode"><span class="id" title="keyword">fun</span></span> <span class="inlinecode"><span class="id" title="var">h</span></span> <span class="inlinecode">⇒</span> <span class="inlinecode"><span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">h'</span>,</span> <span class="inlinecode"><span class="id" title="var">Fmap.disjoint</span></span> <span class="inlinecode"><span class="id" title="var">h</span></span> <span class="inlinecode"><span class="id" title="var">h'</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">h'</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode">(<span class="id" title="var">h</span></span> <span class="inlinecode">\<span class="id" title="var">u</span></span> <span class="inlinecode"><span class="id" title="var">h'</span>)</span>

<div class="paragraph"> </div>

    2. The definition <span class="inlinecode"><span class="id" title="var">qwand</span></span>, expressed in terms of existing operators:
    <span class="inlinecode"><span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span>,</span> <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class='gray-font'>\</span>[</span> <span class="inlinecode">(<span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*+</span> <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span>)</span> <span class="inlinecode">===&gt;</span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span>]</span>

<div class="paragraph"> </div>

    3. The definition expressed using the universal quantifier:
    <span class="inlinecode">\<span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">v</span>,</span> <span class="inlinecode">(<span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">v</span>)</span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode">(<span class="id" title="var">Q<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="var">v</span>)</span>

<div class="paragraph"> </div>

    4. The characterization via the equivalence <span class="inlinecode"><span class="id" title="var">hwand_equiv</span></span>:
    <span class="inlinecode"><span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>,</span> <span class="inlinecode">(<span class="id" title="var">H<sub>0</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode">↔</span> <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>0</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span>.

<div class="paragraph"> </div>

    5. The characterization via the pair of the introduction rule
    <span class="inlinecode"><span class="id" title="var">himpl_qwand_r</span></span> and the elimination rule <span class="inlinecode"><span class="id" title="var">qwand_cancel</span></span>.

<div class="paragraph"> </div>

    The proof are essentially identical to the equivalence proofs for <span class="inlinecode"><span class="id" title="var">hwand</span></span>,
    except for definition (3), which is specific to <span class="inlinecode"><span class="id" title="var">qwand</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="QwandEquiv.qwand_characterization_1" class="idref" href="#QwandEquiv.qwand_characterization_1"><span class="id" title="definition">qwand_characterization_1</span></a> <a id="op:314" class="idref" href="#op:314"><span class="id" title="binder">op</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#op:314"><span class="id" title="variable">op</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="keyword">fun</span> <a id="Q<sub>1</sub>:315" class="idref" href="#Q<sub>1</sub>:315"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:316" class="idref" href="#Q<sub>2</sub>:316"><span class="id" title="binder">Q<sub>2</sub></span></a> ⇒ (<span class="id" title="keyword">fun</span> <a id="h:317" class="idref" href="#h:317"><span class="id" title="binder">h</span></a> ⇒ <span class="id" title="keyword">∀</span> <a id="v:318" class="idref" href="#v:318"><span class="id" title="binder">v</span></a> <a id="h':319" class="idref" href="#h':319"><span class="id" title="binder">h'</span></a>, <a class="idref" href="LibSepReference.html#Fmap.disjoint"><span class="id" title="definition">Fmap.disjoint</span></a> <a class="idref" href="Wand.html#h:317"><span class="id" title="variable">h</span></a> <a class="idref" href="Wand.html#h':319"><span class="id" title="variable">h'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Wand.html#Q<sub>1</sub>:315"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#v:318"><span class="id" title="variable">v</span></a> <a class="idref" href="Wand.html#h':319"><span class="id" title="variable">h'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:316"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="Wand.html#v:318"><span class="id" title="variable">v</span></a> (<a class="idref" href="Wand.html#h:317"><span class="id" title="variable">h</span></a> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <a class="idref" href="Wand.html#h':319"><span class="id" title="variable">h'</span></a>))<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a id="QwandEquiv.qwand_characterization_2" class="idref" href="#QwandEquiv.qwand_characterization_2"><span class="id" title="definition">qwand_characterization_2</span></a> <a id="op:320" class="idref" href="#op:320"><span class="id" title="binder">op</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#op:320"><span class="id" title="variable">op</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="keyword">fun</span> <a id="Q<sub>1</sub>:321" class="idref" href="#Q<sub>1</sub>:321"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:322" class="idref" href="#Q<sub>2</sub>:322"><span class="id" title="binder">Q<sub>2</sub></span></a> ⇒ <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="H<sub>0</sub>:323" class="idref" href="#H<sub>0</sub>:323"><span class="id" title="binder">H<sub>0</sub></span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:323"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a> <a class="idref" href="Wand.html#Q<sub>1</sub>:321"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:323"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:322"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a id="QwandEquiv.qwand_characterization_3" class="idref" href="#QwandEquiv.qwand_characterization_3"><span class="id" title="definition">qwand_characterization_3</span></a> <a id="op:324" class="idref" href="#op:324"><span class="id" title="binder">op</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#op:324"><span class="id" title="variable">op</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="keyword">fun</span> <a id="Q<sub>1</sub>:325" class="idref" href="#Q<sub>1</sub>:325"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:326" class="idref" href="#Q<sub>2</sub>:326"><span class="id" title="binder">Q<sub>2</sub></span></a> ⇒ <a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">∀</span></a> <a id="v:327" class="idref" href="#v:327"><span class="id" title="binder">v</span></a><a class="idref" href="LibSepReference.html#466ecb7d71d07e4d74c1c028c2497a<sub>33</sub>"><span class="id" title="notation">,</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:325"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#v:327"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation"><span class='gray-font'>\</span><span class="nowrap">&minus;&lowast;</span></span></a> <a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>2</sub>:326"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="Wand.html#v:327"><span class="id" title="variable">v</span></a><a class="idref" href="LibSepReference.html#1153660e6ba8dfddb6aef382b72370c<sub>9</sub>"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a id="QwandEquiv.qwand_characterization_4" class="idref" href="#QwandEquiv.qwand_characterization_4"><span class="id" title="definition">qwand_characterization_4</span></a> <a id="op:328" class="idref" href="#op:328"><span class="id" title="binder">op</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="H<sub>0</sub>:329" class="idref" href="#H<sub>0</sub>:329"><span class="id" title="binder">H<sub>0</sub></span></a> <a id="Q<sub>1</sub>:330" class="idref" href="#Q<sub>1</sub>:330"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:331" class="idref" href="#Q<sub>2</sub>:331"><span class="id" title="binder">Q<sub>2</sub></span></a>, <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>0</sub>:329"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#op:328"><span class="id" title="variable">op</span></a> <a class="idref" href="Wand.html#Q<sub>1</sub>:330"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:331"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:330"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:329"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:331"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a id="QwandEquiv.qwand_characterization_5" class="idref" href="#QwandEquiv.qwand_characterization_5"><span class="id" title="definition">qwand_characterization_5</span></a> <a id="op:332" class="idref" href="#op:332"><span class="id" title="binder">op</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="H<sub>0</sub>:333" class="idref" href="#H<sub>0</sub>:333"><span class="id" title="binder">H<sub>0</sub></span></a> <a id="Q<sub>1</sub>:334" class="idref" href="#Q<sub>1</sub>:334"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:335" class="idref" href="#Q<sub>2</sub>:335"><span class="id" title="binder">Q<sub>2</sub></span></a>, <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#Q<sub>1</sub>:334"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Wand.html#H<sub>0</sub>:333"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:335"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#H<sub>0</sub>:333"><span class="id" title="variable">H<sub>0</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Wand.html#op:332"><span class="id" title="variable">op</span></a> <a class="idref" href="Wand.html#Q<sub>1</sub>:334"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:335"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="Q<sub>1</sub>:336" class="idref" href="#Q<sub>1</sub>:336"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:337" class="idref" href="#Q<sub>2</sub>:337"><span class="id" title="binder">Q<sub>2</sub></span></a>, (<a class="idref" href="Wand.html#Q<sub>1</sub>:336"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation">(</span></a><a class="idref" href="Wand.html#op:332"><span class="id" title="variable">op</span></a> <a class="idref" href="Wand.html#Q<sub>1</sub>:336"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:337"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Wand.html#Q<sub>2</sub>:337"><span class="id" title="variable">Q<sub>2</sub></span></a>)<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">)</span></a>.<br/>
</div>

<div class="doc">
Here again, we show proofs for the reference, but the reader needs not
    follow through the details. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="QwandEquiv.hwand_characterization_1_eq_2" class="idref" href="#QwandEquiv.hwand_characterization_1_eq_2"><span class="id" title="lemma">hwand_characterization_1_eq_2</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#QwandEquiv.qwand_characterization_1"><span class="id" title="definition">qwand_characterization_1</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#QwandEquiv.qwand_characterization_2"><span class="id" title="definition">qwand_characterization_2</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <span class="id" title="lemma">pred_ext_1</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">op</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Wand.html#QwandEquiv.qwand_characterization_1"><span class="id" title="definition">qwand_characterization_1</span></a>, <a class="idref" href="Wand.html#QwandEquiv.qwand_characterization_2"><span class="id" title="definition">qwand_characterization_2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">asserts</span> <span class="id" title="var">K</span>: (<span class="id" title="keyword">∀</span> <a id="A:340" class="idref" href="#A:340"><span class="id" title="binder">A</span></a> <a id="B:341" class="idref" href="#B:341"><span class="id" title="binder">B</span></a>, <a class="idref" href="Wand.html#A:338"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#B:339"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="var">op</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#A:338"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <span class="id" title="var">op</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#B:339"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="var">iff</span>; <span class="id" title="tactic">subst</span>*. } <span class="id" title="tactic">apply</span> <span class="id" title="var">K</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">pred_ext_3</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Q<sub>1</sub></span> <span class="id" title="var">Q<sub>2</sub></span> <span class="id" title="var">h</span>. <span class="id" title="var">iff</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">∃</span> (<span class="id" title="notation">=</span><span class="id" title="var">h</span>). <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_hpure_r"><span class="id" title="lemma">hstar_hpure_r</span></a>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">h<sub>3</sub></span> <span class="id" title="var">K<sub>3</sub></span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_comm"><span class="id" title="lemma">hstar_comm</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">K<sub>3</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">K<sub>3</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">K<sub>1</sub></span>&amp;<span class="id" title="var">K<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">U</span>). <span class="id" title="tactic">subst</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">h<sub>3</sub></span>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span> <span class="id" title="var">D</span> <span class="id" title="var">K<sub>2</sub></span>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">D</span> <span class="id" title="var">K<sub>1</sub></span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">M</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">H<sub>0</sub></span>&amp;<span class="id" title="var">M</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">M</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">h<sub>0</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">K<sub>0</sub></span>&amp;<span class="id" title="var">K<sub>2</sub></span>&amp;<span class="id" title="var">D'</span>&amp;<span class="id" title="var">U</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> (<span class="id" title="var">N</span>&amp;<span class="id" title="var">E</span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hpure_inv"><span class="id" title="lemma">hpure_inv</span></a> (<span class="id" title="definition">rm</span> <span class="id" title="var">K<sub>2</sub></span>). <span class="id" title="tactic">subst</span> <span class="id" title="var">h</span> <span class="id" title="var">h<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#Fmap.union_empty_r"><span class="id" title="lemma">Fmap.union_empty_r</span></a> <span class="id" title="keyword">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">applys</span> <span class="id" title="var">N</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_comm"><span class="id" title="lemma">hstar_comm</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a> <span class="id" title="var">K<sub>0</sub></span> <span class="id" title="var">K<sub>1</sub></span> <span class="id" title="var">D</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="QwandEquiv.qwand_characterization_2_eq_3" class="idref" href="#QwandEquiv.qwand_characterization_2_eq_3"><span class="id" title="lemma">qwand_characterization_2_eq_3</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#QwandEquiv.qwand_characterization_2"><span class="id" title="definition">qwand_characterization_2</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#QwandEquiv.qwand_characterization_3"><span class="id" title="definition">qwand_characterization_3</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <span class="id" title="lemma">pred_ext_1</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">op</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Wand.html#QwandEquiv.qwand_characterization_2"><span class="id" title="definition">qwand_characterization_2</span></a>, <a class="idref" href="Wand.html#QwandEquiv.qwand_characterization_3"><span class="id" title="definition">qwand_characterization_3</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">asserts</span> <span class="id" title="var">K</span>: (<span class="id" title="keyword">∀</span> <a id="A:344" class="idref" href="#A:344"><span class="id" title="binder">A</span></a> <a id="B:345" class="idref" href="#B:345"><span class="id" title="binder">B</span></a>, <a class="idref" href="Wand.html#A:342"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#B:343"><span class="id" title="variable">B</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="var">op</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#A:342"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <span class="id" title="var">op</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#B:343"><span class="id" title="variable">B</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="var">iff</span>; <span class="id" title="tactic">subst</span>*. } <span class="id" title="tactic">apply</span> <span class="id" title="var">K</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">fun_ext_2</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Q<sub>1</sub></span> <span class="id" title="var">Q<sub>2</sub></span>. <span class="id" title="tactic">apply</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_antisym"><span class="id" title="lemma">himpl_antisym</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">xpull</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">H<sub>0</sub></span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_hforall_r"><span class="id" title="lemma">himpl_hforall_r</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hwand_equiv"><span class="id" title="lemma">hwand_equiv</span></a>. <span class="id" title="var">xchange</span> <span class="id" title="var">M</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">xsimpl</span> (<a class="idref" href="LibSepReference.html#SepSimplArgs.qwand"><span class="id" title="definition">qwand</span></a> <span class="id" title="var">Q<sub>1</sub></span> <span class="id" title="var">Q<sub>2</sub></span>). <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.qwand_cancel"><span class="id" title="lemma">qwand_cancel</span></a>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="QwandEquiv.qwand_characterization_2_eq_4" class="idref" href="#QwandEquiv.qwand_characterization_2_eq_4"><span class="id" title="lemma">qwand_characterization_2_eq_4</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#QwandEquiv.qwand_characterization_2"><span class="id" title="definition">qwand_characterization_2</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#QwandEquiv.qwand_characterization_4"><span class="id" title="definition">qwand_characterization_4</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <span class="id" title="lemma">pred_ext_1</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">op</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Wand.html#QwandEquiv.qwand_characterization_2"><span class="id" title="definition">qwand_characterization_2</span></a>, <a class="idref" href="Wand.html#QwandEquiv.qwand_characterization_4"><span class="id" title="definition">qwand_characterization_4</span></a>. <span class="id" title="var">iff</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">iff</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">xchange</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span> <span class="id" title="var">H<sub>3</sub></span> <span class="id" title="var">N</span>. <span class="id" title="var">xchange</span> <span class="id" title="var">N</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">xsimpl</span> <span class="id" title="var">H<sub>0</sub></span>. <span class="id" title="var">xchange</span> <span class="id" title="var">M</span>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="lemma">fun_ext_2</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>. <span class="id" title="tactic">apply</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_antisym"><span class="id" title="lemma">himpl_antisym</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">lets</span> (<span class="id" title="var">M</span>&amp;<span class="id" title="var">_</span>): (<span class="id" title="var">K</span> (<span class="id" title="var">op</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>) <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>). <span class="id" title="var">xsimpl</span> (<span class="id" title="var">op</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">applys</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.himpl_refl"><span class="id" title="lemma">himpl_refl</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">xsimpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">H<sub>0</sub></span> <span class="id" title="var">M</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="QwandEquiv.qwand_characterization_4_eq_5" class="idref" href="#QwandEquiv.qwand_characterization_4_eq_5"><span class="id" title="lemma">qwand_characterization_4_eq_5</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="Wand.html#QwandEquiv.qwand_characterization_4"><span class="id" title="definition">qwand_characterization_4</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Wand.html#QwandEquiv.qwand_characterization_5"><span class="id" title="definition">qwand_characterization_5</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <span class="id" title="lemma">pred_ext_1</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">op</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Wand.html#QwandEquiv.qwand_characterization_4"><span class="id" title="definition">qwand_characterization_4</span></a>, <a class="idref" href="Wand.html#QwandEquiv.qwand_characterization_5"><span class="id" title="definition">qwand_characterization_5</span></a>. <span class="id" title="var">iff</span> <span class="id" title="var">K</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">apply</span> &lt;- <span class="id" title="var">K</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">M</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">K</span>. <span class="id" title="tactic">auto</span>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">K</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">K<sub>1</sub></span>&amp;<span class="id" title="var">K<sub>2</sub></span>). <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">xchange</span> <span class="id" title="var">M</span>. <span class="id" title="var">xchange</span> (<span class="id" title="var">K<sub>2</sub></span> <span class="id" title="var">Q<sub>1</sub></span> <span class="id" title="var">Q<sub>2</sub></span>). }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <span class="id" title="var">K<sub>1</sub></span>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="Wand.html#QwandEquiv"><span class="id" title="module">QwandEquiv</span></a>.<br/>
</div>

<div class="doc">
<a id="lab269"></a><h2 class="section">Historical Notes</h2>

<div class="paragraph"> </div>

 The magic wand is an operator that was introduced in the very first days of
    Separation Logic. From a logical perspective, it makes total sense to have
    it. From a practical perspective, however, it was not always entirely
    obvious how the magic wand could simplify specifications and proofs.
    Experience with CFML-1.0 shows that it is possible to develop a verification
    framework and verify thousands of lines of advanced data structures and
    algorithms without ever involving the magic wand operator. The magic wand,
    however, reveals its interest when exploited (1) in the ramified frame rule,
    and (2) in weakest-precondition style reasoning rules.

<div class="paragraph"> </div>

    The idea of the ramified frame rule was introduced by
    <a href="Bib.html#Krishnaswami,-Birkedal, and Aldrich 2010"><span class="inlineref">[Krishnaswami, Birkedal, and Aldrich 2010]</span></a>. Its general statement, as
    formulated in the present chapter, was proposed by
    <a href="Bib.html#Hobor-and Villard 2013"><span class="inlineref">[Hobor and Villard 2013]</span></a>. The rule has later been popularized by the
    Iris framework, in particular. 
</div>
<div class="code">

<span class="comment">(*&nbsp;2024-12-26&nbsp;15:06&nbsp;*)</span><br/>
</div>
</div>

<div id="footer">
<hr/><a href="coqindex.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>