<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="common/css/sf.css" rel="stylesheet" type="text/css" />
<title>Triples: Structural Reasoning Rules</title>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/slf.css" rel="stylesheet" type="text/css"/>
</head>

<body>

<div id="page">

<div id="header">
<div id='logoinheader'><a href='https://softwarefoundations.cis.upenn.edu'>
<img src='common/media/image/sf_logo_sm.png' alt='Software Foundations Logo'></a></div>
<div class='booktitleinheader'><a href='index.html'>Volume 6: Separation Logic Foundations</a></div>
<ul id='menu'>
   <li class='section_name'><a href='toc.html'>Table of Contents</a></li>
   <li class='section_name'><a href='coqindex.html'>Index</a></li>
   <li class='section_name'><a href='deps.html'>Roadmap</a></li>
</ul>
</div>

<div id="main">

<h1 class="libtitle">Triples<span class="subtitle">Structural Reasoning Rules</span></h1>


<div class="code">

<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>
</div>

<div class="doc">
The file <span class="inlinecode"><span class="id" title="var">LibSepReference.v</span></span> contains definitions that are essentially the
    same as those from <span class="inlinecode"><span class="id" title="var">Hprop.v</span></span> and <span class="inlinecode"><span class="id" title="var">Himpl.v</span></span>, but with one key difference:
    <span class="inlinecode"><span class="id" title="var">LibSepReference</span></span> makes the definition of Separation Logic operators opaque.
    This chapter and the following ones import <span class="inlinecode"><span class="id" title="var">LibSepReference.v</span></span> instead of
    <span class="inlinecode"><span class="id" title="var">Hprop.v</span></span> and <span class="inlinecode"><span class="id" title="var">Himpl.v</span></span>.

<div class="paragraph"> </div>

    As a result, we cannot unfold the definition of <span class="inlinecode"><span class="id" title="var">hstar</span></span>, <span class="inlinecode"><span class="id" title="var">hpure</span></span>, etc. any
    more. To reason, we must instead use the introduction and elimination
    lemmas, such as <span class="inlinecode"><span class="id" title="var">hstar_intro</span></span> and <span class="inlinecode"><span class="id" title="var">hstar_elim</span></span>. These lemmas enforce
    abstraction, ensuring that the proofs do not depend on the particular choice
    of the definitions used for constructing Separation Logic. For example, we
    should not depend on whether <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">P</span>]</span> is internally implemented as
    <span class="inlinecode"><span class="id" title="keyword">fun</span></span> <span class="inlinecode"><span class="id" title="var">h</span></span> <span class="inlinecode">⇒</span> <span class="inlinecode"><span class="id" title="var">h</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">empty</span></span> <span class="inlinecode">∧</span> <span class="inlinecode"><span class="id" title="var">P</span></span> or as <span class="inlinecode"><span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode">(<span class="id" title="var">p</span>:<span class="id" title="var">P</span>),</span> <span class="inlinecode"><span class='gray-font'>\</span>[]</span>. 
</div>
<div class="code">

<span class="id" title="keyword">From</span> <span class="id" title="var">SLF</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="LibSepReference.html#"><span class="id" title="library">LibSepReference</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">SLF</span> <span class="id" title="keyword">Require</span> <a class="idref" href="Basic.html#"><span class="id" title="library">Basic</span></a>.<br/>
</div>

<div class="doc">
<a id="lab155"></a><h1 class="section">First Pass</h1>

<div class="paragraph"> </div>

 In chapter <a href="Hprop.html"><span class="inlineref">Hprop</span></a>, we formalized heap predicates, of type <span class="inlinecode"><span class="id" title="var">hprop</span></span>, and
    several operators on them: <span class="inlinecode"><span class='gray-font'>\</span>[]</span>, <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">P</span>]</span>, <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode">~~&gt;</span> <span class="inlinecode"><span class="id" title="var">v</span></span>, <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>,
    <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*+</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>, and <span class="inlinecode"><span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode"><span class="id" title="var">H</span></span>. In chapter <a href="Himpl.html"><span class="inlineref">Himpl</span></a>, we formalized the
    heap entailment relations <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> and <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode">===&gt;</span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span>. The goal of the
    present chapter and the next one is to formalize the definition of triples,
    written <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>, and the reasoning rules of Separation Logic.

<div class="paragraph"> </div>

    More precisely, the present chapter focuses on the definition of triples and
    the proofs of the "structural rules", which are essential in particular for
    implementing the tactics <span class="inlinecode"><span class="id" title="var">xpull</span></span> and <span class="inlinecode"><span class="id" title="var">xapp</span></span>. The structural rules include
    the "frame rule", which lies at the heart of Separation Logic, as well as
    the "consequence rule" and two "extraction rules", which admit similar
    statements as in Hoare Logic. The reasoning rules concerned with term
    constructs are discussed in the next chapter (<a href="Rules.html"><span class="inlineref">Rules</span></a>).

<div class="paragraph"> </div>

    This chapter starts with a formalization of the syntax and the semantics of
    the programming language we are using for examples. The semantics is
    axiomatized using a variant of big-step semantics called "omni-big-step
    semantics". This presentation is well suited for capturing safety and
    termination in nondeterministic programming languages. Near the end of the
    chapter, we explain how an omni-big-step semantics can be formally related
    to a standard small-step semantics. 
<div class="paragraph"> </div>

 This chapter exploits a few additional TLC tactics to enable concise proofs.
    Recall from chapter <a href="Himpl.html"><span class="inlineref">Himpl</span></a> that <span class="inlinecode"><span class="id" title="var">applys</span></span> is an enhanced version of
    <span class="inlinecode"><span class="id" title="tactic">eapply</span></span>, which takes as argument a lemma or hypothesis, followed by a
    variable number of arguments, which are fed to the lemma on a first-match
    basis. For example, <span class="inlinecode"><span class="id" title="var">applys</span></span> <span class="inlinecode"><span class="id" title="var">L</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> is equivalent to
    <span class="inlinecode"><span class="id" title="tactic">eapply</span></span> <span class="inlinecode">(<span class="id" title="var">L</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">..</span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">..</span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">..)</span> for an appropriate number of
    underscore symbols.

<div class="paragraph"> </div>

    Likewise, the tactics <span class="inlinecode"><span class="id" title="var">lets</span></span>, <span class="inlinecode"><span class="id" title="var">forwards</span></span>, and <span class="inlinecode"><span class="id" title="var">specializes</span></span> can be used to
    instantiate a lemma or an existing hypothesis:

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">lets</span></span> <span class="inlinecode"><span class="id" title="var">H</span>:</span> <span class="inlinecode"><span class="id" title="var">L</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> introduces an hypothesis named <span class="inlinecode"><span class="id" title="var">H</span></span>, whose statement
      is the specialization of the lemma <span class="inlinecode"><span class="id" title="var">L</span></span> on the arguments <span class="inlinecode"><span class="id" title="var">x</span></span> and <span class="inlinecode"><span class="id" title="var">y</span></span>.
      It is equivalent to <span class="inlinecode"><span class="id" title="tactic">generalize</span></span> <span class="inlinecode">(<span class="id" title="var">L</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">..</span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">..</span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">y</span>);</span> <span class="inlinecode"><span class="id" title="tactic">intros</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span>,
      for the appropriate number of underscore symbols.

</li>
<li> <span class="inlinecode"><span class="id" title="var">forwards</span></span> <span class="inlinecode"><span class="id" title="var">H</span>:</span> <span class="inlinecode"><span class="id" title="var">L</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> is very similar to <span class="inlinecode"><span class="id" title="var">lets</span></span>, except that it attempts
      to instantiate all arguments of <span class="inlinecode"><span class="id" title="var">L</span></span>. It is equivalent to
      <span class="inlinecode"><span class="id" title="tactic">generalize</span></span> <span class="inlinecode">(<span class="id" title="var">L</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">..</span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">..</span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode">..</span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span>);</span> <span class="inlinecode"><span class="id" title="tactic">intros</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span>.

</li>
<li> <span class="inlinecode"><span class="id" title="var">specializes</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> specializes an existing hypothesis <span class="inlinecode"><span class="id" title="var">H</span></span> in place.
      It is equivalent to <span class="inlinecode"><span class="id" title="var">lets</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>:</span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">y</span>;</span> <span class="inlinecode"><span class="id" title="tactic">clear</span></span> <span class="inlinecode"><span class="id" title="var">H</span>;</span> <span class="inlinecode"><span class="id" title="tactic">rename</span></span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="var">into</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span>.

</li>
</ul>

<div class="paragraph"> </div>

    The reader will find many occurrences of these tactics in proofs and
    solutions. However, exploiting these tactics is never required for solving
    exercises. 
</div>

<div class="doc">
<a id="lab156"></a><h2 class="section">Formalized Syntax of the Programming Language</h2>

<div class="paragraph"> </div>

 In what follows, we present the formalization of the syntax of the
    programming language. This material corresponds to a large subset of the
    material from the file <span class="inlinecode"><span class="id" title="var">LibSepReference</span></span>. Further on in this file, we will
    want to refer to the definitions from <span class="inlinecode"><span class="id" title="var">LibSepReference</span></span>, to avoid having to
    copy-paste all the construction of Separation Logic operators, which depend
    on the type <span class="inlinecode"><span class="id" title="var">heap</span></span> and therefore depend on the type <span class="inlinecode"><span class="id" title="var">val</span></span> associated with
    program values. Hence, we wrap the definitions of syntax presented below
    inside a module. 
</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="Syntax" class="idref" href="#Syntax"><span class="id" title="module">Syntax</span></a>.<br/>
</div>

<div class="doc">
<a id="lab157"></a><h3 class="section">Values and Terms</h3>

<div class="paragraph"> </div>

 The syntax of our example programming language is described using an
    <i>abstract syntax tree</i>. Its presentation distiguishes between closed values
    (i.e., values with no free variables inside) and terms. This presentation
    simplifies the definition and evaluation of the substitution function.
    Indeed, since values are always closed, the substitution function never
    needs to traverse through values.

<div class="paragraph"> </div>

    The grammar for values includes the unit value, booleans, integers,
    locations, functions, recursive functions, and primitive operations. For
    example, <span class="inlinecode"><span class="id" title="var">val_int</span></span> <span class="inlinecode">3</span> denotes the integer value <span class="inlinecode">3</span>, while <span class="inlinecode"><span class="id" title="var">val_fun</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span>
    denotes the function <span class="inlinecode"><span class="id" title="keyword">fun</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">⇒</span> <span class="inlinecode"><span class="id" title="var">t</span></span>, and <span class="inlinecode"><span class="id" title="var">val_fix</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> denotes the function
    <span class="inlinecode"><span class="id" title="keyword">fix</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">⇒</span> <span class="inlinecode"><span class="id" title="var">t</span></span>, which is written <span class="inlinecode"><span class="id" title="keyword">let</span></span> <span class="inlinecode"><span class="id" title="keyword">rec</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="keyword">in</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span> in OCaml syntax.

<div class="paragraph"> </div>

    For conciseness, we include just a few primitive operations: <span class="inlinecode"><span class="id" title="var">val_ref</span></span>,
    <span class="inlinecode"><span class="id" title="var">val_get</span></span>, <span class="inlinecode"><span class="id" title="var">val_set</span></span>, and <span class="inlinecode"><span class="id" title="var">val_free</span></span> for manipulating the mutable state,
    <span class="inlinecode"><span class="id" title="var">val_add</span></span> to illustrate a simple arithmetic operation, <span class="inlinecode"><span class="id" title="var">val_div</span></span> to
    illustrate a partial operation, and <span class="inlinecode"><span class="id" title="var">val_rand</span></span> to illustrate nondeterminism.
    
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="Syntax.val" class="idref" href="#Syntax.val"><span class="id" title="inductive">val</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a id="Syntax.val_unit" class="idref" href="#Syntax.val_unit"><span class="id" title="constructor">val_unit</span></a> : <a class="idref" href="Triples.html#val:1"><span class="id" title="inductive">val</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.val_bool" class="idref" href="#Syntax.val_bool"><span class="id" title="constructor">val_bool</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#val:1"><span class="id" title="inductive">val</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.val_int" class="idref" href="#Syntax.val_int"><span class="id" title="constructor">val_int</span></a> : <span class="id" title="notation">int</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#val:1"><span class="id" title="inductive">val</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.val_loc" class="idref" href="#Syntax.val_loc"><span class="id" title="constructor">val_loc</span></a> : <a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#val:1"><span class="id" title="inductive">val</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.val_fun" class="idref" href="#Syntax.val_fun"><span class="id" title="constructor">val_fun</span></a> : <a class="idref" href="LibSepVar.html#var"><span class="id" title="definition">var</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#val:1"><span class="id" title="inductive">val</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.val_fix" class="idref" href="#Syntax.val_fix"><span class="id" title="constructor">val_fix</span></a> : <a class="idref" href="LibSepVar.html#var"><span class="id" title="definition">var</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepVar.html#var"><span class="id" title="definition">var</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#val:1"><span class="id" title="inductive">val</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.val_ref" class="idref" href="#Syntax.val_ref"><span class="id" title="constructor">val_ref</span></a> : <a class="idref" href="Triples.html#val:1"><span class="id" title="inductive">val</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.val_get" class="idref" href="#Syntax.val_get"><span class="id" title="constructor">val_get</span></a> : <a class="idref" href="Triples.html#val:1"><span class="id" title="inductive">val</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.val_set" class="idref" href="#Syntax.val_set"><span class="id" title="constructor">val_set</span></a> : <a class="idref" href="Triples.html#val:1"><span class="id" title="inductive">val</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.val_free" class="idref" href="#Syntax.val_free"><span class="id" title="constructor">val_free</span></a> : <a class="idref" href="Triples.html#val:1"><span class="id" title="inductive">val</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.val_add" class="idref" href="#Syntax.val_add"><span class="id" title="constructor">val_add</span></a> : <a class="idref" href="Triples.html#val:1"><span class="id" title="inductive">val</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.val_div" class="idref" href="#Syntax.val_div"><span class="id" title="constructor">val_div</span></a> : <a class="idref" href="Triples.html#val:1"><span class="id" title="inductive">val</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.val_rand" class="idref" href="#Syntax.val_rand"><span class="id" title="constructor">val_rand</span></a> : <a class="idref" href="Triples.html#val:1"><span class="id" title="inductive">val</span></a><br/>
<br/>
</div>

<div class="doc">
The grammar for terms includes values, variables, function definitions,
    recursive function definitions, function applications, sequences,
    let-bindings, and conditionals. 
</div>
<div class="code">
<br/>
<span class="id" title="keyword">with</span> <a id="Syntax.trm" class="idref" href="#Syntax.trm"><span class="id" title="inductive">trm</span></a> : <span class="id" title="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a id="Syntax.trm_val" class="idref" href="#Syntax.trm_val"><span class="id" title="constructor">trm_val</span></a> : <a class="idref" href="Triples.html#val:1"><span class="id" title="inductive">val</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.trm_var" class="idref" href="#Syntax.trm_var"><span class="id" title="constructor">trm_var</span></a> : <a class="idref" href="LibSepVar.html#var"><span class="id" title="definition">var</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.trm_fun" class="idref" href="#Syntax.trm_fun"><span class="id" title="constructor">trm_fun</span></a> : <a class="idref" href="LibSepVar.html#var"><span class="id" title="definition">var</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.trm_fix" class="idref" href="#Syntax.trm_fix"><span class="id" title="constructor">trm_fix</span></a> : <a class="idref" href="LibSepVar.html#var"><span class="id" title="definition">var</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepVar.html#var"><span class="id" title="definition">var</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.trm_app" class="idref" href="#Syntax.trm_app"><span class="id" title="constructor">trm_app</span></a> : <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.trm_seq" class="idref" href="#Syntax.trm_seq"><span class="id" title="constructor">trm_seq</span></a> : <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.trm_let" class="idref" href="#Syntax.trm_let"><span class="id" title="constructor">trm_let</span></a> : <a class="idref" href="LibSepVar.html#var"><span class="id" title="definition">var</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a><br/>
&nbsp;&nbsp;| <a id="Syntax.trm_if" class="idref" href="#Syntax.trm_if"><span class="id" title="constructor">trm_if</span></a> : <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#trm:2"><span class="id" title="inductive">trm</span></a>.<br/>
</div>

<div class="doc">
Note that <span class="inlinecode"><span class="id" title="var">trm_fun</span></span> and <span class="inlinecode"><span class="id" title="var">trm_fix</span></span> denote functions that may feature free
    variables, unlike <span class="inlinecode"><span class="id" title="var">val_fun</span></span> and <span class="inlinecode"><span class="id" title="var">val_fix</span></span>, which denote closed values. More
    concretely, in the term <span class="inlinecode"><span class="id" title="var">trm_fun</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span>, the term <span class="inlinecode"><span class="id" title="var">t</span></span> may refer to the
    variable <span class="inlinecode"><span class="id" title="var">x</span></span> or to other free variables. In contrast, in the term
    <span class="inlinecode"><span class="id" title="var">val_fun</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span>, the only free variable that <span class="inlinecode"><span class="id" title="var">t</span></span> may have is <span class="inlinecode"><span class="id" title="var">x</span></span>.

<div class="paragraph"> </div>

    We will see, below, evaluation rules asserting that <span class="inlinecode"><span class="id" title="var">trm_fun</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> reduces,
    in the empty context, to <span class="inlinecode"><span class="id" title="var">val_fun</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span>. Likewise, <span class="inlinecode"><span class="id" title="var">trm_fix</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> reduces,
    in the empty context, to <span class="inlinecode"><span class="id" title="var">val_fix</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span>.

<div class="paragraph"> </div>

    At a high level, the term <span class="inlinecode"><span class="id" title="var">val_fun</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> may be thought of as the term
    <span class="inlinecode"><span class="id" title="var">trm_fun</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> augmented with a proof that this term <span class="inlinecode"><span class="id" title="var">trm_fun</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> is a
    closed term. The syntax that we consider therefore embeds "proofs that
    values are closed". Thanks to this presentation, the substitution function
    <span class="inlinecode"><span class="id" title="tactic">subst</span></span>, which will be presented shortly afterwards, need not recurse
    through values. Moreover, we never need to manipulate proofs that specific
    terms are closed. 
<div class="paragraph"> </div>

 Functions of several arguments are encoded as nested functions (curried
    functions). For example, the syntax <span class="inlinecode"><span class="id" title="keyword">fun</span></span> <span class="inlinecode"><span class="id" title="var">x<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">x<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="var">x<sub>3</sub></span></span> <span class="inlinecode">⇒</span> <span class="inlinecode"><span class="id" title="var">t</span></span> used to define a
    top-level function in the chapters <span class="inlinecode"><span class="id" title="var">Basic</span></span> and <span class="inlinecode"><span class="id" title="var">Repr</span></span> is encoded as
    <span class="inlinecode"><span class="id" title="var">val_fun</span></span> <span class="inlinecode"><span class="id" title="var">x<sub>1</sub></span></span> <span class="inlinecode">(<span class="id" title="var">trm_fun</span></span> <span class="inlinecode"><span class="id" title="var">x<sub>2</sub></span></span> <span class="inlinecode">(<span class="id" title="var">trm_fun</span></span> <span class="inlinecode"><span class="id" title="var">x<sub>3</sub></span></span> <span class="inlinecode"><span class="id" title="var">t</span>))</span>. Observe how the outer constructor
    asserts that the whole function is a closed value, whereas the inner
    functions are terms. In particular <span class="inlinecode"><span class="id" title="var">t</span></span> may refer to <span class="inlinecode"><span class="id" title="var">x<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">x<sub>2</sub></span></span>, which are
    free variables for the term <span class="inlinecode"><span class="id" title="var">trm_fun</span></span> <span class="inlinecode"><span class="id" title="var">x<sub>3</sub></span></span> <span class="inlinecode"><span class="id" title="var">t</span></span>.

<div class="paragraph"> </div>

    Likewise, a closed recursive function <span class="inlinecode"><span class="id" title="keyword">fix</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">x<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="var">x<sub>3</sub></span></span> <span class="inlinecode">⇒</span> <span class="inlinecode"><span class="id" title="var">t</span></span> is encoded as
    <span class="inlinecode"><span class="id" title="var">val_fix</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x<sub>1</sub></span></span> <span class="inlinecode">(<span class="id" title="var">trm_fun</span></span> <span class="inlinecode"><span class="id" title="var">x<sub>2</sub></span></span> <span class="inlinecode">(<span class="id" title="var">trm_fun</span></span> <span class="inlinecode"><span class="id" title="var">x<sub>3</sub></span></span> <span class="inlinecode"><span class="id" title="var">t</span>))</span>. Here only the outermost function
    is recursive (and closed).

<div class="paragraph"> </div>

    In the rest of the course, we will focus on functions with a single
    argument. The treatment of n-ary functions is the topic of a
    yet-to-be-released chapter. 
</div>

<div class="doc">
<a id="lab158"></a><h3 class="section">State</h3>

<div class="paragraph"> </div>

 The language we consider is imperative, with primitive functions for
    manipulating the state. Thus, the statements of the evaluation rules involve
    memory states. 
<div class="paragraph"> </div>

 Recall from chapter <a href="Hprop.html"><span class="inlineref">Hprop</span></a> that a state is represented as a finite map
    from location to values. Finite maps are presented using the type <span class="inlinecode"><span class="id" title="var">fmap</span></span>.
    Details of the construction of finite maps may be found in the file
    <span class="inlinecode"><span class="id" title="var">LibSepFmap.v</span></span>. (The construction is beyond the scope of this course,
    because it leverages dependent pairs to realize the type of finite maps.) 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="Syntax.heap" class="idref" href="#Syntax.heap"><span class="id" title="definition">heap</span></a> : <span class="id" title="keyword">Type</span> := <a class="idref" href="LibSepFmap.html#fmap"><span class="id" title="record">fmap</span></a> <a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a> <a class="idref" href="Triples.html#Syntax.val"><span class="id" title="inductive">val</span></a>.<br/>
</div>

<div class="doc">
For technical reasons related to the internal representation of finite maps,
    to enable reading in a state, we need to justify that the grammar of values
    is inhabited. This property is captured by the following command, whose
    details are not relevant for understanding the rest of the chapter. 
</div>
<div class="code">

<span class="id" title="keyword">Global Instance</span> <a id="Syntax.Inhab_val" class="idref" href="#Syntax.Inhab_val"><span class="id" title="instance">Inhab_val</span></a> : <span class="id" title="class">Inhab</span> <a class="idref" href="Triples.html#Syntax.val"><span class="id" title="inductive">val</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="lemma">Inhab_of_val</span> <a class="idref" href="Triples.html#Syntax.val_unit"><span class="id" title="constructor">val_unit</span></a>). <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab159"></a><h3 class="section">Substitution</h3>

<div class="paragraph"> </div>

 The semantics of the evaluation of a program function is described by means
    of a substitution function, written <span class="inlinecode"><span class="id" title="tactic">subst</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span>, which replaces all
    occurrences of a variable <span class="inlinecode"><span class="id" title="var">y</span></span> with a value <span class="inlinecode"><span class="id" title="var">w</span></span> inside a term <span class="inlinecode"><span class="id" title="var">t</span></span>.

<div class="paragraph"> </div>

    The substitution function is always the identity on values, because our
    language only considers closed values. In other words, we define
    <span class="inlinecode"><span class="id" title="tactic">subst</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> <span class="inlinecode">(<span class="id" title="var">trm_val</span></span> <span class="inlinecode"><span class="id" title="var">v</span>)</span> <span class="inlinecode">=</span> <span class="inlinecode">(<span class="id" title="var">trm_val</span></span> <span class="inlinecode"><span class="id" title="var">v</span>)</span>.

<div class="paragraph"> </div>

    When it reaches a variable, substitution performs a comparison between two
    variables. To that end, it exploits the comparison function <span class="inlinecode"><span class="id" title="var">var_eq</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span>,
    which produces a boolean value indicating whether <span class="inlinecode"><span class="id" title="var">x</span></span> and <span class="inlinecode"><span class="id" title="var">y</span></span> denote the
    same variable. 
<div class="paragraph"> </div>

 The remainder of this subsection describes the implementation of the
    substitution function <span class="inlinecode"><span class="id" title="tactic">subst</span></span>. This operation traverses all other language
    constructs in a structural manner. It takes care of avoiding "variable
    capture" when traversing binders: <span class="inlinecode"><span class="id" title="tactic">subst</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> does not recurse below the
    scope of binders whose bound name is equal to <span class="inlinecode"><span class="id" title="var">y</span></span>. For example, the result
    of <span class="inlinecode"><span class="id" title="tactic">subst</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> <span class="inlinecode">(<span class="id" title="var">trm_let</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span>)</span> is
    <span class="inlinecode"><span class="id" title="var">trm_let</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">(<span class="id" title="tactic">subst</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span>)</span> <span class="inlinecode">(<span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">var_eq</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode">(<span class="id" title="tactic">subst</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> <span class="inlinecode"><span class="id" title="var">w</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span>))</span>.

<div class="paragraph"> </div>

    The auxiliary function <span class="inlinecode"><span class="id" title="var">if_y_eq</span></span>, which appears in the definition of
    <span class="inlinecode"><span class="id" title="tactic">subst</span></span>, helps factorizing the comparisons required to prevent variable
    capture. 
</div>
<div class="code">

<span class="id" title="keyword">Fixpoint</span> <a id="Syntax.subst" class="idref" href="#Syntax.subst"><span class="id" title="definition">subst</span></a> (<a id="y:5" class="idref" href="#y:5"><span class="id" title="binder">y</span></a>:<a class="idref" href="LibSepVar.html#var"><span class="id" title="definition">var</span></a>) (<a id="w:6" class="idref" href="#w:6"><span class="id" title="binder">w</span></a>:<a class="idref" href="Triples.html#Syntax.val"><span class="id" title="inductive">val</span></a>) (<a id="t:7" class="idref" href="#t:7"><span class="id" title="binder">t</span></a>:<a class="idref" href="Triples.html#Syntax.trm"><span class="id" title="inductive">trm</span></a>) : <a class="idref" href="Triples.html#Syntax.trm"><span class="id" title="inductive">trm</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="aux:10" class="idref" href="#aux:10"><span class="id" title="binder">aux</span></a> <a id="t:9" class="idref" href="#t:9"><span class="id" title="binder">t</span></a> := <a class="idref" href="Triples.html#subst:8"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#y:5"><span class="id" title="variable">y</span></a> <a class="idref" href="Triples.html#w:6"><span class="id" title="variable">w</span></a> <a class="idref" href="Triples.html#t:9"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="if_y_eq:14" class="idref" href="#if_y_eq:14"><span class="id" title="binder">if_y_eq</span></a> <a id="x:11" class="idref" href="#x:11"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:12" class="idref" href="#t<sub>1</sub>:12"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:13" class="idref" href="#t<sub>2</sub>:13"><span class="id" title="binder">t<sub>2</sub></span></a> := <span class="id" title="keyword">if</span> <a class="idref" href="LibSepVar.html#var_eq"><span class="id" title="definition">var_eq</span></a> <a class="idref" href="Triples.html#x:11"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#y:5"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Triples.html#t<sub>1</sub>:12"><span class="id" title="variable">t<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Triples.html#t<sub>2</sub>:13"><span class="id" title="variable">t<sub>2</sub></span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Triples.html#t:7"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Triples.html#Syntax.trm_val"><span class="id" title="constructor">trm_val</span></a> <span class="id" title="var">v</span> ⇒ <a class="idref" href="Triples.html#Syntax.trm_val"><span class="id" title="constructor">trm_val</span></a> <span class="id" title="var">v</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Triples.html#Syntax.trm_var"><span class="id" title="constructor">trm_var</span></a> <span class="id" title="var">x</span> ⇒ <a class="idref" href="Triples.html#if_y_eq:14"><span class="id" title="variable">if_y_eq</span></a> <span class="id" title="var">x</span> (<a class="idref" href="Triples.html#Syntax.trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Triples.html#w:6"><span class="id" title="variable">w</span></a>) <a class="idref" href="Triples.html#t:7"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Triples.html#Syntax.trm_fun"><span class="id" title="constructor">trm_fun</span></a> <span class="id" title="var">x</span> <span class="id" title="var">t<sub>1</sub></span> ⇒ <a class="idref" href="Triples.html#Syntax.trm_fun"><span class="id" title="constructor">trm_fun</span></a> <span class="id" title="var">x</span> (<a class="idref" href="Triples.html#if_y_eq:14"><span class="id" title="variable">if_y_eq</span></a> <span class="id" title="var">x</span> <span class="id" title="var">t<sub>1</sub></span> (<a class="idref" href="Triples.html#aux:10"><span class="id" title="variable">aux</span></a> <span class="id" title="var">t<sub>1</sub></span>))<br/>
&nbsp;&nbsp;| <a class="idref" href="Triples.html#Syntax.trm_fix"><span class="id" title="constructor">trm_fix</span></a> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">t<sub>1</sub></span> ⇒ <a class="idref" href="Triples.html#Syntax.trm_fix"><span class="id" title="constructor">trm_fix</span></a> <span class="id" title="var">f</span> <span class="id" title="var">x</span> (<a class="idref" href="Triples.html#if_y_eq:14"><span class="id" title="variable">if_y_eq</span></a> <span class="id" title="var">f</span> <span class="id" title="var">t<sub>1</sub></span> (<a class="idref" href="Triples.html#if_y_eq:14"><span class="id" title="variable">if_y_eq</span></a> <span class="id" title="var">x</span> <span class="id" title="var">t<sub>1</sub></span> (<a class="idref" href="Triples.html#aux:10"><span class="id" title="variable">aux</span></a> <span class="id" title="var">t<sub>1</sub></span>)))<br/>
&nbsp;&nbsp;| <a class="idref" href="Triples.html#Syntax.trm_app"><span class="id" title="constructor">trm_app</span></a> <span class="id" title="var">t<sub>1</sub></span> <span class="id" title="var">t<sub>2</sub></span> ⇒ <a class="idref" href="Triples.html#Syntax.trm_app"><span class="id" title="constructor">trm_app</span></a> (<a class="idref" href="Triples.html#aux:10"><span class="id" title="variable">aux</span></a> <span class="id" title="var">t<sub>1</sub></span>) (<a class="idref" href="Triples.html#aux:10"><span class="id" title="variable">aux</span></a> <span class="id" title="var">t<sub>2</sub></span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Triples.html#Syntax.trm_seq"><span class="id" title="constructor">trm_seq</span></a> <span class="id" title="var">t<sub>1</sub></span> <span class="id" title="var">t<sub>2</sub></span> ⇒ <a class="idref" href="Triples.html#Syntax.trm_seq"><span class="id" title="constructor">trm_seq</span></a>  (<a class="idref" href="Triples.html#aux:10"><span class="id" title="variable">aux</span></a> <span class="id" title="var">t<sub>1</sub></span>) (<a class="idref" href="Triples.html#aux:10"><span class="id" title="variable">aux</span></a> <span class="id" title="var">t<sub>2</sub></span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="Triples.html#Syntax.trm_let"><span class="id" title="constructor">trm_let</span></a> <span class="id" title="var">x</span> <span class="id" title="var">t<sub>1</sub></span> <span class="id" title="var">t<sub>2</sub></span> ⇒ <a class="idref" href="Triples.html#Syntax.trm_let"><span class="id" title="constructor">trm_let</span></a> <span class="id" title="var">x</span> (<a class="idref" href="Triples.html#aux:10"><span class="id" title="variable">aux</span></a> <span class="id" title="var">t<sub>1</sub></span>) (<a class="idref" href="Triples.html#if_y_eq:14"><span class="id" title="variable">if_y_eq</span></a> <span class="id" title="var">x</span> <span class="id" title="var">t<sub>2</sub></span> (<a class="idref" href="Triples.html#aux:10"><span class="id" title="variable">aux</span></a> <span class="id" title="var">t<sub>2</sub></span>))<br/>
&nbsp;&nbsp;| <a class="idref" href="Triples.html#Syntax.trm_if"><span class="id" title="constructor">trm_if</span></a> <span class="id" title="var">t<sub>0</sub></span> <span class="id" title="var">t<sub>1</sub></span> <span class="id" title="var">t<sub>2</sub></span> ⇒ <a class="idref" href="Triples.html#Syntax.trm_if"><span class="id" title="constructor">trm_if</span></a> (<a class="idref" href="Triples.html#aux:10"><span class="id" title="variable">aux</span></a> <span class="id" title="var">t<sub>0</sub></span>) (<a class="idref" href="Triples.html#aux:10"><span class="id" title="variable">aux</span></a> <span class="id" title="var">t<sub>1</sub></span>) (<a class="idref" href="Triples.html#aux:10"><span class="id" title="variable">aux</span></a> <span class="id" title="var">t<sub>2</sub></span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>

<div class="doc">
<a id="lab160"></a><h3 class="section">Implicit Types and Coercions</h3>

<div class="paragraph"> </div>

 To improve the readability of the evaluation rules below, we take advantage
    of Coq's <i>implicit types</i> and <i>coercions</i>.

<div class="paragraph"> </div>

    First off, we give several Implicit Types declarations. For example, the
    first command indicates that variables whose name begins with the letter 'b'
    are, by default, of type <span class="inlinecode"><span class="id" title="var">bool</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">b</span> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> <span class="id" title="var">r</span> : <a class="idref" href="Triples.html#Syntax.val"><span class="id" title="inductive">val</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">t</span> : <a class="idref" href="Triples.html#Syntax.trm"><span class="id" title="inductive">trm</span></a>.<br/>
</div>

<div class="doc">
Next, we give a collection of coercions. Coercions correspond to implicit
    function calls, which aim to make statements more concise. For example,
    <span class="inlinecode"><span class="id" title="var">val_loc</span></span> is declared as a coercion, so that a location <span class="inlinecode"><span class="id" title="var">p</span></span> of type <span class="inlinecode"><span class="id" title="var">loc</span></span>
    can be viewed as the value <span class="inlinecode"><span class="id" title="var">val_loc</span></span> <span class="inlinecode"><span class="id" title="var">p</span></span> where an expression of type <span class="inlinecode"><span class="id" title="var">val</span></span> is
    expected. Likewise, a boolean <span class="inlinecode"><span class="id" title="var">b</span></span> may be viewed as the value <span class="inlinecode"><span class="id" title="var">val_bool</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span>,
    and an integer <span class="inlinecode"><span class="id" title="var">n</span></span> may be viewed as the value <span class="inlinecode"><span class="id" title="var">val_int</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Coercion</span> <a class="idref" href="Triples.html#Syntax.val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Triples.html#Syntax.val_loc"><span class="id" title="constructor">:</span></a> <a class="idref" href="Triples.html#Syntax.val_loc"><span class="id" title="constructor">loc</span></a> <a class="idref" href="Triples.html#Syntax.val_loc"><span class="id" title="constructor">&gt;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span></span></a> <a class="idref" href="Triples.html#Syntax.val_loc"><span class="id" title="constructor">val</span></a>.<br/>
<span class="id" title="keyword">Coercion</span> <a class="idref" href="Triples.html#Syntax.val_bool"><span class="id" title="constructor">val_bool</span></a> <a class="idref" href="Triples.html#Syntax.val_bool"><span class="id" title="constructor">:</span></a> <a class="idref" href="Triples.html#Syntax.val_bool"><span class="id" title="constructor">bool</span></a> <a class="idref" href="Triples.html#Syntax.val_bool"><span class="id" title="constructor">&gt;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span></span></a> <a class="idref" href="Triples.html#Syntax.val_bool"><span class="id" title="constructor">val</span></a>.<br/>
<span class="id" title="keyword">Coercion</span> <a class="idref" href="Triples.html#Syntax.val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#Syntax.val_int"><span class="id" title="constructor">:</span></a> <a class="idref" href="Triples.html#Syntax.val_int"><span class="id" title="constructor">Z</span></a> <a class="idref" href="Triples.html#Syntax.val_int"><span class="id" title="constructor">&gt;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span></span></a> <a class="idref" href="Triples.html#Syntax.val_int"><span class="id" title="constructor">val</span></a>.<br/>
</div>

<div class="doc">
The constructor <span class="inlinecode"><span class="id" title="var">trm_val</span></span> is also declared as a coercion. Thus, instead of
    writing <span class="inlinecode"><span class="id" title="var">trm_val</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> at a place where a term is expected, we can write just
    <span class="inlinecode"><span class="id" title="var">v</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Coercion</span> <a class="idref" href="Triples.html#Syntax.trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Triples.html#Syntax.trm_val"><span class="id" title="constructor">:</span></a> <a class="idref" href="Triples.html#Syntax.trm_val"><span class="id" title="constructor">val</span></a> <a class="idref" href="Triples.html#Syntax.trm_val"><span class="id" title="constructor">&gt;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span></span></a> <a class="idref" href="Triples.html#Syntax.trm_val"><span class="id" title="constructor">trm</span></a>.<br/>
</div>

<div class="doc">
The constructor <span class="inlinecode"><span class="id" title="var">trm_app</span></span> is declared as a "Funclass" coercion. This bit of
    magic enables us to write <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span> as a shorthand for <span class="inlinecode"><span class="id" title="var">trm_app</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span>. The
    idea of associating <span class="inlinecode"><span class="id" title="var">trm_app</span></span> as the "Funclass" coercion for the type <span class="inlinecode"><span class="id" title="var">trm</span></span>
    is that if a term <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> of type <span class="inlinecode"><span class="id" title="var">trm</span></span> is applied like a function to an
    argument, then <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> should be interpreted as <span class="inlinecode"><span class="id" title="var">trm_app</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Coercion</span> <a class="idref" href="Triples.html#Syntax.trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Triples.html#Syntax.trm_app"><span class="id" title="constructor">:</span></a> <a class="idref" href="Triples.html#Syntax.trm_app"><span class="id" title="constructor">trm</span></a> <a class="idref" href="Triples.html#Syntax.trm_app"><span class="id" title="constructor">&gt;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span></span></a> <a class="idref" href="Triples.html#Syntax.trm_app"><span class="id" title="constructor">Funclass</span></a>.<br/>
</div>

<div class="doc">
The "Funclass" coercion for <span class="inlinecode"><span class="id" title="var">trm_app</span></span> can be iterated. The expression
    <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>3</sub></span></span> is parsed by Coq as <span class="inlinecode">(<span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span>)</span> <span class="inlinecode"><span class="id" title="var">t<sub>3</sub></span></span>. The first application <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span>
    is interpreted as <span class="inlinecode"><span class="id" title="var">trm_app</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span>. This expression, which itself has type
    <span class="inlinecode"><span class="id" title="var">trm</span></span>, is applied to <span class="inlinecode"><span class="id" title="var">t<sub>3</sub></span></span>. Hence, <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>3</sub></span></span> is interpreted as
    <span class="inlinecode"><span class="id" title="var">trm_app</span></span> <span class="inlinecode">(<span class="id" title="var">trm_app</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span>)</span> <span class="inlinecode"><span class="id" title="var">t<sub>3</sub></span></span>. 
</div>

<div class="doc">
<a id="lab161"></a><h3 class="section">Loading Definitions from LibSepReference</h3>

<div class="paragraph"> </div>

 As announced earlier, we will carry out proofs not with respect to the above
    definitions, but with respect to the definitions from <span class="inlinecode"><span class="id" title="var">LibSepReference.v</span></span>.

<div class="paragraph"> </div>

    Concretely, we close the scope of the module <span class="inlinecode"><span class="id" title="keyword">Syntax</span></span>, and re-enter the
    scope of the definitions from <span class="inlinecode"><span class="id" title="var">LibSepReference</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">End</span> <a class="idref" href="Triples.html#Syntax"><span class="id" title="module">Syntax</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">f</span> : <a class="idref" href="LibSepVar.html#var"><span class="id" title="definition">var</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">b</span> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">p</span> : <a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">n</span> : <span class="id" title="notation">int</span>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">r</span> : <a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">t</span> : <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">h</span> <span class="id" title="var">s</span> : <a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">H</span> : <a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>.<br/>
</div>

<div class="doc">
<a id="lab162"></a><h2 class="section">Formalized Semantics of the Programming Language</h2>

</div>

<div class="doc">
<a id="lab163"></a><h3 class="section">Standard Big-Step Semantics</h3>

<div class="paragraph"> </div>

 We are now ready to present a formal semantics for the language. To begin
    with, we present a big-step evaluation judgment, written <span class="inlinecode"><span class="id" title="var">big</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>.
    This judgment asserts that, starting from state <span class="inlinecode"><span class="id" title="var">s</span></span>, the evaluation of the
    term <span class="inlinecode"><span class="id" title="var">t</span></span> terminates in a state <span class="inlinecode"><span class="id" title="var">s'</span></span>, and produces an output value <span class="inlinecode"><span class="id" title="var">v</span></span>.

<div class="paragraph"> </div>

    For simplicity, we assume terms to be in "A-normal form": the arguments of
    applications and of conditionals are restricted to variables and values.
    Such a requirement does not limit expressiveness, but it simplifies the
    statement of the evaluation rules.

<div class="paragraph"> </div>

    For example, if a source program includes a conditional <span class="inlinecode"><span class="id" title="var">trm_if</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>0</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span>,
    then it is required that <span class="inlinecode"><span class="id" title="var">t<sub>0</sub></span></span> be either a variable or a value. This is not a
    real restriction, because <span class="inlinecode"><span class="id" title="var">trm_if</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>0</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span> can always be encoded as
    <span class="inlinecode"><span class="id" title="keyword">let</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">t<sub>0</sub></span></span> <span class="inlinecode"><span class="id" title="keyword">in</span></span> <span class="inlinecode"><span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span>.

<div class="paragraph"> </div>

    The big-step judgment is inductively defined as follows. By convention, we
    let <span class="inlinecode"><span class="id" title="var">s</span></span> range over entire memory states, and let <span class="inlinecode"><span class="id" title="var">h</span></span> range over pieces of
    states thay may correspond to a subset of the entire state. 
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="big" class="idref" href="#big"><span class="id" title="inductive">big</span></a> : <a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
<br/>
</div>

<div class="doc">
1. <span class="inlinecode"><span class="id" title="var">big</span></span> for values and function definitions.

<div class="paragraph"> </div>

      A value evaluates to itself. A term function evaluates to a value
      function. Likewise for a recursive function. 
</div>
<div class="code">
<br/>
&nbsp;&nbsp;| <a id="big_val" class="idref" href="#big_val"><span class="id" title="constructor">big_val</span></a> : <span class="id" title="keyword">∀</span> <a id="s:18" class="idref" href="#s:18"><span class="id" title="binder">s</span></a> <a id="v:19" class="idref" href="#v:19"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s:18"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Triples.html#v:19"><span class="id" title="variable">v</span></a>) <a class="idref" href="Triples.html#s:18"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#v:19"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;| <a id="big_fun" class="idref" href="#big_fun"><span class="id" title="constructor">big_fun</span></a> : <span class="id" title="keyword">∀</span> <a id="s:20" class="idref" href="#s:20"><span class="id" title="binder">s</span></a> <a id="x:21" class="idref" href="#x:21"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:22" class="idref" href="#t<sub>1</sub>:22"><span class="id" title="binder">t<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s:20"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_fun"><span class="id" title="constructor">trm_fun</span></a> <a class="idref" href="Triples.html#x:21"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:22"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Triples.html#s:20"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_fun"><span class="id" title="constructor">val_fun</span></a> <a class="idref" href="Triples.html#x:21"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:22"><span class="id" title="variable">t<sub>1</sub></span></a>)<br/>
&nbsp;&nbsp;| <a id="big_fix" class="idref" href="#big_fix"><span class="id" title="constructor">big_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s:23" class="idref" href="#s:23"><span class="id" title="binder">s</span></a> <a id="f:24" class="idref" href="#f:24"><span class="id" title="binder">f</span></a> <a id="x:25" class="idref" href="#x:25"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:26" class="idref" href="#t<sub>1</sub>:26"><span class="id" title="binder">t<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s:23"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_fix"><span class="id" title="constructor">trm_fix</span></a> <a class="idref" href="Triples.html#f:24"><span class="id" title="variable">f</span></a> <a class="idref" href="Triples.html#x:25"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:26"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Triples.html#s:23"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Triples.html#f:24"><span class="id" title="variable">f</span></a> <a class="idref" href="Triples.html#x:25"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:26"><span class="id" title="variable">t<sub>1</sub></span></a>)<br/>
<br/>
</div>

<div class="doc">
2. <span class="inlinecode"><span class="id" title="var">big</span></span> for function applications.

<div class="paragraph"> </div>

     The beta-reduction rule asserts that <span class="inlinecode">(<span class="id" title="var">val_fun</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span>)</span> <span class="inlinecode"><span class="id" title="var">v<sub>2</sub></span></span> evaluates to the
     same result as <span class="inlinecode"><span class="id" title="tactic">subst</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">v<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span>. Likewise, <span class="inlinecode">(<span class="id" title="var">val_fix</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span>)</span> <span class="inlinecode"><span class="id" title="var">v<sub>2</sub></span></span> evaluates
     to <span class="inlinecode"><span class="id" title="tactic">subst</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">v<sub>2</sub></span></span> <span class="inlinecode">(<span class="id" title="tactic">subst</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span>)</span>, where <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span></span> denotes the recursive function
     itself, that is, <span class="inlinecode"><span class="id" title="var">val_fix</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span>. 
</div>
<div class="code">
<br/>
&nbsp;&nbsp;| <a id="big_app_fun" class="idref" href="#big_app_fun"><span class="id" title="constructor">big_app_fun</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:27" class="idref" href="#s<sub>1</sub>:27"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:28" class="idref" href="#s<sub>2</sub>:28"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="v<sub>1</sub>:29" class="idref" href="#v<sub>1</sub>:29"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:30" class="idref" href="#v<sub>2</sub>:30"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="x:31" class="idref" href="#x:31"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:32" class="idref" href="#t<sub>1</sub>:32"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="v:33" class="idref" href="#v:33"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#v<sub>1</sub>:29"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fun"><span class="id" title="constructor">val_fun</span></a> <a class="idref" href="Triples.html#x:31"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:32"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:27"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#x:31"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#v<sub>2</sub>:30"><span class="id" title="variable">v<sub>2</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:32"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Triples.html#s<sub>2</sub>:28"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#v:33"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:27"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:29"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#v<sub>2</sub>:30"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="Triples.html#s<sub>2</sub>:28"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#v:33"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;| <a id="big_app_fix" class="idref" href="#big_app_fix"><span class="id" title="constructor">big_app_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:34" class="idref" href="#s<sub>1</sub>:34"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:35" class="idref" href="#s<sub>2</sub>:35"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="v<sub>1</sub>:36" class="idref" href="#v<sub>1</sub>:36"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:37" class="idref" href="#v<sub>2</sub>:37"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="f:38" class="idref" href="#f:38"><span class="id" title="binder">f</span></a> <a id="x:39" class="idref" href="#x:39"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:40" class="idref" href="#t<sub>1</sub>:40"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="v:41" class="idref" href="#v:41"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#v<sub>1</sub>:36"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Triples.html#f:38"><span class="id" title="variable">f</span></a> <a class="idref" href="Triples.html#x:39"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:40"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:34"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#x:39"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#v<sub>2</sub>:37"><span class="id" title="variable">v<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#f:38"><span class="id" title="variable">f</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:36"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:40"><span class="id" title="variable">t<sub>1</sub></span></a>)) <a class="idref" href="Triples.html#s<sub>2</sub>:35"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#v:41"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:34"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:36"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#v<sub>2</sub>:37"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="Triples.html#s<sub>2</sub>:35"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#v:41"><span class="id" title="variable">v</span></a><br/>
<br/>
</div>

<div class="doc">
3. <span class="inlinecode"><span class="id" title="var">big</span></span> for structural constructs.

<div class="paragraph"> </div>

      A sequence <span class="inlinecode"><span class="id" title="var">trm_seq</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span> first evaluates <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span>, taking the state from
      <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span> to <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span>, then drops the result of <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> and evaluates <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span>, taking the
      state from <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span> to <span class="inlinecode"><span class="id" title="var">s<sub>3</sub></span></span>.

<div class="paragraph"> </div>

      The let-binding <span class="inlinecode"><span class="id" title="var">trm_let</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span> is similar, except that the variable <span class="inlinecode"><span class="id" title="var">x</span></span>
      gets substituted with the result of <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> inside <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span>. 
</div>
<div class="code">
<br/>
&nbsp;&nbsp;| <a id="big_seq" class="idref" href="#big_seq"><span class="id" title="constructor">big_seq</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:42" class="idref" href="#s<sub>1</sub>:42"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:43" class="idref" href="#s<sub>2</sub>:43"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="s<sub>3</sub>:44" class="idref" href="#s<sub>3</sub>:44"><span class="id" title="binder">s<sub>3</sub></span></a> <a id="t<sub>1</sub>:45" class="idref" href="#t<sub>1</sub>:45"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:46" class="idref" href="#t<sub>2</sub>:46"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="v<sub>1</sub>:47" class="idref" href="#v<sub>1</sub>:47"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v:48" class="idref" href="#v:48"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:42"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:45"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#s<sub>2</sub>:43"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:47"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s<sub>2</sub>:43"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:46"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="Triples.html#s<sub>3</sub>:44"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="Triples.html#v:48"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:42"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_seq"><span class="id" title="constructor">trm_seq</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:45"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:46"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#s<sub>3</sub>:44"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="Triples.html#v:48"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;| <a id="big_let" class="idref" href="#big_let"><span class="id" title="constructor">big_let</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:49" class="idref" href="#s<sub>1</sub>:49"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:50" class="idref" href="#s<sub>2</sub>:50"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="s<sub>3</sub>:51" class="idref" href="#s<sub>3</sub>:51"><span class="id" title="binder">s<sub>3</sub></span></a> <a id="x:52" class="idref" href="#x:52"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:53" class="idref" href="#t<sub>1</sub>:53"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:54" class="idref" href="#t<sub>2</sub>:54"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="v<sub>1</sub>:55" class="idref" href="#v<sub>1</sub>:55"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="r:56" class="idref" href="#r:56"><span class="id" title="binder">r</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:49"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:53"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#s<sub>2</sub>:50"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:55"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s<sub>2</sub>:50"><span class="id" title="variable">s<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#x:52"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:55"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:54"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#s<sub>3</sub>:51"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="Triples.html#r:56"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:49"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Triples.html#x:52"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:53"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:54"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#s<sub>3</sub>:51"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="Triples.html#r:56"><span class="id" title="variable">r</span></a><br/>
<br/>
</div>

<div class="doc">
4. <span class="inlinecode"><span class="id" title="var">big</span></span> for conditionals.

<div class="paragraph"> </div>

      A conditional in a source program is assumed to be of the form
      <span class="inlinecode"><span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>0</sub></span></span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span>, where <span class="inlinecode"><span class="id" title="var">t<sub>0</sub></span></span> is either a variable or a value. If
      <span class="inlinecode"><span class="id" title="var">t<sub>0</sub></span></span> is a variable, then, by the time it reaches an evaluation position,
      the variable must have been substituted by a value. Thus, the evaluation
      rule only considers the form <span class="inlinecode"><span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">v<sub>0</sub></span></span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span>. The value <span class="inlinecode"><span class="id" title="var">v<sub>0</sub></span></span> must
      be a boolean value, otherwise evaluation gets stuck.

<div class="paragraph"> </div>

      The term <span class="inlinecode"><span class="id" title="var">trm_if</span></span> <span class="inlinecode">(<span class="id" title="var">val_bool</span></span> <span class="inlinecode"><span class="id" title="var">true</span>)</span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span> behaves like <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span>, whereas the
      term <span class="inlinecode"><span class="id" title="var">trm_if</span></span> <span class="inlinecode">(<span class="id" title="var">val_bool</span></span> <span class="inlinecode"><span class="id" title="var">false</span>)</span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span> behaves like <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span>. This behavior is
      described by a single rule, leveraging Coq's "if" constructor to factor
      out the two cases. 
</div>
<div class="code">
<br/>
&nbsp;&nbsp;| <a id="big_if" class="idref" href="#big_if"><span class="id" title="constructor">big_if</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:57" class="idref" href="#s<sub>1</sub>:57"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:58" class="idref" href="#s<sub>2</sub>:58"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="b:59" class="idref" href="#b:59"><span class="id" title="binder">b</span></a> <a id="v:60" class="idref" href="#v:60"><span class="id" title="binder">v</span></a> <a id="t<sub>1</sub>:61" class="idref" href="#t<sub>1</sub>:61"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:62" class="idref" href="#t<sub>2</sub>:62"><span class="id" title="binder">t<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:57"><span class="id" title="variable">s<sub>1</sub></span></a> (<span class="id" title="keyword">if</span> <a class="idref" href="Triples.html#b:59"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Triples.html#t<sub>1</sub>:61"><span class="id" title="variable">t<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Triples.html#t<sub>2</sub>:62"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#s<sub>2</sub>:58"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#v:60"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:57"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_if"><span class="id" title="constructor">trm_if</span></a> (<a class="idref" href="LibSepReference.html#val_bool"><span class="id" title="constructor">val_bool</span></a> <a class="idref" href="Triples.html#b:59"><span class="id" title="variable">b</span></a>) <a class="idref" href="Triples.html#t<sub>1</sub>:61"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:62"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#s<sub>2</sub>:58"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#v:60"><span class="id" title="variable">v</span></a><br/>
<br/>
</div>

<div class="doc">
5. <span class="inlinecode"><span class="id" title="var">big</span></span> for primitive stateless operations.

<div class="paragraph"> </div>

      For similar reasons, the behavior of applied primitive functions only
      needs to be described for the case of value arguments.

<div class="paragraph"> </div>

      An arithmetic operation expects integer arguments. The addition of
      <span class="inlinecode"><span class="id" title="var">val_int</span></span> <span class="inlinecode"><span class="id" title="var">n<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">val_int</span></span> <span class="inlinecode"><span class="id" title="var">n<sub>2</sub></span></span> produces <span class="inlinecode"><span class="id" title="var">val_int</span></span> <span class="inlinecode">(<span class="id" title="var">n<sub>1</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">n<sub>2</sub></span>)</span>.

<div class="paragraph"> </div>

      The division operation, on the same arguments, produces the quotient
      <span class="inlinecode"><span class="id" title="var">n<sub>1</sub></span></span> <span class="inlinecode">/</span> <span class="inlinecode"><span class="id" title="var">n<sub>2</sub></span></span>, under the assumption that the divisor <span class="inlinecode"><span class="id" title="var">n<sub>2</sub></span></span> is non-zero. In
      other words, if a program performs a division by zero, then it cannot
      satisfy the <span class="inlinecode"><span class="id" title="var">big</span></span> judgment.

<div class="paragraph"> </div>

      The random number generator <span class="inlinecode"><span class="id" title="var">val_rand</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> produces an integer <span class="inlinecode"><span class="id" title="var">n<sub>1</sub></span></span> in the
      range from <span class="inlinecode">0</span> (inclusive) to <span class="inlinecode"><span class="id" title="var">n</span></span> (exclusive). 
</div>
<div class="code">
<br/>
&nbsp;&nbsp;| <a id="big_add" class="idref" href="#big_add"><span class="id" title="constructor">big_add</span></a> : <span class="id" title="keyword">∀</span> <a id="s:63" class="idref" href="#s:63"><span class="id" title="binder">s</span></a> <a id="n<sub>1</sub>:64" class="idref" href="#n<sub>1</sub>:64"><span class="id" title="binder">n<sub>1</sub></span></a> <a id="n<sub>2</sub>:65" class="idref" href="#n<sub>2</sub>:65"><span class="id" title="binder">n<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s:63"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_add"><span class="id" title="constructor">val_add</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n<sub>1</sub>:64"><span class="id" title="variable">n<sub>1</sub></span></a>) (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n<sub>2</sub>:65"><span class="id" title="variable">n<sub>2</sub></span></a>)) <a class="idref" href="Triples.html#s:63"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> (<a class="idref" href="Triples.html#n<sub>1</sub>:64"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="Triples.html#n<sub>2</sub>:65"><span class="id" title="variable">n<sub>2</sub></span></a>))<br/>
&nbsp;&nbsp;| <a id="big_div" class="idref" href="#big_div"><span class="id" title="constructor">big_div</span></a> : <span class="id" title="keyword">∀</span> <a id="s:66" class="idref" href="#s:66"><span class="id" title="binder">s</span></a> <a id="n<sub>1</sub>:67" class="idref" href="#n<sub>1</sub>:67"><span class="id" title="binder">n<sub>1</sub></span></a> <a id="n<sub>2</sub>:68" class="idref" href="#n<sub>2</sub>:68"><span class="id" title="binder">n<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#n<sub>2</sub>:68"><span class="id" title="variable">n<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> 0 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s:66"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_div"><span class="id" title="constructor">val_div</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n<sub>1</sub>:67"><span class="id" title="variable">n<sub>1</sub></span></a>) (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n<sub>2</sub>:68"><span class="id" title="variable">n<sub>2</sub></span></a>)) <a class="idref" href="Triples.html#s:66"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> (<a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#Z.quot"><span class="id" title="definition">Z.quot</span></a> <a class="idref" href="Triples.html#n<sub>1</sub>:67"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="Triples.html#n<sub>2</sub>:68"><span class="id" title="variable">n<sub>2</sub></span></a>))<br/>
&nbsp;&nbsp;| <a id="big_rand" class="idref" href="#big_rand"><span class="id" title="constructor">big_rand</span></a> : <span class="id" title="keyword">∀</span> <a id="s:69" class="idref" href="#s:69"><span class="id" title="binder">s</span></a> <a id="n:70" class="idref" href="#n:70"><span class="id" title="binder">n</span></a> <a id="n<sub>1</sub>:71" class="idref" href="#n<sub>1</sub>:71"><span class="id" title="binder">n<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 <span class="id" title="notation">≤</span> <a class="idref" href="Triples.html#n<sub>1</sub>:71"><span class="id" title="variable">n<sub>1</sub></span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="Triples.html#n:70"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s:69"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_rand"><span class="id" title="constructor">val_rand</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n:70"><span class="id" title="variable">n</span></a>)) <a class="idref" href="Triples.html#s:69"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n<sub>1</sub>:71"><span class="id" title="variable">n<sub>1</sub></span></a>)<br/>
<br/>
</div>

<div class="doc">
6. <span class="inlinecode"><span class="id" title="var">big</span></span> for primitive operations on memory.

<div class="paragraph"> </div>

      The term <span class="inlinecode"><span class="id" title="var">val_ref</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> allocates a fresh cell with contents <span class="inlinecode"><span class="id" title="var">v</span></span> and returns
      the location, <span class="inlinecode"><span class="id" title="var">p</span></span>, of the new cell. This location must not be previously
      in the domain of the store <span class="inlinecode"><span class="id" title="var">s</span></span>.

<div class="paragraph"> </div>

      The term <span class="inlinecode"><span class="id" title="var">val_get</span></span> <span class="inlinecode">(<span class="id" title="var">val_loc</span></span> <span class="inlinecode"><span class="id" title="var">p</span>)</span> reads the value in the store <span class="inlinecode"><span class="id" title="var">s</span></span> at
      location <span class="inlinecode"><span class="id" title="var">p</span></span>. The location must be bound to a value in the store,
      otherwise evaluation is stuck.

<div class="paragraph"> </div>

      The term <span class="inlinecode"><span class="id" title="var">val_set</span></span> <span class="inlinecode">(<span class="id" title="var">val_loc</span></span> <span class="inlinecode"><span class="id" title="var">p</span>)</span> <span class="inlinecode"><span class="id" title="var">v</span></span> updates the store at a location <span class="inlinecode"><span class="id" title="var">p</span></span>
      assumed to be bound in the store <span class="inlinecode"><span class="id" title="var">s</span></span>. The operation modifies the store and
      returns the unit value.

<div class="paragraph"> </div>

      The term <span class="inlinecode"><span class="id" title="var">val_free</span></span> <span class="inlinecode">(<span class="id" title="var">val_loc</span></span> <span class="inlinecode"><span class="id" title="var">p</span>)</span> deallocates the cell at location <span class="inlinecode"><span class="id" title="var">p</span></span>. 
</div>
<div class="code">
<br/>
&nbsp;&nbsp;| <a id="big_ref" class="idref" href="#big_ref"><span class="id" title="constructor">big_ref</span></a> : <span class="id" title="keyword">∀</span> <a id="s:72" class="idref" href="#s:72"><span class="id" title="binder">s</span></a> <a id="v:73" class="idref" href="#v:73"><span class="id" title="binder">v</span></a> <a id="p:74" class="idref" href="#p:74"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Triples.html#s:72"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:74"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s:72"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Triples.html#v:73"><span class="id" title="variable">v</span></a>) (<a class="idref" href="LibSepReference.html#Fmap.update"><span class="id" title="definition">Fmap.update</span></a> <a class="idref" href="Triples.html#s:72"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:74"><span class="id" title="variable">p</span></a> <a class="idref" href="Triples.html#v:73"><span class="id" title="variable">v</span></a>) (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Triples.html#p:74"><span class="id" title="variable">p</span></a>)<br/>
&nbsp;&nbsp;| <a id="big_get" class="idref" href="#big_get"><span class="id" title="constructor">big_get</span></a> : <span class="id" title="keyword">∀</span> <a id="s:75" class="idref" href="#s:75"><span class="id" title="binder">s</span></a> <a id="p:76" class="idref" href="#p:76"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Triples.html#s:75"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:76"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s:75"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_get"><span class="id" title="constructor">val_get</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Triples.html#p:76"><span class="id" title="variable">p</span></a>)) <a class="idref" href="Triples.html#s:75"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#Fmap.read"><span class="id" title="definition">Fmap.read</span></a> <a class="idref" href="Triples.html#s:75"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:76"><span class="id" title="variable">p</span></a>)<br/>
&nbsp;&nbsp;| <a id="big_set" class="idref" href="#big_set"><span class="id" title="constructor">big_set</span></a> : <span class="id" title="keyword">∀</span> <a id="s:77" class="idref" href="#s:77"><span class="id" title="binder">s</span></a> <a id="p:78" class="idref" href="#p:78"><span class="id" title="binder">p</span></a> <a id="v:79" class="idref" href="#v:79"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Triples.html#s:77"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:78"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s:77"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_set"><span class="id" title="constructor">val_set</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Triples.html#p:78"><span class="id" title="variable">p</span></a>) <a class="idref" href="Triples.html#v:79"><span class="id" title="variable">v</span></a>) (<a class="idref" href="LibSepReference.html#Fmap.update"><span class="id" title="definition">Fmap.update</span></a> <a class="idref" href="Triples.html#s:77"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:78"><span class="id" title="variable">p</span></a> <a class="idref" href="Triples.html#v:79"><span class="id" title="variable">v</span></a>) <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a><br/>
&nbsp;&nbsp;| <a id="big_free" class="idref" href="#big_free"><span class="id" title="constructor">big_free</span></a> : <span class="id" title="keyword">∀</span> <a id="s:80" class="idref" href="#s:80"><span class="id" title="binder">s</span></a> <a id="p:81" class="idref" href="#p:81"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Triples.html#s:80"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:81"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#big:16"><span class="id" title="inductive">big</span></a> <a class="idref" href="Triples.html#s:80"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_free"><span class="id" title="constructor">val_free</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Triples.html#p:81"><span class="id" title="variable">p</span></a>)) (<a class="idref" href="LibSepReference.html#Fmap.remove"><span class="id" title="definition">Fmap.remove</span></a> <a class="idref" href="Triples.html#s:80"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:81"><span class="id" title="variable">p</span></a>) <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a>.<br/>
</div>

<div class="doc">
<a id="lab164"></a><h3 class="section">Omni-Big-Step Semantics</h3>

<div class="paragraph"> </div>

 A triple of the form <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> aims to capture the property that, for
    any input state <span class="inlinecode"><span class="id" title="var">s</span></span> satisfying the precondition <span class="inlinecode"><span class="id" title="var">H</span></span>, any possible execution
    of the program starting from the initial configuration <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> will
    terminate and reach a final configuration satisfying the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>.

<div class="paragraph"> </div>

    However, the standard big-step judgment, <span class="inlinecode"><span class="id" title="var">big</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>, only describes
    <i>one</i> possible execution. Using this judgment, we can capture the property
    that "if a particular execution terminates, then it reaches a final
    configuration satisfying <span class="inlinecode"><span class="id" title="var">Q</span></span>". But we do not capture the property that "all
    possible executions terminate".

<div class="paragraph"> </div>

    The omni-big-step judgment is a generalization of the standard big-step
    judgment that allows capturing properties of all possible executions. The
    judgment takes the form <span class="inlinecode"><span class="id" title="tactic">eval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>, where <span class="inlinecode"><span class="id" title="var">Q</span></span> denotes a set of final
    configurations. It captures the fact that all possible executions starting
    on the configuration <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> terminate safely and reach a final
    configuration in the set <span class="inlinecode"><span class="id" title="var">Q</span></span>. We can think of <span class="inlinecode"><span class="id" title="var">Q</span></span> as a set of pairs made of
    values and a state. Equivalently, we can think of <span class="inlinecode"><span class="id" title="var">Q</span></span> as a postcondition, of
    type <span class="inlinecode"><span class="id" title="var">val</span>→<span class="id" title="var">heap</span>→<span class="id" title="keyword">Prop</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">Q</span> : <a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><span class="id" title="keyword">Prop</span>.<br/>
</div>

<div class="doc">
The inductive definition below defines the omni-big-step judgment, which has
    the form <span class="inlinecode"><span class="id" title="tactic">eval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>, where <span class="inlinecode"><span class="id" title="var">Q</span></span> is a postcondition. The generalization from
    standard-big-step to omni-big-step follows a regular pattern, which should
    become apparent while stepping through the rules. 
</div>
<div class="code">
<span class="id" title="keyword">Inductive</span> <a id="eval" class="idref" href="#eval"><span class="id" title="inductive">eval</span></a> : <a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><span class="id" title="keyword">Prop</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
<br/>
</div>

<div class="doc">
1. <span class="inlinecode"><span class="id" title="tactic">eval</span></span> for values and function definitions.

<div class="paragraph"> </div>

      The judgment <span class="inlinecode"><span class="id" title="tactic">eval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> asserts that the value <span class="inlinecode"><span class="id" title="var">v</span></span> in the state <span class="inlinecode"><span class="id" title="var">s</span></span>
      satisfies the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>. The premise for deriving that judgment is
      thus that <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> must hold. 
</div>
<div class="code">
<br/>
&nbsp;&nbsp;| <a id="eval_val" class="idref" href="#eval_val"><span class="id" title="constructor">eval_val</span></a> : <span class="id" title="keyword">∀</span> <a id="s:84" class="idref" href="#s:84"><span class="id" title="binder">s</span></a> <a id="v:85" class="idref" href="#v:85"><span class="id" title="binder">v</span></a> <a id="Q:86" class="idref" href="#Q:86"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#Q:86"><span class="id" title="variable">Q</span></a> <a class="idref" href="Triples.html#v:85"><span class="id" title="variable">v</span></a> <a class="idref" href="Triples.html#s:84"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:84"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <a class="idref" href="Triples.html#v:85"><span class="id" title="variable">v</span></a>) <a class="idref" href="Triples.html#Q:86"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="eval_fun" class="idref" href="#eval_fun"><span class="id" title="constructor">eval_fun</span></a> : <span class="id" title="keyword">∀</span> <a id="s:87" class="idref" href="#s:87"><span class="id" title="binder">s</span></a> <a id="x:88" class="idref" href="#x:88"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:89" class="idref" href="#t<sub>1</sub>:89"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="Q:90" class="idref" href="#Q:90"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#Q:90"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_fun"><span class="id" title="constructor">val_fun</span></a> <a class="idref" href="Triples.html#x:88"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:89"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Triples.html#s:87"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:87"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_fun"><span class="id" title="constructor">trm_fun</span></a> <a class="idref" href="Triples.html#x:88"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:89"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Triples.html#Q:90"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="eval_fix" class="idref" href="#eval_fix"><span class="id" title="constructor">eval_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s:91" class="idref" href="#s:91"><span class="id" title="binder">s</span></a> <a id="f:92" class="idref" href="#f:92"><span class="id" title="binder">f</span></a> <a id="x:93" class="idref" href="#x:93"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:94" class="idref" href="#t<sub>1</sub>:94"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="Q:95" class="idref" href="#Q:95"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#Q:95"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Triples.html#f:92"><span class="id" title="variable">f</span></a> <a class="idref" href="Triples.html#x:93"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:94"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Triples.html#s:91"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:91"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_fix"><span class="id" title="constructor">trm_fix</span></a> <a class="idref" href="Triples.html#f:92"><span class="id" title="variable">f</span></a> <a class="idref" href="Triples.html#x:93"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:94"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Triples.html#Q:95"><span class="id" title="variable">Q</span></a><br/>
<br/>
</div>

<div class="doc">
2. <span class="inlinecode"><span class="id" title="tactic">eval</span></span> for function applications.

<div class="paragraph"> </div>

     Consider a function <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span></span> of the form <span class="inlinecode"><span class="id" title="var">val_fun</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span>. The term
     <span class="inlinecode"><span class="id" title="var">trm_app</span></span> <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">v<sub>2</sub></span></span> terminates with postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span> provided that the
     substituted term <span class="inlinecode"><span class="id" title="tactic">subst</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">v<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> terminates with postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>. Hence,
     to prove <span class="inlinecode"><span class="id" title="tactic">eval</span></span> <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span> <span class="inlinecode">(<span class="id" title="var">trm_app</span></span> <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">v<sub>2</sub></span>)</span> <span class="inlinecode"><span class="id" title="var">Q</span></span>, we must establish
     <span class="inlinecode"><span class="id" title="tactic">eval</span></span> <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span> <span class="inlinecode">(<span class="id" title="tactic">subst</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">v<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span>)</span> <span class="inlinecode"><span class="id" title="var">Q</span></span>. 
</div>
<div class="code">
<br/>
&nbsp;&nbsp;| <a id="eval_app_fun" class="idref" href="#eval_app_fun"><span class="id" title="constructor">eval_app_fun</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:96" class="idref" href="#s<sub>1</sub>:96"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="v<sub>1</sub>:97" class="idref" href="#v<sub>1</sub>:97"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:98" class="idref" href="#v<sub>2</sub>:98"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="x:99" class="idref" href="#x:99"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:100" class="idref" href="#t<sub>1</sub>:100"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="Q:101" class="idref" href="#Q:101"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#v<sub>1</sub>:97"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fun"><span class="id" title="constructor">val_fun</span></a> <a class="idref" href="Triples.html#x:99"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:100"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:96"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#x:99"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#v<sub>2</sub>:98"><span class="id" title="variable">v<sub>2</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:100"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Triples.html#Q:101"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:96"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:97"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#v<sub>2</sub>:98"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="Triples.html#Q:101"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="eval_app_fix" class="idref" href="#eval_app_fix"><span class="id" title="constructor">eval_app_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s:102" class="idref" href="#s:102"><span class="id" title="binder">s</span></a> <a id="v<sub>1</sub>:103" class="idref" href="#v<sub>1</sub>:103"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:104" class="idref" href="#v<sub>2</sub>:104"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="f:105" class="idref" href="#f:105"><span class="id" title="binder">f</span></a> <a id="x:106" class="idref" href="#x:106"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:107" class="idref" href="#t<sub>1</sub>:107"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="Q:108" class="idref" href="#Q:108"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#v<sub>1</sub>:103"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Triples.html#f:105"><span class="id" title="variable">f</span></a> <a class="idref" href="Triples.html#x:106"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:107"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:102"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#x:106"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#v<sub>2</sub>:104"><span class="id" title="variable">v<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#f:105"><span class="id" title="variable">f</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:103"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:107"><span class="id" title="variable">t<sub>1</sub></span></a>)) <a class="idref" href="Triples.html#Q:108"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:102"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:103"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#v<sub>2</sub>:104"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="Triples.html#Q:108"><span class="id" title="variable">Q</span></a><br/>
<br/>
</div>

<div class="doc">
3. <span class="inlinecode"><span class="id" title="tactic">eval</span></span> for sequencing.

<div class="paragraph"> </div>

      Consider a sequence <span class="inlinecode"><span class="id" title="var">trm_seq</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span> in a state <span class="inlinecode"><span class="id" title="var">s</span></span>. What is the
      requirement for this configuration to terminate with postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>?
      First, we need the evaluation of <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> in <span class="inlinecode"><span class="id" title="var">s</span></span> to terminate. Let <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> be (an
      overapproximation of) the set of possible results for the execution of
      <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t<sub>1</sub></span>)</span>. Then, to prove that the sequence <span class="inlinecode"><span class="id" title="var">trm_seq</span></span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span> terminates in
      <span class="inlinecode"><span class="id" title="var">Q</span></span>, we need to show that, for any intermediate state <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span> satisfying
      <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span>, the evaluation of <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span> terminates with postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>.

<div class="paragraph"> </div>

      The case of let-bindings is similar, only with an additional substitution.
      
</div>
<div class="code">
<br/>
&nbsp;&nbsp;| <a id="eval_seq" class="idref" href="#eval_seq"><span class="id" title="constructor">eval_seq</span></a> : <span class="id" title="keyword">∀</span> <a id="Q<sub>1</sub>:109" class="idref" href="#Q<sub>1</sub>:109"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="s:110" class="idref" href="#s:110"><span class="id" title="binder">s</span></a> <a id="t<sub>1</sub>:111" class="idref" href="#t<sub>1</sub>:111"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:112" class="idref" href="#t<sub>2</sub>:112"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="Q:113" class="idref" href="#Q:113"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:110"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:111"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#Q<sub>1</sub>:109"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="v<sub>1</sub>:114" class="idref" href="#v<sub>1</sub>:114"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="s<sub>2</sub>:115" class="idref" href="#s<sub>2</sub>:115"><span class="id" title="binder">s<sub>2</sub></span></a>, <a class="idref" href="Triples.html#Q<sub>1</sub>:109"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:114"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#s<sub>2</sub>:115"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s<sub>2</sub>:115"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:112"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="Triples.html#Q:113"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:110"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_seq"><span class="id" title="constructor">trm_seq</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:111"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:112"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#Q:113"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="eval_let" class="idref" href="#eval_let"><span class="id" title="constructor">eval_let</span></a> : <span class="id" title="keyword">∀</span> <a id="Q<sub>1</sub>:116" class="idref" href="#Q<sub>1</sub>:116"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="s:117" class="idref" href="#s:117"><span class="id" title="binder">s</span></a> <a id="x:118" class="idref" href="#x:118"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:119" class="idref" href="#t<sub>1</sub>:119"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:120" class="idref" href="#t<sub>2</sub>:120"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="Q:121" class="idref" href="#Q:121"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:117"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:119"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#Q<sub>1</sub>:116"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="v<sub>1</sub>:122" class="idref" href="#v<sub>1</sub>:122"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="s<sub>2</sub>:123" class="idref" href="#s<sub>2</sub>:123"><span class="id" title="binder">s<sub>2</sub></span></a>, <a class="idref" href="Triples.html#Q<sub>1</sub>:116"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:122"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#s<sub>2</sub>:123"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s<sub>2</sub>:123"><span class="id" title="variable">s<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#x:118"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:122"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:120"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#Q:121"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:117"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Triples.html#x:118"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:119"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:120"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#Q:121"><span class="id" title="variable">Q</span></a><br/>
<br/>
</div>

<div class="doc">
4. <span class="inlinecode"><span class="id" title="tactic">eval</span></span> for conditionals.

<div class="paragraph"> </div>

      The term <span class="inlinecode">(<span class="id" title="var">trm_if</span></span> <span class="inlinecode">(<span class="id" title="var">val_bool</span></span> <span class="inlinecode"><span class="id" title="var">b</span>)</span> <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span>)</span> has the same behaviors as the term
      <span class="inlinecode"><span class="id" title="var">t<sub>1</sub></span></span> when <span class="inlinecode"><span class="id" title="var">b</span></span> is <span class="inlinecode"><span class="id" title="var">true</span></span>, and as the term <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span></span> when <span class="inlinecode"><span class="id" title="var">b</span></span> is false. 
</div>
<div class="code">
<br/>
&nbsp;&nbsp;| <a id="eval_if" class="idref" href="#eval_if"><span class="id" title="constructor">eval_if</span></a> : <span class="id" title="keyword">∀</span> <a id="s:124" class="idref" href="#s:124"><span class="id" title="binder">s</span></a> (<a id="b:125" class="idref" href="#b:125"><span class="id" title="binder">b</span></a>:<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) <a id="t<sub>1</sub>:126" class="idref" href="#t<sub>1</sub>:126"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:127" class="idref" href="#t<sub>2</sub>:127"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="Q:128" class="idref" href="#Q:128"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:124"><span class="id" title="variable">s</span></a> (<span class="id" title="keyword">if</span> <a class="idref" href="Triples.html#b:125"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Triples.html#t<sub>1</sub>:126"><span class="id" title="variable">t<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Triples.html#t<sub>2</sub>:127"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#Q:128"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:124"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_if"><span class="id" title="constructor">trm_if</span></a> (<a class="idref" href="LibSepReference.html#val_bool"><span class="id" title="constructor">val_bool</span></a> <a class="idref" href="Triples.html#b:125"><span class="id" title="variable">b</span></a>) <a class="idref" href="Triples.html#t<sub>1</sub>:126"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:127"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#Q:128"><span class="id" title="variable">Q</span></a><br/>
<br/>
</div>

<div class="doc">
5. <span class="inlinecode"><span class="id" title="tactic">eval</span></span> for primitive stateless operations.

<div class="paragraph"> </div>

    The judgment <span class="inlinecode"><span class="id" title="tactic">eval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode">(<span class="id" title="var">val_add</span></span> <span class="inlinecode"><span class="id" title="var">n<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">n<sub>2</sub></span>)</span> <span class="inlinecode"><span class="id" title="var">Q</span></span> asserts that the pair of the state
    <span class="inlinecode"><span class="id" title="var">s</span></span> and the value <span class="inlinecode"><span class="id" title="var">n<sub>1</sub></span>+<span class="id" title="var">n<sub>2</sub></span></span> produced by the addition operation satisfies the
    postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>. Hence, the premise is <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode">(<span class="id" title="var">val_int</span></span> <span class="inlinecode">(<span class="id" title="var">n<sub>1</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">n<sub>2</sub></span>))</span> <span class="inlinecode"><span class="id" title="var">s</span></span>.

<div class="paragraph"> </div>

    Nondeterministic constructs are more interesting. The rule <span class="inlinecode"><span class="id" title="var">eval_rand</span></span> gives
    the condition under which the term <span class="inlinecode"><span class="id" title="var">val_rand</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span>, evaluated in a state <span class="inlinecode"><span class="id" title="var">s</span></span>,
    produces an output satisfying <span class="inlinecode"><span class="id" title="var">Q</span></span>. The first premise of the rule requires
    <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">&gt;</span> <span class="inlinecode">0</span>. The second premise requires that, for any value <span class="inlinecode"><span class="id" title="var">n<sub>1</sub></span></span> that
    <span class="inlinecode"><span class="id" title="var">val_rand</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> may evaluate to -- that is, such that <span class="inlinecode">0</span> <span class="inlinecode">≤</span> <span class="inlinecode"><span class="id" title="var">n<sub>1</sub></span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">n</span></span> -- the
    configuration made of <span class="inlinecode"><span class="id" title="var">n<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">s</span></span> satisfies the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>.
    Formally: <span class="inlinecode"><span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">n<sub>1</sub></span>,</span> <span class="inlinecode">(0</span> <span class="inlinecode">≤</span> <span class="inlinecode"><span class="id" title="var">n<sub>1</sub></span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">n</span>)</span> <span class="inlinecode">→</span> <span class="inlinecode">(<span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">n<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">s</span>)</span>. 
</div>
<div class="code">
<br/>
&nbsp;&nbsp;| <a id="eval_add" class="idref" href="#eval_add"><span class="id" title="constructor">eval_add</span></a> : <span class="id" title="keyword">∀</span> <a id="s:129" class="idref" href="#s:129"><span class="id" title="binder">s</span></a> <a id="n<sub>1</sub>:130" class="idref" href="#n<sub>1</sub>:130"><span class="id" title="binder">n<sub>1</sub></span></a> <a id="n<sub>2</sub>:131" class="idref" href="#n<sub>2</sub>:131"><span class="id" title="binder">n<sub>2</sub></span></a> <a id="Q:132" class="idref" href="#Q:132"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#Q:132"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> (<a class="idref" href="Triples.html#n<sub>1</sub>:130"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="Triples.html#n<sub>2</sub>:131"><span class="id" title="variable">n<sub>2</sub></span></a>)) <a class="idref" href="Triples.html#s:129"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:129"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_add"><span class="id" title="constructor">val_add</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n<sub>1</sub>:130"><span class="id" title="variable">n<sub>1</sub></span></a>) (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n<sub>2</sub>:131"><span class="id" title="variable">n<sub>2</sub></span></a>)) <a class="idref" href="Triples.html#Q:132"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="eval_div" class="idref" href="#eval_div"><span class="id" title="constructor">eval_div</span></a> : <span class="id" title="keyword">∀</span> <a id="s:133" class="idref" href="#s:133"><span class="id" title="binder">s</span></a> <a id="n<sub>1</sub>:134" class="idref" href="#n<sub>1</sub>:134"><span class="id" title="binder">n<sub>1</sub></span></a> <a id="n<sub>2</sub>:135" class="idref" href="#n<sub>2</sub>:135"><span class="id" title="binder">n<sub>2</sub></span></a> <a id="Q:136" class="idref" href="#Q:136"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#n<sub>2</sub>:135"><span class="id" title="variable">n<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> 0 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#Q:136"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> (<a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#Z.quot"><span class="id" title="definition">Z.quot</span></a> <a class="idref" href="Triples.html#n<sub>1</sub>:134"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="Triples.html#n<sub>2</sub>:135"><span class="id" title="variable">n<sub>2</sub></span></a>)) <a class="idref" href="Triples.html#s:133"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:133"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_div"><span class="id" title="constructor">val_div</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n<sub>1</sub>:134"><span class="id" title="variable">n<sub>1</sub></span></a>) (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n<sub>2</sub>:135"><span class="id" title="variable">n<sub>2</sub></span></a>)) <a class="idref" href="Triples.html#Q:136"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="eval_rand" class="idref" href="#eval_rand"><span class="id" title="constructor">eval_rand</span></a> : <span class="id" title="keyword">∀</span> <a id="s:137" class="idref" href="#s:137"><span class="id" title="binder">s</span></a> <a id="n:138" class="idref" href="#n:138"><span class="id" title="binder">n</span></a> <a id="Q:139" class="idref" href="#Q:139"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#n:138"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;</span> 0 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="n<sub>1</sub>:140" class="idref" href="#n<sub>1</sub>:140"><span class="id" title="binder">n<sub>1</sub></span></a>, 0 <span class="id" title="notation">≤</span> <a class="idref" href="Triples.html#n<sub>1</sub>:140"><span class="id" title="variable">n<sub>1</sub></span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="Triples.html#n:138"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#Q:139"><span class="id" title="variable">Q</span></a> <a class="idref" href="Triples.html#n<sub>1</sub>:140"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="Triples.html#s:137"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:137"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_rand"><span class="id" title="constructor">val_rand</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n:138"><span class="id" title="variable">n</span></a>)) <a class="idref" href="Triples.html#Q:139"><span class="id" title="variable">Q</span></a><br/>
<br/>
</div>

<div class="doc">
6. <span class="inlinecode"><span class="id" title="tactic">eval</span></span> for primitive operations on memory.

<div class="paragraph"> </div>

    The most interesting case here is that of allocation, which is
    nondeterministic. For <span class="inlinecode"><span class="id" title="var">val_ref</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>, evaluated in a state <span class="inlinecode"><span class="id" title="var">s</span></span>, to produce a
    configuration in <span class="inlinecode"><span class="id" title="var">Q</span></span>, we require that, for any location <span class="inlinecode"><span class="id" title="var">p</span></span> that is "fresh"
    for the state <span class="inlinecode"><span class="id" title="var">s</span></span>, the pair made of <span class="inlinecode"><span class="id" title="var">p</span></span> and "<span class="inlinecode"><span class="id" title="var">s</span></span> extended with a binding
    from <span class="inlinecode"><span class="id" title="var">p</span></span> to <span class="inlinecode"><span class="id" title="var">v</span></span>" satisfies <span class="inlinecode"><span class="id" title="var">Q</span></span>. 
</div>
<div class="code">
<br/>
&nbsp;&nbsp;| <a id="eval_ref" class="idref" href="#eval_ref"><span class="id" title="constructor">eval_ref</span></a> : <span class="id" title="keyword">∀</span> <a id="s:141" class="idref" href="#s:141"><span class="id" title="binder">s</span></a> <a id="v:142" class="idref" href="#v:142"><span class="id" title="binder">v</span></a> <a id="Q:143" class="idref" href="#Q:143"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="p:144" class="idref" href="#p:144"><span class="id" title="binder">p</span></a>, <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Triples.html#s:141"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:144"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#Q:143"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Triples.html#p:144"><span class="id" title="variable">p</span></a>) (<a class="idref" href="LibSepReference.html#Fmap.update"><span class="id" title="definition">Fmap.update</span></a> <a class="idref" href="Triples.html#s:141"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:144"><span class="id" title="variable">p</span></a> <a class="idref" href="Triples.html#v:142"><span class="id" title="variable">v</span></a>)<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:141"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Triples.html#v:142"><span class="id" title="variable">v</span></a>) <a class="idref" href="Triples.html#Q:143"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="eval_get" class="idref" href="#eval_get"><span class="id" title="constructor">eval_get</span></a> : <span class="id" title="keyword">∀</span> <a id="s:145" class="idref" href="#s:145"><span class="id" title="binder">s</span></a> <a id="p:146" class="idref" href="#p:146"><span class="id" title="binder">p</span></a> <a id="Q:147" class="idref" href="#Q:147"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Triples.html#s:145"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:146"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#Q:147"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#Fmap.read"><span class="id" title="definition">Fmap.read</span></a> <a class="idref" href="Triples.html#s:145"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:146"><span class="id" title="variable">p</span></a>) <a class="idref" href="Triples.html#s:145"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:145"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_get"><span class="id" title="constructor">val_get</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Triples.html#p:146"><span class="id" title="variable">p</span></a>)) <a class="idref" href="Triples.html#Q:147"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="eval_set" class="idref" href="#eval_set"><span class="id" title="constructor">eval_set</span></a> : <span class="id" title="keyword">∀</span> <a id="s:148" class="idref" href="#s:148"><span class="id" title="binder">s</span></a> <a id="p:149" class="idref" href="#p:149"><span class="id" title="binder">p</span></a> <a id="v:150" class="idref" href="#v:150"><span class="id" title="binder">v</span></a> <a id="Q:151" class="idref" href="#Q:151"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Triples.html#s:148"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:149"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#Q:151"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a> (<a class="idref" href="LibSepReference.html#Fmap.update"><span class="id" title="definition">Fmap.update</span></a> <a class="idref" href="Triples.html#s:148"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:149"><span class="id" title="variable">p</span></a> <a class="idref" href="Triples.html#v:150"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:148"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_set"><span class="id" title="constructor">val_set</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Triples.html#p:149"><span class="id" title="variable">p</span></a>) <a class="idref" href="Triples.html#v:150"><span class="id" title="variable">v</span></a>) <a class="idref" href="Triples.html#Q:151"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="eval_free" class="idref" href="#eval_free"><span class="id" title="constructor">eval_free</span></a> : <span class="id" title="keyword">∀</span> <a id="s:152" class="idref" href="#s:152"><span class="id" title="binder">s</span></a> <a id="p:153" class="idref" href="#p:153"><span class="id" title="binder">p</span></a> <a id="Q:154" class="idref" href="#Q:154"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Triples.html#s:152"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:153"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#Q:154"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a> (<a class="idref" href="LibSepReference.html#Fmap.remove"><span class="id" title="definition">Fmap.remove</span></a> <a class="idref" href="Triples.html#s:152"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:153"><span class="id" title="variable">p</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#eval:82"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:152"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_free"><span class="id" title="constructor">val_free</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Triples.html#p:153"><span class="id" title="variable">p</span></a>)) <a class="idref" href="Triples.html#Q:154"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
Note that, given <span class="inlinecode"><span class="id" title="tactic">eval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>, it is *not* necessarily the case that <span class="inlinecode"><span class="id" title="var">Q</span></span> is
    the exact set of configurations that are reachable from <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span>; it may
    rather be an <i>overapproximation</i> of that set. Trying to set up an inductive
    definition that relates <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> with <i>exactly</i> its set of reachable
    configurations would introduce unnecessary complications.

<div class="paragraph"> </div>

    Note, also, that <span class="inlinecode"><span class="id" title="tactic">eval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> will not hold if there exist one or more
    executions of <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> that run into an error, i.e., that reach a
    configuration that is stuck. To see why, consider a program of the form
    <span class="inlinecode"><span class="id" title="keyword">let</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">rand</span></span> <span class="inlinecode">10</span> <span class="inlinecode"><span class="id" title="keyword">in</span></span> <span class="inlinecode">(<span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">n</span>)</span>. When applying the rule <span class="inlinecode"><span class="id" title="var">eval_let</span></span> to this
    program, the postcondition <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> associated with <span class="inlinecode"><span class="id" title="var">rand</span></span> <span class="inlinecode">10</span> must include all
    integers in the range <span class="inlinecode">0..9</span>. The second premise of the rule <span class="inlinecode"><span class="id" title="var">eval_let</span></span> is
    of the form <span class="inlinecode"><span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span>,</span> <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="tactic">eval</span></span> <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span> <span class="inlinecode">(<span class="id" title="tactic">subst</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">t<sub>2</sub></span>)</span> <span class="inlinecode"><span class="id" title="var">Q</span></span>. In our
    specific example, this premise asserts that for any result in <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span>, which
    includes all integers <span class="inlinecode"><span class="id" title="var">n</span></span> in the range <span class="inlinecode">0..9</span>, it is the case that the term
    <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> terminates. 
</div>

<div class="doc">
<a id="lab165"></a><h2 class="section">Definition of Triples</h2>

<div class="paragraph"> </div>

 Now we come to the most important definition of the whole course! 
<div class="paragraph"> </div>

 A triple <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> asserts that, for any input state <span class="inlinecode"><span class="id" title="var">s</span></span> satisfying the
    precondition <span class="inlinecode"><span class="id" title="var">H</span></span>, any possible execution of <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> terminates and reaches a
    final configuration satisfying the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>. This statement is
    captured in terms of the omni-big-step semantics as follows. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="triple" class="idref" href="#triple"><span class="id" title="definition">triple</span></a> (<a id="t:155" class="idref" href="#t:155"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) (<a id="H:156" class="idref" href="#H:156"><span class="id" title="binder">H</span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) (<a id="Q:157" class="idref" href="#Q:157"><span class="id" title="binder">Q</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="s:158" class="idref" href="#s:158"><span class="id" title="binder">s</span></a>, <a class="idref" href="Triples.html#H:156"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#s:158"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#eval"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:158"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:155"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q:157"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
Because the predicate <span class="inlinecode"><span class="id" title="tactic">eval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> captures termination, the predicate
    <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> that we build on top of it also captures termination. It
    therefore yields a "total correctness" triple. If we had defined the
    predicate <span class="inlinecode"><span class="id" title="tactic">eval</span></span> as <span class="inlinecode"><span class="id" title="keyword">CoInductive</span></span> instead of <span class="inlinecode"><span class="id" title="keyword">Inductive</span></span>, we would have
    allowed for infinite executions.

<div class="paragraph"> </div>

    With such a coinductive definition of <span class="inlinecode"><span class="id" title="tactic">eval</span></span>, we would have obtained a
    "partial correctness" triple instead. Such a partial correctness triple
    would still capture the property that none of the possible executions can
    get stuck -- each possible execution either terminates safely with a result
    satisfying the postcondition, or else diverges. 
<div class="paragraph"> </div>

 Throughout the development of program logics, most research has concentrated
    on "partial correctness" logics. Depending on the set up, capturing "total
    correctness" is often much more challenging. In particular, when considering
    nondeterministic small-step semantics, and in particular when targeting
    concurrent programs, it can be nonobvious how to account for termination.
    But as long as we are concerned with sequential programs (i.e., without
    concurrency), omni-big-step semantics simplify reasoning about
    nondeterministic termination. 
</div>

<div class="doc">
<a id="lab166"></a><h2 class="section">Structural Rules</h2>

<div class="paragraph"> </div>

 Now that triples are defined, we can state and prove reasoning rules of
    Separation Logic. This chapter focuses on structural rules; the other rules
    will be presented in the next chapter. We begin with the statements of the
    rules and present their proofs afterwards. 
</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="StructuralRules" class="idref" href="#StructuralRules"><span class="id" title="module">StructuralRules</span></a>.<br/>
</div>

<div class="doc">
The frame rule asserts that an arbitrary heap predicate may be added to both
    the precondition and the postcondition of any triple. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="StructuralRules.triple_frame" class="idref" href="#StructuralRules.triple_frame"><span class="id" title="axiom">triple_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="t:159" class="idref" href="#t:159"><span class="id" title="binder">t</span></a> <a id="H:160" class="idref" href="#H:160"><span class="id" title="binder">H</span></a> <a id="Q:161" class="idref" href="#Q:161"><span class="id" title="binder">Q</span></a> <a id="H':162" class="idref" href="#H':162"><span class="id" title="binder">H'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:159"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H:160"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#Q:161"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:159"><span class="id" title="variable">t</span></a> (<a class="idref" href="Triples.html#H:160"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Triples.html#H':162"><span class="id" title="variable">H'</span></a>) (<a class="idref" href="Triples.html#Q:161"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Triples.html#H':162"><span class="id" title="variable">H'</span></a>).<br/>
</div>

<div class="doc">
The consequence rule asserts, as in Hoare Logic, that the validity of a
    triple is preserved if we strengthen its precondition or weaken its
    postcondition. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="StructuralRules.triple_conseq" class="idref" href="#StructuralRules.triple_conseq"><span class="id" title="axiom">triple_conseq</span></a> : <span class="id" title="keyword">∀</span> <a id="t:164" class="idref" href="#t:164"><span class="id" title="binder">t</span></a> <a id="H':165" class="idref" href="#H':165"><span class="id" title="binder">H'</span></a> <a id="Q':166" class="idref" href="#Q':166"><span class="id" title="binder">Q'</span></a> <a id="H:167" class="idref" href="#H:167"><span class="id" title="binder">H</span></a> <a id="Q:168" class="idref" href="#Q:168"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:164"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H':165"><span class="id" title="variable">H'</span></a> <a class="idref" href="Triples.html#Q':166"><span class="id" title="variable">Q'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#H:167"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Triples.html#H':165"><span class="id" title="variable">H'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#Q':166"><span class="id" title="variable">Q'</span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Triples.html#Q:168"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:164"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H:167"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#Q:168"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
The "extraction rule for pure facts" asserts that a judgment of the form
    <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">(<span class='gray-font'>\</span>[<span class="id" title="var">P</span>]</span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H</span>)</span> <span class="inlinecode"><span class="id" title="var">Q</span></span> is derivable from <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>. This
    structural rule captures the extraction of the pure facts out of the
    precondition of a triple, like <span class="inlinecode"><span class="id" title="var">himpl_hstar_hpure_l</span></span> for entailments. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="StructuralRules.triple_hpure" class="idref" href="#StructuralRules.triple_hpure"><span class="id" title="axiom">triple_hpure</span></a> : <span class="id" title="keyword">∀</span> <a id="t:170" class="idref" href="#t:170"><span class="id" title="binder">t</span></a> (<a id="P:171" class="idref" href="#P:171"><span class="id" title="binder">P</span></a>:<span class="id" title="keyword">Prop</span>) <a id="H:172" class="idref" href="#H:172"><span class="id" title="binder">H</span></a> <a id="Q:173" class="idref" href="#Q:173"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Triples.html#P:171"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:170"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H:172"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#Q:173"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:170"><span class="id" title="variable">t</span></a> (<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Triples.html#P:171"><span class="id" title="variable">P</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Triples.html#H:172"><span class="id" title="variable">H</span></a>) <a class="idref" href="Triples.html#Q:173"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
The "extraction rule for existentials" asserts that a judgment of the form
    <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">(<span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode"><span class="id" title="var">J</span></span> <span class="inlinecode"><span class="id" title="var">x</span>)</span> <span class="inlinecode"><span class="id" title="var">Q</span></span> is derivable from
    <span class="inlinecode"><span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">(<span class="id" title="var">J</span></span> <span class="inlinecode"><span class="id" title="var">x</span>)</span> <span class="inlinecode"><span class="id" title="var">Q</span></span>. Again, this rule is the counterpart of the
    corresponding rule on entailments, <span class="inlinecode"><span class="id" title="var">himpl_hexists_l</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="StructuralRules.triple_hexists" class="idref" href="#StructuralRules.triple_hexists"><span class="id" title="axiom">triple_hexists</span></a> : <span class="id" title="keyword">∀</span> <a id="t:175" class="idref" href="#t:175"><span class="id" title="binder">t</span></a> (<a id="A:176" class="idref" href="#A:176"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>) (<a id="J:177" class="idref" href="#J:177"><span class="id" title="binder">J</span></a>:<a class="idref" href="Triples.html#A:176"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) <a id="Q:178" class="idref" href="#Q:178"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="x:179" class="idref" href="#x:179"><span class="id" title="binder">x</span></a>, <a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:175"><span class="id" title="variable">t</span></a> (<a class="idref" href="Triples.html#J:177"><span class="id" title="variable">J</span></a> <a class="idref" href="Triples.html#x:179"><span class="id" title="variable">x</span></a>) <a class="idref" href="Triples.html#Q:178"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:175"><span class="id" title="variable">t</span></a> (<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="x:180" class="idref" href="#x:180"><span class="id" title="binder">x</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="Triples.html#J:177"><span class="id" title="variable">J</span></a> <a class="idref" href="Triples.html#x:180"><span class="id" title="variable">x</span></a>) <a class="idref" href="Triples.html#Q:178"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
<a id="lab167"></a><h2 class="section">Derived Structural Rules</h2>

<div class="paragraph"> </div>

 Given a triple to be established, is is very unlikely for the frame rule to
    be applicable directly, because the precondition must be exactly of the form
    <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H'</span></span> and the postcondition exactly of the form <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*+</span> <span class="inlinecode"><span class="id" title="var">H'</span></span> for some
    <span class="inlinecode"><span class="id" title="var">H'</span></span>. For example, the frame rule would not apply to a proof obligation of
    the form <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">(<span class="id" title="var">H'</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H</span>)</span> <span class="inlinecode">(<span class="id" title="var">Q</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*+</span> <span class="inlinecode"><span class="id" title="var">H'</span>)</span> because <span class="inlinecode"><span class="id" title="var">H'</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H</span></span> does not match
    <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H'</span></span>.

<div class="paragraph"> </div>

    This limitation rule can be addressed by combining the frame rule and the
    rule of consequence into a single rule, called the "consequence-frame rule".
    This rule, shown below, enables deriving a triple from another triple,
    without syntactic restrictions on the shape of the precondition and
    postcondition of the two triples involved. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="StructuralRules.triple_conseq_frame" class="idref" href="#StructuralRules.triple_conseq_frame"><span class="id" title="lemma">triple_conseq_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>2</sub>:182" class="idref" href="#H<sub>2</sub>:182"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>1</sub>:183" class="idref" href="#H<sub>1</sub>:183"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="Q<sub>1</sub>:184" class="idref" href="#Q<sub>1</sub>:184"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="t:185" class="idref" href="#t:185"><span class="id" title="binder">t</span></a> <a id="H:186" class="idref" href="#H:186"><span class="id" title="binder">H</span></a> <a id="Q:187" class="idref" href="#Q:187"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:185"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H<sub>1</sub>:183"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Triples.html#Q<sub>1</sub>:184"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#H:186"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Triples.html#H<sub>1</sub>:183"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Triples.html#H<sub>2</sub>:182"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#Q<sub>1</sub>:184"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Triples.html#H<sub>2</sub>:182"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Triples.html#Q:187"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:185"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H:186"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#Q:187"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
<a id="lab168"></a><h4 class="section">Exercise: 1 star, standard, especially useful (triple_conseq_frame)</h4>
 Prove the combined consequence-frame rule. 
</div>
<div class="code">

<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 The extraction rule <span class="inlinecode"><span class="id" title="var">triple_hpure</span></span> assumes a precondition of the form
    <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">P</span>]</span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H</span></span>. The variant rule <span class="inlinecode"><span class="id" title="var">triple_hpure'</span></span>, stated below, assumes instead
    a precondition with only the pure part, i.e., of the form <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">P</span>]</span>. 
<div class="paragraph"> </div>

<a id="lab169"></a><h4 class="section">Exercise: 1 star, standard, optional (triple_hpure')</h4>
 Prove that <span class="inlinecode"><span class="id" title="var">triple_hpure'</span></span> is indeed a corollary of <span class="inlinecode"><span class="id" title="var">triple_hpure</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="StructuralRules.triple_hpure'" class="idref" href="#StructuralRules.triple_hpure'"><span class="id" title="lemma">triple_hpure'</span></a> : <span class="id" title="keyword">∀</span> <a id="t:188" class="idref" href="#t:188"><span class="id" title="binder">t</span></a> (<a id="P:189" class="idref" href="#P:189"><span class="id" title="binder">P</span></a>:<span class="id" title="keyword">Prop</span>) <a id="Q:190" class="idref" href="#Q:190"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Triples.html#P:189"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:188"><span class="id" title="variable">t</span></a> <a class="idref" href="LibSepReference.html#0a700e54c124035039013e87e1a2bcaa"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a> <a class="idref" href="Triples.html#Q:190"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:188"><span class="id" title="variable">t</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Triples.html#P:189"><span class="id" title="variable">P</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="Triples.html#Q:190"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="code">

<span class="id" title="keyword">End</span> <a class="idref" href="Triples.html#StructuralRules"><span class="id" title="module">StructuralRules</span></a>.<br/>
</div>

<div class="doc">
<a id="lab170"></a><h1 class="section">More Details</h1>

</div>

<div class="doc">
<a id="lab171"></a><h2 class="section">Proof of the Consequence Rule</h2>

<div class="paragraph"> </div>

 The proof of the consequence rule relies on establishing that the
    omni-big-step judgment is preserved under weakening its postcondition.
    Recall that in <span class="inlinecode"><span class="id" title="tactic">eval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span>, the postcondition <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> is an overapproximation
    of the set of configurations reachable from <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span>. Thus, if <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> is
    included in a larger set <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span>, then <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span> is also an overapproximation of the
    configurations reachable from <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span>. The formalization is a
    straightforward induction. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="eval_conseq" class="idref" href="#eval_conseq"><span class="id" title="lemma">eval_conseq</span></a> : <span class="id" title="keyword">∀</span> <a id="s:191" class="idref" href="#s:191"><span class="id" title="binder">s</span></a> <a id="t:192" class="idref" href="#t:192"><span class="id" title="binder">t</span></a> <a id="Q<sub>1</sub>:193" class="idref" href="#Q<sub>1</sub>:193"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:194" class="idref" href="#Q<sub>2</sub>:194"><span class="id" title="binder">Q<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#eval"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:191"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:192"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q<sub>1</sub>:193"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#Q<sub>1</sub>:193"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Triples.html#Q<sub>2</sub>:194"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#eval"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:191"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:192"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q<sub>2</sub>:194"><span class="id" title="variable">Q<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">W</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">asserts</span> <span class="id" title="var">W'</span>: (<span class="id" title="keyword">∀</span> <a id="v:197" class="idref" href="#v:197"><span class="id" title="binder">v</span></a> <a id="h:198" class="idref" href="#h:198"><span class="id" title="binder">h</span></a>, <span class="id" title="var">Q<sub>1</sub></span> <a class="idref" href="Triples.html#v:195"><span class="id" title="variable">v</span></a> <a class="idref" href="Triples.html#h:196"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="var">Q<sub>2</sub></span> <a class="idref" href="Triples.html#v:195"><span class="id" title="variable">v</span></a> <a class="idref" href="Triples.html#h:196"><span class="id" title="variable">h</span></a>). { <span class="id" title="tactic">auto</span>. } <span class="id" title="tactic">clear</span> <span class="id" title="var">W</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">M</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [ <span class="id" title="var">constructors</span>* ].<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
From there, it is straightforward to derive the consequence rule. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triple_conseq" class="idref" href="#triple_conseq"><span class="id" title="lemma">triple_conseq</span></a> : <span class="id" title="keyword">∀</span> <a id="t:199" class="idref" href="#t:199"><span class="id" title="binder">t</span></a> <a id="H':200" class="idref" href="#H':200"><span class="id" title="binder">H'</span></a> <a id="Q':201" class="idref" href="#Q':201"><span class="id" title="binder">Q'</span></a> <a id="H:202" class="idref" href="#H:202"><span class="id" title="binder">H</span></a> <a id="Q:203" class="idref" href="#Q:203"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:199"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H':200"><span class="id" title="variable">H'</span></a> <a class="idref" href="Triples.html#Q':201"><span class="id" title="variable">Q'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#H:202"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Triples.html#H':200"><span class="id" title="variable">H'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#Q':201"><span class="id" title="variable">Q'</span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Triples.html#Q:203"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:199"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H:202"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#Q:203"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">unfolds</span> <a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">MH</span> <span class="id" title="var">MQ</span> <span class="id" title="var">HF</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#eval_conseq"><span class="id" title="lemma">eval_conseq</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab172"></a><h2 class="section">Proof of the Frame Rule</h2>

<div class="paragraph"> </div>

 The second key property that we wish to establish is the "frame rule". The
    frame rule asserts that if a specification <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> holds, then one
    may derive <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode">(<span class="id" title="var">H</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H'</span>)</span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">(<span class="id" title="var">Q</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*+</span> <span class="inlinecode"><span class="id" title="var">H'</span>)</span> for any <span class="inlinecode"><span class="id" title="var">H'</span></span>. Recall from chapter
    <a href="Hprop.html"><span class="inlineref">Hprop</span></a> that the operator <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*+</span> <span class="inlinecode"><span class="id" title="var">H'</span></span> is a notation for
    <span class="inlinecode"><span class="id" title="keyword">fun</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">⇒</span> <span class="inlinecode">(<span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H'</span>)</span>.

<div class="paragraph"> </div>

    Intuitively, if the term <span class="inlinecode"><span class="id" title="var">t</span></span> executes safely in a heap <span class="inlinecode"><span class="id" title="var">H</span></span>, then this this
    term should behave similarly in any extension of <span class="inlinecode"><span class="id" title="var">H</span></span> with a disjoint part
    <span class="inlinecode"><span class="id" title="var">H'</span></span>. Moreover, its evaluation should leave this piece of state <span class="inlinecode"><span class="id" title="var">H'</span></span>
    unmodified throughout the execution of <span class="inlinecode"><span class="id" title="var">t</span></span>. 
<div class="paragraph"> </div>

 The crux of the proof of the frame rule is to argue that <span class="inlinecode"><span class="id" title="tactic">eval</span></span> is stable
    under extension with a disjoint piece of heap. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="eval_frame" class="idref" href="#eval_frame"><span class="id" title="lemma">eval_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="h<sub>1</sub>:204" class="idref" href="#h<sub>1</sub>:204"><span class="id" title="binder">h<sub>1</sub></span></a> <a id="h<sub>2</sub>:205" class="idref" href="#h<sub>2</sub>:205"><span class="id" title="binder">h<sub>2</sub></span></a> <a id="t:206" class="idref" href="#t:206"><span class="id" title="binder">t</span></a> <a id="Q:207" class="idref" href="#Q:207"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#eval"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#h<sub>1</sub>:204"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="Triples.html#t:206"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q:207"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.disjoint"><span class="id" title="definition">Fmap.disjoint</span></a> <a class="idref" href="Triples.html#h<sub>1</sub>:204"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="Triples.html#h<sub>2</sub>:205"><span class="id" title="variable">h<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#eval"><span class="id" title="inductive">eval</span></a> (<a class="idref" href="Triples.html#h<sub>1</sub>:204"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <a class="idref" href="Triples.html#h<sub>2</sub>:205"><span class="id" title="variable">h<sub>2</sub></span></a>) <a class="idref" href="Triples.html#t:206"><span class="id" title="variable">t</span></a> (<a class="idref" href="Triples.html#Q:207"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation">(</span></a><span class="id" title="notation">=</span> <a class="idref" href="Triples.html#h<sub>2</sub>:205"><span class="id" title="variable">h<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation">)</span></a>).<br/>
</div>

<div class="doc">
This proof goes by induction. The most interesting step is for allocation.
    In a derivation built using <span class="inlinecode"><span class="id" title="var">eval_ref</span></span>, we are given as assumption a
    property that holds for any location <span class="inlinecode"><span class="id" title="var">p</span></span> fresh from <span class="inlinecode"><span class="id" title="var">h<sub>1</sub></span></span>, and we are
    requested to prove a property that holds for any location <span class="inlinecode"><span class="id" title="var">p</span></span> fresh from
    <span class="inlinecode"><span class="id" title="var">h<sub>1</sub></span></span> <span class="inlinecode">\<span class="id" title="var">u</span></span> <span class="inlinecode"><span class="id" title="var">h<sub>2</sub></span></span>. We are thus restricting the set of <span class="inlinecode"><span class="id" title="var">p</span></span> that can be considered
    for allocation, and so the result holds. 
</div>
<div class="code">

<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">HD</span>. <span class="id" title="var">gen</span> <span class="id" title="var">h<sub>2</sub></span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">M</span>; <span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [ <span class="id" title="var">hint</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>; <span class="id" title="var">constructors</span>* ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rename</span> <span class="id" title="var">M</span> <span class="id" title="var">into</span> <span class="id" title="var">M<sub>1</sub></span>, <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">M<sub>2</sub></span>, <span class="id" title="var">IHM</span> <span class="id" title="var">into</span> <span class="id" title="var">IH<sub>1</sub></span>, <span class="id" title="var">H<sub>0</sub></span> <span class="id" title="var">into</span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specializes</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">HD</span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#eval_seq"><span class="id" title="constructor">eval_seq</span></a> <span class="id" title="var">IH<sub>1</sub></span>. <span class="id" title="var">introv</span> <span class="id" title="var">HK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> (<span class="id" title="var">h<sub>1</sub>'</span>&amp;<span class="id" title="var">h<sub>2</sub>'</span>&amp;<span class="id" title="var">K<sub>1</sub>'</span>&amp;<span class="id" title="var">K<sub>2</sub>'</span>&amp;<span class="id" title="var">KD</span>&amp;<span class="id" title="var">KU</span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_inv"><span class="id" title="lemma">hstar_inv</span></a> <span class="id" title="var">HK</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="var">applys</span>* <span class="id" title="var">IH<sub>2</sub></span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rename</span> <span class="id" title="var">M</span> <span class="id" title="var">into</span> <span class="id" title="var">M<sub>1</sub></span>, <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">M<sub>2</sub></span>, <span class="id" title="var">IHM</span> <span class="id" title="var">into</span> <span class="id" title="var">IH<sub>1</sub></span>, <span class="id" title="var">H<sub>0</sub></span> <span class="id" title="var">into</span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">specializes</span> <span class="id" title="var">IH<sub>1</sub></span> <span class="id" title="var">HD</span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#eval_let"><span class="id" title="constructor">eval_let</span></a> <span class="id" title="var">IH<sub>1</sub></span>. <span class="id" title="var">introv</span> <span class="id" title="var">HK</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lets</span> (<span class="id" title="var">h<sub>1</sub>'</span>&amp;<span class="id" title="var">h<sub>2</sub>'</span>&amp;<span class="id" title="var">K<sub>1</sub>'</span>&amp;<span class="id" title="var">K<sub>2</sub>'</span>&amp;<span class="id" title="var">KD</span>&amp;<span class="id" title="var">KU</span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_inv"><span class="id" title="lemma">hstar_inv</span></a> <span class="id" title="var">HK</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="var">applys</span>* <span class="id" title="var">IH<sub>2</sub></span>. }<br/>
&nbsp;&nbsp;{ <span class="comment">(*&nbsp;Here&nbsp;is&nbsp;the&nbsp;interesting&nbsp;case&nbsp;about&nbsp;allocation.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rename</span> <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#eval_ref"><span class="id" title="constructor">eval_ref</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">p</span> <span class="id" title="var">Hp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#Fmap.indom_union_eq"><span class="id" title="lemma">Fmap.indom_union_eq</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">Hp</span>. <span class="id" title="var">rew_logic</span> <span class="id" title="keyword">in</span> <span class="id" title="var">Hp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hp</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hp<sub>1</sub></span> <span class="id" title="var">Hp<sub>2</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.update_union_not_r"><span class="id" title="lemma">Fmap.update_union_not_r</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <span class="id" title="var">M</span>. } { <span class="id" title="tactic">auto</span>. } { <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.disjoint_update_not_r"><span class="id" title="lemma">Fmap.disjoint_update_not_r</span></a>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#eval_get"><span class="id" title="constructor">eval_get</span></a>. { <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_eq"><span class="id" title="lemma">Fmap.indom_union_eq</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.read_union_l"><span class="id" title="lemma">Fmap.read_union_l</span></a>. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#eval_set"><span class="id" title="constructor">eval_set</span></a>. { <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_eq"><span class="id" title="lemma">Fmap.indom_union_eq</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.update_union_l"><span class="id" title="lemma">Fmap.update_union_l</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">auto</span>. } { <span class="id" title="tactic">auto</span>. } { <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.disjoint_update_l"><span class="id" title="lemma">Fmap.disjoint_update_l</span></a>. } } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#eval_free"><span class="id" title="constructor">eval_free</span></a>. { <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_eq"><span class="id" title="lemma">Fmap.indom_union_eq</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.remove_disjoint_union_l"><span class="id" title="lemma">Fmap.remove_disjoint_union_l</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">auto</span>. } { <span class="id" title="tactic">auto</span>. } { <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.disjoint_remove_l"><span class="id" title="lemma">Fmap.disjoint_remove_l</span></a>. } } }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The frame rule is derived from <span class="inlinecode"><span class="id" title="var">eval_frame</span></span> and <span class="inlinecode"><span class="id" title="var">eval_conseq</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triple_frame" class="idref" href="#triple_frame"><span class="id" title="lemma">triple_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="t:208" class="idref" href="#t:208"><span class="id" title="binder">t</span></a> <a id="H:209" class="idref" href="#H:209"><span class="id" title="binder">H</span></a> <a id="Q:210" class="idref" href="#Q:210"><span class="id" title="binder">Q</span></a> <a id="H':211" class="idref" href="#H':211"><span class="id" title="binder">H'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:208"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H:209"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#Q:210"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:208"><span class="id" title="variable">t</span></a> (<a class="idref" href="Triples.html#H:209"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Triples.html#H':211"><span class="id" title="variable">H'</span></a>) (<a class="idref" href="Triples.html#Q:210"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Triples.html#H':211"><span class="id" title="variable">H'</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">HF</span>. <span class="id" title="var">lets</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">M<sub>2</sub></span>&amp;<span class="id" title="var">MD</span>&amp;<span class="id" title="var">MU</span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_inv"><span class="id" title="lemma">hstar_inv</span></a> (<span class="id" title="definition">rm</span> <span class="id" title="var">HF</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">specializes</span> <span class="id" title="var">M</span> <span class="id" title="var">M<sub>1</sub></span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#eval_conseq"><span class="id" title="lemma">eval_conseq</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#eval_frame"><span class="id" title="lemma">eval_frame</span></a> <span class="id" title="var">M</span> <span class="id" title="var">MD</span>. } { <span class="id" title="var">xsimpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h'</span> →. <span class="id" title="var">applys</span> <span class="id" title="var">M<sub>2</sub></span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab173"></a><h2 class="section">Proof of the Extraction Rules</h2>

<div class="paragraph"> </div>

 The extraction rules are proved by unfolding the definition of <span class="inlinecode"><span class="id" title="var">triple</span></span> and
    inverting the hypothesis capturing the fact that the input state satisfies
    the precondition. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triple_hpure" class="idref" href="#triple_hpure"><span class="id" title="lemma">triple_hpure</span></a> : <span class="id" title="keyword">∀</span> <a id="t:212" class="idref" href="#t:212"><span class="id" title="binder">t</span></a> (<a id="P:213" class="idref" href="#P:213"><span class="id" title="binder">P</span></a>:<span class="id" title="keyword">Prop</span>) <a id="H:214" class="idref" href="#H:214"><span class="id" title="binder">H</span></a> <a id="Q:215" class="idref" href="#Q:215"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Triples.html#P:213"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:212"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H:214"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#Q:215"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:212"><span class="id" title="variable">t</span></a> (<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Triples.html#P:213"><span class="id" title="variable">P</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Triples.html#H:214"><span class="id" title="variable">H</span></a>) <a class="idref" href="Triples.html#Q:215"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">M<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">U</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">HP</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">E</span>: <a class="idref" href="LibSepReference.html#SepSimplArgs.hempty_inv"><span class="id" title="lemma">hempty_inv</span></a> <span class="id" title="var">HP</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#Fmap.union_empty_l"><span class="id" title="lemma">Fmap.union_empty_l</span></a>. <span class="id" title="var">applys</span>¬<span class="id" title="var">M</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab174"></a><h4 class="section">Exercise: 1 star, standard, especially useful (triple_hexists)</h4>
 Prove <span class="inlinecode"><span class="id" title="var">triple_hexists</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triple_hexists" class="idref" href="#triple_hexists"><span class="id" title="lemma">triple_hexists</span></a> : <span class="id" title="keyword">∀</span> <a id="t:216" class="idref" href="#t:216"><span class="id" title="binder">t</span></a> (<a id="A:217" class="idref" href="#A:217"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>) (<a id="J:218" class="idref" href="#J:218"><span class="id" title="binder">J</span></a>:<a class="idref" href="Triples.html#A:217"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) <a id="Q:219" class="idref" href="#Q:219"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> (<a id="x:220" class="idref" href="#x:220"><span class="id" title="binder">x</span></a>:<a class="idref" href="Triples.html#A:217"><span class="id" title="variable">A</span></a>), <a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:216"><span class="id" title="variable">t</span></a> (<a class="idref" href="Triples.html#J:218"><span class="id" title="variable">J</span></a> <a class="idref" href="Triples.html#x:220"><span class="id" title="variable">x</span></a>) <a class="idref" href="Triples.html#Q:219"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:216"><span class="id" title="variable">t</span></a> (<a class="idref" href="LibSepReference.html#SepSimplArgs.hexists"><span class="id" title="definition">hexists</span></a> <a class="idref" href="Triples.html#J:218"><span class="id" title="variable">J</span></a>) <a class="idref" href="Triples.html#Q:219"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>


<div class="doc">
<a id="lab175"></a><h2 class="section">Rule for Naming Heaps</h2>

<div class="paragraph"> </div>

 To prove <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>, it suffices to show that, for any heap <span class="inlinecode"><span class="id" title="var">h</span></span>
    satisfying <span class="inlinecode"><span class="id" title="var">H</span></span>, the triple <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">(=</span> <span class="inlinecode"><span class="id" title="var">h</span>)</span> <span class="inlinecode"><span class="id" title="var">Q</span></span> holds. In other words, even
    though the predicate <span class="inlinecode"><span class="id" title="var">triple</span></span> abstracts away from the input heap, it remains
    technically possible to introduce an entity, namely <span class="inlinecode"><span class="id" title="var">h</span></span>, that refers to the
    specific heap at hand during the evaluation of <span class="inlinecode"><span class="id" title="var">t</span></span>. (An example use case
    will appear in a later chapter (<a href="WPsem.html"><span class="inlineref">WPsem</span></a>, lemma <span class="inlinecode"><span class="id" title="var">wp_equiv_2</span></span>). 
<div class="paragraph"> </div>

<a id="lab176"></a><h4 class="section">Exercise: 1 star, standard, optional (triple_named_heap)</h4>
 Prove the reasoning rule <span class="inlinecode"><span class="id" title="var">hoare_named_heap</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triple_named_heap" class="idref" href="#triple_named_heap"><span class="id" title="lemma">triple_named_heap</span></a> : <span class="id" title="keyword">∀</span> <a id="t:221" class="idref" href="#t:221"><span class="id" title="binder">t</span></a> <a id="H:222" class="idref" href="#H:222"><span class="id" title="binder">H</span></a> <a id="Q:223" class="idref" href="#Q:223"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="h:224" class="idref" href="#h:224"><span class="id" title="binder">h</span></a>, <a class="idref" href="Triples.html#H:222"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#h:224"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:221"><span class="id" title="variable">t</span></a> (<span class="id" title="notation">=</span> <a class="idref" href="Triples.html#h:224"><span class="id" title="variable">h</span></a>) <a class="idref" href="Triples.html#Q:223"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:221"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H:222"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#Q:223"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>


<div class="doc">
<a id="lab177"></a><h1 class="section">Optional Material</h1>

</div>

<div class="doc">
<a id="lab178"></a><h2 class="section">An Alternative Structural Rule for Existentials</h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="AlternativeExistentialRule" class="idref" href="#AlternativeExistentialRule"><span class="id" title="module">AlternativeExistentialRule</span></a>.<br/>
</div>

<div class="doc">
Traditional papers on Separation Logic do not include <span class="inlinecode"><span class="id" title="var">triple_hexists</span></span>, but
    instead include a rule called here <span class="inlinecode"><span class="id" title="var">triple_hexists2</span></span>, which features an
    existential quantifier both in the precondition and in the postcondition. As
    we show next, in the presence of the consequence rule, the two rules are
    equivalent. 
<div class="paragraph"> </div>

<a id="lab179"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (triple_hexists2)</h4>
 Using <span class="inlinecode"><span class="id" title="var">triple_hexists</span></span> and <span class="inlinecode"><span class="id" title="var">triple_conseq</span></span>, as well as the tactic <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>,
    prove that <span class="inlinecode"><span class="id" title="var">triple_hexists2</span></span> is derivable. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="AlternativeExistentialRule.triple_hexists2" class="idref" href="#AlternativeExistentialRule.triple_hexists2"><span class="id" title="lemma">triple_hexists2</span></a> : <span class="id" title="keyword">∀</span> <a id="A:225" class="idref" href="#A:225"><span class="id" title="binder">A</span></a> (<a id="Hof:226" class="idref" href="#Hof:226"><span class="id" title="binder">Hof</span></a>:<a class="idref" href="Triples.html#A:225"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) (<a id="Qof:227" class="idref" href="#Qof:227"><span class="id" title="binder">Qof</span></a>:<a class="idref" href="Triples.html#A:225"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) <a id="t:228" class="idref" href="#t:228"><span class="id" title="binder">t</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="x:229" class="idref" href="#x:229"><span class="id" title="binder">x</span></a>, <a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:228"><span class="id" title="variable">t</span></a> (<a class="idref" href="Triples.html#Hof:226"><span class="id" title="variable">Hof</span></a> <a class="idref" href="Triples.html#x:229"><span class="id" title="variable">x</span></a>) (<a class="idref" href="Triples.html#Qof:227"><span class="id" title="variable">Qof</span></a> <a class="idref" href="Triples.html#x:229"><span class="id" title="variable">x</span></a>)<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:228"><span class="id" title="variable">t</span></a> (<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="x:232" class="idref" href="#x:232"><span class="id" title="binder">x</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="Triples.html#Hof:226"><span class="id" title="variable">Hof</span></a> <a class="idref" href="Triples.html#x:232"><span class="id" title="variable">x</span></a>) (<span class="id" title="keyword">fun</span> <a id="v:230" class="idref" href="#v:230"><span class="id" title="binder">v</span></a> ⇒ <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="x:231" class="idref" href="#x:231"><span class="id" title="binder">x</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="Triples.html#Qof:227"><span class="id" title="variable">Qof</span></a> <a class="idref" href="Triples.html#x:231"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#v:230"><span class="id" title="variable">v</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;<span class="inlinecode"></span>&nbsp;*)</span><br/>
</div>

<div class="doc">
<a id="lab180"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (triple_hexists_of_triple_hexists2)</h4>
 Reciprocally, using <span class="inlinecode"><span class="id" title="var">triple_hexists2</span></span> and <span class="inlinecode"><span class="id" title="var">triple_conseq</span></span>, as well as the
    tactic <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>, prove that <span class="inlinecode"><span class="id" title="var">triple_hexists</span></span> is derivable. Of course, you
    may not use <span class="inlinecode"><span class="id" title="var">triple_hexists</span></span> in this proof.) 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="AlternativeExistentialRule.triple_hexists_of_triple_hexists2" class="idref" href="#AlternativeExistentialRule.triple_hexists_of_triple_hexists2"><span class="id" title="lemma">triple_hexists_of_triple_hexists2</span></a> : <span class="id" title="keyword">∀</span> <a id="t:233" class="idref" href="#t:233"><span class="id" title="binder">t</span></a> (<a id="A:234" class="idref" href="#A:234"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>) (<a id="Hof:235" class="idref" href="#Hof:235"><span class="id" title="binder">Hof</span></a>:<a class="idref" href="Triples.html#A:234"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) <a id="Q:236" class="idref" href="#Q:236"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="x:237" class="idref" href="#x:237"><span class="id" title="binder">x</span></a>, <a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:233"><span class="id" title="variable">t</span></a> (<a class="idref" href="Triples.html#Hof:235"><span class="id" title="variable">Hof</span></a> <a class="idref" href="Triples.html#x:237"><span class="id" title="variable">x</span></a>) <a class="idref" href="Triples.html#Q:236"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:233"><span class="id" title="variable">t</span></a> (<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="x:238" class="idref" href="#x:238"><span class="id" title="binder">x</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="Triples.html#Hof:235"><span class="id" title="variable">Hof</span></a> <a class="idref" href="Triples.html#x:238"><span class="id" title="variable">x</span></a>) <a class="idref" href="Triples.html#Q:236"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/><hr class='doublespaceincode'/>
<span class="comment">(*&nbsp;<span class="inlinecode"></span>&nbsp;*)</span><br/>
</div>

<div class="doc">
Compared with <span class="inlinecode"><span class="id" title="var">triple_hexists2</span></span>, the formulation of <span class="inlinecode"><span class="id" title="var">triple_hexists</span></span> is more
    concise, and is easier to exploit in practice. 
</div>
<div class="code">

<span class="id" title="keyword">End</span> <a class="idref" href="Triples.html#AlternativeExistentialRule"><span class="id" title="module">AlternativeExistentialRule</span></a>.<br/>
</div>

<div class="doc">
<a id="lab181"></a><h2 class="section">Small-Step Semantics</h2>

<div class="paragraph"> </div>

 Suppose we have a language with a formal semantics written not in big-step
    stype but in small-step style. What are the options for formalizing total
    correctness triples? We discuss two approaches. The first one consists of
    formally relating the small-step judgment with the omni-big-step judgment.
    The second consists of directly defining triples in terms of the small-step
    judgment. Before explaining the two approaches, let us present the
    formalization of the small-step semantics. 
<div class="paragraph"> </div>

 The judgment <span class="inlinecode"><span class="id" title="var">step</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode"><span class="id" title="var">t'</span></span> describes the small-step reduction relation:
    it asserts that the program configuration <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> can take one reduction
    step to reach the program configuration <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">t'</span>)</span>. Its definition is
    standard. 
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="step" class="idref" href="#step"><span class="id" title="inductive">step</span></a> : <a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
<br/>
<span class="comment">(*&nbsp;Context&nbsp;rules&nbsp;*)</span><br/>
| <a id="step_seq_ctx" class="idref" href="#step_seq_ctx"><span class="id" title="constructor">step_seq_ctx</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:241" class="idref" href="#s<sub>1</sub>:241"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:242" class="idref" href="#s<sub>2</sub>:242"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="t<sub>1</sub>:243" class="idref" href="#t<sub>1</sub>:243"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>1</sub>':244" class="idref" href="#t<sub>1</sub>':244"><span class="id" title="binder">t<sub>1</sub>'</span></a> <a id="t<sub>2</sub>:245" class="idref" href="#t<sub>2</sub>:245"><span class="id" title="binder">t<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:241"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:243"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#s<sub>2</sub>:242"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>':244"><span class="id" title="variable">t<sub>1</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:241"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_seq"><span class="id" title="constructor">trm_seq</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:243"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:245"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#s<sub>2</sub>:242"><span class="id" title="variable">s<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_seq"><span class="id" title="constructor">trm_seq</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>':244"><span class="id" title="variable">t<sub>1</sub>'</span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:245"><span class="id" title="variable">t<sub>2</sub></span></a>)<br/>
| <a id="step_let_ctx" class="idref" href="#step_let_ctx"><span class="id" title="constructor">step_let_ctx</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:246" class="idref" href="#s<sub>1</sub>:246"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:247" class="idref" href="#s<sub>2</sub>:247"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="x:248" class="idref" href="#x:248"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:249" class="idref" href="#t<sub>1</sub>:249"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>1</sub>':250" class="idref" href="#t<sub>1</sub>':250"><span class="id" title="binder">t<sub>1</sub>'</span></a> <a id="t<sub>2</sub>:251" class="idref" href="#t<sub>2</sub>:251"><span class="id" title="binder">t<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:246"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:249"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#s<sub>2</sub>:247"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>':250"><span class="id" title="variable">t<sub>1</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:246"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Triples.html#x:248"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:249"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:251"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#s<sub>2</sub>:247"><span class="id" title="variable">s<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Triples.html#x:248"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>':250"><span class="id" title="variable">t<sub>1</sub>'</span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:251"><span class="id" title="variable">t<sub>2</sub></span></a>)<br/>
<br/>
<span class="comment">(*&nbsp;Reductions&nbsp;*)</span><br/>
| <a id="step_fun" class="idref" href="#step_fun"><span class="id" title="constructor">step_fun</span></a> : <span class="id" title="keyword">∀</span> <a id="s:252" class="idref" href="#s:252"><span class="id" title="binder">s</span></a> <a id="x:253" class="idref" href="#x:253"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:254" class="idref" href="#t<sub>1</sub>:254"><span class="id" title="binder">t<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:252"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_fun"><span class="id" title="constructor">trm_fun</span></a> <a class="idref" href="Triples.html#x:253"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:254"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Triples.html#s:252"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_fun"><span class="id" title="constructor">val_fun</span></a> <a class="idref" href="Triples.html#x:253"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:254"><span class="id" title="variable">t<sub>1</sub></span></a>)<br/>
| <a id="step_fix" class="idref" href="#step_fix"><span class="id" title="constructor">step_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s:255" class="idref" href="#s:255"><span class="id" title="binder">s</span></a> <a id="f:256" class="idref" href="#f:256"><span class="id" title="binder">f</span></a> <a id="x:257" class="idref" href="#x:257"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:258" class="idref" href="#t<sub>1</sub>:258"><span class="id" title="binder">t<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:255"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_fix"><span class="id" title="constructor">trm_fix</span></a> <a class="idref" href="Triples.html#f:256"><span class="id" title="variable">f</span></a> <a class="idref" href="Triples.html#x:257"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:258"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Triples.html#s:255"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Triples.html#f:256"><span class="id" title="variable">f</span></a> <a class="idref" href="Triples.html#x:257"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:258"><span class="id" title="variable">t<sub>1</sub></span></a>)<br/>
| <a id="step_app_fun" class="idref" href="#step_app_fun"><span class="id" title="constructor">step_app_fun</span></a> : <span class="id" title="keyword">∀</span> <a id="s:259" class="idref" href="#s:259"><span class="id" title="binder">s</span></a> <a id="v<sub>1</sub>:260" class="idref" href="#v<sub>1</sub>:260"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:261" class="idref" href="#v<sub>2</sub>:261"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="x:262" class="idref" href="#x:262"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:263" class="idref" href="#t<sub>1</sub>:263"><span class="id" title="binder">t<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#v<sub>1</sub>:260"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fun"><span class="id" title="constructor">val_fun</span></a> <a class="idref" href="Triples.html#x:262"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:263"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:259"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:260"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#v<sub>2</sub>:261"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="Triples.html#s:259"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#x:262"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#v<sub>2</sub>:261"><span class="id" title="variable">v<sub>2</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:263"><span class="id" title="variable">t<sub>1</sub></span></a>)<br/>
| <a id="step_app_fix" class="idref" href="#step_app_fix"><span class="id" title="constructor">step_app_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s:264" class="idref" href="#s:264"><span class="id" title="binder">s</span></a> <a id="v<sub>1</sub>:265" class="idref" href="#v<sub>1</sub>:265"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:266" class="idref" href="#v<sub>2</sub>:266"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="f:267" class="idref" href="#f:267"><span class="id" title="binder">f</span></a> <a id="x:268" class="idref" href="#x:268"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:269" class="idref" href="#t<sub>1</sub>:269"><span class="id" title="binder">t<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#v<sub>1</sub>:265"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Triples.html#f:267"><span class="id" title="variable">f</span></a> <a class="idref" href="Triples.html#x:268"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:269"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:264"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:265"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#v<sub>2</sub>:266"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="Triples.html#s:264"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#x:268"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#v<sub>2</sub>:266"><span class="id" title="variable">v<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#f:267"><span class="id" title="variable">f</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:265"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:269"><span class="id" title="variable">t<sub>1</sub></span></a>))<br/>
| <a id="step_if" class="idref" href="#step_if"><span class="id" title="constructor">step_if</span></a> : <span class="id" title="keyword">∀</span> <a id="s:270" class="idref" href="#s:270"><span class="id" title="binder">s</span></a> <a id="b:271" class="idref" href="#b:271"><span class="id" title="binder">b</span></a> <a id="t<sub>1</sub>:272" class="idref" href="#t<sub>1</sub>:272"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:273" class="idref" href="#t<sub>2</sub>:273"><span class="id" title="binder">t<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:270"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_if"><span class="id" title="constructor">trm_if</span></a> (<a class="idref" href="LibSepReference.html#val_bool"><span class="id" title="constructor">val_bool</span></a> <a class="idref" href="Triples.html#b:271"><span class="id" title="variable">b</span></a>) <a class="idref" href="Triples.html#t<sub>1</sub>:272"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:273"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#s:270"><span class="id" title="variable">s</span></a> (<span class="id" title="keyword">if</span> <a class="idref" href="Triples.html#b:271"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Triples.html#t<sub>1</sub>:272"><span class="id" title="variable">t<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Triples.html#t<sub>2</sub>:273"><span class="id" title="variable">t<sub>2</sub></span></a>)<br/>
| <a id="step_seq" class="idref" href="#step_seq"><span class="id" title="constructor">step_seq</span></a> : <span class="id" title="keyword">∀</span> <a id="s:274" class="idref" href="#s:274"><span class="id" title="binder">s</span></a> <a id="t<sub>2</sub>:275" class="idref" href="#t<sub>2</sub>:275"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="v<sub>1</sub>:276" class="idref" href="#v<sub>1</sub>:276"><span class="id" title="binder">v<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:274"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_seq"><span class="id" title="constructor">trm_seq</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:276"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:275"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#s:274"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:275"><span class="id" title="variable">t<sub>2</sub></span></a><br/>
| <a id="step_let" class="idref" href="#step_let"><span class="id" title="constructor">step_let</span></a> : <span class="id" title="keyword">∀</span> <a id="s:277" class="idref" href="#s:277"><span class="id" title="binder">s</span></a> <a id="x:278" class="idref" href="#x:278"><span class="id" title="binder">x</span></a> <a id="t<sub>2</sub>:279" class="idref" href="#t<sub>2</sub>:279"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="v<sub>1</sub>:280" class="idref" href="#v<sub>1</sub>:280"><span class="id" title="binder">v<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:277"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Triples.html#x:278"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:280"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:279"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#s:277"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#x:278"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:280"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:279"><span class="id" title="variable">t<sub>2</sub></span></a>)<br/>
<br/>
<span class="comment">(*&nbsp;Primitive&nbsp;operations&nbsp;*)</span><br/>
| <a id="step_add" class="idref" href="#step_add"><span class="id" title="constructor">step_add</span></a> : <span class="id" title="keyword">∀</span> <a id="s:281" class="idref" href="#s:281"><span class="id" title="binder">s</span></a> <a id="n<sub>1</sub>:282" class="idref" href="#n<sub>1</sub>:282"><span class="id" title="binder">n<sub>1</sub></span></a> <a id="n<sub>2</sub>:283" class="idref" href="#n<sub>2</sub>:283"><span class="id" title="binder">n<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:281"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_add"><span class="id" title="constructor">val_add</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n<sub>1</sub>:282"><span class="id" title="variable">n<sub>1</sub></span></a>) (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n<sub>2</sub>:283"><span class="id" title="variable">n<sub>2</sub></span></a>)) <a class="idref" href="Triples.html#s:281"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> (<a class="idref" href="Triples.html#n<sub>1</sub>:282"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="Triples.html#n<sub>2</sub>:283"><span class="id" title="variable">n<sub>2</sub></span></a>))<br/>
| <a id="step_div" class="idref" href="#step_div"><span class="id" title="constructor">step_div</span></a> : <span class="id" title="keyword">∀</span> <a id="s:284" class="idref" href="#s:284"><span class="id" title="binder">s</span></a> <a id="n<sub>1</sub>:285" class="idref" href="#n<sub>1</sub>:285"><span class="id" title="binder">n<sub>1</sub></span></a> <a id="n<sub>2</sub>:286" class="idref" href="#n<sub>2</sub>:286"><span class="id" title="binder">n<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#n<sub>2</sub>:286"><span class="id" title="variable">n<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> 0 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:284"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_div"><span class="id" title="constructor">val_div</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n<sub>1</sub>:285"><span class="id" title="variable">n<sub>1</sub></span></a>) (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n<sub>2</sub>:286"><span class="id" title="variable">n<sub>2</sub></span></a>)) <a class="idref" href="Triples.html#s:284"><span class="id" title="variable">s</span></a> (<a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#Z.quot"><span class="id" title="definition">Z.quot</span></a> <a class="idref" href="Triples.html#n<sub>1</sub>:285"><span class="id" title="variable">n<sub>1</sub></span></a> <a class="idref" href="Triples.html#n<sub>2</sub>:286"><span class="id" title="variable">n<sub>2</sub></span></a>)<br/>
| <a id="step_rand" class="idref" href="#step_rand"><span class="id" title="constructor">step_rand</span></a> : <span class="id" title="keyword">∀</span> <a id="s:287" class="idref" href="#s:287"><span class="id" title="binder">s</span></a> <a id="n:288" class="idref" href="#n:288"><span class="id" title="binder">n</span></a> <a id="n<sub>1</sub>:289" class="idref" href="#n<sub>1</sub>:289"><span class="id" title="binder">n<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 <span class="id" title="notation">≤</span> <a class="idref" href="Triples.html#n<sub>1</sub>:289"><span class="id" title="variable">n<sub>1</sub></span></a> <span class="id" title="notation">&lt;</span> <a class="idref" href="Triples.html#n:288"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:287"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_rand"><span class="id" title="constructor">val_rand</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n:288"><span class="id" title="variable">n</span></a>)) <a class="idref" href="Triples.html#s:287"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_int"><span class="id" title="constructor">val_int</span></a> <a class="idref" href="Triples.html#n<sub>1</sub>:289"><span class="id" title="variable">n<sub>1</sub></span></a>)<br/>
| <a id="step_ref" class="idref" href="#step_ref"><span class="id" title="constructor">step_ref</span></a> : <span class="id" title="keyword">∀</span> <a id="s:290" class="idref" href="#s:290"><span class="id" title="binder">s</span></a> <a id="v:291" class="idref" href="#v:291"><span class="id" title="binder">v</span></a> <a id="p:292" class="idref" href="#p:292"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Triples.html#s:290"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:292"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:290"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_ref"><span class="id" title="constructor">val_ref</span></a> <a class="idref" href="Triples.html#v:291"><span class="id" title="variable">v</span></a>) (<a class="idref" href="LibSepReference.html#Fmap.update"><span class="id" title="definition">Fmap.update</span></a> <a class="idref" href="Triples.html#s:290"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:292"><span class="id" title="variable">p</span></a> <a class="idref" href="Triples.html#v:291"><span class="id" title="variable">v</span></a>) (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Triples.html#p:292"><span class="id" title="variable">p</span></a>)<br/>
| <a id="step_get" class="idref" href="#step_get"><span class="id" title="constructor">step_get</span></a> : <span class="id" title="keyword">∀</span> <a id="s:293" class="idref" href="#s:293"><span class="id" title="binder">s</span></a> <a id="p:294" class="idref" href="#p:294"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Triples.html#s:293"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:294"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:293"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_get"><span class="id" title="constructor">val_get</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Triples.html#p:294"><span class="id" title="variable">p</span></a>)) <a class="idref" href="Triples.html#s:293"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#Fmap.read"><span class="id" title="definition">Fmap.read</span></a> <a class="idref" href="Triples.html#s:293"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:294"><span class="id" title="variable">p</span></a>)<br/>
| <a id="step_set" class="idref" href="#step_set"><span class="id" title="constructor">step_set</span></a> : <span class="id" title="keyword">∀</span> <a id="s:295" class="idref" href="#s:295"><span class="id" title="binder">s</span></a> <a id="p:296" class="idref" href="#p:296"><span class="id" title="binder">p</span></a> <a id="v:297" class="idref" href="#v:297"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Triples.html#s:295"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:296"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:295"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_set"><span class="id" title="constructor">val_set</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Triples.html#p:296"><span class="id" title="variable">p</span></a>) <a class="idref" href="Triples.html#v:297"><span class="id" title="variable">v</span></a>) (<a class="idref" href="LibSepReference.html#Fmap.update"><span class="id" title="definition">Fmap.update</span></a> <a class="idref" href="Triples.html#s:295"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:296"><span class="id" title="variable">p</span></a> <a class="idref" href="Triples.html#v:297"><span class="id" title="variable">v</span></a>) <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a><br/>
| <a id="step_free" class="idref" href="#step_free"><span class="id" title="constructor">step_free</span></a> : <span class="id" title="keyword">∀</span> <a id="s:298" class="idref" href="#s:298"><span class="id" title="binder">s</span></a> <a id="p:299" class="idref" href="#p:299"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.indom"><span class="id" title="definition">Fmap.indom</span></a> <a class="idref" href="Triples.html#s:298"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:299"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step:239"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:298"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#val_free"><span class="id" title="constructor">val_free</span></a> (<a class="idref" href="LibSepReference.html#val_loc"><span class="id" title="constructor">val_loc</span></a> <a class="idref" href="Triples.html#p:299"><span class="id" title="variable">p</span></a>)) (<a class="idref" href="LibSepReference.html#Fmap.remove"><span class="id" title="definition">Fmap.remove</span></a> <a class="idref" href="Triples.html#s:298"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#p:299"><span class="id" title="variable">p</span></a>) <a class="idref" href="LibSepReference.html#val_unit"><span class="id" title="constructor">val_unit</span></a>.<br/>
</div>

<div class="doc">
The judgment <span class="inlinecode"><span class="id" title="var">steps</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode"><span class="id" title="var">t'</span></span> corresponds to the reflexive and transitive
    closure of <span class="inlinecode"><span class="id" title="var">step</span></span>. Concretely, it asserts that the configuration <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> can
    reduce in zero, one, or several steps to <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">t'</span>)</span>. 
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="steps" class="idref" href="#steps"><span class="id" title="inductive">steps</span></a> : <a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="steps_refl" class="idref" href="#steps_refl"><span class="id" title="constructor">steps_refl</span></a> : <span class="id" title="keyword">∀</span> <a id="s:302" class="idref" href="#s:302"><span class="id" title="binder">s</span></a> <a id="t:303" class="idref" href="#t:303"><span class="id" title="binder">t</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#steps:300"><span class="id" title="inductive">steps</span></a> <a class="idref" href="Triples.html#s:302"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:303"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#s:302"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:303"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;| <a id="steps_step" class="idref" href="#steps_step"><span class="id" title="constructor">steps_step</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:304" class="idref" href="#s<sub>1</sub>:304"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:305" class="idref" href="#s<sub>2</sub>:305"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="s<sub>3</sub>:306" class="idref" href="#s<sub>3</sub>:306"><span class="id" title="binder">s<sub>3</sub></span></a> <a id="t<sub>1</sub>:307" class="idref" href="#t<sub>1</sub>:307"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:308" class="idref" href="#t<sub>2</sub>:308"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="t<sub>3</sub>:309" class="idref" href="#t<sub>3</sub>:309"><span class="id" title="binder">t<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:304"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:307"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#s<sub>2</sub>:305"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:308"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#steps:300"><span class="id" title="inductive">steps</span></a> <a class="idref" href="Triples.html#s<sub>2</sub>:305"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:308"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="Triples.html#s<sub>3</sub>:306"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="Triples.html#t<sub>3</sub>:309"><span class="id" title="variable">t<sub>3</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#steps:300"><span class="id" title="inductive">steps</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:304"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:307"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#s<sub>3</sub>:306"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="Triples.html#t<sub>3</sub>:309"><span class="id" title="variable">t<sub>3</sub></span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="steps_of_step" class="idref" href="#steps_of_step"><span class="id" title="lemma">steps_of_step</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:310" class="idref" href="#s<sub>1</sub>:310"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:311" class="idref" href="#s<sub>2</sub>:311"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="t<sub>1</sub>:312" class="idref" href="#t<sub>1</sub>:312"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:313" class="idref" href="#t<sub>2</sub>:313"><span class="id" title="binder">t<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:310"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:312"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#s<sub>2</sub>:311"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:313"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#steps"><span class="id" title="inductive">steps</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:310"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:312"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#s<sub>2</sub>:311"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:313"><span class="id" title="variable">t<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#steps_step"><span class="id" title="constructor">steps_step</span></a> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#steps_refl"><span class="id" title="constructor">steps_refl</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="steps_trans" class="idref" href="#steps_trans"><span class="id" title="lemma">steps_trans</span></a> : <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:314" class="idref" href="#s<sub>1</sub>:314"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:315" class="idref" href="#s<sub>2</sub>:315"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="s<sub>3</sub>:316" class="idref" href="#s<sub>3</sub>:316"><span class="id" title="binder">s<sub>3</sub></span></a> <a id="t<sub>1</sub>:317" class="idref" href="#t<sub>1</sub>:317"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:318" class="idref" href="#t<sub>2</sub>:318"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="t<sub>3</sub>:319" class="idref" href="#t<sub>3</sub>:319"><span class="id" title="binder">t<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#steps"><span class="id" title="inductive">steps</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:314"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:317"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#s<sub>2</sub>:315"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:318"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#steps"><span class="id" title="inductive">steps</span></a> <a class="idref" href="Triples.html#s<sub>2</sub>:315"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:318"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="Triples.html#s<sub>3</sub>:316"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="Triples.html#t<sub>3</sub>:319"><span class="id" title="variable">t<sub>3</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#steps"><span class="id" title="inductive">steps</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:314"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:317"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#s<sub>3</sub>:316"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="Triples.html#t<sub>3</sub>:319"><span class="id" title="variable">t<sub>3</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M<sub>1</sub></span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">M<sub>1</sub></span>; <span class="id" title="var">introv</span> <span class="id" title="var">M<sub>2</sub></span>. { <span class="id" title="tactic">auto</span>. } { <span class="id" title="var">constructors</span>*. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The predicate <span class="inlinecode"><span class="id" title="var">trm_is_val</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> asserts that <span class="inlinecode"><span class="id" title="var">t</span></span> is a value. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="trm_is_val" class="idref" href="#trm_is_val"><span class="id" title="definition">trm_is_val</span></a> (<a id="t:320" class="idref" href="#t:320"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Triples.html#t:320"><span class="id" title="variable">t</span></a> <span class="id" title="keyword">with</span> <a class="idref" href="LibSepReference.html#trm_val"><span class="id" title="constructor">trm_val</span></a> <span class="id" title="var">v</span> ⇒ <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a> | <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a> <span class="id" title="keyword">end</span>.<br/>
</div>

<div class="doc">
Consider a configuration <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span>, where <span class="inlinecode"><span class="id" title="var">t</span></span> is not a value. If this
    configuration cannot take any reduction step, it is said to be <i>stuck</i>.
    Conversely, a configuration <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> that can take a step is said to be
    <i>reducible</i>. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="reducible" class="idref" href="#reducible"><span class="id" title="definition">reducible</span></a> (<a id="s:322" class="idref" href="#s:322"><span class="id" title="binder">s</span></a>:<a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a>) (<a id="t:323" class="idref" href="#t:323"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="s':324" class="idref" href="#s':324"><span class="id" title="binder">s'</span></a> <a id="t':325" class="idref" href="#t':325"><span class="id" title="binder">t'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="Triples.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:322"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:323"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#s':324"><span class="id" title="variable">s'</span></a> <a class="idref" href="Triples.html#t':325"><span class="id" title="variable">t'</span></a>.<br/>
</div>

<div class="doc">
Values are not reducible. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="reducible_val_inv" class="idref" href="#reducible_val_inv"><span class="id" title="lemma">reducible_val_inv</span></a> : <span class="id" title="keyword">∀</span> <a id="s:326" class="idref" href="#s:326"><span class="id" title="binder">s</span></a> <a id="v:327" class="idref" href="#v:327"><span class="id" title="binder">v</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="Triples.html#reducible"><span class="id" title="definition">reducible</span></a> <a class="idref" href="Triples.html#s:326"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#v:327"><span class="id" title="variable">v</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> (<span class="id" title="var">s'</span>&amp;<span class="id" title="var">t'</span>&amp;<span class="id" title="var">M</span>). <span class="id" title="var">inverts</span> <span class="id" title="var">M</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The predicate <span class="inlinecode"><span class="id" title="var">notstuck</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> asserts that either <span class="inlinecode"><span class="id" title="var">t</span></span> is a value or <span class="inlinecode"><span class="id" title="var">t</span></span> is
    reducible. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="notstuck" class="idref" href="#notstuck"><span class="id" title="definition">notstuck</span></a> (<a id="s:328" class="idref" href="#s:328"><span class="id" title="binder">s</span></a>:<a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a>) (<a id="t:329" class="idref" href="#t:329"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#trm_is_val"><span class="id" title="definition">trm_is_val</span></a> <a class="idref" href="Triples.html#t:329"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#f031fe1957c4a4a8e217aa46af2b4e<sub>25</sub>"><span class="id" title="notation">∨</span></a> <a class="idref" href="Triples.html#reducible"><span class="id" title="definition">reducible</span></a> <a class="idref" href="Triples.html#s:328"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:329"><span class="id" title="variable">t</span></a>.<br/>
</div>

<div class="doc">
<a id="lab182"></a><h2 class="section">Equivalence Between Small-Step and Omni-Big-Step</h2>

<div class="paragraph"> </div>

 If we consider the omni-big-step semantics to be the starting point of a
    development, then the definition of <span class="inlinecode"><span class="id" title="var">triple</span></span> is obviously sound with respect
    to that semantics, as it concludes <span class="inlinecode"><span class="id" title="tactic">eval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>. If, however, we consider
    the small-step semantics to be the starting point, then to establish
    soundness it is required to prove that <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> ensures that all
    possible evaluations of <span class="inlinecode"><span class="id" title="var">t</span></span> in a heap satisfying <span class="inlinecode"><span class="id" title="var">H</span></span> are: (1) terminating,
    and (2) guaranteed to reach a value; moreover, (3) this value and the final
    state obtained must satisfy the postconditon <span class="inlinecode"><span class="id" title="var">Q</span></span>. We begin by formalizing
    each of these properties. 
<div class="paragraph"> </div>

 The judgment <span class="inlinecode"><span class="id" title="var">terminates</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> is defined inductively. The execution starting
    from <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> terminates if any possible step leads to a configuration that
    terminates. Note that a configuration that has reached a value cannot take a
    step, hence is considered terminating. 
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="terminates" class="idref" href="#terminates"><span class="id" title="inductive">terminates</span></a> : <a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="terminates_step" class="idref" href="#terminates_step"><span class="id" title="constructor">terminates_step</span></a> : <span class="id" title="keyword">∀</span> <a id="s:332" class="idref" href="#s:332"><span class="id" title="binder">s</span></a> <a id="t:333" class="idref" href="#t:333"><span class="id" title="binder">t</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="s':334" class="idref" href="#s':334"><span class="id" title="binder">s'</span></a> <a id="t':335" class="idref" href="#t':335"><span class="id" title="binder">t'</span></a>, <a class="idref" href="Triples.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:332"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:333"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#s':334"><span class="id" title="variable">s'</span></a> <a class="idref" href="Triples.html#t':335"><span class="id" title="variable">t'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#terminates:330"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Triples.html#s':334"><span class="id" title="variable">s'</span></a> <a class="idref" href="Triples.html#t':335"><span class="id" title="variable">t'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#terminates:330"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Triples.html#s:332"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:333"><span class="id" title="variable">t</span></a>.<br/>
</div>

<div class="doc">
The judgment <span class="inlinecode"><span class="id" title="var">safe</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> asserts that no execution may reach a stuck term. In
    other words, for any configuration <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">t'</span>)</span> reachable from <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span>, it is
    the case that the configuration <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">t'</span>)</span> is either a value or is reducible.
    
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="safe" class="idref" href="#safe"><span class="id" title="definition">safe</span></a> (<a id="s:336" class="idref" href="#s:336"><span class="id" title="binder">s</span></a>:<a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a>) (<a id="t:337" class="idref" href="#t:337"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="s':338" class="idref" href="#s':338"><span class="id" title="binder">s'</span></a> <a id="t':339" class="idref" href="#t':339"><span class="id" title="binder">t'</span></a>, <a class="idref" href="Triples.html#steps"><span class="id" title="inductive">steps</span></a> <a class="idref" href="Triples.html#s:336"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:337"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#s':338"><span class="id" title="variable">s'</span></a> <a class="idref" href="Triples.html#t':339"><span class="id" title="variable">t'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#notstuck"><span class="id" title="definition">notstuck</span></a> <a class="idref" href="Triples.html#s':338"><span class="id" title="variable">s'</span></a> <a class="idref" href="Triples.html#t':339"><span class="id" title="variable">t'</span></a>.<br/>
</div>

<div class="doc">
The judgment <span class="inlinecode"><span class="id" title="var">correct</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> asserts that if the execution of <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span>
    reaches a final configuration, then this final configuration satisfies <span class="inlinecode"><span class="id" title="var">Q</span></span>.
    
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="correct" class="idref" href="#correct"><span class="id" title="definition">correct</span></a> (<a id="s:340" class="idref" href="#s:340"><span class="id" title="binder">s</span></a>:<a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a>) (<a id="t:341" class="idref" href="#t:341"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) (<a id="Q:342" class="idref" href="#Q:342"><span class="id" title="binder">Q</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="s':343" class="idref" href="#s':343"><span class="id" title="binder">s'</span></a> <a id="v:344" class="idref" href="#v:344"><span class="id" title="binder">v</span></a>, <a class="idref" href="Triples.html#steps"><span class="id" title="inductive">steps</span></a> <a class="idref" href="Triples.html#s:340"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:341"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#s':343"><span class="id" title="variable">s'</span></a> <a class="idref" href="Triples.html#v:344"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#Q:342"><span class="id" title="variable">Q</span></a> <a class="idref" href="Triples.html#v:344"><span class="id" title="variable">v</span></a> <a class="idref" href="Triples.html#s':343"><span class="id" title="variable">s'</span></a>.<br/>
</div>

<div class="doc">
The conjunction of <span class="inlinecode"><span class="id" title="var">safe</span></span> and <span class="inlinecode"><span class="id" title="var">correct</span></span> corresponds to "partial
    correctness". The conjunction of <span class="inlinecode"><span class="id" title="var">safe</span></span>, <span class="inlinecode"><span class="id" title="var">correct</span></span> and <span class="inlinecode"><span class="id" title="var">terminates</span></span>
    corresponds to "total correctness". The soundness theorem that we aim for
    establishes that <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> entails total correctness.
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">triple</span> <span class="id" title="var">t</span> <span class="id" title="var">H</span> <span class="id" title="var">Q</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">s</span>, <span class="id" title="var">H</span> <span class="id" title="var">s</span> → <span class="id" title="var">terminates</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span> ∧ <span class="id" title="var">safe</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span> ∧ <span class="id" title="var">correct</span> <span class="id" title="var">s</span> <span class="id" title="var">t</span> <span class="id" title="var">Q</span>.
</span>
<div class="paragraph"> </div>

    To prove soundness, we introduce an inductively predicate, named <span class="inlinecode"><span class="id" title="var">seval</span></span>,
    which captures total correctness in small-step style. On the one hand, we
    prove that <span class="inlinecode"><span class="id" title="var">seval</span></span> entails <span class="inlinecode"><span class="id" title="var">safe</span></span>, <span class="inlinecode"><span class="id" title="var">correct</span></span>, and <span class="inlinecode"><span class="id" title="var">terminates</span></span>. On the other
    hand, we prove that <span class="inlinecode"><span class="id" title="var">seval</span></span> is related to the omni-big-step judgment,
    <span class="inlinecode"><span class="id" title="tactic">eval</span></span>.

<div class="paragraph"> </div>

    The judgment <span class="inlinecode"><span class="id" title="var">seval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> asserts that any execution of <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> terminates
    and reaches a configuration satisfying <span class="inlinecode"><span class="id" title="var">Q</span></span>. In the "base" case,
    <span class="inlinecode"><span class="id" title="var">seval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> holds if the terminal configuration <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">v</span>)</span> satisfies <span class="inlinecode"><span class="id" title="var">Q</span></span>. In
    the "step" case, <span class="inlinecode"><span class="id" title="var">seval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> holds if (1) the configuration <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> is
    reducible, and (2) if for any step that <span class="inlinecode">(<span class="id" title="var">s</span>,<span class="id" title="var">t</span>)</span> may take to <span class="inlinecode">(<span class="id" title="var">s'</span>,<span class="id" title="var">t'</span>)</span>, the
    predicate <span class="inlinecode"><span class="id" title="var">seval</span></span> <span class="inlinecode"><span class="id" title="var">s'</span></span> <span class="inlinecode"><span class="id" title="var">t'</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> holds. 
</div>
<div class="code">

<span class="id" title="keyword">Inductive</span> <a id="seval" class="idref" href="#seval"><span class="id" title="inductive">seval</span></a> : <a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation"><span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>(</span></a><a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span></span></a><span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="seval_val" class="idref" href="#seval_val"><span class="id" title="constructor">seval_val</span></a> : <span class="id" title="keyword">∀</span> <a id="s:347" class="idref" href="#s:347"><span class="id" title="binder">s</span></a> <a id="v:348" class="idref" href="#v:348"><span class="id" title="binder">v</span></a> <a id="Q:349" class="idref" href="#Q:349"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#Q:349"><span class="id" title="variable">Q</span></a> <a class="idref" href="Triples.html#v:348"><span class="id" title="variable">v</span></a> <a class="idref" href="Triples.html#s:347"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#seval:345"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:347"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#v:348"><span class="id" title="variable">v</span></a> <a class="idref" href="Triples.html#Q:349"><span class="id" title="variable">Q</span></a><br/>
&nbsp;&nbsp;| <a id="seval_step" class="idref" href="#seval_step"><span class="id" title="constructor">seval_step</span></a> : <span class="id" title="keyword">∀</span> <a id="s:350" class="idref" href="#s:350"><span class="id" title="binder">s</span></a> <a id="t:351" class="idref" href="#t:351"><span class="id" title="binder">t</span></a> <a id="Q:352" class="idref" href="#Q:352"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#reducible"><span class="id" title="definition">reducible</span></a> <a class="idref" href="Triples.html#s:350"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:351"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="comment">(*&nbsp;(exists&nbsp;s'&nbsp;t',&nbsp;step&nbsp;s&nbsp;t&nbsp;s'&nbsp;t')&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="s':353" class="idref" href="#s':353"><span class="id" title="binder">s'</span></a> <a id="t':354" class="idref" href="#t':354"><span class="id" title="binder">t'</span></a>, <a class="idref" href="Triples.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="Triples.html#s:350"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:351"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#s':353"><span class="id" title="variable">s'</span></a> <a class="idref" href="Triples.html#t':354"><span class="id" title="variable">t'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#seval:345"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s':353"><span class="id" title="variable">s'</span></a> <a class="idref" href="Triples.html#t':354"><span class="id" title="variable">t'</span></a> <a class="idref" href="Triples.html#Q:352"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Triples.html#seval:345"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:350"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:351"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q:352"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
<a id="lab183"></a><h4 class="section">Exercise: 2 stars, standard, optional (seval_val_inv)</h4>
 As a warm-up to get some familiary with <span class="inlinecode"><span class="id" title="var">seval</span></span>, prove the following
    inversion lemma, which asserts that, given a value <span class="inlinecode"><span class="id" title="var">v</span></span>, the property
    <span class="inlinecode"><span class="id" title="var">seval</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> implies <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="seval_val_inv" class="idref" href="#seval_val_inv"><span class="id" title="lemma">seval_val_inv</span></a> : <span class="id" title="keyword">∀</span> <a id="s:355" class="idref" href="#s:355"><span class="id" title="binder">s</span></a> <a id="v:356" class="idref" href="#v:356"><span class="id" title="binder">v</span></a> <a id="Q:357" class="idref" href="#Q:357"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:355"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#v:356"><span class="id" title="variable">v</span></a> <a class="idref" href="Triples.html#Q:357"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#Q:357"><span class="id" title="variable">Q</span></a> <a class="idref" href="Triples.html#v:356"><span class="id" title="variable">v</span></a> <a class="idref" href="Triples.html#s:355"><span class="id" title="variable">s</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 We begin with the three key properties of <span class="inlinecode"><span class="id" title="var">seval</span></span>: termination, safety, and
    correctness. 
<div class="paragraph"> </div>

<a id="lab184"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (seval_terminates)</h4>
 Prove that <span class="inlinecode"><span class="id" title="var">seval</span></span> captures termination. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="seval_terminates" class="idref" href="#seval_terminates"><span class="id" title="lemma">seval_terminates</span></a> : <span class="id" title="keyword">∀</span> <a id="s:358" class="idref" href="#s:358"><span class="id" title="binder">s</span></a> <a id="t:359" class="idref" href="#t:359"><span class="id" title="binder">t</span></a> <a id="Q:360" class="idref" href="#Q:360"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:358"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:359"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q:360"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#terminates"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Triples.html#s:358"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:359"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab185"></a><h4 class="section">Exercise: 3 stars, standard, especially useful (seval_safe)</h4>
 Prove that <span class="inlinecode"><span class="id" title="var">seval</span></span> captures safety. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="seval_safe" class="idref" href="#seval_safe"><span class="id" title="lemma">seval_safe</span></a> : <span class="id" title="keyword">∀</span> <a id="s:361" class="idref" href="#s:361"><span class="id" title="binder">s</span></a> <a id="t:362" class="idref" href="#t:362"><span class="id" title="binder">t</span></a> <a id="Q:363" class="idref" href="#Q:363"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:361"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:362"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q:363"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#safe"><span class="id" title="definition">safe</span></a> <a class="idref" href="Triples.html#s:361"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:362"><span class="id" title="variable">t</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab186"></a><h4 class="section">Exercise: 3 stars, standard, especially useful (seval_correct)</h4>
 Prove that <span class="inlinecode"><span class="id" title="var">seval</span></span> captures correctness. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="seval_correct" class="idref" href="#seval_correct"><span class="id" title="lemma">seval_correct</span></a> : <span class="id" title="keyword">∀</span> <a id="s:364" class="idref" href="#s:364"><span class="id" title="binder">s</span></a> <a id="t:365" class="idref" href="#t:365"><span class="id" title="binder">t</span></a> <a id="Q:366" class="idref" href="#Q:366"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:364"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:365"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q:366"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#correct"><span class="id" title="definition">correct</span></a> <a class="idref" href="Triples.html#s:364"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:365"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q:366"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 We can group the three results into a soundness theorem for <span class="inlinecode"><span class="id" title="var">seval</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="seval_sound" class="idref" href="#seval_sound"><span class="id" title="lemma">seval_sound</span></a> : <span class="id" title="keyword">∀</span> <a id="s:367" class="idref" href="#s:367"><span class="id" title="binder">s</span></a> <a id="t:368" class="idref" href="#t:368"><span class="id" title="binder">t</span></a> <a id="Q:369" class="idref" href="#Q:369"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:367"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:368"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q:369"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#terminates"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Triples.html#s:367"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:368"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Triples.html#safe"><span class="id" title="definition">safe</span></a> <a class="idref" href="Triples.html#s:367"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:368"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Triples.html#correct"><span class="id" title="definition">correct</span></a> <a class="idref" href="Triples.html#s:367"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:368"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q:369"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">splits</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_terminates"><span class="id" title="axiom">seval_terminates</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_safe"><span class="id" title="axiom">seval_safe</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_correct"><span class="id" title="axiom">seval_correct</span></a>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
We now establish that the omni-big-step evaluation judgment entails the
    small-step-based <span class="inlinecode"><span class="id" title="var">seval</span></span> judgment. The proof is carried out by induction on
    the omni-big-step relation. It relies on a number of auxiliary results
    establishing that, for each term construct, the <span class="inlinecode"><span class="id" title="var">seval</span></span> judgment admits an
    evaluation rule that mimics the omni-big-step evaluation rule. We begin with
    the statements of the auxiliary lemmas. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="seval_fun" class="idref" href="#seval_fun"><span class="id" title="lemma">seval_fun</span></a> : <span class="id" title="keyword">∀</span> <a id="s:370" class="idref" href="#s:370"><span class="id" title="binder">s</span></a> <a id="x:371" class="idref" href="#x:371"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:372" class="idref" href="#t<sub>1</sub>:372"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="Q:373" class="idref" href="#Q:373"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#Q:373"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_fun"><span class="id" title="constructor">val_fun</span></a> <a class="idref" href="Triples.html#x:371"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:372"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Triples.html#s:370"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:370"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_fun"><span class="id" title="constructor">trm_fun</span></a> <a class="idref" href="Triples.html#x:371"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:372"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Triples.html#Q:373"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_step"><span class="id" title="constructor">seval_step</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="tactic">constructor</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">R</span>. { <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_val"><span class="id" title="constructor">seval_val</span></a>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="seval_fix" class="idref" href="#seval_fix"><span class="id" title="lemma">seval_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s:374" class="idref" href="#s:374"><span class="id" title="binder">s</span></a> <a id="f:375" class="idref" href="#f:375"><span class="id" title="binder">f</span></a> <a id="x:376" class="idref" href="#x:376"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:377" class="idref" href="#t<sub>1</sub>:377"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="Q:378" class="idref" href="#Q:378"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#Q:378"><span class="id" title="variable">Q</span></a> (<a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Triples.html#f:375"><span class="id" title="variable">f</span></a> <a class="idref" href="Triples.html#x:376"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:377"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Triples.html#s:374"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:374"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_fix"><span class="id" title="constructor">trm_fix</span></a> <a class="idref" href="Triples.html#f:375"><span class="id" title="variable">f</span></a> <a class="idref" href="Triples.html#x:376"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:377"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Triples.html#Q:378"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_step"><span class="id" title="constructor">seval_step</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="tactic">constructor</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">R</span>. { <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_val"><span class="id" title="constructor">seval_val</span></a>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="seval_app_fun" class="idref" href="#seval_app_fun"><span class="id" title="lemma">seval_app_fun</span></a> : <span class="id" title="keyword">∀</span> <a id="s:379" class="idref" href="#s:379"><span class="id" title="binder">s</span></a> <a id="x:380" class="idref" href="#x:380"><span class="id" title="binder">x</span></a> <a id="v<sub>1</sub>:381" class="idref" href="#v<sub>1</sub>:381"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:382" class="idref" href="#v<sub>2</sub>:382"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="t<sub>1</sub>:383" class="idref" href="#t<sub>1</sub>:383"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="Q:384" class="idref" href="#Q:384"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#v<sub>1</sub>:381"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fun"><span class="id" title="constructor">val_fun</span></a> <a class="idref" href="Triples.html#x:380"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:383"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:379"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#x:380"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#v<sub>2</sub>:382"><span class="id" title="variable">v<sub>2</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:383"><span class="id" title="variable">t<sub>1</sub></span></a>) <a class="idref" href="Triples.html#Q:384"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:379"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:381"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#v<sub>2</sub>:382"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="Triples.html#Q:384"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">E</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_step"><span class="id" title="constructor">seval_step</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#step_app_fun"><span class="id" title="constructor">step_app_fun</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">invert</span> <span class="id" title="var">R</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">intros</span>; <span class="id" title="var">false</span>]. <span class="id" title="var">introv</span> → → → → → <span class="id" title="var">R</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">E</span>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="seval_app_fix" class="idref" href="#seval_app_fix"><span class="id" title="lemma">seval_app_fix</span></a> : <span class="id" title="keyword">∀</span> <a id="s:385" class="idref" href="#s:385"><span class="id" title="binder">s</span></a> <a id="f:386" class="idref" href="#f:386"><span class="id" title="binder">f</span></a> <a id="x:387" class="idref" href="#x:387"><span class="id" title="binder">x</span></a> <a id="v<sub>1</sub>:388" class="idref" href="#v<sub>1</sub>:388"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:389" class="idref" href="#v<sub>2</sub>:389"><span class="id" title="binder">v<sub>2</sub></span></a> <a id="t<sub>1</sub>:390" class="idref" href="#t<sub>1</sub>:390"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="Q:391" class="idref" href="#Q:391"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#v<sub>1</sub>:388"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="LibSepReference.html#val_fix"><span class="id" title="constructor">val_fix</span></a> <a class="idref" href="Triples.html#f:386"><span class="id" title="variable">f</span></a> <a class="idref" href="Triples.html#x:387"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:390"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:385"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#x:387"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#v<sub>2</sub>:389"><span class="id" title="variable">v<sub>2</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#f:386"><span class="id" title="variable">f</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:388"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:390"><span class="id" title="variable">t<sub>1</sub></span></a>)) <a class="idref" href="Triples.html#Q:391"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:385"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_app"><span class="id" title="constructor">trm_app</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:388"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#v<sub>2</sub>:389"><span class="id" title="variable">v<sub>2</sub></span></a>) <a class="idref" href="Triples.html#Q:391"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">E</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_step"><span class="id" title="constructor">seval_step</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#step_app_fix"><span class="id" title="constructor">step_app_fix</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">invert</span> <span class="id" title="var">R</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [<span class="id" title="tactic">intros</span>; <span class="id" title="var">false</span>]. <span class="id" title="var">introv</span> → → → → → <span class="id" title="var">R</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">E</span>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab187"></a><h4 class="section">Exercise: 5 stars, standard, especially useful (seval_seq)</h4>
 Prove the big-step reasoning rule for sequence for <span class="inlinecode"><span class="id" title="var">seval</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="seval_seq" class="idref" href="#seval_seq"><span class="id" title="lemma">seval_seq</span></a> : <span class="id" title="keyword">∀</span> <a id="s:392" class="idref" href="#s:392"><span class="id" title="binder">s</span></a> <a id="t<sub>1</sub>:393" class="idref" href="#t<sub>1</sub>:393"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:394" class="idref" href="#t<sub>2</sub>:394"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="Q<sub>1</sub>:395" class="idref" href="#Q<sub>1</sub>:395"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q:396" class="idref" href="#Q:396"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:392"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:393"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#Q<sub>1</sub>:395"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:397" class="idref" href="#s<sub>1</sub>:397"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="v<sub>1</sub>:398" class="idref" href="#v<sub>1</sub>:398"><span class="id" title="binder">v<sub>1</sub></span></a>, <a class="idref" href="Triples.html#Q<sub>1</sub>:395"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:398"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:397"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:397"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:394"><span class="id" title="variable">t<sub>2</sub></span></a> <a class="idref" href="Triples.html#Q:396"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:392"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_seq"><span class="id" title="constructor">trm_seq</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:393"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:394"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#Q:396"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab188"></a><h4 class="section">Exercise: 5 stars, standard, optional (seval_let)</h4>
 The proof of <span class="inlinecode"><span class="id" title="var">seval_let</span></span> is the same as that of <span class="inlinecode"><span class="id" title="var">seval_seq</span></span>. We also present
    it as an exercise to avoid giving away the solution. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="seval_let" class="idref" href="#seval_let"><span class="id" title="lemma">seval_let</span></a> : <span class="id" title="keyword">∀</span> <a id="s:399" class="idref" href="#s:399"><span class="id" title="binder">s</span></a> <a id="x:400" class="idref" href="#x:400"><span class="id" title="binder">x</span></a> <a id="t<sub>1</sub>:401" class="idref" href="#t<sub>1</sub>:401"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:402" class="idref" href="#t<sub>2</sub>:402"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="Q<sub>1</sub>:403" class="idref" href="#Q<sub>1</sub>:403"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q:404" class="idref" href="#Q:404"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:399"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:401"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#Q<sub>1</sub>:403"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:405" class="idref" href="#s<sub>1</sub>:405"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="v<sub>1</sub>:406" class="idref" href="#v<sub>1</sub>:406"><span class="id" title="binder">v<sub>1</sub></span></a>, <a class="idref" href="Triples.html#Q<sub>1</sub>:403"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:406"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:405"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>:405"><span class="id" title="variable">s<sub>1</sub></span></a> (<a class="idref" href="LibSepReference.html#subst"><span class="id" title="definition">subst</span></a> <a class="idref" href="Triples.html#x:400"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#v<sub>1</sub>:406"><span class="id" title="variable">v<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:402"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#Q:404"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:399"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_let"><span class="id" title="constructor">trm_let</span></a> <a class="idref" href="Triples.html#x:400"><span class="id" title="variable">x</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:401"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:402"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#Q:404"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="seval_if" class="idref" href="#seval_if"><span class="id" title="lemma">seval_if</span></a> : <span class="id" title="keyword">∀</span> <a id="s:407" class="idref" href="#s:407"><span class="id" title="binder">s</span></a> <a id="b:408" class="idref" href="#b:408"><span class="id" title="binder">b</span></a> <a id="t<sub>1</sub>:409" class="idref" href="#t<sub>1</sub>:409"><span class="id" title="binder">t<sub>1</sub></span></a> <a id="t<sub>2</sub>:410" class="idref" href="#t<sub>2</sub>:410"><span class="id" title="binder">t<sub>2</sub></span></a> <a id="Q:411" class="idref" href="#Q:411"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:407"><span class="id" title="variable">s</span></a> (<span class="id" title="keyword">if</span> <a class="idref" href="Triples.html#b:408"><span class="id" title="variable">b</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Triples.html#t<sub>1</sub>:409"><span class="id" title="variable">t<sub>1</sub></span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Triples.html#t<sub>2</sub>:410"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#Q:411"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:407"><span class="id" title="variable">s</span></a> (<a class="idref" href="LibSepReference.html#trm_if"><span class="id" title="constructor">trm_if</span></a> <a class="idref" href="Triples.html#b:408"><span class="id" title="variable">b</span></a> <a class="idref" href="Triples.html#t<sub>1</sub>:409"><span class="id" title="variable">t<sub>1</sub></span></a> <a class="idref" href="Triples.html#t<sub>2</sub>:410"><span class="id" title="variable">t<sub>2</sub></span></a>) <a class="idref" href="Triples.html#Q:411"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_step"><span class="id" title="constructor">seval_step</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">constructors</span>*. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">R</span>; <span class="id" title="var">tryfalse</span>. { <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
We are now ready to prove by induction that the omni-big-step judgment
    entails the small-step-based judgment <span class="inlinecode"><span class="id" title="var">seval</span></span>. Note that the reciprocal
    entailment also holds, however it is not needed for establishing soundness.
    
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="seval_of_eval" class="idref" href="#seval_of_eval"><span class="id" title="lemma">seval_of_eval</span></a> : <span class="id" title="keyword">∀</span> <a id="s:412" class="idref" href="#s:412"><span class="id" title="binder">s</span></a> <a id="t:413" class="idref" href="#t:413"><span class="id" title="binder">t</span></a> <a id="Q:414" class="idref" href="#Q:414"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#eval"><span class="id" title="inductive">eval</span></a> <a class="idref" href="Triples.html#s:412"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:413"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q:414"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:412"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:413"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q:414"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_val"><span class="id" title="constructor">seval_val</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_fun"><span class="id" title="lemma">seval_fun</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_fix"><span class="id" title="lemma">seval_fix</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_app_fun"><span class="id" title="lemma">seval_app_fun</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_app_fix"><span class="id" title="lemma">seval_app_fix</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_seq"><span class="id" title="axiom">seval_seq</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_let"><span class="id" title="axiom">seval_let</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_if"><span class="id" title="lemma">seval_if</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_step"><span class="id" title="constructor">seval_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#step_add"><span class="id" title="constructor">step_add</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_val"><span class="id" title="constructor">seval_val</span></a>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_step"><span class="id" title="constructor">seval_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#step_div"><span class="id" title="constructor">step_div</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_val"><span class="id" title="constructor">seval_val</span></a>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_step"><span class="id" title="constructor">seval_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#step_rand"><span class="id" title="constructor">step_rand</span></a> 0. <span class="id" title="var">math</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_val"><span class="id" title="constructor">seval_val</span></a>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_step"><span class="id" title="constructor">seval_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">forwards</span>¬(<span class="id" title="var">p</span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">N</span>): (<a class="idref" href="LibSepFmap.html#exists_fresh"><span class="id" title="lemma">exists_fresh</span></a> <a class="idref" href="LibSepReference.html#null"><span class="id" title="definition">null</span></a> <span class="id" title="var">s</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#step_ref"><span class="id" title="constructor">step_ref</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_val"><span class="id" title="constructor">seval_val</span></a>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_step"><span class="id" title="constructor">seval_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#step_get"><span class="id" title="constructor">step_get</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_val"><span class="id" title="constructor">seval_val</span></a>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_step"><span class="id" title="constructor">seval_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#step_set"><span class="id" title="constructor">step_set</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_val"><span class="id" title="constructor">seval_val</span></a>. } }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_step"><span class="id" title="constructor">seval_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#step_free"><span class="id" title="constructor">step_free</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">K</span>. <span class="id" title="var">inverts</span> <span class="id" title="var">K</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">applys</span>* <a class="idref" href="Triples.html#seval_val"><span class="id" title="constructor">seval_val</span></a>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Putting it all together, we conclude on the soundness of Separation Logic
    with respect to the small-step semantics defined by the relation <span class="inlinecode"><span class="id" title="var">step</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="soundness_small_step" class="idref" href="#soundness_small_step"><span class="id" title="lemma">soundness_small_step</span></a> : <span class="id" title="keyword">∀</span> <a id="t:415" class="idref" href="#t:415"><span class="id" title="binder">t</span></a> <a id="H:416" class="idref" href="#H:416"><span class="id" title="binder">H</span></a> <a id="Q:417" class="idref" href="#Q:417"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Triples.html#t:415"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H:416"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#Q:417"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="s:418" class="idref" href="#s:418"><span class="id" title="binder">s</span></a>, <a class="idref" href="Triples.html#H:416"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#s:418"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#terminates"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Triples.html#s:418"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:415"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Triples.html#safe"><span class="id" title="definition">safe</span></a> <a class="idref" href="Triples.html#s:418"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:415"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Triples.html#correct"><span class="id" title="definition">correct</span></a> <a class="idref" href="Triples.html#s:418"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:415"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q:417"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">Hs</span>. <span class="id" title="var">specializes</span> <span class="id" title="var">M</span> <span class="id" title="var">Hs</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">lets</span> <span class="id" title="var">R</span>: <a class="idref" href="Triples.html#seval_of_eval"><span class="id" title="lemma">seval_of_eval</span></a> <span class="id" title="var">M</span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_sound"><span class="id" title="lemma">seval_sound</span></a> <span class="id" title="var">R</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab189"></a><h2 class="section">Small-Step-Based Triples</h2>

<div class="paragraph"> </div>

 A second possible approach to setting up a Separation Logic starting from a
    small-step semantics consists of defining <span class="inlinecode"><span class="id" title="var">triple</span></span> directly in terms of
    <span class="inlinecode"><span class="id" title="var">seval</span></span>, without introducing the omni-big-step judgment <span class="inlinecode"><span class="id" title="tactic">eval</span></span>.

<div class="paragraph"> </div>

    Let <span class="inlinecode"><span class="id" title="var">striple</span></span> denote triples built from <span class="inlinecode"><span class="id" title="var">seval</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="striple" class="idref" href="#striple"><span class="id" title="definition">striple</span></a> (<a id="t:419" class="idref" href="#t:419"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) (<a id="H:420" class="idref" href="#H:420"><span class="id" title="binder">H</span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) (<a id="Q:421" class="idref" href="#Q:421"><span class="id" title="binder">Q</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="s:422" class="idref" href="#s:422"><span class="id" title="binder">s</span></a>:<a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a>), <a class="idref" href="Triples.html#H:420"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#s:422"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:422"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:419"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q:421"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
The first step is to check that this new definition of triple is sound. This
    property has been essentially been established in the previous section via
    the lemma <span class="inlinecode"><span class="id" title="var">seval_sound</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="striple_sound" class="idref" href="#striple_sound"><span class="id" title="lemma">striple_sound</span></a> : <span class="id" title="keyword">∀</span> <a id="t:423" class="idref" href="#t:423"><span class="id" title="binder">t</span></a> <a id="H:424" class="idref" href="#H:424"><span class="id" title="binder">H</span></a> <a id="Q:425" class="idref" href="#Q:425"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#striple"><span class="id" title="definition">striple</span></a> <a class="idref" href="Triples.html#t:423"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H:424"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#Q:425"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="s:426" class="idref" href="#s:426"><span class="id" title="binder">s</span></a>, <a class="idref" href="Triples.html#H:424"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#s:426"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Triples.html#terminates"><span class="id" title="inductive">terminates</span></a> <a class="idref" href="Triples.html#s:426"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:423"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Triples.html#safe"><span class="id" title="definition">safe</span></a> <a class="idref" href="Triples.html#s:426"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:423"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Triples.html#correct"><span class="id" title="definition">correct</span></a> <a class="idref" href="Triples.html#s:426"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:423"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q:425"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">Hs</span>. <span class="id" title="var">specializes</span> <span class="id" title="var">M</span> <span class="id" title="var">Hs</span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_sound"><span class="id" title="lemma">seval_sound</span></a> <span class="id" title="var">M</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The second step is to establish reasoning rules for <span class="inlinecode"><span class="id" title="var">striple</span></span>. Let us begin
    with the consequence rule and the frame rule. For those, we need to
    establish the consequence and the frame property directly for <span class="inlinecode"><span class="id" title="var">seval</span></span>. The
    proofs differ from the corresponding proofs on <span class="inlinecode"><span class="id" title="tactic">eval</span></span>. 
<div class="paragraph"> </div>

 The consequence rule for <span class="inlinecode"><span class="id" title="var">seval</span></span> is established by induction. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="seval_conseq" class="idref" href="#seval_conseq"><span class="id" title="lemma">seval_conseq</span></a> : <span class="id" title="keyword">∀</span> <a id="s:427" class="idref" href="#s:427"><span class="id" title="binder">s</span></a> <a id="t:428" class="idref" href="#t:428"><span class="id" title="binder">t</span></a> <a id="Q:429" class="idref" href="#Q:429"><span class="id" title="binder">Q</span></a> <a id="Q':430" class="idref" href="#Q':430"><span class="id" title="binder">Q'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:427"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:428"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q':430"><span class="id" title="variable">Q'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#Q':430"><span class="id" title="variable">Q'</span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Triples.html#Q:429"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#s:427"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:428"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q:429"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">WQ</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_val"><span class="id" title="constructor">seval_val</span></a>. <span class="id" title="var">applys</span>* <span class="id" title="var">WQ</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rename</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">into</span> <span class="id" title="var">IH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_step"><span class="id" title="constructor">seval_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">HR</span>. <span class="id" title="var">applys</span>* <span class="id" title="var">IH</span>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The consequence rule follows directly. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="striple_conseq" class="idref" href="#striple_conseq"><span class="id" title="lemma">striple_conseq</span></a> : <span class="id" title="keyword">∀</span> <a id="t:431" class="idref" href="#t:431"><span class="id" title="binder">t</span></a> <a id="H':432" class="idref" href="#H':432"><span class="id" title="binder">H'</span></a> <a id="Q':433" class="idref" href="#Q':433"><span class="id" title="binder">Q'</span></a> <a id="H:434" class="idref" href="#H:434"><span class="id" title="binder">H</span></a> <a id="Q:435" class="idref" href="#Q:435"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#striple"><span class="id" title="definition">striple</span></a> <a class="idref" href="Triples.html#t:431"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H':432"><span class="id" title="variable">H'</span></a> <a class="idref" href="Triples.html#Q':433"><span class="id" title="variable">Q'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#H:434"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Triples.html#H':432"><span class="id" title="variable">H'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#Q':433"><span class="id" title="variable">Q'</span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Triples.html#Q:435"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#striple"><span class="id" title="definition">striple</span></a> <a class="idref" href="Triples.html#t:431"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H:434"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#Q:435"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">MH</span> <span class="id" title="var">MQ</span> <span class="id" title="var">HF</span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_conseq"><span class="id" title="lemma">seval_conseq</span></a> <span class="id" title="var">M</span> <span class="id" title="var">MQ</span>. <span class="id" title="var">applys</span>* <span class="id" title="var">MH</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The frame property for <span class="inlinecode"><span class="id" title="var">seval</span></span> is also established by induction, however the
    proof is more involved. 
</div>
<div class="code">

<span class="id" title="keyword">Section</span> <a id="stepsFrame" class="idref" href="#stepsFrame"><span class="id" title="section">stepsFrame</span></a>.<br/>
<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="Triples.html#step"><span class="id" title="inductive">step</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="seval_frame" class="idref" href="#seval_frame"><span class="id" title="lemma">seval_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="h<sub>1</sub>:436" class="idref" href="#h<sub>1</sub>:436"><span class="id" title="binder">h<sub>1</sub></span></a> <a id="h<sub>2</sub>:437" class="idref" href="#h<sub>2</sub>:437"><span class="id" title="binder">h<sub>2</sub></span></a> <a id="t:438" class="idref" href="#t:438"><span class="id" title="binder">t</span></a> <a id="Q:439" class="idref" href="#Q:439"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> <a class="idref" href="Triples.html#h<sub>1</sub>:436"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="Triples.html#t:438"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#Q:439"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.disjoint"><span class="id" title="definition">Fmap.disjoint</span></a> <a class="idref" href="Triples.html#h<sub>1</sub>:436"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="Triples.html#h<sub>2</sub>:437"><span class="id" title="variable">h<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#seval"><span class="id" title="inductive">seval</span></a> (<a class="idref" href="Triples.html#h<sub>1</sub>:436"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <a class="idref" href="Triples.html#h<sub>2</sub>:437"><span class="id" title="variable">h<sub>2</sub></span></a>) <a class="idref" href="Triples.html#t:438"><span class="id" title="variable">t</span></a> (<a class="idref" href="Triples.html#Q:439"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation">(</span></a><span class="id" title="notation">=</span> <a class="idref" href="Triples.html#h<sub>2</sub>:437"><span class="id" title="variable">h<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation">)</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">HD</span>. <span class="id" title="var">gen</span> <span class="id" title="var">h<sub>2</sub></span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">M</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_val"><span class="id" title="constructor">seval_val</span></a>. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">rename</span> <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">M<sub>1</sub></span>, <span class="id" title="var">H<sub>0</sub></span> <span class="id" title="var">into</span> <span class="id" title="var">M<sub>2</sub></span>, <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">into</span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_step"><span class="id" title="constructor">seval_step</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">unfolds</span> <a class="idref" href="Triples.html#reducible"><span class="id" title="definition">reducible</span></a>. <span class="id" title="tactic">clear</span> <span class="id" title="var">M<sub>2</sub></span> <span class="id" title="var">IH<sub>2</sub></span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">s'</span>&amp;<span class="id" title="var">t'</span>&amp;<span class="id" title="var">R</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">R</span>; <span class="id" title="var">tryfalse</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">solve</span> [ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>; <span class="id" title="var">constructors</span>* ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">forwards</span>* (<span class="id" title="var">s'</span>&amp;<span class="id" title="var">t'</span>&amp;<span class="id" title="var">R'</span>): <span class="id" title="var">IHR</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">forwards</span>* (<span class="id" title="var">s'</span>&amp;<span class="id" title="var">t'</span>&amp;<span class="id" title="var">R'</span>): <span class="id" title="var">IHR</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">lets</span> (<span class="id" title="var">p'</span>&amp;<span class="id" title="var">F</span>&amp;<span class="id" title="var">_</span>): <a class="idref" href="LibSepFmap.html#exists_fresh"><span class="id" title="lemma">exists_fresh</span></a> <a class="idref" href="LibSepReference.html#null"><span class="id" title="definition">null</span></a> (<a class="idref" href="LibSepReference.html#Fmap.union"><span class="id" title="definition">Fmap.union</span></a> <span class="id" title="var">s</span> <span class="id" title="var">h<sub>2</sub></span>). <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Triples.html#step_ref"><span class="id" title="constructor">step_ref</span></a> <span class="id" title="var">v</span> <span class="id" title="var">p'</span>. <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#step_get"><span class="id" title="constructor">step_get</span></a>. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_l"><span class="id" title="lemma">Fmap.indom_union_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#step_set"><span class="id" title="constructor">step_set</span></a>. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_l"><span class="id" title="lemma">Fmap.indom_union_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">do</span> 2 <span class="id" title="var">esplit</span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#step_free"><span class="id" title="constructor">step_free</span></a>. <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.indom_union_l"><span class="id" title="lemma">Fmap.indom_union_l</span></a>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">R</span>. <span class="id" title="var">cuts</span> (<span class="id" title="var">s<sub>1</sub>'</span>&amp;<span class="id" title="var">E'</span>&amp;<span class="id" title="var">D'</span>&amp;<span class="id" title="var">R'</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="s<sub>1</sub>':441" class="idref" href="#s<sub>1</sub>':441"><span class="id" title="binder">s<sub>1</sub>'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <span class="id" title="var">s'</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>':440"><span class="id" title="variable">s<sub>1</sub>'</span></a> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <span class="id" title="var">h<sub>2</sub></span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="LibSepReference.html#Fmap.disjoint"><span class="id" title="definition">Fmap.disjoint</span></a> <a class="idref" href="Triples.html#s<sub>1</sub>':440"><span class="id" title="variable">s<sub>1</sub>'</span></a> <span class="id" title="var">h<sub>2</sub></span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Triples.html#step"><span class="id" title="inductive">step</span></a> <span class="id" title="var">s</span> <span class="id" title="var">t</span> <a class="idref" href="Triples.html#s<sub>1</sub>':440"><span class="id" title="variable">s<sub>1</sub>'</span></a> <span class="id" title="var">t'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">subst</span>. <span class="id" title="var">applys</span>* <span class="id" title="var">IH<sub>2</sub></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">M<sub>2</sub></span> <span class="id" title="var">IH<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">gen_eq</span> <span class="id" title="var">su</span>: (<span class="id" title="var">s</span> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <span class="id" title="var">h<sub>2</sub></span>). <span class="id" title="var">gen</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unfolds</span> <a class="idref" href="Triples.html#reducible"><span class="id" title="definition">reducible</span></a>. <span class="id" title="tactic">induction</span> <span class="id" title="var">R</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">s<sub>0</sub></span>&amp;<span class="id" title="var">t<sub>0</sub></span>&amp;<span class="id" title="var">R<sub>0</sub></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rename</span> <span class="id" title="var">R</span> <span class="id" title="var">into</span> <span class="id" title="var">R<sub>1</sub></span>. <span class="id" title="var">forwards</span>* (<span class="id" title="var">s<sub>1</sub>'</span>&amp;<span class="id" title="var">E</span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">R<sub>1</sub>'</span>): <span class="id" title="var">IHR</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">inverts</span> <span class="id" title="var">R<sub>0</sub></span>. { <span class="id" title="tactic">eauto</span>. } { <span class="id" title="var">inverts</span> <span class="id" title="var">R<sub>1</sub></span>. } } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">s<sub>0</sub></span>&amp;<span class="id" title="var">t<sub>0</sub></span>&amp;<span class="id" title="var">R<sub>0</sub></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rename</span> <span class="id" title="var">R</span> <span class="id" title="var">into</span> <span class="id" title="var">R<sub>1</sub></span>. <span class="id" title="var">forwards</span>* (<span class="id" title="var">s<sub>1</sub>'</span>&amp;<span class="id" title="var">E</span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">R<sub>1</sub>'</span>): <span class="id" title="var">IHR</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">inverts</span> <span class="id" title="var">R<sub>0</sub></span>. { <span class="id" title="tactic">eauto</span>. } { <span class="id" title="var">inverts</span> <span class="id" title="var">R<sub>1</sub></span>. } } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rename</span> <span class="id" title="var">H</span> <span class="id" title="var">into</span> <span class="id" title="var">D</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#Fmap.indom_union_eq"><span class="id" title="lemma">Fmap.indom_union_eq</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">D</span>. <span class="id" title="var">rew_logic</span> <span class="id" title="keyword">in</span> <span class="id" title="var">D</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">D</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">D<sub>1</sub></span>&amp;<span class="id" title="var">D<sub>2</sub></span>). <span class="id" title="var">esplit</span>. <span class="id" title="var">splits</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.update_union_not_r"><span class="id" title="lemma">Fmap.update_union_not_r</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.disjoint_update_not_r"><span class="id" title="lemma">Fmap.disjoint_update_not_r</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eauto</span>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">se</span>&amp;<span class="id" title="var">te</span>&amp;<span class="id" title="var">Re</span>). <span class="id" title="var">inverts</span> <span class="id" title="var">Re</span>; <span class="id" title="var">tryfalse</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.read_union_l"><span class="id" title="lemma">Fmap.read_union_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">se</span>&amp;<span class="id" title="var">te</span>&amp;<span class="id" title="var">Re</span>). <span class="id" title="var">inverts</span> <span class="id" title="var">Re</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">esplit</span>. <span class="id" title="var">splits</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepReference.html#Fmap.update_union_l"><span class="id" title="lemma">Fmap.update_union_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.disjoint_update_l"><span class="id" title="lemma">Fmap.disjoint_update_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eauto</span>. } }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">se</span>&amp;<span class="id" title="var">te</span>&amp;<span class="id" title="var">Re</span>). <span class="id" title="var">inverts</span> <span class="id" title="var">Re</span>; <span class="id" title="var">tryfalse</span>. <span class="id" title="var">esplit</span>. <span class="id" title="var">splits</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span>* <a class="idref" href="LibSepFmap.html#remove_disjoint_union_l"><span class="id" title="lemma">remove_disjoint_union_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#Fmap.disjoint_remove_l"><span class="id" title="lemma">Fmap.disjoint_remove_l</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eauto</span>. } } } }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="Triples.html#stepsFrame"><span class="id" title="section">stepsFrame</span></a>.<br/>
</div>

<div class="doc">
The frame rule for <span class="inlinecode"><span class="id" title="var">striple</span></span> then follows from the frame and the consequence
    properties for <span class="inlinecode"><span class="id" title="var">seval</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="striple_frame" class="idref" href="#striple_frame"><span class="id" title="lemma">striple_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="t:442" class="idref" href="#t:442"><span class="id" title="binder">t</span></a> <a id="H:443" class="idref" href="#H:443"><span class="id" title="binder">H</span></a> <a id="Q:444" class="idref" href="#Q:444"><span class="id" title="binder">Q</span></a> <a id="H':445" class="idref" href="#H':445"><span class="id" title="binder">H'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#striple"><span class="id" title="definition">striple</span></a> <a class="idref" href="Triples.html#t:442"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H:443"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#Q:444"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#striple"><span class="id" title="definition">striple</span></a> <a class="idref" href="Triples.html#t:442"><span class="id" title="variable">t</span></a> (<a class="idref" href="Triples.html#H:443"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Triples.html#H':445"><span class="id" title="variable">H'</span></a>) (<a class="idref" href="Triples.html#Q:444"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Triples.html#H':445"><span class="id" title="variable">H'</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">HF</span>. <span class="id" title="var">lets</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">M<sub>2</sub></span>&amp;<span class="id" title="var">MD</span>&amp;<span class="id" title="var">MU</span>): <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_inv"><span class="id" title="lemma">hstar_inv</span></a> (<span class="id" title="definition">rm</span> <span class="id" title="var">HF</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">specializes</span> <span class="id" title="var">M</span> <span class="id" title="var">M<sub>1</sub></span>. <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_conseq"><span class="id" title="lemma">seval_conseq</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Triples.html#seval_frame"><span class="id" title="lemma">seval_frame</span></a> <span class="id" title="var">M</span> <span class="id" title="var">MD</span>. } { <span class="id" title="var">xsimpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h'</span> →. <span class="id" title="var">applys</span> <span class="id" title="var">M<sub>2</sub></span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
To establish other reasoning rules for <span class="inlinecode"><span class="id" title="var">striple</span></span>, one need to prove
    big-step-style evaluation rules for <span class="inlinecode"><span class="id" title="var">seval</span></span>, such as the lemma <span class="inlinecode"><span class="id" title="var">seval_let</span></span>
    stated earlier. 
<div class="paragraph"> </div>

 In summary, it is possible to set up a Separation Logic directly based on
    the small-step-based judgment <span class="inlinecode"><span class="id" title="var">seval</span></span>, without going through a definition of
    the omni-big-step judgment <span class="inlinecode"><span class="id" title="tactic">eval</span></span>. However, most of the proof effort
    remains, as one needs to establish the frame property and to derive
    big-step-style evaluation rules such as <span class="inlinecode"><span class="id" title="var">seval_let</span></span>. 
</div>

<div class="doc">
<a id="lab190"></a><h2 class="section">Separation Logic Triples for Quasi-Deterministic Semantics</h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="BakedInFrame" class="idref" href="#BakedInFrame"><span class="id" title="module">BakedInFrame</span></a>.<br/>
</div>

<div class="doc">
Consider a programming language that is deterministic except for the
    allocation operation, which may pick any fresh location. For such languages,
    it is possible to define Separation Logic triples in terms of the standard
    big-step semantics, using a technique known as the "baked-in frame rule".

<div class="paragraph"> </div>

    Recall the big-step judgment. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="BakedInFrame.eval" class="idref" href="#BakedInFrame.eval"><span class="id" title="axiom">eval</span></a> : <a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>.<br/>
</div>

<div class="doc">
First, we define a (total correctness) Hoare triple, written <span class="inlinecode"><span class="id" title="var">hoare</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>.
    This judgment asserts that, starting from a state <span class="inlinecode"><span class="id" title="var">s</span></span> satisfying the
    precondition <span class="inlinecode"><span class="id" title="var">H</span></span>, the term <span class="inlinecode"><span class="id" title="var">t</span></span> evaluates to a value <span class="inlinecode"><span class="id" title="var">v</span></span> and to a state <span class="inlinecode"><span class="id" title="var">s'</span></span>
    that, together, satisfy the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>. Formally: 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="BakedInFrame.hoare" class="idref" href="#BakedInFrame.hoare"><span class="id" title="definition">hoare</span></a> (<a id="t:447" class="idref" href="#t:447"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) (<a id="H:448" class="idref" href="#H:448"><span class="id" title="binder">H</span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) (<a id="Q:449" class="idref" href="#Q:449"><span class="id" title="binder">Q</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="s:450" class="idref" href="#s:450"><span class="id" title="binder">s</span></a>:<a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a>), <a class="idref" href="Triples.html#H:448"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#s:450"><span class="id" title="variable">s</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a id="s':451" class="idref" href="#s':451"><span class="id" title="binder">s'</span></a>:<a class="idref" href="LibSepReference.html#heap"><span class="id" title="definition">heap</span></a>) (<a id="v:452" class="idref" href="#v:452"><span class="id" title="binder">v</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">),</span></a> <a class="idref" href="Triples.html#BakedInFrame.eval"><span class="id" title="axiom">eval</span></a> <a class="idref" href="Triples.html#s:450"><span class="id" title="variable">s</span></a> <a class="idref" href="Triples.html#t:447"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#s':451"><span class="id" title="variable">s'</span></a> <a class="idref" href="Triples.html#v:452"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Triples.html#Q:449"><span class="id" title="variable">Q</span></a> <a class="idref" href="Triples.html#v:452"><span class="id" title="variable">v</span></a> <a class="idref" href="Triples.html#s':451"><span class="id" title="variable">s'</span></a>.<br/>
</div>

<div class="doc">
<a id="lab191"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (hoare_conseq)</h4>
 To gain familiarity with the <span class="inlinecode"><span class="id" title="var">hoare</span></span> judgment, prove the consequence rule
    for Hoare triples. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="BakedInFrame.hoare_conseq" class="idref" href="#BakedInFrame.hoare_conseq"><span class="id" title="lemma">hoare_conseq</span></a> : <span class="id" title="keyword">∀</span> <a id="t:453" class="idref" href="#t:453"><span class="id" title="binder">t</span></a> <a id="H:454" class="idref" href="#H:454"><span class="id" title="binder">H</span></a> <a id="Q:455" class="idref" href="#Q:455"><span class="id" title="binder">Q</span></a> <a id="H':456" class="idref" href="#H':456"><span class="id" title="binder">H'</span></a> <a id="Q':457" class="idref" href="#Q':457"><span class="id" title="binder">Q'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#BakedInFrame.hoare"><span class="id" title="definition">hoare</span></a> <a class="idref" href="Triples.html#t:453"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H':456"><span class="id" title="variable">H'</span></a> <a class="idref" href="Triples.html#Q':457"><span class="id" title="variable">Q'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#H:454"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Triples.html#H':456"><span class="id" title="variable">H'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#Q':457"><span class="id" title="variable">Q'</span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Triples.html#Q:455"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#BakedInFrame.hoare"><span class="id" title="definition">hoare</span></a> <a class="idref" href="Triples.html#t:453"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H:454"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#Q:455"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 The judgment <span class="inlinecode"><span class="id" title="var">hoare</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> satisfies the consequence rule, yet it does not
    satisfy the frame property. Can you figure out a counter-example? 
<div class="paragraph"> </div>

 It is nevertheless possible to define <span class="inlinecode"><span class="id" title="var">triple</span></span> on top of <span class="inlinecode"><span class="id" title="var">hoare</span></span> by "baking
    in" the frame rule. The relevant definition is as follows. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="BakedInFrame.btriple" class="idref" href="#BakedInFrame.btriple"><span class="id" title="definition">btriple</span></a> (<a id="t:458" class="idref" href="#t:458"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) (<a id="H:459" class="idref" href="#H:459"><span class="id" title="binder">H</span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) (<a id="Q:460" class="idref" href="#Q:460"><span class="id" title="binder">Q</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="H':461" class="idref" href="#H':461"><span class="id" title="binder">H'</span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>), <a class="idref" href="Triples.html#BakedInFrame.hoare"><span class="id" title="definition">hoare</span></a> <a class="idref" href="Triples.html#t:458"><span class="id" title="variable">t</span></a> (<a class="idref" href="Triples.html#H:459"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Triples.html#H':461"><span class="id" title="variable">H'</span></a>) (<a class="idref" href="Triples.html#Q:460"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Triples.html#H':461"><span class="id" title="variable">H'</span></a>).<br/>
</div>

<div class="doc">
This definition inherently satisfies the frame rule, as we show below. The
    proof essentially exploits the associativity of the star operator. 
<div class="paragraph"> </div>

<a id="lab192"></a><h4 class="section">Exercise: 3 stars, standard, especially useful (btriple_frame)</h4>
 Prove that <span class="inlinecode"><span class="id" title="var">btriple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> is a judgment satisfying the frame rule. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="BakedInFrame.btriple_frame" class="idref" href="#BakedInFrame.btriple_frame"><span class="id" title="lemma">btriple_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="t:462" class="idref" href="#t:462"><span class="id" title="binder">t</span></a> <a id="H:463" class="idref" href="#H:463"><span class="id" title="binder">H</span></a> <a id="Q:464" class="idref" href="#Q:464"><span class="id" title="binder">Q</span></a> <a id="H':465" class="idref" href="#H':465"><span class="id" title="binder">H'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#BakedInFrame.btriple"><span class="id" title="definition">btriple</span></a> <a class="idref" href="Triples.html#t:462"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H:463"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#Q:464"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#BakedInFrame.btriple"><span class="id" title="definition">btriple</span></a> <a class="idref" href="Triples.html#t:462"><span class="id" title="variable">t</span></a> (<a class="idref" href="Triples.html#H:463"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Triples.html#H':465"><span class="id" title="variable">H'</span></a>) (<a class="idref" href="Triples.html#Q:464"><span class="id" title="variable">Q</span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Triples.html#H':465"><span class="id" title="variable">H'</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 We have previously defined <span class="inlinecode"><span class="id" title="var">btriple</span></span> on top of <span class="inlinecode"><span class="id" title="var">hoare</span></span>, with the help of the
    separating conjunction operator, in the form:
    <span class="inlinecode"><span class="id" title="keyword">∀</span></span> <span class="inlinecode">(<span class="id" title="var">H'</span>:<span class="id" title="var">hprop</span>),</span> <span class="inlinecode"><span class="id" title="var">hoare</span></span> <span class="inlinecode">(<span class="id" title="var">H</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H'</span>)</span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">(<span class="id" title="var">Q</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*+</span> <span class="inlinecode"><span class="id" title="var">H'</span>)</span>. In what follows, we give
    an equivalent characterization, expressed directly in terms of heaps and
    heap unions.

<div class="paragraph"> </div>

    The alternative definition of <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> asserts that if <span class="inlinecode"><span class="id" title="var">h<sub>1</sub></span></span> satisfies
    the precondition <span class="inlinecode"><span class="id" title="var">H</span></span> and <span class="inlinecode"><span class="id" title="var">h<sub>2</sub></span></span> describes the rest of the state, then the
    evaluation of <span class="inlinecode"><span class="id" title="var">t</span></span> produces a value <span class="inlinecode"><span class="id" title="var">v</span></span> in a final state made that can be
    decomposed between a part <span class="inlinecode"><span class="id" title="var">h<sub>1</sub>'</span></span> and <span class="inlinecode"><span class="id" title="var">h<sub>2</sub></span></span> unchanged, in such a way that <span class="inlinecode"><span class="id" title="var">v</span></span>
    and <span class="inlinecode"><span class="id" title="var">h<sub>1</sub>'</span></span> together satisfy the postcondition <span class="inlinecode"><span class="id" title="var">Q</span></span>.

<div class="paragraph"> </div>

    Formally: 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="BakedInFrame.btriple_lowlevel" class="idref" href="#BakedInFrame.btriple_lowlevel"><span class="id" title="definition">btriple_lowlevel</span></a> (<a id="t:466" class="idref" href="#t:466"><span class="id" title="binder">t</span></a>:<a class="idref" href="LibSepReference.html#trm"><span class="id" title="inductive">trm</span></a>) (<a id="H:467" class="idref" href="#H:467"><span class="id" title="binder">H</span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) (<a id="Q:468" class="idref" href="#Q:468"><span class="id" title="binder">Q</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="h<sub>1</sub>:469" class="idref" href="#h<sub>1</sub>:469"><span class="id" title="binder">h<sub>1</sub></span></a> <a id="h<sub>2</sub>:470" class="idref" href="#h<sub>2</sub>:470"><span class="id" title="binder">h<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.disjoint"><span class="id" title="definition">Fmap.disjoint</span></a> <a class="idref" href="Triples.html#h<sub>1</sub>:469"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="Triples.html#h<sub>2</sub>:470"><span class="id" title="variable">h<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#H:467"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#h<sub>1</sub>:469"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="h<sub>1</sub>':471" class="idref" href="#h<sub>1</sub>':471"><span class="id" title="binder">h<sub>1</sub>'</span></a> <a id="v:472" class="idref" href="#v:472"><span class="id" title="binder">v</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#Fmap.disjoint"><span class="id" title="definition">Fmap.disjoint</span></a> <a class="idref" href="Triples.html#h<sub>1</sub>':471"><span class="id" title="variable">h<sub>1</sub>'</span></a> <a class="idref" href="Triples.html#h<sub>2</sub>:470"><span class="id" title="variable">h<sub>2</sub></span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Triples.html#BakedInFrame.eval"><span class="id" title="axiom">eval</span></a> (<a class="idref" href="Triples.html#h<sub>1</sub>:469"><span class="id" title="variable">h<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <a class="idref" href="Triples.html#h<sub>2</sub>:470"><span class="id" title="variable">h<sub>2</sub></span></a>) <a class="idref" href="Triples.html#t:466"><span class="id" title="variable">t</span></a> (<a class="idref" href="Triples.html#h<sub>1</sub>':471"><span class="id" title="variable">h<sub>1</sub>'</span></a> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <a class="idref" href="Triples.html#h<sub>2</sub>:470"><span class="id" title="variable">h<sub>2</sub></span></a>) <a class="idref" href="Triples.html#v:472"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Triples.html#Q:468"><span class="id" title="variable">Q</span></a> <a class="idref" href="Triples.html#v:472"><span class="id" title="variable">v</span></a> <a class="idref" href="Triples.html#h<sub>1</sub>':471"><span class="id" title="variable">h<sub>1</sub>'</span></a>.<br/>
</div>

<div class="doc">
Let us establish the equivalence between this alternative definition of
    <span class="inlinecode"><span class="id" title="var">triple</span></span> and the original one. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="BakedInFrame.btriple_iff_btriple_lowlevel" class="idref" href="#BakedInFrame.btriple_iff_btriple_lowlevel"><span class="id" title="lemma">btriple_iff_btriple_lowlevel</span></a> : <span class="id" title="keyword">∀</span> <a id="t:473" class="idref" href="#t:473"><span class="id" title="binder">t</span></a> <a id="H:474" class="idref" href="#H:474"><span class="id" title="binder">H</span></a> <a id="Q:475" class="idref" href="#Q:475"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Triples.html#BakedInFrame.btriple"><span class="id" title="definition">btriple</span></a> <a class="idref" href="Triples.html#t:473"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H:474"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#Q:475"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="Triples.html#BakedInFrame.btriple_lowlevel"><span class="id" title="definition">btriple_lowlevel</span></a> <a class="idref" href="Triples.html#t:473"><span class="id" title="variable">t</span></a> <a class="idref" href="Triples.html#H:474"><span class="id" title="variable">H</span></a> <a class="idref" href="Triples.html#Q:475"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Triples.html#triple"><span class="id" title="definition">triple</span></a>, <a class="idref" href="Triples.html#BakedInFrame.btriple_lowlevel"><span class="id" title="definition">btriple_lowlevel</span></a>, <a class="idref" href="Triples.html#BakedInFrame.hoare"><span class="id" title="definition">hoare</span></a>. <span class="id" title="var">iff</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="var">introv</span> <span class="id" title="var">D</span> <span class="id" title="var">P<sub>1</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">forwards</span> (<span class="id" title="var">h'</span>&amp;<span class="id" title="var">v</span>&amp;<span class="id" title="var">HR</span>&amp;<span class="id" title="var">HQ</span>): <span class="id" title="var">M</span> (<span class="id" title="notation">=</span><span class="id" title="var">h<sub>2</sub></span>) (<span class="id" title="var">h<sub>1</sub></span> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <span class="id" title="var">h<sub>2</sub></span>). { <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HQ</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">h<sub>1</sub>'</span>&amp;<span class="id" title="var">h<sub>2</sub>'</span>&amp;<span class="id" title="var">N<sub>0</sub></span>&amp;<span class="id" title="var">N<sub>1</sub></span>&amp;<span class="id" title="var">N<sub>2</sub></span>&amp;<span class="id" title="var">N<sub>3</sub></span>). <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> <span class="id" title="var">h<sub>1</sub>'</span> <span class="id" title="var">v</span>. <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">H'</span> <span class="id" title="var">h</span>. <span class="id" title="var">introv</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">N<sub>1</sub></span>&amp;<span class="id" title="var">N<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">U</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">forwards</span> (<span class="id" title="var">h<sub>1</sub>'</span>&amp;<span class="id" title="var">v</span>&amp;<span class="id" title="var">D'</span>&amp;<span class="id" title="var">HR</span>&amp;<span class="id" title="var">HQ</span>): <span class="id" title="var">M</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">h<sub>2</sub></span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> (<span class="id" title="var">h<sub>1</sub>'</span> <a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <span class="id" title="var">h<sub>2</sub></span>) <span class="id" title="var">v</span>. <span class="id" title="tactic">split</span>. { <span class="id" title="tactic">eauto</span>. } { <span class="id" title="var">applys</span>* <a class="idref" href="LibSepReference.html#SepSimplArgs.hstar_intro"><span class="id" title="lemma">hstar_intro</span></a>. } }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The low-level definition of triple leveraging the baked-in frame rule may be
    convenient for formalizing certain extensions of Separation Logic. 
</div>
<div class="code">

<span class="id" title="keyword">End</span> <a class="idref" href="Triples.html#BakedInFrame"><span class="id" title="module">BakedInFrame</span></a>.<br/>
</div>

<div class="doc">
<a id="lab193"></a><h2 class="section">Historical Notes</h2>

<div class="paragraph"> </div>

 The definition of Separation Logic triples based on the use of an
    omni-big-step semantics is a contribution of <a href="Bib.html#Charguéraud-et al 2023"><span class="inlineref">[Charguéraud et al 2023]</span></a>.
    Omni-big-step semantics was introduced by <a href="Bib.html#Schäfer-et al 2016"><span class="inlineref">[Schäfer et al 2016]</span></a>, with
    applications to a Hoare logic. The technique of the "baked-in frame rule"
    presented near the end of this chapter was introduced by
    <a href="Bib.html#Birkedal,-Torp-Smith and Yang 2006"><span class="inlineref">[Birkedal, Torp-Smith and Yang 2006]</span></a>, who developed the first
    Separation Logic for a higher-order programming language. Since then, this
    technique has been employed successfully in numerous formalizations of
    Separation Logic. 
</div>
<div class="code">

<span class="comment">(*&nbsp;2024-11-04&nbsp;20:38&nbsp;*)</span><br/>
</div>
</div>

<div id="footer">
<hr/><a href="coqindex.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>