<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="common/css/sf.css" rel="stylesheet" type="text/css" />
<title>Himpl: Heap Entailment</title>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/slf.css" rel="stylesheet" type="text/css"/>
</head>

<body>

<div id="page">

<div id="header">
<div id='logoinheader'><a href='https://softwarefoundations.cis.upenn.edu'>
<img src='common/media/image/sf_logo_sm.png' alt='Software Foundations Logo'></a></div>
<div class='booktitleinheader'><a href='index.html'>Volume 6: Separation Logic Foundations</a></div>
<ul id='menu'>
   <li class='section_name'><a href='toc.html'>Table of Contents</a></li>
   <li class='section_name'><a href='coqindex.html'>Index</a></li>
   <li class='section_name'><a href='deps.html'>Roadmap</a></li>
</ul>
</div>

<div id="main">

<h1 class="libtitle">Himpl<span class="subtitle">Heap Entailment</span></h1>


<div class="doc">

<div class="paragraph"> </div>


<div class="paragraph"> </div>

Foundations of Separation Logic

<div class="paragraph"> </div>

Chapter: "Himpl".

<div class="paragraph"> </div>

Author: Arthur Charguéraud.
License: CC-by 4.0.

<div class="paragraph"> </div>


</div>
<div class="code">

<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">SLF</span> <span class="id" title="keyword">Require</span> <a class="idref" href="LibSepReference.html#"><span class="id" title="library">LibSepReference</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">SLF</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="Hprop.html#"><span class="id" title="library">Hprop</span></a>.<br/>
</div>

<div class="doc">
Implicit Types 
</div>
<div class="code">

<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> : <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">H</span> : <a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">Q</span> : <a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>.<br/>
</div>

<div class="doc">
<a id="lab104"></a><h1 class="section">First Pass</h1>

<div class="paragraph"> </div>

 In the previous chapter, we have introduced the key heap predicate
    operators, and we have defined the notion of Separation Logic triple.

<div class="paragraph"> </div>

    Before we can state and prove reasoning rules for establishing triples,
    we need to introduce the "entailment relation". This relation,
    written <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>, asserts that any heap that satisfies <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> also
    satisfies <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>.

<div class="paragraph"> </div>

    We also need to extend the entailment relation to postconditions.
    We write <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode">===&gt;</span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span> to asserts that, for any result value <span class="inlinecode"><span class="id" title="var">v</span></span>,
    the entailment <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> holds.

<div class="paragraph"> </div>

    The two entailment relations appear in the statement of the rule of
    consequence, which admits the same statement in Separation Logic
    as in Hoare logic. It asserts that precondition can be strengthened
    and postcondition can be weakened in a specification triple.
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">triple_conseq</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">t</span> <span class="id" title="var">H</span> <span class="id" title="var">Q</span> <span class="id" title="var">H'</span> <span class="id" title="var">Q'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">triple</span> <span class="id" title="var">t</span> <span class="id" title="var">H'</span> <span class="id" title="var">Q'</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">H</span> ==&gt; <span class="id" title="var">H'</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Q'</span> ===&gt; <span class="id" title="var">Q</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">triple</span> <span class="id" title="var">t</span> <span class="id" title="var">H</span> <span class="id" title="var">Q</span>.
</span>   This chapter presents:
<ul class="doclist">
<li> the formal definition of the entailment relations,

</li>
<li> the fundamental properties of the Separation Logic operators:
     these properties are expressed either as entailments, or as
     equalities, which denote symmetric entailments,

</li>
<li> the 4 structural rules of Separation Logic: the rule of consequence,
     the frame rule (which can be combined with the rule of consequence),
     and the extractions rules for pure facts and for quantifiers,

</li>
<li> the tactics <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> and <span class="inlinecode"><span class="id" title="var">xchange</span></span> that are critically useful
     for manipulating entailments in practice,

</li>
<li> (optional) details on how to prove the fundamental properties
     and the structural rules.

</li>
</ul>

<div class="paragraph"> </div>


</div>

<div class="doc">
<a id="lab105"></a><h2 class="section">Definition of Entailment</h2>

<div class="paragraph"> </div>

 The "entailment relationship" <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> asserts that any
    heap <span class="inlinecode"><span class="id" title="var">h</span></span> that satisfies the heap predicate <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> also satisfies
    the heap predicate <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="himpl" class="idref" href="#himpl"><span class="id" title="definition">himpl</span></a> (<a id="H<sub>1</sub>:1" class="idref" href="#H<sub>1</sub>:1"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:2" class="idref" href="#H<sub>2</sub>:2"><span class="id" title="binder">H<sub>2</sub></span></a>:<a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="h:3" class="idref" href="#h:3"><span class="id" title="binder">h</span></a>:<a class="idref" href="Hprop.html#heap"><span class="id" title="definition">heap</span></a>), <a class="idref" href="Himpl.html#H<sub>1</sub>:1"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Himpl.html#h:3"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:2"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Himpl.html#h:3"><span class="id" title="variable">h</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Notation</span> <a id="7cf9375cc810cd6cb65186f6ede01686" class="idref" href="#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">&quot;</span></a>H<sub>1</sub> ==&gt; H<sub>2</sub>" := (<a class="idref" href="Himpl.html#himpl"><span class="id" title="definition">himpl</span></a> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 55).<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> captures the fact that <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> is a stronger precondition
    than <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>, in the sense that it is more restrictive. 
<div class="paragraph"> </div>

 As we show next, the entailment relation is reflexive, transitive,
    and antisymmetric. It thus forms an order relation on heap predicates. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="himpl_refl" class="idref" href="#himpl_refl"><span class="id" title="lemma">himpl_refl</span></a> : <span class="id" title="keyword">∀</span> <a id="H:4" class="idref" href="#H:4"><span class="id" title="binder">H</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H:4"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H:4"><span class="id" title="variable">H</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span>. <span class="id" title="tactic">hnf</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="himpl_trans" class="idref" href="#himpl_trans"><span class="id" title="lemma">himpl_trans</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>2</sub>:5" class="idref" href="#H<sub>2</sub>:5"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>1</sub>:6" class="idref" href="#H<sub>1</sub>:6"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>3</sub>:7" class="idref" href="#H<sub>3</sub>:7"><span class="id" title="binder">H<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>1</sub>:6"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:5"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>2</sub>:5"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:7"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>1</sub>:6"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:7"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="var">M<sub>2</sub></span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> <span class="id" title="var">H1h</span>. <span class="id" title="tactic">eauto</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab106"></a><h4 class="section">Exercise: 1 star, standard, especially useful (himpl_antisym)</h4>
 Prove the antisymmetry of entailment result shown below
    using extensionality for heap predicates, as captured by
    lemma <span class="inlinecode"><span class="id" title="var">predicate_extensionality</span></span> (or lemma <span class="inlinecode"><span class="id" title="var">hprop_eq</span></span>)
    introduced in the previous chapter (<a href="Hprop.html"><span class="inlineref">Hprop</span></a>). 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="himpl_antisym" class="idref" href="#himpl_antisym"><span class="id" title="lemma">himpl_antisym</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:8" class="idref" href="#H<sub>1</sub>:8"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:9" class="idref" href="#H<sub>2</sub>:9"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>1</sub>:8"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:9"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>2</sub>:9"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>:8"><span class="id" title="variable">H<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:8"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:9"><span class="id" title="variable">H<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 Remark: as the proof scripts show, the fact that entailment on <span class="inlinecode"><span class="id" title="var">hprop</span></span>
    constitutes an order relation is a direct consequence of the fact that
    implication on <span class="inlinecode"><span class="id" title="keyword">Prop</span></span>, that is, <span class="inlinecode">→</span>, is an order relation on <span class="inlinecode"><span class="id" title="keyword">Prop</span></span>
    (when assuming the propositional extensionality axiom). 
<div class="paragraph"> </div>

 The lemma <span class="inlinecode"><span class="id" title="var">himpl_antisym</span></span> may, for example, be used to establish
    commutativity of separating conjunction: <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode">=</span> <span class="inlinecode">(<span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span>)</span>
    by proving that each side entails the other side, that is, by proving
    <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode">==&gt;</span> <span class="inlinecode">(<span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span>)</span> and <span class="inlinecode">(<span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span>)</span> <span class="inlinecode">==&gt;</span> <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span>. 
</div>

<div class="doc">
<a id="lab107"></a><h2 class="section">Entailment for Postconditions</h2>

<div class="paragraph"> </div>

 The entailment <span class="inlinecode">==&gt;</span> relates heap predicates. It is used to capture
    that a precondition "entails" another one. We need a similar
    judgment to assert that a postcondition "entails" another one.

<div class="paragraph"> </div>

    For that purpose, we introduce <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode">===&gt;</span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span>, which asserts that
    for any value <span class="inlinecode"><span class="id" title="var">v</span></span>, the heap predicate <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> entails <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="var">v</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="qimpl" class="idref" href="#qimpl"><span class="id" title="definition">qimpl</span></a> (<a id="Q<sub>1</sub>:10" class="idref" href="#Q<sub>1</sub>:10"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:11" class="idref" href="#Q<sub>2</sub>:11"><span class="id" title="binder">Q<sub>2</sub></span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<a id="v:12" class="idref" href="#v:12"><span class="id" title="binder">v</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a>), <a class="idref" href="Himpl.html#Q<sub>1</sub>:10"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Himpl.html#v:12"><span class="id" title="variable">v</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#Q<sub>2</sub>:11"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="Himpl.html#v:12"><span class="id" title="variable">v</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Notation</span> <a id="28f43c6c1c00c11599fc86b7e27012f<sub>9</sub>" class="idref" href="#28f43c6c1c00c11599fc86b7e27012f<sub>9</sub>"><span class="id" title="notation">&quot;</span></a>Q<sub>1</sub> ===&gt; Q<sub>2</sub>" := (<a class="idref" href="Himpl.html#qimpl"><span class="id" title="definition">qimpl</span></a> <span class="id" title="var">Q<sub>1</sub></span> <span class="id" title="var">Q<sub>2</sub></span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 55).<br/>
</div>

<div class="doc">
Remark: equivalently, <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode">===&gt;</span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span> holds if for any value <span class="inlinecode"><span class="id" title="var">v</span></span> and
    any heap <span class="inlinecode"><span class="id" title="var">h</span></span>, the proposition <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">h</span></span> implies <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode"><span class="id" title="var">h</span></span>. 
<div class="paragraph"> </div>

 Entailment on postconditions also forms an order relation:
    it is reflexive, transitive, and antisymmetric. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="qimpl_refl" class="idref" href="#qimpl_refl"><span class="id" title="lemma">qimpl_refl</span></a> : <span class="id" title="keyword">∀</span> <a id="Q:13" class="idref" href="#Q:13"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#Q:13"><span class="id" title="variable">Q</span></a> <a class="idref" href="Himpl.html#28f43c6c1c00c11599fc86b7e27012f<sub>9</sub>"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Himpl.html#Q:13"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Q</span> <span class="id" title="var">v</span>. <span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#himpl_refl"><span class="id" title="lemma">himpl_refl</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="qimpl_trans" class="idref" href="#qimpl_trans"><span class="id" title="lemma">qimpl_trans</span></a> : <span class="id" title="keyword">∀</span> <a id="Q<sub>2</sub>:14" class="idref" href="#Q<sub>2</sub>:14"><span class="id" title="binder">Q<sub>2</sub></span></a> <a id="Q<sub>1</sub>:15" class="idref" href="#Q<sub>1</sub>:15"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>3</sub>:16" class="idref" href="#Q<sub>3</sub>:16"><span class="id" title="binder">Q<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#Q<sub>1</sub>:15"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Himpl.html#28f43c6c1c00c11599fc86b7e27012f<sub>9</sub>"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Himpl.html#Q<sub>2</sub>:14"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#Q<sub>2</sub>:14"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="Himpl.html#28f43c6c1c00c11599fc86b7e27012f<sub>9</sub>"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Himpl.html#Q<sub>3</sub>:16"><span class="id" title="variable">Q<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#Q<sub>1</sub>:15"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Himpl.html#28f43c6c1c00c11599fc86b7e27012f<sub>9</sub>"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Himpl.html#Q<sub>3</sub>:16"><span class="id" title="variable">Q<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="var">M<sub>2</sub></span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span>. <span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#himpl_trans"><span class="id" title="lemma">himpl_trans</span></a>; <span class="id" title="tactic">eauto</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="qimpl_antisym" class="idref" href="#qimpl_antisym"><span class="id" title="lemma">qimpl_antisym</span></a> : <span class="id" title="keyword">∀</span> <a id="Q<sub>1</sub>:17" class="idref" href="#Q<sub>1</sub>:17"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:18" class="idref" href="#Q<sub>2</sub>:18"><span class="id" title="binder">Q<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#Q<sub>1</sub>:17"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Himpl.html#28f43c6c1c00c11599fc86b7e27012f<sub>9</sub>"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Himpl.html#Q<sub>2</sub>:18"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#Q<sub>2</sub>:18"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="Himpl.html#28f43c6c1c00c11599fc86b7e27012f<sub>9</sub>"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Himpl.html#Q<sub>1</sub>:17"><span class="id" title="variable">Q<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#Q<sub>1</sub>:17"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Himpl.html#Q<sub>2</sub>:18"><span class="id" title="variable">Q<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="var">M<sub>2</sub></span>. <span class="id" title="tactic">apply</span> <a class="idref" href="Hprop.html#functional_extensionality"><span class="id" title="axiom">functional_extensionality</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">v</span>. <span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#himpl_antisym"><span class="id" title="axiom">himpl_antisym</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab108"></a><h2 class="section">Fundamental Properties of Separation Logic Operators</h2>

<div class="paragraph"> </div>

 The 5 fundamental properties of Separation Logic operators are
    described next. Many other properties are derivable from those. 
<div class="paragraph"> </div>

 (1) The star operator is associative. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="hstar_assoc" class="idref" href="#hstar_assoc"><span class="id" title="axiom">hstar_assoc</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:19" class="idref" href="#H<sub>1</sub>:19"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:20" class="idref" href="#H<sub>2</sub>:20"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:21" class="idref" href="#H<sub>3</sub>:21"><span class="id" title="binder">H<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>1</sub>:19"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:20"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:21"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>:19"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>2</sub>:20"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:21"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">)</span></a>.<br/>
</div>

<div class="doc">
(2) The star operator is commutative. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="hstar_comm" class="idref" href="#hstar_comm"><span class="id" title="axiom">hstar_comm</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:23" class="idref" href="#H<sub>1</sub>:23"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:24" class="idref" href="#H<sub>2</sub>:24"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:23"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:24"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:24"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>:23"><span class="id" title="variable">H<sub>1</sub></span></a>.<br/>
</div>

<div class="doc">
(3) The empty heap predicate is a neutral for the star.
    Because star is commutative, it is equivalent to state that
    <span class="inlinecode"><span class="id" title="var">hempty</span></span> is a left or a right neutral for <span class="inlinecode"><span class="id" title="var">hstar</span></span>.
    We chose, arbitrarily, to state the left-neutral property. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="hstar_hempty_l" class="idref" href="#hstar_hempty_l"><span class="id" title="axiom">hstar_hempty_l</span></a> : <span class="id" title="keyword">∀</span> <a id="H:26" class="idref" href="#H:26"><span class="id" title="binder">H</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#cb6b4bc70cb30142f9711e4deb4cb93a"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H:26"><span class="id" title="variable">H</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Himpl.html#H:26"><span class="id" title="variable">H</span></a>.<br/>
</div>

<div class="doc">
(4) Existentials can be "extruded" out of stars, that is:
     <span class="inlinecode">(<span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode"><span class="id" title="var">J</span></span> <span class="inlinecode"><span class="id" title="var">x</span>)</span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H</span></span> is equivalent to <span class="inlinecode"><span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode">(<span class="id" title="var">J</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H</span>)</span>. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="hstar_hexists" class="idref" href="#hstar_hexists"><span class="id" title="axiom">hstar_hexists</span></a> : <span class="id" title="keyword">∀</span> <a id="A:28" class="idref" href="#A:28"><span class="id" title="binder">A</span></a> (<a id="J:29" class="idref" href="#J:29"><span class="id" title="binder">J</span></a>:<a class="idref" href="Himpl.html#A:28"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>) <a id="H:30" class="idref" href="#H:30"><span class="id" title="binder">H</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">∃</span></a> <a id="x:31" class="idref" href="#x:31"><span class="id" title="binder">x</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">,</span></a> <a class="idref" href="Himpl.html#J:29"><span class="id" title="variable">J</span></a> <a class="idref" href="Himpl.html#x:31"><span class="id" title="variable">x</span></a><a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H:30"><span class="id" title="variable">H</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">∃</span></a> <a id="x:32" class="idref" href="#x:32"><span class="id" title="binder">x</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">,</span></a> <a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#J:29"><span class="id" title="variable">J</span></a> <a class="idref" href="Himpl.html#x:32"><span class="id" title="variable">x</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H:30"><span class="id" title="variable">H</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">)</span></a>.<br/>
</div>

<div class="doc">
(5) The star operator is "monotone" with respect to entailment, meaning
    that if <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub>'</span></span> then <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode">==&gt;</span> <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub>'</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span>.

<div class="paragraph"> </div>

    Viewed the other way around, if we have to prove the entailment relation
    <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span> <span class="inlinecode">==&gt;</span> <span class="inlinecode">(<span class="id" title="var">H<sub>1</sub>'</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span>)</span>, we can "cancel out" <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> on both sides.
    In this view, the monotonicity property is a sort of "frame rule for
    the entailment relation".

<div class="paragraph"> </div>

    Here again, due to commutativity of star, it only suffices to state
    the left version of the monotonicity property. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="himpl_frame_l" class="idref" href="#himpl_frame_l"><span class="id" title="axiom">himpl_frame_l</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>2</sub>:34" class="idref" href="#H<sub>2</sub>:34"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>1</sub>:35" class="idref" href="#H<sub>1</sub>:35"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>1</sub>':36" class="idref" href="#H<sub>1</sub>':36"><span class="id" title="binder">H<sub>1</sub>'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:35"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>':36"><span class="id" title="variable">H<sub>1</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>1</sub>:35"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:34"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">)</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>1</sub>':36"><span class="id" title="variable">H<sub>1</sub>'</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:34"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">)</span></a>.<br/>
</div>

<div class="doc">
<a id="lab109"></a><h4 class="section">Exercise: 1 star, standard, especially useful (hstar_comm_assoc)</h4>
 The commutativity and associativity results combine into one result
    that is sometimes convenient to exploit in proofs. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="hstar_comm_assoc" class="idref" href="#hstar_comm_assoc"><span class="id" title="lemma">hstar_comm_assoc</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:38" class="idref" href="#H<sub>1</sub>:38"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:39" class="idref" href="#H<sub>2</sub>:39"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:40" class="idref" href="#H<sub>3</sub>:40"><span class="id" title="binder">H<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:38"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:39"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:40"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:39"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>:38"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:40"><span class="id" title="variable">H<sub>3</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab110"></a><h4 class="section">Exercise: 1 star, standard, especially useful (himpl_frame_r)</h4>
 The monotonicity property of the star operator w.r.t. entailment can
    also be stated in a symmetric fashion, as shown next. Prove this result.
    Hint: exploit the transitivity of entailment (<span class="inlinecode"><span class="id" title="var">himpl_trans</span></span>) and the
    asymmetric monotonicity result (<span class="inlinecode"><span class="id" title="var">himpl_frame_l</span></span>). 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="himpl_frame_r" class="idref" href="#himpl_frame_r"><span class="id" title="lemma">himpl_frame_r</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:41" class="idref" href="#H<sub>1</sub>:41"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:42" class="idref" href="#H<sub>2</sub>:42"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>2</sub>':43" class="idref" href="#H<sub>2</sub>':43"><span class="id" title="binder">H<sub>2</sub>'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>2</sub>:42"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>':43"><span class="id" title="variable">H<sub>2</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>1</sub>:41"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:42"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">)</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>1</sub>:41"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>':43"><span class="id" title="variable">H<sub>2</sub>'</span></a><a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab111"></a><h4 class="section">Exercise: 1 star, standard, especially useful (himpl_frame_lr)</h4>
 The monotonicity property of the star operator w.r.t. entailment can
    also be stated in a symmetric fashion, as shown next. Prove this result.
    Hint: exploit the transitivity of entailment (<span class="inlinecode"><span class="id" title="var">himpl_trans</span></span>) and the
    asymmetric monotonicity result (<span class="inlinecode"><span class="id" title="var">himpl_frame_l</span></span>). 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="himpl_frame_lr" class="idref" href="#himpl_frame_lr"><span class="id" title="lemma">himpl_frame_lr</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:44" class="idref" href="#H<sub>1</sub>:44"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>1</sub>':45" class="idref" href="#H<sub>1</sub>':45"><span class="id" title="binder">H<sub>1</sub>'</span></a> <a id="H<sub>2</sub>:46" class="idref" href="#H<sub>2</sub>:46"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>2</sub>':47" class="idref" href="#H<sub>2</sub>':47"><span class="id" title="binder">H<sub>2</sub>'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:44"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>':45"><span class="id" title="variable">H<sub>1</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>2</sub>:46"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>':47"><span class="id" title="variable">H<sub>2</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>1</sub>:44"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:46"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">)</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>1</sub>':45"><span class="id" title="variable">H<sub>1</sub>'</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>':47"><span class="id" title="variable">H<sub>2</sub>'</span></a><a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>


<div class="doc">
<a id="lab112"></a><h2 class="section">Introduction and Elimination Rules w.r.t. Entailments</h2>

<div class="paragraph"> </div>

 The rules for introducing and eliminating pure facts and existential
    quantifiers in entailments are essential. They are presented next. 
<div class="paragraph"> </div>

 Consider an entailment of the form <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode">(<span class='gray-font'>\</span>[<span class="id" title="var">P</span>]</span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H'</span>)</span>. To establish
    this entailment, one must prove that <span class="inlinecode"><span class="id" title="var">P</span></span> is true, and that <span class="inlinecode"><span class="id" title="var">H</span></span> entails
    <span class="inlinecode"><span class="id" title="var">H'</span></span>. 
<div class="paragraph"> </div>

<a id="lab113"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (himpl_hstar_hpure_r).</h4>
 Prove the rule <span class="inlinecode"><span class="id" title="var">himpl_hstar_hpure_r</span></span>.
    Hint: recall from <span class="inlinecode"><span class="id" title="var">Hprop</span></span> the lemma <span class="inlinecode"><span class="id" title="var">hstar_hpure_l</span></span>, which asserts
    the equality <span class="inlinecode">(<span class='gray-font'>\</span>[<span class="id" title="var">P</span>]</span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H</span>)</span> <span class="inlinecode"><span class="id" title="var">h</span></span> <span class="inlinecode">=</span> <span class="inlinecode">(<span class="id" title="var">P</span></span> <span class="inlinecode">∧</span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">h</span>)</span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="himpl_hstar_hpure_r" class="idref" href="#himpl_hstar_hpure_r"><span class="id" title="lemma">himpl_hstar_hpure_r</span></a> : <span class="id" title="keyword">∀</span> <a id="P:48" class="idref" href="#P:48"><span class="id" title="binder">P</span></a> <a id="H:49" class="idref" href="#H:49"><span class="id" title="binder">H</span></a> <a id="H':50" class="idref" href="#H':50"><span class="id" title="binder">H'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#P:48"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H:49"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H':50"><span class="id" title="variable">H'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H:49"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">(</span></a><a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#P:48"><span class="id" title="variable">P</span></a><a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation">]</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H':50"><span class="id" title="variable">H'</span></a><a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 Reciprocally, consider an entailment of the form <span class="inlinecode">(<span class='gray-font'>\</span>[<span class="id" title="var">P</span>]</span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H</span>)</span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H'</span></span>.
    To establish this entailment, one must prove that <span class="inlinecode"><span class="id" title="var">H</span></span> entails <span class="inlinecode"><span class="id" title="var">H'</span></span> under
    the assumption that <span class="inlinecode"><span class="id" title="var">P</span></span> is true.

<div class="paragraph"> </div>

    Indeed, the former proposition asserts that if a heap <span class="inlinecode"><span class="id" title="var">h</span></span> satisfies <span class="inlinecode"><span class="id" title="var">H</span></span>
    and that <span class="inlinecode"><span class="id" title="var">P</span></span> is true, then <span class="inlinecode"><span class="id" title="var">h</span></span> satisfies <span class="inlinecode"><span class="id" title="var">H'</span></span>, while the latter asserts
    that if <span class="inlinecode"><span class="id" title="var">P</span></span> is true, then if a heap <span class="inlinecode"><span class="id" title="var">h</span></span> satisfies <span class="inlinecode"><span class="id" title="var">H</span></span> it also
    satisfies <span class="inlinecode"><span class="id" title="var">H'</span></span>.

<div class="paragraph"> </div>

    The "extraction rule for pure facts in the left of an entailment"
    captures the property that the pure fact <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">P</span>]</span> can be extracted into
    the Coq context. It is stated as follows. 
<div class="paragraph"> </div>

<a id="lab114"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (himpl_hstar_hpure_l).</h4>
 Prove the rule <span class="inlinecode"><span class="id" title="var">himpl_hstar_hpure_l</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="himpl_hstar_hpure_l" class="idref" href="#himpl_hstar_hpure_l"><span class="id" title="lemma">himpl_hstar_hpure_l</span></a> : <span class="id" title="keyword">∀</span> (<a id="P:51" class="idref" href="#P:51"><span class="id" title="binder">P</span></a>:<span class="id" title="keyword">Prop</span>) (<a id="H:52" class="idref" href="#H:52"><span class="id" title="binder">H</span></a> <a id="H':53" class="idref" href="#H':53"><span class="id" title="binder">H'</span></a>:<a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#P:51"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Himpl.html#H:52"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H':53"><span class="id" title="variable">H'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">(</span></a><a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#P:51"><span class="id" title="variable">P</span></a><a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation">]</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H:52"><span class="id" title="variable">H</span></a><a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">)</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H':53"><span class="id" title="variable">H'</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 Consider an entailment of the form <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode">(<span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode"><span class="id" title="var">J</span></span> <span class="inlinecode"><span class="id" title="var">x</span>)</span>, where <span class="inlinecode"><span class="id" title="var">x</span></span>
    has some type <span class="inlinecode"><span class="id" title="var">A</span></span> and <span class="inlinecode"><span class="id" title="var">J</span></span> has type <span class="inlinecode"><span class="id" title="var">A</span>→<span class="id" title="var">hprop</span></span>. To establish this
    entailment, one must exhibit a value for <span class="inlinecode"><span class="id" title="var">x</span></span> for which <span class="inlinecode"><span class="id" title="var">H</span></span> entails <span class="inlinecode"><span class="id" title="var">J</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span>. 
<div class="paragraph"> </div>

<a id="lab115"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (himpl_hexists_r).</h4>
 Prove the rule <span class="inlinecode"><span class="id" title="var">himpl_hexists_r</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="himpl_hexists_r" class="idref" href="#himpl_hexists_r"><span class="id" title="lemma">himpl_hexists_r</span></a> : <span class="id" title="keyword">∀</span> <a id="A:54" class="idref" href="#A:54"><span class="id" title="binder">A</span></a> (<a id="x:55" class="idref" href="#x:55"><span class="id" title="binder">x</span></a>:<a class="idref" href="Himpl.html#A:54"><span class="id" title="variable">A</span></a>) <a id="H:56" class="idref" href="#H:56"><span class="id" title="binder">H</span></a> <a id="J:57" class="idref" href="#J:57"><span class="id" title="binder">J</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H:56"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#J:57"><span class="id" title="variable">J</span></a> <a class="idref" href="Himpl.html#x:55"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H:56"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">(</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">∃</span></a> <a id="x:58" class="idref" href="#x:58"><span class="id" title="binder">x</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">,</span></a> <a class="idref" href="Himpl.html#J:57"><span class="id" title="variable">J</span></a> <a class="idref" href="Himpl.html#x:58"><span class="id" title="variable">x</span></a><a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 Reciprocally, consider an entailment <span class="inlinecode">(<span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode">(<span class="id" title="var">J</span></span> <span class="inlinecode"><span class="id" title="var">x</span>))</span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H</span></span>.
    To establish this entailment, one has to prove that, whatever the
    value of <span class="inlinecode"><span class="id" title="var">x</span></span>, the predicate <span class="inlinecode"><span class="id" title="var">J</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> entails <span class="inlinecode"><span class="id" title="var">H</span></span>.

<div class="paragraph"> </div>

    Indeed the former proposition asserts that if a heap <span class="inlinecode"><span class="id" title="var">h</span></span>
    satisfies <span class="inlinecode"><span class="id" title="var">J</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> for some <span class="inlinecode"><span class="id" title="var">x</span></span>, then <span class="inlinecode"><span class="id" title="var">h</span></span> satisfies <span class="inlinecode"><span class="id" title="var">H'</span></span>, while
    the latter asserts that if, for some <span class="inlinecode"><span class="id" title="var">x</span></span>, the predicate <span class="inlinecode"><span class="id" title="var">h</span></span>
    satisfies <span class="inlinecode"><span class="id" title="var">J</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span>, then <span class="inlinecode"><span class="id" title="var">h</span></span> satisfies <span class="inlinecode"><span class="id" title="var">H'</span></span>.

<div class="paragraph"> </div>

    Observe how the existential quantifier on the left of the
    entailment becomes an universal quantifier outside of the arrow.

<div class="paragraph"> </div>

    The "extraction rule for existentials in the left of an entailment"
    captures the property that existentials can be extracted into
    the Coq context. It is stated as follows. 
<div class="paragraph"> </div>

<a id="lab116"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (himpl_hexists_l).</h4>
 Prove the rule <span class="inlinecode"><span class="id" title="var">himpl_hexists_l</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="himpl_hexists_l" class="idref" href="#himpl_hexists_l"><span class="id" title="lemma">himpl_hexists_l</span></a> : <span class="id" title="keyword">∀</span> (<a id="A:59" class="idref" href="#A:59"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>) (<a id="H:60" class="idref" href="#H:60"><span class="id" title="binder">H</span></a>:<a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>) (<a id="J:61" class="idref" href="#J:61"><span class="id" title="binder">J</span></a>:<a class="idref" href="Himpl.html#A:59"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="x:62" class="idref" href="#x:62"><span class="id" title="binder">x</span></a>, <a class="idref" href="Himpl.html#J:61"><span class="id" title="variable">J</span></a> <a class="idref" href="Himpl.html#x:62"><span class="id" title="variable">x</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H:60"><span class="id" title="variable">H</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">(</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">∃</span></a> <a id="x:63" class="idref" href="#x:63"><span class="id" title="binder">x</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">,</span></a> <a class="idref" href="Himpl.html#J:61"><span class="id" title="variable">J</span></a> <a class="idref" href="Himpl.html#x:63"><span class="id" title="variable">x</span></a><a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">)</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H:60"><span class="id" title="variable">H</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>


<div class="doc">
<a id="lab117"></a><h2 class="section">Extracting Information from Heap Predicates</h2>

<div class="paragraph"> </div>

 We next present an example showing how entailments can be used to
    state lemmas allowing to extract information from particular heap
    predicates. We show that from a heap predicate of the form
    <span class="inlinecode">(<span class="id" title="var">p</span></span> <span class="inlinecode">~~&gt;</span> <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span>)</span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode">(<span class="id" title="var">p</span></span> <span class="inlinecode">~~&gt;</span> <span class="inlinecode"><span class="id" title="var">v<sub>2</sub></span>)</span> describes two "disjoint" cells that
    are both "at location <span class="inlinecode"><span class="id" title="var">p</span></span>", one can extract a contradiction.

<div class="paragraph"> </div>

    Indeed, such a state cannot exist. The underlying contraction is
    formally captured by the following entailment relation, which
    concludes <span class="inlinecode"><span class="id" title="var">False</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="hstar_hsingle_same_loc" class="idref" href="#hstar_hsingle_same_loc"><span class="id" title="lemma">hstar_hsingle_same_loc</span></a> : <span class="id" title="keyword">∀</span> (<a id="p:64" class="idref" href="#p:64"><span class="id" title="binder">p</span></a>:<a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>) (<a id="v<sub>1</sub>:65" class="idref" href="#v<sub>1</sub>:65"><span class="id" title="binder">v<sub>1</sub></span></a> <a id="v<sub>2</sub>:66" class="idref" href="#v<sub>2</sub>:66"><span class="id" title="binder">v<sub>2</sub></span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#p:64"><span class="id" title="variable">p</span></a> <a class="idref" href="Hprop.html#7322bfa5d36ce5cf12f68db819774432"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Himpl.html#v<sub>1</sub>:65"><span class="id" title="variable">v<sub>1</sub></span></a><a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#p:64"><span class="id" title="variable">p</span></a> <a class="idref" href="Hprop.html#7322bfa5d36ce5cf12f68db819774432"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Himpl.html#v<sub>2</sub>:66"><span class="id" title="variable">v<sub>2</sub></span></a><a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation">]</span></a>.<br/>
</div>

<div class="doc">
The proof of this result exploits a result on finite maps.
    Essentially, the domain of a single singleton map that binds
    a location <span class="inlinecode"><span class="id" title="var">p</span></span> to some value is the singleton set <span class="inlinecode">\{<span class="id" title="var">p</span>}</span>, thus
    such a singleton map cannot be disjoint from another singleton
    map that binds the same location <span class="inlinecode"><span class="id" title="var">p</span></span>.
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Check</span> <span class="id" title="var">disjoint_single_single_same_inv</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">p</span>:<span class="id" title="var">loc</span>) (<span class="id" title="var">v<sub>1</sub></span> <span class="id" title="var">v<sub>2</sub></span>:<span class="id" title="var">val</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Fmap.disjoint</span> (<span class="id" title="var">Fmap.single</span> <span class="id" title="var">p</span> <span class="id" title="var">v<sub>1</sub></span>) (<span class="id" title="var">Fmap.single</span> <span class="id" title="var">p</span> <span class="id" title="var">v<sub>2</sub></span>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">False</span>.
</span>
<div class="paragraph"> </div>

 Using this lemma, we can prove <span class="inlinecode"><span class="id" title="var">hstar_hsingle_same_loc</span></span>
    by unfolding the definition of <span class="inlinecode"><span class="id" title="var">hstar</span></span> to reveal the
    contradiction on the disjointness assumption. 
</div>
<div class="code">

<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Hprop.html#hsingle"><span class="id" title="definition">hsingle</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">E<sub>1</sub></span>&amp;<span class="id" title="var">E<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">E</span>). <span class="id" title="var">false</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">applys</span> <a class="idref" href="LibSepReference.html#Fmap.disjoint_single_single_same_inv"><span class="id" title="lemma">Fmap.disjoint_single_single_same_inv</span></a> <span class="id" title="var">D</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
More generally, a heap predicate of the form <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H</span></span> is generally
    suspicious in Separation Logic. In (the simplest variant of) Separation
    Logic, such a predicate can only be satisfied if <span class="inlinecode"><span class="id" title="var">H</span></span> covers no memory
    cell at all, that is, if <span class="inlinecode"><span class="id" title="var">H</span></span> is a pure predicate of the form <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">P</span>]</span>
    for some proposition <span class="inlinecode"><span class="id" title="var">P</span></span>. 
</div>

<div class="doc">
<a id="lab118"></a><h2 class="section">Consequence, Frame, and their Combination</h2>

<div class="paragraph"> </div>

 The rule of consequence in Separation Logic is similar to that
    in Hoare logic. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="triple_conseq" class="idref" href="#triple_conseq"><span class="id" title="axiom">triple_conseq</span></a> : <span class="id" title="keyword">∀</span> <a id="t:67" class="idref" href="#t:67"><span class="id" title="binder">t</span></a> <a id="H:68" class="idref" href="#H:68"><span class="id" title="binder">H</span></a> <a id="Q:69" class="idref" href="#Q:69"><span class="id" title="binder">Q</span></a> <a id="H':70" class="idref" href="#H':70"><span class="id" title="binder">H'</span></a> <a id="Q':71" class="idref" href="#Q':71"><span class="id" title="binder">Q'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:67"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H':70"><span class="id" title="variable">H'</span></a> <a class="idref" href="Himpl.html#Q':71"><span class="id" title="variable">Q'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H:68"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H':70"><span class="id" title="variable">H'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#Q':71"><span class="id" title="variable">Q'</span></a> <a class="idref" href="Himpl.html#28f43c6c1c00c11599fc86b7e27012f<sub>9</sub>"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Himpl.html#Q:69"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:67"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H:68"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#Q:69"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
Recall the frame rule introduced in the previous chapter. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="triple_frame" class="idref" href="#triple_frame"><span class="id" title="axiom">triple_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="t:73" class="idref" href="#t:73"><span class="id" title="binder">t</span></a> <a id="H:74" class="idref" href="#H:74"><span class="id" title="binder">H</span></a> <a id="Q:75" class="idref" href="#Q:75"><span class="id" title="binder">Q</span></a> <a id="H':76" class="idref" href="#H':76"><span class="id" title="binder">H'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:73"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H:74"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#Q:75"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:73"><span class="id" title="variable">t</span></a> (<a class="idref" href="Himpl.html#H:74"><span class="id" title="variable">H</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H':76"><span class="id" title="variable">H'</span></a>) (<a class="idref" href="Himpl.html#Q:75"><span class="id" title="variable">Q</span></a> <a class="idref" href="Hprop.html#9c07dc3fe866f600abcbb5cdf7c0a7fa"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Himpl.html#H':76"><span class="id" title="variable">H'</span></a>).<br/>
</div>

<div class="doc">
Observe that, stated as such, it is very unlikely for the frame rule
    to be applicable in practice, because the precondition must be exactly
    of the form <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H'</span></span> and the postcondition exactly of the form
    <span class="inlinecode"><span class="id" title="var">Q</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*+</span> <span class="inlinecode"><span class="id" title="var">H'</span></span>, for some <span class="inlinecode"><span class="id" title="var">H'</span></span>. For example, the frame rule would not apply
    to a proof obligation of the form <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">(<span class="id" title="var">H'</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H</span>)</span> <span class="inlinecode">(<span class="id" title="var">Q</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*+</span> <span class="inlinecode"><span class="id" title="var">H'</span>)</span>,
    simply because <span class="inlinecode"><span class="id" title="var">H'</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H</span></span> does not match <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H'</span></span>.

<div class="paragraph"> </div>

    This limitation of the frame rule can be addressed by combining the frame
    rule with the rule of consequence into a single rule, called the
    "consequence-frame rule". This rule, shown below, enables deriving
    a triple from another triple, without any restriction on the exact
    shape of the precondition and postcondition of the two triples involved. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triple_conseq_frame" class="idref" href="#triple_conseq_frame"><span class="id" title="lemma">triple_conseq_frame</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>2</sub>:78" class="idref" href="#H<sub>2</sub>:78"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>1</sub>:79" class="idref" href="#H<sub>1</sub>:79"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="Q<sub>1</sub>:80" class="idref" href="#Q<sub>1</sub>:80"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="t:81" class="idref" href="#t:81"><span class="id" title="binder">t</span></a> <a id="H:82" class="idref" href="#H:82"><span class="id" title="binder">H</span></a> <a id="Q:83" class="idref" href="#Q:83"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:81"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>:79"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Himpl.html#Q<sub>1</sub>:80"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H:82"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>:79"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:78"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#Q<sub>1</sub>:80"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="Hprop.html#9c07dc3fe866f600abcbb5cdf7c0a7fa"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:78"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Himpl.html#28f43c6c1c00c11599fc86b7e27012f<sub>9</sub>"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Himpl.html#Q:83"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:81"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H:82"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#Q:83"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
<a id="lab119"></a><h4 class="section">Exercise: 1 star, standard, especially useful (triple_conseq_frame)</h4>
 Prove the combined consequence-frame rule. 
</div>
<div class="code">

<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>


<div class="doc">
<a id="lab120"></a><h2 class="section">The Extraction Rules for Triples</h2>

<div class="paragraph"> </div>

 A judgment of the form <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">(<span class='gray-font'>\</span>[<span class="id" title="var">P</span>]</span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H</span>)</span> <span class="inlinecode"><span class="id" title="var">Q</span></span> is equivalent
    to <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span>. This structural rule is called <span class="inlinecode"><span class="id" title="var">triple_hpure</span></span>
    and formalized as shown below. It captures the extraction of the
    pure facts out of the precondition of a triple, in a similar way
    as <span class="inlinecode"><span class="id" title="var">himpl_hstar_hpure_l</span></span> for entailments. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="triple_hpure" class="idref" href="#triple_hpure"><span class="id" title="axiom">triple_hpure</span></a> : <span class="id" title="keyword">∀</span> <a id="t:84" class="idref" href="#t:84"><span class="id" title="binder">t</span></a> (<a id="P:85" class="idref" href="#P:85"><span class="id" title="binder">P</span></a>:<span class="id" title="keyword">Prop</span>) <a id="H:86" class="idref" href="#H:86"><span class="id" title="binder">H</span></a> <a id="Q:87" class="idref" href="#Q:87"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#P:85"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:84"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H:86"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#Q:87"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:84"><span class="id" title="variable">t</span></a> (<a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#P:85"><span class="id" title="variable">P</span></a><a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation">]</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H:86"><span class="id" title="variable">H</span></a>) <a class="idref" href="Himpl.html#Q:87"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
A judgment of the form <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">(<span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode"><span class="id" title="var">J</span></span> <span class="inlinecode"><span class="id" title="var">x</span>)</span> <span class="inlinecode"><span class="id" title="var">Q</span></span> is equivalent
    to <span class="inlinecode"><span class="id" title="keyword">∀</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode"><span class="id" title="var">triple</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">(<span class="id" title="var">J</span></span> <span class="inlinecode"><span class="id" title="var">x</span>)</span> <span class="inlinecode"><span class="id" title="var">Q</span></span>. This structural rule is called
    <span class="inlinecode"><span class="id" title="var">triple_hexists</span></span> and formalized as shown below. It captures the
    extraction of an existential quantifier out of the precondition
    of a triple, in a similar way as <span class="inlinecode"><span class="id" title="var">himpl_hexists_l</span></span> for entailments. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="triple_hexists" class="idref" href="#triple_hexists"><span class="id" title="axiom">triple_hexists</span></a> : <span class="id" title="keyword">∀</span> <a id="t:89" class="idref" href="#t:89"><span class="id" title="binder">t</span></a> (<a id="A:90" class="idref" href="#A:90"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>) (<a id="J:91" class="idref" href="#J:91"><span class="id" title="binder">J</span></a>:<a class="idref" href="Himpl.html#A:90"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>) <a id="Q:92" class="idref" href="#Q:92"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="x:93" class="idref" href="#x:93"><span class="id" title="binder">x</span></a>, <a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:89"><span class="id" title="variable">t</span></a> (<a class="idref" href="Himpl.html#J:91"><span class="id" title="variable">J</span></a> <a class="idref" href="Himpl.html#x:93"><span class="id" title="variable">x</span></a>) <a class="idref" href="Himpl.html#Q:92"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:89"><span class="id" title="variable">t</span></a> (<a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">∃</span></a> <a id="x:94" class="idref" href="#x:94"><span class="id" title="binder">x</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">,</span></a> <a class="idref" href="Himpl.html#J:91"><span class="id" title="variable">J</span></a> <a class="idref" href="Himpl.html#x:94"><span class="id" title="variable">x</span></a>) <a class="idref" href="Himpl.html#Q:92"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
<a id="lab121"></a><h1 class="section">More Details</h1>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="XsimplTactic" class="idref" href="#XsimplTactic"><span class="id" title="module">XsimplTactic</span></a>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">LibSepReference</span>.<br/>
<span class="id" title="keyword">Notation</span> <a id="XsimplTactic.:::'hprop'''" class="idref" href="#XsimplTactic.:::'hprop'''"><span class="id" title="notation">&quot;</span></a>'hprop''" := (<a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">Hprop.hprop</span></a>).<br/>
</div>

<div class="doc">
<a id="lab122"></a><h2 class="section">Identifying True and False Entailments</h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="XsimplTactic.CaseStudy" class="idref" href="#XsimplTactic.CaseStudy"><span class="id" title="module">CaseStudy</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> : <a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="notation">int</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="Himpl.html#XsimplTactic.CaseStudy"><span class="id" title="module">CaseStudy</span></a>.<br/>
</div>

<div class="doc">
<a id="lab123"></a><h2 class="section">Proving Entailments by Hand</h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="XsimplTactic.EntailmentProofs" class="idref" href="#XsimplTactic.EntailmentProofs"><span class="id" title="module">EntailmentProofs</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">p</span> : <a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">n</span> : <span class="id" title="notation">int</span>.<br/>
</div>

<div class="doc">
Proving an entailment by hand is generally a tedious task. This is why
    most Separation Logic based framework include an automated tactic for
    simplifying entailments. In this course, the relevant tactic is named
    <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>. Further in this chapter, we describe by means of examples the
    behavior of this tactic. But in order to best appreciate what the tactic
    provides and best understand how it works, it is very useful to complete
    a few proofs by hand. 
<div class="paragraph"> </div>

<a id="lab124"></a><h4 class="section">Exercise: 3 stars, standard, optional (himpl_example_1)</h4>
 Prove the example entailment below.
    Hint: exploit <span class="inlinecode"><span class="id" title="var">hstar_comm</span></span>, <span class="inlinecode"><span class="id" title="var">hstar_assoc</span></span>, or <span class="inlinecode"><span class="id" title="var">hstar_comm_assoc</span></span>
    which combines the two, and exploit <span class="inlinecode"><span class="id" title="var">himpl_frame_l</span></span> or <span class="inlinecode"><span class="id" title="var">himpl_frame_r</span></span>
    to cancel out matching pieces. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.EntailmentProofs.himpl_example_1" class="idref" href="#XsimplTactic.EntailmentProofs.himpl_example_1"><span class="id" title="lemma">himpl_example_1</span></a> : <span class="id" title="keyword">∀</span> <a id="p<sub>1</sub>:96" class="idref" href="#p<sub>1</sub>:96"><span class="id" title="binder">p<sub>1</sub></span></a> <a id="p<sub>2</sub>:97" class="idref" href="#p<sub>2</sub>:97"><span class="id" title="binder">p<sub>2</sub></span></a> <a id="p<sub>3</sub>:98" class="idref" href="#p<sub>3</sub>:98"><span class="id" title="binder">p<sub>3</sub></span></a> <a id="p<sub>4</sub>:99" class="idref" href="#p<sub>4</sub>:99"><span class="id" title="binder">p<sub>4</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Himpl.html#p<sub>1</sub>:96"><span class="id" title="variable">p<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> 6 <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#p<sub>2</sub>:97"><span class="id" title="variable">p<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> 7 <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#p<sub>3</sub>:98"><span class="id" title="variable">p<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> 8 <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#p<sub>4</sub>:99"><span class="id" title="variable">p<sub>4</sub></span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> 9<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#p<sub>4</sub>:99"><span class="id" title="variable">p<sub>4</sub></span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> 9 <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#p<sub>3</sub>:98"><span class="id" title="variable">p<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> 8 <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#p<sub>2</sub>:97"><span class="id" title="variable">p<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> 7 <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#p<sub>1</sub>:96"><span class="id" title="variable">p<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> 6.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab125"></a><h4 class="section">Exercise: 3 stars, standard, optional (himpl_example_2)</h4>
 Prove the example entailment below.
    Hint: use <span class="inlinecode"><span class="id" title="var">himpl_hstar_hpure_r</span></span> to extract pure facts, once they
    appear at the head of the left-hand side of the entailment. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.EntailmentProofs.himpl_example_2" class="idref" href="#XsimplTactic.EntailmentProofs.himpl_example_2"><span class="id" title="lemma">himpl_example_2</span></a> : <span class="id" title="keyword">∀</span> <a id="p<sub>1</sub>:100" class="idref" href="#p<sub>1</sub>:100"><span class="id" title="binder">p<sub>1</sub></span></a> <a id="p<sub>2</sub>:101" class="idref" href="#p<sub>2</sub>:101"><span class="id" title="binder">p<sub>2</sub></span></a> <a id="p<sub>3</sub>:102" class="idref" href="#p<sub>3</sub>:102"><span class="id" title="binder">p<sub>3</sub></span></a> <a id="n:103" class="idref" href="#n:103"><span class="id" title="binder">n</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Himpl.html#p<sub>1</sub>:100"><span class="id" title="variable">p<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> 6 <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#n:103"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;</span> 0<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#p<sub>2</sub>:101"><span class="id" title="variable">p<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> 7 <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#n:103"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&lt;</span> 0<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#p<sub>3</sub>:102"><span class="id" title="variable">p<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> 8.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab126"></a><h4 class="section">Exercise: 3 stars, standard, optional (himpl_example_3)</h4>
 Prove the example entailment below.
    Hint: use lemmas among <span class="inlinecode"><span class="id" title="var">himpl_hexists_r</span></span>, <span class="inlinecode"><span class="id" title="var">himpl_hexists_l</span></span>,
    <span class="inlinecode"><span class="id" title="var">himpl_hstar_hpure_r</span></span> and <span class="inlinecode"><span class="id" title="var">himpl_hstar_hpure_r</span></span> to deal with
    pure facts and quantifiers. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.EntailmentProofs.himpl_example_3" class="idref" href="#XsimplTactic.EntailmentProofs.himpl_example_3"><span class="id" title="lemma">himpl_example_3</span></a> : <span class="id" title="keyword">∀</span> <a id="p:104" class="idref" href="#p:104"><span class="id" title="binder">p</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="n:105" class="idref" href="#n:105"><span class="id" title="binder">n</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="Himpl.html#p:104"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Himpl.html#n:105"><span class="id" title="variable">n</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#n:105"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;</span> 0<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a id="n:106" class="idref" href="#n:106"><span class="id" title="binder">n</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">,</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#n:106"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;</span> 1<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#p:104"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#n:106"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a>1<a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="code">

<span class="id" title="keyword">End</span> <a class="idref" href="Himpl.html#XsimplTactic.EntailmentProofs"><span class="id" title="module">EntailmentProofs</span></a>.<br/>
</div>

<div class="doc">
<a id="lab127"></a><h2 class="section">The <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> Tactic</h2>

<div class="paragraph"> </div>

 Performing manual simplifications of entailments by hand is
    an extremely tedious task. Fortunately, it can be automated
    using specialized Coq tactic. This tactic, called <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>,
    applies to an entailment and implements a 3-step process:

<div class="paragraph"> </div>

    1. extract pure facts and existential quantifiers from the LHS,
    2. cancel out equal predicates occurring both in the LHS and RHS,
    3. generate subgoals for the pure facts occurring in the RHS, and
       instantiate the existential quantifiers from the RHS
       (using either unification variables or user-provided hints).

<div class="paragraph"> </div>

    These steps are detailed and illustrated next.

<div class="paragraph"> </div>

    The tactic <span class="inlinecode"><span class="id" title="var">xpull</span></span> is a degraded version of <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> that only
    performs the first step. We will also illustrate its usage. 
</div>

<div class="doc">
<a id="lab128"></a><h3 class="section"><span class="inlinecode"><span class="id" title="var">xsimpl</span></span> to Extract Pure Facts and Quantifiers in LHS</h3>

<div class="paragraph"> </div>

 The first feature of <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> is its ability to extract the
    pure facts and the existential quantifiers from the left-hand
    side out into the Coq context.

<div class="paragraph"> </div>

    In the example below, the pure fact <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">&gt;</span> <span class="inlinecode">0</span> appears in the LHS.
    After calling <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>, this pure fact is turned into an hypothesis,
    which may be introduced with a name into the Coq context. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xsimpl_demo_lhs_hpure" class="idref" href="#XsimplTactic.xsimpl_demo_lhs_hpure"><span class="id" title="lemma">xsimpl_demo_lhs_hpure</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:107" class="idref" href="#H<sub>1</sub>:107"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:108" class="idref" href="#H<sub>2</sub>:108"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:109" class="idref" href="#H<sub>3</sub>:109"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:110" class="idref" href="#H<sub>4</sub>:110"><span class="id" title="binder">H<sub>4</sub></span></a> (<a id="n:111" class="idref" href="#n:111"><span class="id" title="binder">n</span></a>:<span class="id" title="notation">int</span>),<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:107"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:108"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#n:111"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;</span> 0<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:109"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>4</sub>:110"><span class="id" title="variable">H<sub>4</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">Hn</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
In case the LHS includes a contradiction, such as the pure fact
    <span class="inlinecode"><span class="id" title="var">False</span></span>, the goal gets solved immediately by <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xsimpl_demo_lhs_hpure" class="idref" href="#XsimplTactic.xsimpl_demo_lhs_hpure"><span class="id" title="lemma">xsimpl_demo_lhs_hpure</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:112" class="idref" href="#H<sub>1</sub>:112"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:113" class="idref" href="#H<sub>2</sub>:113"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:114" class="idref" href="#H<sub>3</sub>:114"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:115" class="idref" href="#H<sub>4</sub>:115"><span class="id" title="binder">H<sub>4</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:112"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:113"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:114"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>4</sub>:115"><span class="id" title="variable">H<sub>4</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> tactic also extracts existential quantifier from the LHS.
    It turns them into universally quantified variables outside of the
    entailment relation, as illustrated through the following example. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xsimpl_demo_lhs_hexists" class="idref" href="#XsimplTactic.xsimpl_demo_lhs_hexists"><span class="id" title="lemma">xsimpl_demo_lhs_hexists</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:116" class="idref" href="#H<sub>1</sub>:116"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:117" class="idref" href="#H<sub>2</sub>:117"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:118" class="idref" href="#H<sub>3</sub>:118"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:119" class="idref" href="#H<sub>4</sub>:119"><span class="id" title="binder">H<sub>4</sub></span></a> (<a id="p:120" class="idref" href="#p:120"><span class="id" title="binder">p</span></a>:<a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:116"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">(</span></a><a id="n:121" class="idref" href="#n:121"><span class="id" title="binder">n</span></a>:<span class="id" title="notation">int</span><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">),</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#p:120"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Himpl.html#n:121"><span class="id" title="variable">n</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:117"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:118"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>4</sub>:119"><span class="id" title="variable">H<sub>4</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
A call to <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>, or to its degraded version <span class="inlinecode"><span class="id" title="var">xpull</span></span>, extract at once
    all the pure facts and quantifiers from the LHS, as illustrated next. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xsimpl_demo_lhs_several" class="idref" href="#XsimplTactic.xsimpl_demo_lhs_several"><span class="id" title="lemma">xsimpl_demo_lhs_several</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:122" class="idref" href="#H<sub>1</sub>:122"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:123" class="idref" href="#H<sub>2</sub>:123"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:124" class="idref" href="#H<sub>3</sub>:124"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:125" class="idref" href="#H<sub>4</sub>:125"><span class="id" title="binder">H<sub>4</sub></span></a> (<a id="p:126" class="idref" href="#p:126"><span class="id" title="binder">p</span></a> <a id="q:127" class="idref" href="#q:127"><span class="id" title="binder">q</span></a>:<a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:122"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">(</span></a><a id="n:128" class="idref" href="#n:128"><span class="id" title="binder">n</span></a>:<span class="id" title="notation">int</span><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">),</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#p:126"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Himpl.html#n:128"><span class="id" title="variable">n</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#n:128"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;</span> 0<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:123"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#p:126"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;&gt;'_x"><span class="id" title="notation">≠</span></a> <a class="idref" href="Himpl.html#q:127"><span class="id" title="variable">q</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:124"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>4</sub>:125"><span class="id" title="variable">H<sub>4</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">xsimpl</span>. <span class="comment">(*&nbsp;or&nbsp;<span class="inlinecode"><span class="id" title="var">xpull</span></span>&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">n</span> <span class="id" title="var">Hn</span> <span class="id" title="var">Hp</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
<a id="lab129"></a><h3 class="section"><span class="inlinecode"><span class="id" title="var">xsimpl</span></span> to Cancel Out Heap Predicates from LHS and RHS</h3>

<div class="paragraph"> </div>

 The second feature of <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> is its ability to cancel out similar
    heap predicates that occur on both sides of an entailment.

<div class="paragraph"> </div>

    In the example below, <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> occurs on both sides, so it is canceled
    out by <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xsimpl_demo_cancel_one" class="idref" href="#XsimplTactic.xsimpl_demo_cancel_one"><span class="id" title="lemma">xsimpl_demo_cancel_one</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:129" class="idref" href="#H<sub>1</sub>:129"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:130" class="idref" href="#H<sub>2</sub>:130"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:131" class="idref" href="#H<sub>3</sub>:131"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:132" class="idref" href="#H<sub>4</sub>:132"><span class="id" title="binder">H<sub>4</sub></span></a> <a id="H<sub>5</sub>:133" class="idref" href="#H<sub>5</sub>:133"><span class="id" title="binder">H<sub>5</sub></span></a> <a id="H<sub>6</sub>:134" class="idref" href="#H<sub>6</sub>:134"><span class="id" title="binder">H<sub>6</sub></span></a> <a id="H<sub>7</sub>:135" class="idref" href="#H<sub>7</sub>:135"><span class="id" title="binder">H<sub>7</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:129"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:130"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:131"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>4</sub>:132"><span class="id" title="variable">H<sub>4</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>5</sub>:133"><span class="id" title="variable">H<sub>5</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>6</sub>:134"><span class="id" title="variable">H<sub>6</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:130"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>7</sub>:135"><span class="id" title="variable">H<sub>7</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">xsimpl</span></span> actually cancels out at once all the heap predicates that it
    can spot appearing on both sides. In the example below, <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>, <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span>,
    and <span class="inlinecode"><span class="id" title="var">H<sub>4</sub></span></span> are canceled out. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xsimpl_demo_cancel_many" class="idref" href="#XsimplTactic.xsimpl_demo_cancel_many"><span class="id" title="lemma">xsimpl_demo_cancel_many</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:136" class="idref" href="#H<sub>1</sub>:136"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:137" class="idref" href="#H<sub>2</sub>:137"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:138" class="idref" href="#H<sub>3</sub>:138"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:139" class="idref" href="#H<sub>4</sub>:139"><span class="id" title="binder">H<sub>4</sub></span></a> <a id="H<sub>5</sub>:140" class="idref" href="#H<sub>5</sub>:140"><span class="id" title="binder">H<sub>5</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:136"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:137"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:138"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>4</sub>:139"><span class="id" title="variable">H<sub>4</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>4</sub>:139"><span class="id" title="variable">H<sub>4</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:138"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>5</sub>:140"><span class="id" title="variable">H<sub>5</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:137"><span class="id" title="variable">H<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
If all the pieces of heap predicate get canceled out, the remaining
    proof obligation is <span class="inlinecode"><span class='gray-font'>\</span>[]</span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class='gray-font'>\</span>[]</span>. In this case, <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> automatically
    solves the goal by invoking the reflexivity property of entailment. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xsimpl_demo_cancel_all" class="idref" href="#XsimplTactic.xsimpl_demo_cancel_all"><span class="id" title="lemma">xsimpl_demo_cancel_all</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:141" class="idref" href="#H<sub>1</sub>:141"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:142" class="idref" href="#H<sub>2</sub>:142"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:143" class="idref" href="#H<sub>3</sub>:143"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:144" class="idref" href="#H<sub>4</sub>:144"><span class="id" title="binder">H<sub>4</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:141"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:142"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:143"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>4</sub>:144"><span class="id" title="variable">H<sub>4</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>4</sub>:144"><span class="id" title="variable">H<sub>4</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:143"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>:141"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:142"><span class="id" title="variable">H<sub>2</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab130"></a><h3 class="section"><span class="inlinecode"><span class="id" title="var">xsimpl</span></span> to Instantiate Pure Facts and Quantifiers in RHS</h3>

<div class="paragraph"> </div>

 The third feature of <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> is its ability to extract pure facts
    from the RHS as separate subgoals, and to instantiate existential
    quantifiers from the RHS.

<div class="paragraph"> </div>

    Let us first illustrate how it deals with pure facts. In the example
    below, the fact <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">&gt;</span> <span class="inlinecode">0</span> gets spawned in a separated subgoal. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xsimpl_demo_rhs_hpure" class="idref" href="#XsimplTactic.xsimpl_demo_rhs_hpure"><span class="id" title="lemma">xsimpl_demo_rhs_hpure</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:145" class="idref" href="#H<sub>1</sub>:145"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:146" class="idref" href="#H<sub>2</sub>:146"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:147" class="idref" href="#H<sub>3</sub>:147"><span class="id" title="binder">H<sub>3</sub></span></a> (<a id="n:148" class="idref" href="#n:148"><span class="id" title="binder">n</span></a>:<span class="id" title="notation">int</span>),<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:145"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:146"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#n:148"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;</span> 0<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:147"><span class="id" title="variable">H<sub>3</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
When it encounters an existential quantifier in the RHS, the <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>
    tactic introduces a unification variable denoted by a question mark,
    that is, an "evar", in Coq terminology. In the example below, the <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>
    tactic turns <span class="inlinecode"><span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">n</span>,</span> <span class="inlinecode">..</span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode">~~&gt;</span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">..</span> into <span class="inlinecode">..</span> <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode">~~&gt;</span> <span class="inlinecode">?<span class="id" title="var">x</span></span> <span class="inlinecode">..</span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xsimpl_demo_rhs_hexists" class="idref" href="#XsimplTactic.xsimpl_demo_rhs_hexists"><span class="id" title="lemma">xsimpl_demo_rhs_hexists</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:149" class="idref" href="#H<sub>1</sub>:149"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:150" class="idref" href="#H<sub>2</sub>:150"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:151" class="idref" href="#H<sub>3</sub>:151"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:152" class="idref" href="#H<sub>4</sub>:152"><span class="id" title="binder">H<sub>4</sub></span></a> (<a id="p:153" class="idref" href="#p:153"><span class="id" title="binder">p</span></a>:<a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:149"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:150"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">(</span></a><a id="n:154" class="idref" href="#n:154"><span class="id" title="binder">n</span></a>:<span class="id" title="notation">int</span><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">),</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#p:153"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Himpl.html#n:154"><span class="id" title="variable">n</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:151"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>4</sub>:152"><span class="id" title="variable">H<sub>4</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
The "evar" often gets subsequently instantiated as a result of
    a cancellation step. For example, in the example below, <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>
    instantiates the existentially quantified variable <span class="inlinecode"><span class="id" title="var">n</span></span> as <span class="inlinecode">?<span class="id" title="var">x</span></span>,
    then cancels out <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode">~~&gt;</span> <span class="inlinecode">?<span class="id" title="var">x</span></span> from the LHS against <span class="inlinecode"><span class="id" title="var">p</span></span> <span class="inlinecode">~~&gt;</span> <span class="inlinecode">3</span> on
    the right-hand-side, thereby unifying <span class="inlinecode">?<span class="id" title="var">x</span></span> with <span class="inlinecode">3</span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xsimpl_demo_rhs_hexists_unify" class="idref" href="#XsimplTactic.xsimpl_demo_rhs_hexists_unify"><span class="id" title="lemma">xsimpl_demo_rhs_hexists_unify</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:155" class="idref" href="#H<sub>1</sub>:155"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:156" class="idref" href="#H<sub>2</sub>:156"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:157" class="idref" href="#H<sub>3</sub>:157"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:158" class="idref" href="#H<sub>4</sub>:158"><span class="id" title="binder">H<sub>4</sub></span></a> (<a id="p:159" class="idref" href="#p:159"><span class="id" title="binder">p</span></a>:<a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:155"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#p:159"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> 3<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:156"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">(</span></a><a id="n:160" class="idref" href="#n:160"><span class="id" title="binder">n</span></a>:<span class="id" title="notation">int</span><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">),</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#p:159"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Himpl.html#n:160"><span class="id" title="variable">n</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:157"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>4</sub>:158"><span class="id" title="variable">H<sub>4</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
The instantiation of the evar <span class="inlinecode">?<span class="id" title="var">x</span></span> can be observed if there is
    another occurrence of the same variable in the entailment.
    In the next example, which refines the previous one, observe how
    <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">&gt;</span> <span class="inlinecode">0</span> becomes <span class="inlinecode">3</span> <span class="inlinecode">&gt;</span> <span class="inlinecode">0</span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xsimpl_demo_rhs_hexists_unify_view" class="idref" href="#XsimplTactic.xsimpl_demo_rhs_hexists_unify_view"><span class="id" title="lemma">xsimpl_demo_rhs_hexists_unify_view</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:161" class="idref" href="#H<sub>1</sub>:161"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:162" class="idref" href="#H<sub>2</sub>:162"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>4</sub>:163" class="idref" href="#H<sub>4</sub>:163"><span class="id" title="binder">H<sub>4</sub></span></a> (<a id="p:164" class="idref" href="#p:164"><span class="id" title="binder">p</span></a>:<a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:161"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#p:164"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> 3<a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:162"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">(</span></a><a id="n:165" class="idref" href="#n:165"><span class="id" title="binder">n</span></a>:<span class="id" title="notation">int</span><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">),</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#p:164"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Himpl.html#n:165"><span class="id" title="variable">n</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#n:165"><span class="id" title="variable">n</span></a> <span class="id" title="notation">&gt;</span> 0<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a><a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation">)</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>4</sub>:163"><span class="id" title="variable">H<sub>4</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
(Advanced.) In some cases, it is desirable to provide an explicit value
    for instantiating an existential quantifier that occurs in the RHS.
    The <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> tactic accepts arguments, which will be used to instantiate
    the existentials (on a first-match basis). The syntax is <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span></span> <span class="inlinecode">..</span> <span class="inlinecode"><span class="id" title="var">vn</span></span>,
    or <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> <span class="inlinecode">(&gt;&gt;</span> <span class="inlinecode"><span class="id" title="var">v<sub>1</sub></span></span> <span class="inlinecode">..</span> <span class="inlinecode"><span class="id" title="var">vn</span>)</span> in the case <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode">&gt;</span> <span class="inlinecode">3</span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xsimpl_demo_rhs_hints" class="idref" href="#XsimplTactic.xsimpl_demo_rhs_hints"><span class="id" title="lemma">xsimpl_demo_rhs_hints</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:166" class="idref" href="#H<sub>1</sub>:166"><span class="id" title="binder">H<sub>1</sub></span></a> (<a id="p:167" class="idref" href="#p:167"><span class="id" title="binder">p</span></a> <a id="q:168" class="idref" href="#q:168"><span class="id" title="binder">q</span></a>:<a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:166"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">(</span></a><a id="n:169" class="idref" href="#n:169"><span class="id" title="binder">n</span></a> <a id="m:170" class="idref" href="#m:170"><span class="id" title="binder">m</span></a>:<span class="id" title="notation">int</span><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">),</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#p:167"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Himpl.html#n:169"><span class="id" title="variable">n</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#q:168"><span class="id" title="variable">q</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Himpl.html#m:170"><span class="id" title="variable">m</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span> 3 4.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
(Advanced.) If two existential quantifiers quantify variables of the same
    type, it is possible to provide a value for only the second quantifier
    by passing as first argument to <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> the special value <span class="inlinecode"><span class="id" title="var">__</span></span>.
    The following example shows how, on LHS of the form <span class="inlinecode"><span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> <span class="inlinecode"><span class="id" title="var">m</span>,</span> <span class="inlinecode">...</span>,
    the tactic <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> <span class="inlinecode"><span class="id" title="var">__</span></span> <span class="inlinecode">4</span> instantiates <span class="inlinecode"><span class="id" title="var">m</span></span> with <span class="inlinecode">4</span> while leaving <span class="inlinecode"><span class="id" title="var">n</span></span>
    as an unresolved evar. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xsimpl_demo_rhs_hints_evar" class="idref" href="#XsimplTactic.xsimpl_demo_rhs_hints_evar"><span class="id" title="lemma">xsimpl_demo_rhs_hints_evar</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:171" class="idref" href="#H<sub>1</sub>:171"><span class="id" title="binder">H<sub>1</sub></span></a> (<a id="p:172" class="idref" href="#p:172"><span class="id" title="binder">p</span></a> <a id="q:173" class="idref" href="#q:173"><span class="id" title="binder">q</span></a>:<a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:171"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">(</span></a><a id="n:174" class="idref" href="#n:174"><span class="id" title="binder">n</span></a> <a id="m:175" class="idref" href="#m:175"><span class="id" title="binder">m</span></a>:<span class="id" title="notation">int</span><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">),</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#p:172"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Himpl.html#n:174"><span class="id" title="variable">n</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#q:173"><span class="id" title="variable">q</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Himpl.html#m:175"><span class="id" title="variable">m</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span> <span class="id" title="notation">__</span> 4.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
<a id="lab131"></a><h3 class="section"><span class="inlinecode"><span class="id" title="var">xsimpl</span></span> on Entailments Between Postconditions</h3>

<div class="paragraph"> </div>

 The tactic <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> also applies on goals of the form <span class="inlinecode"><span class="id" title="var">Q<sub>1</sub></span></span> <span class="inlinecode">===&gt;</span> <span class="inlinecode"><span class="id" title="var">Q<sub>2</sub></span></span>.

<div class="paragraph"> </div>

    For such goals, it unfolds the definition of <span class="inlinecode">===&gt;</span> to reveal an
    entailment of the form <span class="inlinecode">==&gt;</span>, then invokes the <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> tactic. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.qimpl_example_1" class="idref" href="#XsimplTactic.qimpl_example_1"><span class="id" title="lemma">qimpl_example_1</span></a> : <span class="id" title="keyword">∀</span> (<a id="Q<sub>1</sub>:176" class="idref" href="#Q<sub>1</sub>:176"><span class="id" title="binder">Q<sub>1</sub></span></a> <a id="Q<sub>2</sub>:177" class="idref" href="#Q<sub>2</sub>:177"><span class="id" title="binder">Q<sub>2</sub></span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) (<a id="H<sub>2</sub>:178" class="idref" href="#H<sub>2</sub>:178"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:179" class="idref" href="#H<sub>3</sub>:179"><span class="id" title="binder">H<sub>3</sub></span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#Q<sub>1</sub>:176"><span class="id" title="variable">Q<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:178"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#9351a4f098e275023c32e0091e608189"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Himpl.html#Q<sub>2</sub>:177"><span class="id" title="variable">Q<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:178"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#635f8491703dab9d0d18a6c2474b0d2a"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:179"><span class="id" title="variable">H<sub>3</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">xsimpl</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">r</span>. <span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
<a id="lab132"></a><h3 class="section">Example of Entailment Proofs using <span class="inlinecode"><span class="id" title="var">xsimpl</span></span></h3>

</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.himpl_example_1" class="idref" href="#XsimplTactic.himpl_example_1"><span class="id" title="lemma">himpl_example_1</span></a> : <span class="id" title="keyword">∀</span> (<a id="p:180" class="idref" href="#p:180"><span class="id" title="binder">p</span></a>:<a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#p:180"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> 3 <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">(</span></a><a id="n:181" class="idref" href="#n:181"><span class="id" title="binder">n</span></a>:<span class="id" title="notation">int</span><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">),</span></a> <a class="idref" href="Himpl.html#p:180"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Himpl.html#n:181"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">xsimpl</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.himpl_example_2" class="idref" href="#XsimplTactic.himpl_example_2"><span class="id" title="lemma">himpl_example_2</span></a> : <span class="id" title="keyword">∀</span> (<a id="p:182" class="idref" href="#p:182"><span class="id" title="binder">p</span></a> <a id="q:183" class="idref" href="#q:183"><span class="id" title="binder">q</span></a>:<a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#p:182"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> 3 <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#q:183"><span class="id" title="variable">q</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> 3 <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">(</span></a><a id="n:184" class="idref" href="#n:184"><span class="id" title="binder">n</span></a>:<span class="id" title="notation">int</span><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">),</span></a> <a class="idref" href="Himpl.html#p:182"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Himpl.html#n:184"><span class="id" title="variable">n</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#q:183"><span class="id" title="variable">q</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Himpl.html#n:184"><span class="id" title="variable">n</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">xsimpl</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.himpl_example_4" class="idref" href="#XsimplTactic.himpl_example_4"><span class="id" title="lemma">himpl_example_4</span></a> : <span class="id" title="keyword">∀</span> (<a id="p:185" class="idref" href="#p:185"><span class="id" title="binder">p</span></a>:<a class="idref" href="LibSepReference.html#loc"><span class="id" title="definition">loc</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">(</span></a><a id="n:186" class="idref" href="#n:186"><span class="id" title="binder">n</span></a>:<span class="id" title="notation">int</span><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">),</span></a> <a class="idref" href="Himpl.html#p:185"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="Himpl.html#n:186"><span class="id" title="variable">n</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">\</span></a><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">∃</span></a> <a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">(</span></a><a id="m:187" class="idref" href="#m:187"><span class="id" title="binder">m</span></a>:<span class="id" title="notation">int</span><a class="idref" href="LibSepReference.html#961b41dcd8e5f7d3252676574333c51d"><span class="id" title="notation">),</span></a> <a class="idref" href="Himpl.html#p:185"><span class="id" title="variable">p</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">~~&gt;</span></a> <a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#m:187"><span class="id" title="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> 1<a class="idref" href="LibSepReference.html#04d59e26c33e7500ff8979242a3d649f"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="comment">(*&nbsp;observe&nbsp;that&nbsp;<span class="inlinecode"><span class="id" title="var">xsimpl</span></span>&nbsp;here&nbsp;does&nbsp;not&nbsp;work&nbsp;well.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">xpull</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">n</span>. <span class="id" title="var">xsimpl</span> (<span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a>1).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">n</span><a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#::Z_scope:x_'-'_x"><span class="id" title="notation">-</span></a>1<a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a>1) <span class="id" title="keyword">with</span> <span class="id" title="var">n</span>. { <span class="id" title="tactic">auto</span>. } { <span class="id" title="var">math</span>. }<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;variant&nbsp;for&nbsp;the&nbsp;last&nbsp;line:<br/>
&nbsp;&nbsp;applys_eq&nbsp;himpl_refl.&nbsp;fequal.&nbsp;math.&nbsp;*)</span><br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.himpl_example_5" class="idref" href="#XsimplTactic.himpl_example_5"><span class="id" title="lemma">himpl_example_5</span></a> : <span class="id" title="keyword">∀</span> (<a id="H:188" class="idref" href="#H:188"><span class="id" title="binder">H</span></a>:<a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#False"><span class="id" title="inductive">False</span></a><a class="idref" href="LibSepReference.html#d090ebaffe5a082b6a27552ccf013e<sub>09</sub>"><span class="id" title="notation">]</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H:188"><span class="id" title="variable">H</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">xsimpl</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab133"></a><h2 class="section">The <span class="inlinecode"><span class="id" title="var">xchange</span></span> Tactic</h2>

<div class="paragraph"> </div>

 The tactic <span class="inlinecode"><span class="id" title="var">xchange</span></span> is to entailment what <span class="inlinecode"><span class="id" title="tactic">rewrite</span></span> is to equality.

<div class="paragraph"> </div>

    Assume an entailment goal of the form <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>4</sub></span></span>.
    Assume an entailment assumption <span class="inlinecode"><span class="id" title="var">M</span></span>, say <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub>'</span></span>.
    Then <span class="inlinecode"><span class="id" title="var">xchange</span></span> <span class="inlinecode"><span class="id" title="var">M</span></span> turns the goal into <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub>'</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>3</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>4</sub></span></span>,
    effectively replacing <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> with <span class="inlinecode"><span class="id" title="var">H<sub>2</sub>'</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xchange_demo_base" class="idref" href="#XsimplTactic.xchange_demo_base"><span class="id" title="lemma">xchange_demo_base</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:189" class="idref" href="#H<sub>1</sub>:189"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:190" class="idref" href="#H<sub>2</sub>:190"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>2</sub>':191" class="idref" href="#H<sub>2</sub>':191"><span class="id" title="binder">H<sub>2</sub>'</span></a> <a id="H<sub>3</sub>:192" class="idref" href="#H<sub>3</sub>:192"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:193" class="idref" href="#H<sub>4</sub>:193"><span class="id" title="binder">H<sub>4</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>2</sub>:190"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>':191"><span class="id" title="variable">H<sub>2</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:189"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:190"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:192"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>4</sub>:193"><span class="id" title="variable">H<sub>4</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">xchange</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Note&nbsp;that&nbsp;freshly&nbsp;produced&nbsp;items&nbsp;appear&nbsp;to&nbsp;the&nbsp;front&nbsp;*)</span><br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
The tactic <span class="inlinecode"><span class="id" title="var">xchange</span></span> can also take as argument equalities.
    The tactic <span class="inlinecode"><span class="id" title="var">xchange</span></span> <span class="inlinecode"><span class="id" title="var">M</span></span> exploits the left-to-right direction of an
    equality <span class="inlinecode"><span class="id" title="var">M</span></span>, whereas <span class="inlinecode"><span class="id" title="var">xchange</span></span> <span class="inlinecode">&lt;-</span> <span class="inlinecode"><span class="id" title="var">M</span></span> exploits the right-to-left
    direction . 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xchange_demo_eq" class="idref" href="#XsimplTactic.xchange_demo_eq"><span class="id" title="lemma">xchange_demo_eq</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:194" class="idref" href="#H<sub>1</sub>:194"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:195" class="idref" href="#H<sub>2</sub>:195"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:196" class="idref" href="#H<sub>3</sub>:196"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:197" class="idref" href="#H<sub>4</sub>:197"><span class="id" title="binder">H<sub>4</sub></span></a> <a id="H<sub>5</sub>:198" class="idref" href="#H<sub>5</sub>:198"><span class="id" title="binder">H<sub>5</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:194"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:196"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Himpl.html#H<sub>5</sub>:198"><span class="id" title="variable">H<sub>5</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:194"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:195"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:196"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>4</sub>:197"><span class="id" title="variable">H<sub>4</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">xchange</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">xchange</span> &lt;- <span class="id" title="var">M</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
The tactic <span class="inlinecode"><span class="id" title="var">xchange</span></span> <span class="inlinecode"><span class="id" title="var">M</span></span> does accept a lemma or hypothesis <span class="inlinecode"><span class="id" title="var">M</span></span>
    featuring universal quantifiers, as long as its conclusion
    is an equality or an entailment. In such case, <span class="inlinecode"><span class="id" title="var">xchange</span></span> <span class="inlinecode"><span class="id" title="var">M</span></span>
    instantiates <span class="inlinecode"><span class="id" title="var">M</span></span> before attemting to perform a replacement. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xchange_demo_inst" class="idref" href="#XsimplTactic.xchange_demo_inst"><span class="id" title="lemma">xchange_demo_inst</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:199" class="idref" href="#H<sub>1</sub>:199"><span class="id" title="binder">H<sub>1</sub></span></a> (<a id="J:200" class="idref" href="#J:200"><span class="id" title="binder">J</span></a> <a id="J':201" class="idref" href="#J':201"><span class="id" title="binder">J'</span></a>:<span class="id" title="notation">int</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#SepSimplArgs.hprop"><span class="id" title="definition">hprop</span></a>) <a id="H<sub>3</sub>:202" class="idref" href="#H<sub>3</sub>:202"><span class="id" title="binder">H<sub>3</sub></span></a> <a id="H<sub>4</sub>:203" class="idref" href="#H<sub>4</sub>:203"><span class="id" title="binder">H<sub>4</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="n:204" class="idref" href="#n:204"><span class="id" title="binder">n</span></a>, <a class="idref" href="Himpl.html#J:200"><span class="id" title="variable">J</span></a> <a class="idref" href="Himpl.html#n:204"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Himpl.html#J':201"><span class="id" title="variable">J'</span></a> (<a class="idref" href="Himpl.html#n:204"><span class="id" title="variable">n</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a>1)<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:199"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#J:200"><span class="id" title="variable">J</span></a> 3 <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:202"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>4</sub>:203"><span class="id" title="variable">H<sub>4</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="var">xchange</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Note&nbsp;that&nbsp;freshly&nbsp;produced&nbsp;items&nbsp;appear&nbsp;to&nbsp;the&nbsp;front&nbsp;*)</span><br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
How does the <span class="inlinecode"><span class="id" title="var">xchange</span></span> tactic work? Consider a goal of the form <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H'</span></span>
    and assume <span class="inlinecode"><span class="id" title="var">xchange</span></span> is invoked with an hypothesis of type <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub>'</span></span>
    as argument. The tactic <span class="inlinecode"><span class="id" title="var">xchange</span></span> should attempt to decompose <span class="inlinecode"><span class="id" title="var">H</span></span> as the
    star of <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> and the rest of <span class="inlinecode"><span class="id" title="var">H</span></span>, call it <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>. If it succeeds, then the
    goal <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H'</span></span> can be rewritten as <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H'</span></span>. To exploit the
    hypothesis <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub>'</span></span>, the tactic should replace the goal with the
    entailment <span class="inlinecode"><span class="id" title="var">H<sub>1</sub>'</span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H'</span></span>. The lemma shown below captures this piece
    of reasoning implemented by the tactic <span class="inlinecode"><span class="id" title="var">xchange</span></span>. 
<div class="paragraph"> </div>

<a id="lab134"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (xchange_lemma)</h4>
 Prove, without using the tactic <span class="inlinecode"><span class="id" title="var">xchange</span></span>, the following lemma which
    captures the internal working of <span class="inlinecode"><span class="id" title="var">xchange</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="XsimplTactic.xchange_lemma" class="idref" href="#XsimplTactic.xchange_lemma"><span class="id" title="lemma">xchange_lemma</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:205" class="idref" href="#H<sub>1</sub>:205"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>1</sub>':206" class="idref" href="#H<sub>1</sub>':206"><span class="id" title="binder">H<sub>1</sub>'</span></a> <a id="H:207" class="idref" href="#H:207"><span class="id" title="binder">H</span></a> <a id="H':208" class="idref" href="#H':208"><span class="id" title="binder">H'</span></a> <a id="H<sub>2</sub>:209" class="idref" href="#H<sub>2</sub>:209"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:205"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>':206"><span class="id" title="variable">H<sub>1</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H:207"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>:205"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:209"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>':206"><span class="id" title="variable">H<sub>1</sub>'</span></a> <a class="idref" href="LibSepReference.html#6e7aeeae3643da4efcca62b993bbca40"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:209"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H':208"><span class="id" title="variable">H'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H:207"><span class="id" title="variable">H</span></a> <a class="idref" href="LibSepReference.html#c7ebd77e939e3f02c508e57b470dc021"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H':208"><span class="id" title="variable">H'</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="code">

<span class="id" title="keyword">End</span> <a class="idref" href="Himpl.html#XsimplTactic"><span class="id" title="module">XsimplTactic</span></a>.<br/>
</div>

<div class="doc">
<a id="lab135"></a><h1 class="section">Optional Material</h1>

</div>

<div class="doc">
<a id="lab136"></a><h2 class="section">Proofs for the Separation Algebra</h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="FundamentalProofs" class="idref" href="#FundamentalProofs"><span class="id" title="module">FundamentalProofs</span></a>.<br/>
</div>

<div class="doc">
We next show the details of the proofs establishing the fundamental
    properties of the Separation Logic operators.

<div class="paragraph"> </div>

    Note that all these results must be proved without help of the tactic
    <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>, because the implementation of the tactic <span class="inlinecode"><span class="id" title="var">xsimpl</span></span> itself
    depends on these fundamental properties.

<div class="paragraph"> </div>

    We begin with the frame property, which is the simplest to prove. 
<div class="paragraph"> </div>

<a id="lab137"></a><h4 class="section">Exercise: 1 star, standard, especially useful (himpl_frame_l)</h4>
 Prove the frame property for entailment.
    Hint: unfold the definition of <span class="inlinecode"><span class="id" title="var">hstar</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="FundamentalProofs.himpl_frame_l" class="idref" href="#FundamentalProofs.himpl_frame_l"><span class="id" title="lemma">himpl_frame_l</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>2</sub>:210" class="idref" href="#H<sub>2</sub>:210"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>1</sub>:211" class="idref" href="#H<sub>1</sub>:211"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>1</sub>':212" class="idref" href="#H<sub>1</sub>':212"><span class="id" title="binder">H<sub>1</sub>'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:211"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>':212"><span class="id" title="variable">H<sub>1</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>1</sub>:211"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:210"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">)</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>1</sub>':212"><span class="id" title="variable">H<sub>1</sub>'</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:210"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab138"></a><h4 class="section">Exercise: 1 star, standard, especially useful (himpl_frame_r)</h4>
 Prove the lemma <span class="inlinecode"><span class="id" title="var">himpl_frame_r</span></span>, symmetric to <span class="inlinecode"><span class="id" title="var">himpl_frame_l</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="FundamentalProofs.himpl_frame_r" class="idref" href="#FundamentalProofs.himpl_frame_r"><span class="id" title="lemma">himpl_frame_r</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:213" class="idref" href="#H<sub>1</sub>:213"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:214" class="idref" href="#H<sub>2</sub>:214"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>2</sub>':215" class="idref" href="#H<sub>2</sub>':215"><span class="id" title="binder">H<sub>2</sub>'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>2</sub>:214"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>':215"><span class="id" title="variable">H<sub>2</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>1</sub>:213"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:214"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">)</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>1</sub>:213"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>':215"><span class="id" title="variable">H<sub>2</sub>'</span></a><a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 The second simplest result is the extrusion property for existentials.
    To begin with, we exploit the antisymmetry of entailment to turn
    the equality into a conjunction of two entailments. Then, it is simply
    a matter of unfolding the definitions of <span class="inlinecode"><span class="id" title="var">hexists</span></span>, <span class="inlinecode"><span class="id" title="var">hstar</span></span> and <span class="inlinecode">==&gt;</span>.

<div class="paragraph"> </div>

    By default, Coq does not display any of the parentheses written in
    the statement below, making the proof obligation somewhat confusing.
This is a small price to pay in exchange for maximal flexibility
    in allowing the parsing of unparenthesized expressions such as
    <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> and <span class="inlinecode"><span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span>.

<div class="paragraph"> </div>

    As a result, for this proof and the subsequent ones form this section,
    you should consider activating the display of parentheses. In CoqIDE,
    use the "View" menu, check "Display Parentheses". Alternatively, use
    the command "Set Printing Parentheses", or even "Set Printing All". 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="FundamentalProofs.hstar_hexists" class="idref" href="#FundamentalProofs.hstar_hexists"><span class="id" title="lemma">hstar_hexists</span></a> : <span class="id" title="keyword">∀</span> <a id="A:216" class="idref" href="#A:216"><span class="id" title="binder">A</span></a> (<a id="J:217" class="idref" href="#J:217"><span class="id" title="binder">J</span></a>:<a class="idref" href="Himpl.html#A:216"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>) <a id="H:218" class="idref" href="#H:218"><span class="id" title="binder">H</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">∃</span></a> <a id="x:219" class="idref" href="#x:219"><span class="id" title="binder">x</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">,</span></a> <a class="idref" href="Himpl.html#J:217"><span class="id" title="variable">J</span></a> <a class="idref" href="Himpl.html#x:219"><span class="id" title="variable">x</span></a><a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H:218"><span class="id" title="variable">H</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">∃</span></a> <a id="x:220" class="idref" href="#x:220"><span class="id" title="binder">x</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">,</span></a> <a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#J:217"><span class="id" title="variable">J</span></a> <a class="idref" href="Himpl.html#x:220"><span class="id" title="variable">x</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H:218"><span class="id" title="variable">H</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#himpl_antisym"><span class="id" title="axiom">himpl_antisym</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">M<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">U</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">x</span>&amp;<span class="id" title="var">M<sub>1</sub></span>). <span class="id" title="tactic">∃</span>* <span class="id" title="var">x</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">h<sub>2</sub></span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> (<span class="id" title="var">x</span>&amp;<span class="id" title="var">M</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">M</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">M<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">U</span>). <span class="id" title="tactic">∃</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">h<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">splits</span>¬. <span class="id" title="tactic">∃</span>* <span class="id" title="var">x</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
There remains to establish the commutativity and associativity of the star
    operator, and the fact that the empty heap predicate is its neutral element.
    To establish these properties, we need to exploit a few basic facts about
    finite maps. We introduce them as we go along. 
<div class="paragraph"> </div>

 To prove the commutativity of the star operator, i.e. <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>,
    it is sufficient to prove the entailement in one direction, e.g.,
    <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode">==&gt;</span> <span class="inlinecode"><span class="id" title="var">H<sub>2</sub></span></span> <span class="inlinecode"><span class='gray-font'>\</span>*</span> <span class="inlinecode"><span class="id" title="var">H<sub>1</sub></span></span>. Indeed, the other other direction is symmetrical.
    The symmetry argument is captured by the following lemma, which we will
    exploit in the proof of <span class="inlinecode"><span class="id" title="var">hstar_comm</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="FundamentalProofs.hprop_op_comm" class="idref" href="#FundamentalProofs.hprop_op_comm"><span class="id" title="lemma">hprop_op_comm</span></a> : <span class="id" title="keyword">∀</span> (<a id="op:221" class="idref" href="#op:221"><span class="id" title="binder">op</span></a>:<a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:222" class="idref" href="#H<sub>1</sub>:222"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:223" class="idref" href="#H<sub>2</sub>:223"><span class="id" title="binder">H<sub>2</sub></span></a>, <a class="idref" href="Himpl.html#op:221"><span class="id" title="variable">op</span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>:222"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:223"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#op:221"><span class="id" title="variable">op</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:223"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>:222"><span class="id" title="variable">H<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:224" class="idref" href="#H<sub>1</sub>:224"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:225" class="idref" href="#H<sub>2</sub>:225"><span class="id" title="binder">H<sub>2</sub></span></a>, <a class="idref" href="Himpl.html#op:221"><span class="id" title="variable">op</span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>:224"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:225"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Himpl.html#op:221"><span class="id" title="variable">op</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:225"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>:224"><span class="id" title="variable">H<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#himpl_antisym"><span class="id" title="axiom">himpl_antisym</span></a>; <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
To prove commutativity of star, we need to exploit the fact that the union
    of two finite maps with disjoint domains commutes. This fact is captured
    by the following lemma.
<br/>
<span class="inlinecode">&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Check</span> <span class="id" title="var">Fmap.union_comm_of_disjoint</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">h<sub>2</sub></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Fmap.disjoint</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">h<sub>2</sub></span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">h<sub>1</sub></span> \<span class="id" title="var">u</span> <span class="id" title="var">h<sub>2</sub></span> = <span class="id" title="var">h<sub>2</sub></span> \<span class="id" title="var">u</span> <span class="id" title="var">h<sub>1</sub></span>.
</span>    The commutativity result is then proved as follows. Observe the use of
    the lemma <span class="inlinecode"><span class="id" title="var">hprop_op_comm</span></span>, which allows establishing the entailment in
    only one of the two directions.

</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="FundamentalProofs.hstar_comm" class="idref" href="#FundamentalProofs.hstar_comm"><span class="id" title="lemma">hstar_comm</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:226" class="idref" href="#H<sub>1</sub>:226"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:227" class="idref" href="#H<sub>2</sub>:227"><span class="id" title="binder">H<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="Himpl.html#H<sub>1</sub>:226"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:227"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:227"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>:226"><span class="id" title="variable">H<sub>1</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#FundamentalProofs.hprop_op_comm"><span class="id" title="lemma">hprop_op_comm</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">M<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">U</span>). <span class="id" title="tactic">∃</span> <span class="id" title="var">h<sub>2</sub></span> <span class="id" title="var">h<sub>1</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">splits</span>¬. { <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#Fmap.union_comm_of_disjoint"><span class="id" title="lemma">Fmap.union_comm_of_disjoint</span></a>; <span class="id" title="tactic">auto</span>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab139"></a><h4 class="section">Exercise: 3 stars, standard, especially useful (hstar_hempty_l)</h4>
 Prove that the empty heap predicate is a neutral element for the star.
    You will need to exploit the fact that the union with an empty map is
    the identity, as captured by lemma <span class="inlinecode"><span class="id" title="var">Fmap.union_empty_l</span></span>.
<br/>
<span class="inlinecode">&nbsp;&nbsp;<span class="id" title="keyword">Check</span> <span class="id" title="var">Fmap.union_empty_l</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">h</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Fmap.empty</span> \<span class="id" title="var">u</span> <span class="id" title="var">h</span> = <span class="id" title="var">h</span>.
</span>
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="FundamentalProofs.hstar_hempty_l" class="idref" href="#FundamentalProofs.hstar_hempty_l"><span class="id" title="lemma">hstar_hempty_l</span></a> : <span class="id" title="keyword">∀</span> <a id="H:228" class="idref" href="#H:228"><span class="id" title="binder">H</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#cb6b4bc70cb30142f9711e4deb4cb93a"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H:228"><span class="id" title="variable">H</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Himpl.html#H:228"><span class="id" title="variable">H</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 The lemma showing that <span class="inlinecode"><span class="id" title="var">hempty</span></span> is a right neutral can be derived
    from the previous result (<span class="inlinecode"><span class="id" title="var">hempty</span></span> is a left neutral) and commutativity. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="FundamentalProofs.hstar_hempty_r" class="idref" href="#FundamentalProofs.hstar_hempty_r"><span class="id" title="lemma">hstar_hempty_r</span></a> : <span class="id" title="keyword">∀</span> <a id="H:229" class="idref" href="#H:229"><span class="id" title="binder">H</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H:229"><span class="id" title="variable">H</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Hprop.html#cb6b4bc70cb30142f9711e4deb4cb93a"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Himpl.html#H:229"><span class="id" title="variable">H</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="Himpl.html#FundamentalProofs.hstar_comm"><span class="id" title="lemma">hstar_comm</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="Himpl.html#FundamentalProofs.hstar_hempty_l"><span class="id" title="axiom">hstar_hempty_l</span></a>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Associativity of star is the most tedious result to derive.
    We need to exploit the associativity of union on finite maps,
    as well as lemmas about the disjointness of a map with the
    result of the union of two maps.
<br/>
<span class="inlinecode">&nbsp;&nbsp;<span class="id" title="keyword">Check</span> <span class="id" title="var">Fmap.union_assoc</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">h<sub>2</sub></span> <span class="id" title="var">h<sub>3</sub></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">h<sub>1</sub></span> \<span class="id" title="var">u</span> <span class="id" title="var">h<sub>2</sub></span>) \<span class="id" title="var">u</span> <span class="id" title="var">h<sub>3</sub></span> = <span class="id" title="var">h<sub>1</sub></span> \<span class="id" title="var">u</span> (<span class="id" title="var">h<sub>2</sub></span> \<span class="id" title="var">u</span> <span class="id" title="var">h<sub>3</sub></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Check</span> <span class="id" title="var">Fmap.disjoint_union_eq_l</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">h<sub>2</sub></span> <span class="id" title="var">h<sub>3</sub></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Fmap.disjoint</span> (<span class="id" title="var">h<sub>2</sub></span> \<span class="id" title="var">u</span> <span class="id" title="var">h<sub>3</sub></span>) <span class="id" title="var">h<sub>1</sub></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;= (<span class="id" title="var">Fmap.disjoint</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">h<sub>2</sub></span> ∧ <span class="id" title="var">Fmap.disjoint</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">h<sub>3</sub></span>).<br/>
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Check</span> <span class="id" title="var">Fmap.disjoint_union_eq_r</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">h<sub>2</sub></span> <span class="id" title="var">h<sub>3</sub></span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Fmap.disjoint</span> <span class="id" title="var">h<sub>1</sub></span> (<span class="id" title="var">h<sub>2</sub></span> \<span class="id" title="var">u</span> <span class="id" title="var">h<sub>3</sub></span>)<br/>
&nbsp;&nbsp;&nbsp;= (<span class="id" title="var">Fmap.disjoint</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">h<sub>2</sub></span> ∧ <span class="id" title="var">Fmap.disjoint</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">h<sub>3</sub></span>).
</span>
<div class="paragraph"> </div>

<a id="lab140"></a><h4 class="section">Exercise: 1 star, standard, optional (hstar_assoc)</h4>
 Complete the right-to-left part of the proof of associativity of the
    star operator. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="FundamentalProofs.hstar_assoc" class="idref" href="#FundamentalProofs.hstar_assoc"><span class="id" title="lemma">hstar_assoc</span></a> : <span class="id" title="keyword">∀</span> <a id="H<sub>1</sub>:230" class="idref" href="#H<sub>1</sub>:230"><span class="id" title="binder">H<sub>1</sub></span></a> <a id="H<sub>2</sub>:231" class="idref" href="#H<sub>2</sub>:231"><span class="id" title="binder">H<sub>2</sub></span></a> <a id="H<sub>3</sub>:232" class="idref" href="#H<sub>3</sub>:232"><span class="id" title="binder">H<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>1</sub>:230"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>2</sub>:231"><span class="id" title="variable">H<sub>2</sub></span></a><a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:232"><span class="id" title="variable">H<sub>3</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Himpl.html#H<sub>1</sub>:230"><span class="id" title="variable">H<sub>1</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#H<sub>2</sub>:231"><span class="id" title="variable">H<sub>2</sub></span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H<sub>3</sub>:232"><span class="id" title="variable">H<sub>3</sub></span></a><a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#himpl_antisym"><span class="id" title="axiom">himpl_antisym</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> (<span class="id" title="var">h'</span>&amp;<span class="id" title="var">h<sub>3</sub></span>&amp;<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">M<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">U</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">M<sub>3</sub></span>&amp;<span class="id" title="var">M<sub>4</sub></span>&amp;<span class="id" title="var">D'</span>&amp;<span class="id" title="var">U'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span> <span class="id" title="var">h'</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#Fmap.disjoint_union_eq_l"><span class="id" title="lemma">Fmap.disjoint_union_eq_l</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">D</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">∃</span> <span class="id" title="var">h<sub>1</sub></span> (<span class="id" title="var">h<sub>2</sub></span> <a class="idref" href="Hprop.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#11dbc5cc324072f557c3f348a31ba1a<sub>0</sub>"><span class="id" title="notation">u</span></a> <span class="id" title="var">h<sub>3</sub></span>). <span class="id" title="var">splits</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <span class="id" title="var">M<sub>3</sub></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">∃</span>* <span class="id" title="var">h<sub>2</sub></span> <span class="id" title="var">h<sub>3</sub></span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span>* @<a class="idref" href="LibSepReference.html#Fmap.disjoint_union_eq_r"><span class="id" title="lemma">Fmap.disjoint_union_eq_r</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span>* @<a class="idref" href="LibSepReference.html#Fmap.union_assoc"><span class="id" title="lemma">Fmap.union_assoc</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">U</span>. } }<br/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="code">

<span class="id" title="keyword">End</span> <a class="idref" href="Himpl.html#FundamentalProofs"><span class="id" title="module">FundamentalProofs</span></a>.<br/>
</div>

<div class="doc">
<a id="lab141"></a><h2 class="section">Proof of the Consequence Rule</h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="ProveConsequenceRules" class="idref" href="#ProveConsequenceRules"><span class="id" title="module">ProveConsequenceRules</span></a>.<br/>
</div>

<div class="doc">
Recall the statement of the rule of consequence. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="ProveConsequenceRules.triple_conseq'" class="idref" href="#ProveConsequenceRules.triple_conseq'"><span class="id" title="lemma">triple_conseq'</span></a> : <span class="id" title="keyword">∀</span> <a id="t:233" class="idref" href="#t:233"><span class="id" title="binder">t</span></a> <a id="H:234" class="idref" href="#H:234"><span class="id" title="binder">H</span></a> <a id="Q:235" class="idref" href="#Q:235"><span class="id" title="binder">Q</span></a> <a id="H':236" class="idref" href="#H':236"><span class="id" title="binder">H'</span></a> <a id="Q':237" class="idref" href="#Q':237"><span class="id" title="binder">Q'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:233"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H':236"><span class="id" title="variable">H'</span></a> <a class="idref" href="Himpl.html#Q':237"><span class="id" title="variable">Q'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H:234"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H':236"><span class="id" title="variable">H'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#Q':237"><span class="id" title="variable">Q'</span></a> <a class="idref" href="Himpl.html#28f43c6c1c00c11599fc86b7e27012f<sub>9</sub>"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Himpl.html#Q:235"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:233"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H:234"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#Q:235"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
A direct proof of <span class="inlinecode"><span class="id" title="var">triple_conseq</span></span> goes through the low-level
    interpretation of Separation Logic triples in terms of heaps. 
</div>
<div class="code">

<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;No&nbsp;need&nbsp;to&nbsp;follow&nbsp;through&nbsp;this&nbsp;low-level&nbsp;proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span> <span class="id" title="var">WH</span> <span class="id" title="var">WQ</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="Hprop.html#triple_iff_triple_lowlevel"><span class="id" title="axiom">triple_iff_triple_lowlevel</span></a> <span class="id" title="keyword">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">h<sub>1</sub></span> <span class="id" title="var">h<sub>2</sub></span> <span class="id" title="var">D</span> <span class="id" title="var">HH</span>. <span class="id" title="var">forwards</span> (<span class="id" title="var">v</span>&amp;<span class="id" title="var">h<sub>1</sub>'</span>&amp;<span class="id" title="var">D'</span>&amp;<span class="id" title="var">R</span>&amp;<span class="id" title="var">HQ</span>): <span class="id" title="var">M</span> <span class="id" title="var">D</span>. <span class="id" title="var">applys</span> <span class="id" title="var">WH</span> <span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">∃</span> <span class="id" title="var">v</span> <span class="id" title="var">h<sub>1</sub>'</span>. <span class="id" title="var">splits</span>¬. <span class="id" title="var">applys</span> <span class="id" title="var">WQ</span> <span class="id" title="var">HQ</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
An alternative proof consists of first establishing the consequence
    rule for the <span class="inlinecode"><span class="id" title="var">hoare</span></span> judgment, then derive its generalization to
    the <span class="inlinecode"><span class="id" title="var">triple</span></span> judgment of Separation Logic. 
<div class="paragraph"> </div>

<a id="lab142"></a><h4 class="section">Exercise: 3 stars, standard, especially useful (hoare_conseq)</h4>
 Prove the consequence rule for Hoare triples. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="ProveConsequenceRules.hoare_conseq" class="idref" href="#ProveConsequenceRules.hoare_conseq"><span class="id" title="lemma">hoare_conseq</span></a> : <span class="id" title="keyword">∀</span> <a id="t:238" class="idref" href="#t:238"><span class="id" title="binder">t</span></a> <a id="H:239" class="idref" href="#H:239"><span class="id" title="binder">H</span></a> <a id="Q:240" class="idref" href="#Q:240"><span class="id" title="binder">Q</span></a> <a id="H':241" class="idref" href="#H':241"><span class="id" title="binder">H'</span></a> <a id="Q':242" class="idref" href="#Q':242"><span class="id" title="binder">Q'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#hoare"><span class="id" title="definition">hoare</span></a> <a class="idref" href="Himpl.html#t:238"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H':241"><span class="id" title="variable">H'</span></a> <a class="idref" href="Himpl.html#Q':242"><span class="id" title="variable">Q'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H:239"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H':241"><span class="id" title="variable">H'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#Q':242"><span class="id" title="variable">Q'</span></a> <a class="idref" href="Himpl.html#28f43c6c1c00c11599fc86b7e27012f<sub>9</sub>"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Himpl.html#Q:240"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#hoare"><span class="id" title="definition">hoare</span></a> <a class="idref" href="Himpl.html#t:238"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H:239"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#Q:240"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab143"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (triple_conseq)</h4>
 Prove the consequence rule by leveraging the lemma <span class="inlinecode"><span class="id" title="var">hoare_conseq</span></span>.
    Hint: unfold the definition of <span class="inlinecode"><span class="id" title="var">triple</span></span>, apply the lemma <span class="inlinecode"><span class="id" title="var">hoare_conseq</span></span>
    with the appropriate arguments, then exploit <span class="inlinecode"><span class="id" title="var">himpl_frame_l</span></span>
    to prove the entailment relations. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="ProveConsequenceRules.triple_conseq" class="idref" href="#ProveConsequenceRules.triple_conseq"><span class="id" title="lemma">triple_conseq</span></a> : <span class="id" title="keyword">∀</span> <a id="t:243" class="idref" href="#t:243"><span class="id" title="binder">t</span></a> <a id="H:244" class="idref" href="#H:244"><span class="id" title="binder">H</span></a> <a id="Q:245" class="idref" href="#Q:245"><span class="id" title="binder">Q</span></a> <a id="H':246" class="idref" href="#H':246"><span class="id" title="binder">H'</span></a> <a id="Q':247" class="idref" href="#Q':247"><span class="id" title="binder">Q'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:243"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H':246"><span class="id" title="variable">H'</span></a> <a class="idref" href="Himpl.html#Q':247"><span class="id" title="variable">Q'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H:244"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#7cf9375cc810cd6cb65186f6ede01686"><span class="id" title="notation">==&gt;</span></a> <a class="idref" href="Himpl.html#H':246"><span class="id" title="variable">H'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#Q':247"><span class="id" title="variable">Q'</span></a> <a class="idref" href="Himpl.html#28f43c6c1c00c11599fc86b7e27012f<sub>9</sub>"><span class="id" title="notation">===&gt;</span></a> <a class="idref" href="Himpl.html#Q:245"><span class="id" title="variable">Q</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:243"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H:244"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#Q:245"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="code">

<span class="id" title="keyword">End</span> <a class="idref" href="Himpl.html#ProveConsequenceRules"><span class="id" title="module">ProveConsequenceRules</span></a>.<br/>
</div>

<div class="doc">
<a id="lab144"></a><h2 class="section">Proof of the Extraction Rules for Triples</h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="ProveExtractionRules" class="idref" href="#ProveExtractionRules"><span class="id" title="module">ProveExtractionRules</span></a>.<br/>
</div>

<div class="doc">
Recall the extraction rule for pure facts. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="ProveExtractionRules.triple_hpure'" class="idref" href="#ProveExtractionRules.triple_hpure'"><span class="id" title="axiom">triple_hpure'</span></a> : <span class="id" title="keyword">∀</span> <a id="t:248" class="idref" href="#t:248"><span class="id" title="binder">t</span></a> (<a id="P:249" class="idref" href="#P:249"><span class="id" title="binder">P</span></a>:<span class="id" title="keyword">Prop</span>) <a id="H:250" class="idref" href="#H:250"><span class="id" title="binder">H</span></a> <a id="Q:251" class="idref" href="#Q:251"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#P:249"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:248"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H:250"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#Q:251"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:248"><span class="id" title="variable">t</span></a> (<a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#P:249"><span class="id" title="variable">P</span></a><a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation">]</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H:250"><span class="id" title="variable">H</span></a>) <a class="idref" href="Himpl.html#Q:251"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
To prove this lemma, we first the establish corresponding
    result on <span class="inlinecode"><span class="id" title="var">hoare</span></span>, then derive its version for <span class="inlinecode"><span class="id" title="var">triple</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="ProveExtractionRules.hoare_hpure" class="idref" href="#ProveExtractionRules.hoare_hpure"><span class="id" title="lemma">hoare_hpure</span></a> : <span class="id" title="keyword">∀</span> <a id="t:253" class="idref" href="#t:253"><span class="id" title="binder">t</span></a> (<a id="P:254" class="idref" href="#P:254"><span class="id" title="binder">P</span></a>:<span class="id" title="keyword">Prop</span>) <a id="H:255" class="idref" href="#H:255"><span class="id" title="binder">H</span></a> <a id="Q:256" class="idref" href="#Q:256"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#P:254"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Hprop.html#hoare"><span class="id" title="definition">hoare</span></a> <a class="idref" href="Himpl.html#t:253"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H:255"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#Q:256"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#hoare"><span class="id" title="definition">hoare</span></a> <a class="idref" href="Himpl.html#t:253"><span class="id" title="variable">t</span></a> (<a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#P:254"><span class="id" title="variable">P</span></a><a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation">]</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H:255"><span class="id" title="variable">H</span></a>) <a class="idref" href="Himpl.html#Q:256"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> (<span class="id" title="var">h<sub>1</sub></span>&amp;<span class="id" title="var">h<sub>2</sub></span>&amp;<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">M<sub>2</sub></span>&amp;<span class="id" title="var">D</span>&amp;<span class="id" title="var">U</span>). <span class="id" title="tactic">destruct</span> <span class="id" title="var">M<sub>1</sub></span> <span class="id" title="keyword">as</span> (<span class="id" title="var">M<sub>1</sub></span>&amp;<span class="id" title="var">HP</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="LibSepReference.html#Fmap.union_empty_l"><span class="id" title="lemma">Fmap.union_empty_l</span></a>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span> <span class="id" title="var">HP</span> <span class="id" title="var">M<sub>2</sub></span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="ProveExtractionRules.triple_hpure" class="idref" href="#ProveExtractionRules.triple_hpure"><span class="id" title="lemma">triple_hpure</span></a> : <span class="id" title="keyword">∀</span> <a id="t:257" class="idref" href="#t:257"><span class="id" title="binder">t</span></a> (<a id="P:258" class="idref" href="#P:258"><span class="id" title="binder">P</span></a>:<span class="id" title="keyword">Prop</span>) <a id="H:259" class="idref" href="#H:259"><span class="id" title="binder">H</span></a> <a id="Q:260" class="idref" href="#Q:260"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#P:258"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:257"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H:259"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#Q:260"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:257"><span class="id" title="variable">t</span></a> (<a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#P:258"><span class="id" title="variable">P</span></a><a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation">]</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H:259"><span class="id" title="variable">H</span></a>) <a class="idref" href="Himpl.html#Q:260"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Himpl.html#hstar_assoc"><span class="id" title="axiom">hstar_assoc</span></a>. <span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#ProveExtractionRules.hoare_hpure"><span class="id" title="lemma">hoare_hpure</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">HP</span>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span> <span class="id" title="var">HP</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Similarly, the extraction rule for existentials for
    <span class="inlinecode"><span class="id" title="var">triple</span></span> can be derived from that for <span class="inlinecode"><span class="id" title="var">hoare</span></span>. 
<div class="paragraph"> </div>

<a id="lab145"></a><h4 class="section">Exercise: 2 stars, standard, especially useful (triple_hexists)</h4>
 Prove the extraction rule <span class="inlinecode"><span class="id" title="var">triple_hexists</span></span>.
    Hint: start by stating and proving the corresponding
    lemma for <span class="inlinecode"><span class="id" title="var">hoare</span></span> triples. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="ProveExtractionRules.hoare_hexists" class="idref" href="#ProveExtractionRules.hoare_hexists"><span class="id" title="lemma">hoare_hexists</span></a> : <span class="id" title="keyword">∀</span> <a id="t:261" class="idref" href="#t:261"><span class="id" title="binder">t</span></a> (<a id="A:262" class="idref" href="#A:262"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>) (<a id="J:263" class="idref" href="#J:263"><span class="id" title="binder">J</span></a>:<a class="idref" href="Himpl.html#A:262"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>) <a id="Q:264" class="idref" href="#Q:264"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="x:265" class="idref" href="#x:265"><span class="id" title="binder">x</span></a>, <a class="idref" href="Hprop.html#hoare"><span class="id" title="definition">hoare</span></a> <a class="idref" href="Himpl.html#t:261"><span class="id" title="variable">t</span></a> (<a class="idref" href="Himpl.html#J:263"><span class="id" title="variable">J</span></a> <a class="idref" href="Himpl.html#x:265"><span class="id" title="variable">x</span></a>) <a class="idref" href="Himpl.html#Q:264"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#hoare"><span class="id" title="definition">hoare</span></a> <a class="idref" href="Himpl.html#t:261"><span class="id" title="variable">t</span></a> (<a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">∃</span></a> <a id="x:266" class="idref" href="#x:266"><span class="id" title="binder">x</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">,</span></a> <a class="idref" href="Himpl.html#J:263"><span class="id" title="variable">J</span></a> <a class="idref" href="Himpl.html#x:266"><span class="id" title="variable">x</span></a>) <a class="idref" href="Himpl.html#Q:264"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">h</span> (<span class="id" title="var">x</span>&amp;<span class="id" title="var">Hh</span>). <span class="id" title="var">applys</span> <span class="id" title="var">M</span> <span class="id" title="var">Hh</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="ProveExtractionRules.triple_hexists" class="idref" href="#ProveExtractionRules.triple_hexists"><span class="id" title="lemma">triple_hexists</span></a> : <span class="id" title="keyword">∀</span> <a id="t:267" class="idref" href="#t:267"><span class="id" title="binder">t</span></a> (<a id="A:268" class="idref" href="#A:268"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>) (<a id="J:269" class="idref" href="#J:269"><span class="id" title="binder">J</span></a>:<a class="idref" href="Himpl.html#A:268"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>) <a id="Q:270" class="idref" href="#Q:270"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="x:271" class="idref" href="#x:271"><span class="id" title="binder">x</span></a>, <a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:267"><span class="id" title="variable">t</span></a> (<a class="idref" href="Himpl.html#J:269"><span class="id" title="variable">J</span></a> <a class="idref" href="Himpl.html#x:271"><span class="id" title="variable">x</span></a>) <a class="idref" href="Himpl.html#Q:270"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:267"><span class="id" title="variable">t</span></a> (<a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">∃</span></a> <a id="x:272" class="idref" href="#x:272"><span class="id" title="binder">x</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">,</span></a> <a class="idref" href="Himpl.html#J:269"><span class="id" title="variable">J</span></a> <a class="idref" href="Himpl.html#x:272"><span class="id" title="variable">x</span></a>) <a class="idref" href="Himpl.html#Q:270"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 Remark: the rules for extracting existentials out of entailments
    and out of preconditions can be stated in a slightly more concise
    way by exploiting the combinator <span class="inlinecode"><span class="id" title="var">hexists</span></span> rather than its associated
    notation <span class="inlinecode"><span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode"><span class="id" title="var">x</span>,</span> <span class="inlinecode"><span class="id" title="var">H</span></span>, which stands for <span class="inlinecode"><span class="id" title="var">hexists</span></span> <span class="inlinecode">(<span class="id" title="keyword">fun</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">⇒</span> <span class="inlinecode"><span class="id" title="var">H</span>)</span>.

<div class="paragraph"> </div>

    These formulation, shown below, tend to behave slightly better with
    respect to Coq unification, hence we use them in the CFML framework. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="ProveExtractionRules.hstar_hexists'" class="idref" href="#ProveExtractionRules.hstar_hexists'"><span class="id" title="axiom">hstar_hexists'</span></a> : <span class="id" title="keyword">∀</span> <a id="A:273" class="idref" href="#A:273"><span class="id" title="binder">A</span></a> (<a id="J:274" class="idref" href="#J:274"><span class="id" title="binder">J</span></a>:<a class="idref" href="Himpl.html#A:273"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>) <a id="H:275" class="idref" href="#H:275"><span class="id" title="binder">H</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="Hprop.html#hexists"><span class="id" title="definition">hexists</span></a> <a class="idref" href="Himpl.html#J:274"><span class="id" title="variable">J</span></a><a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H:275"><span class="id" title="variable">H</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Hprop.html#hexists"><span class="id" title="definition">hexists</span></a> (<a class="idref" href="Himpl.html#J:274"><span class="id" title="variable">J</span></a> <a class="idref" href="Hprop.html#9c07dc3fe866f600abcbb5cdf7c0a7fa"><span class="id" title="notation"><span class='gray-font'>\</span>*+</span></a> <a class="idref" href="Himpl.html#H:275"><span class="id" title="variable">H</span></a>).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Parameter</span> <a id="ProveExtractionRules.triple_hexists'" class="idref" href="#ProveExtractionRules.triple_hexists'"><span class="id" title="axiom">triple_hexists'</span></a> : <span class="id" title="keyword">∀</span> <a id="t:277" class="idref" href="#t:277"><span class="id" title="binder">t</span></a> (<a id="A:278" class="idref" href="#A:278"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>) (<a id="J:279" class="idref" href="#J:279"><span class="id" title="binder">J</span></a>:<a class="idref" href="Himpl.html#A:278"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>) <a id="Q:280" class="idref" href="#Q:280"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="x:281" class="idref" href="#x:281"><span class="id" title="binder">x</span></a>, <a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:277"><span class="id" title="variable">t</span></a> (<a class="idref" href="Himpl.html#J:279"><span class="id" title="variable">J</span></a> <a class="idref" href="Himpl.html#x:281"><span class="id" title="variable">x</span></a>) <a class="idref" href="Himpl.html#Q:280"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:277"><span class="id" title="variable">t</span></a> (<a class="idref" href="Hprop.html#hexists"><span class="id" title="definition">hexists</span></a> <a class="idref" href="Himpl.html#J:279"><span class="id" title="variable">J</span></a>) <a class="idref" href="Himpl.html#Q:280"><span class="id" title="variable">Q</span></a>.<br/>
</div>

<div class="doc">
Remark: in chapter <a href="Hprop.html"><span class="inlineref">Hprop</span></a>, we observed that <span class="inlinecode"><span class='gray-font'>\</span>[<span class="id" title="var">P</span>]</span> can be
    encoded as <span class="inlinecode"><span class='gray-font'>\</span><span class="id" title="tactic">∃</span></span> <span class="inlinecode">(<span class="id" title="var">p</span>:<span class="id" title="var">P</span>),</span> <span class="inlinecode"><span class='gray-font'>\</span>[]</span>. When this encoding is used,
    the rule <span class="inlinecode"><span class="id" title="var">triple_hpure</span></span> turns out to be a particular instance
    of the rule <span class="inlinecode"><span class="id" title="var">triple_hexists</span></span>, as we prove next. 
</div>
<div class="code">

<span class="id" title="keyword">Parameter</span> <a id="ProveExtractionRules.hpure_encoding" class="idref" href="#ProveExtractionRules.hpure_encoding"><span class="id" title="axiom">hpure_encoding</span></a> : <span class="id" title="keyword">∀</span> <a id="P:283" class="idref" href="#P:283"><span class="id" title="binder">P</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#P:283"><span class="id" title="variable">P</span></a><a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">∃</span></a> <a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">(</span></a><a id="p:284" class="idref" href="#p:284"><span class="id" title="binder">p</span></a>:<a class="idref" href="Himpl.html#P:283"><span class="id" title="variable">P</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">),</span></a> <a class="idref" href="Hprop.html#cb6b4bc70cb30142f9711e4deb4cb93a"><span class="id" title="notation"><span class='gray-font'>\</span>[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="ProveExtractionRules.triple_hpure_from_triple_hexists" class="idref" href="#ProveExtractionRules.triple_hpure_from_triple_hexists"><span class="id" title="lemma">triple_hpure_from_triple_hexists</span></a> : <span class="id" title="keyword">∀</span> <a id="t:286" class="idref" href="#t:286"><span class="id" title="binder">t</span></a> (<a id="P:287" class="idref" href="#P:287"><span class="id" title="binder">P</span></a>:<span class="id" title="keyword">Prop</span>) <a id="H:288" class="idref" href="#H:288"><span class="id" title="binder">H</span></a> <a id="Q:289" class="idref" href="#Q:289"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="Himpl.html#P:287"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:286"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H:288"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#Q:289"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:286"><span class="id" title="variable">t</span></a> (<a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#P:287"><span class="id" title="variable">P</span></a><a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation">]</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Himpl.html#H:288"><span class="id" title="variable">H</span></a>) <a class="idref" href="Himpl.html#Q:289"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="Himpl.html#ProveExtractionRules.hpure_encoding"><span class="id" title="axiom">hpure_encoding</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Himpl.html#hstar_hexists"><span class="id" title="axiom">hstar_hexists</span></a>. <span class="comment">(*&nbsp;disable&nbsp;notation&nbsp;printing&nbsp;to&nbsp;see&nbsp;the&nbsp;effect&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#ProveExtractionRules.triple_hexists"><span class="id" title="axiom">triple_hexists</span></a>. <span class="comment">(*&nbsp;<span class="inlinecode"><span class="id" title="keyword">∀</span></span> <span class="inlinecode">(<span class="id" title="var">p</span>:<span class="id" title="var">P</span>),</span> <span class="inlinecode">...</span>&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">→</span> <span class="inlinecode">...</span>&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Himpl.html#hstar_hempty_l"><span class="id" title="axiom">hstar_hempty_l</span></a>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="Himpl.html#ProveExtractionRules"><span class="id" title="module">ProveExtractionRules</span></a>.<br/>
</div>

<div class="doc">
<a id="lab146"></a><h3 class="section">Rules for Naming Heaps</h3>

<div class="paragraph"> </div>

 Thereafter, we write <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">h</span></span> for <span class="inlinecode"><span class="id" title="keyword">fun</span></span> <span class="inlinecode"><span class="id" title="var">h'</span></span> <span class="inlinecode">⇒</span> <span class="inlinecode"><span class="id" title="var">h'</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">h</span></span>, that is,
    the heap predicate that only accepts heaps exactly equal to <span class="inlinecode"><span class="id" title="var">h</span></span>. 
<div class="paragraph"> </div>

<a id="lab147"></a><h4 class="section">Exercise: 3 stars, standard, optional (hexists_named_eq)</h4>
 Prove that a heap predicate <span class="inlinecode"><span class="id" title="var">H</span></span> is equivalent to the heap
    predicate which asserts that the heap is, for a heap <span class="inlinecode"><span class="id" title="var">h</span></span>
    such that <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">h</span></span>, exactly equal to <span class="inlinecode"><span class="id" title="var">H</span></span>.

<div class="paragraph"> </div>

    Hint: use <span class="inlinecode"><span class="id" title="var">hstar_hpure_l</span></span> and <span class="inlinecode"><span class="id" title="var">hexists_intro</span></span>, as well as
    the extraction rules <span class="inlinecode"><span class="id" title="var">himpl_hexists_l</span></span> and <span class="inlinecode"><span class="id" title="var">himpl_hstar_hpure_l</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="hexists_named_eq" class="idref" href="#hexists_named_eq"><span class="id" title="lemma">hexists_named_eq</span></a> : <span class="id" title="keyword">∀</span> <a id="H:290" class="idref" href="#H:290"><span class="id" title="binder">H</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Himpl.html#H:290"><span class="id" title="variable">H</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">∃</span></a> <a id="h:291" class="idref" href="#h:291"><span class="id" title="binder">h</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">,</span></a> <a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation"><span class='gray-font'>\</span>[</span></a><a class="idref" href="Himpl.html#H:290"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#h:291"><span class="id" title="variable">h</span></a><a class="idref" href="Hprop.html#53316c5a9a53e765aefbae8243c4b1dc"><span class="id" title="notation">]</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation"><span class='gray-font'>\</span>*</span></a> <a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">(</span></a><span class="id" title="notation">=</span> <a class="idref" href="Himpl.html#h:291"><span class="id" title="variable">h</span></a><a class="idref" href="Hprop.html#1c2e0971edf6e9b6c6dd4a5951d04f<sub>36</sub>"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab148"></a><h4 class="section">Exercise: 1 star, standard, optional (hoare_named_heap)</h4>
 Prove that the proposition <span class="inlinecode"><span class="id" title="var">hoare</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> <span class="inlinecode"><span class="id" title="var">Q</span></span> is equivalent to:
    for any heap <span class="inlinecode"><span class="id" title="var">h</span></span> satisfying the precondition <span class="inlinecode"><span class="id" title="var">H</span></span>, the Hoare
    triple whose precondition requires the input heap to be exactly
    equal to <span class="inlinecode"><span class="id" title="var">h</span></span>, and whose postcondition is <span class="inlinecode"><span class="id" title="var">Q</span></span> holds. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="hoare_named_heap" class="idref" href="#hoare_named_heap"><span class="id" title="lemma">hoare_named_heap</span></a> : <span class="id" title="keyword">∀</span> <a id="t:292" class="idref" href="#t:292"><span class="id" title="binder">t</span></a> <a id="H:293" class="idref" href="#H:293"><span class="id" title="binder">H</span></a> <a id="Q:294" class="idref" href="#Q:294"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="h:295" class="idref" href="#h:295"><span class="id" title="binder">h</span></a>, <a class="idref" href="Himpl.html#H:293"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#h:295"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Hprop.html#hoare"><span class="id" title="definition">hoare</span></a> <a class="idref" href="Himpl.html#t:292"><span class="id" title="variable">t</span></a> (<span class="id" title="notation">=</span> <a class="idref" href="Himpl.html#h:295"><span class="id" title="variable">h</span></a>) <a class="idref" href="Himpl.html#Q:294"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#hoare"><span class="id" title="definition">hoare</span></a> <a class="idref" href="Himpl.html#t:292"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H:293"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#Q:294"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab149"></a><h4 class="section">Exercise: 3 stars, standard, optional (triple_named_heap)</h4>
 Prove the counterpart of <span class="inlinecode"><span class="id" title="var">hoare_named_heap</span></span> for Separation
    Logic triples.

<div class="paragraph"> </div>

    It is possible to exploit the lemma <span class="inlinecode"><span class="id" title="var">hoare_named_heap</span></span>, yet
    there exists a simpler, more direct proof that exploits
    the lemma <span class="inlinecode"><span class="id" title="var">hexists_name_eq</span></span>, which is stated above. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="triple_named_heap" class="idref" href="#triple_named_heap"><span class="id" title="lemma">triple_named_heap</span></a> : <span class="id" title="keyword">∀</span> <a id="t:296" class="idref" href="#t:296"><span class="id" title="binder">t</span></a> <a id="H:297" class="idref" href="#H:297"><span class="id" title="binder">H</span></a> <a id="Q:298" class="idref" href="#Q:298"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="h:299" class="idref" href="#h:299"><span class="id" title="binder">h</span></a>, <a class="idref" href="Himpl.html#H:297"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#h:299"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:296"><span class="id" title="variable">t</span></a> (<span class="id" title="notation">=</span> <a class="idref" href="Himpl.html#h:299"><span class="id" title="variable">h</span></a>) <a class="idref" href="Himpl.html#Q:298"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:296"><span class="id" title="variable">t</span></a> <a class="idref" href="Himpl.html#H:297"><span class="id" title="variable">H</span></a> <a class="idref" href="Himpl.html#Q:298"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>. <span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>


<div class="doc">
<a id="lab150"></a><h2 class="section">Alternative Structural Rule for Existentials</h2>

</div>
<div class="code">

<span class="id" title="keyword">Module</span> <a id="AlternativeExistentialRule" class="idref" href="#AlternativeExistentialRule"><span class="id" title="module">AlternativeExistentialRule</span></a>.<br/>
</div>

<div class="doc">
Traditional papers on Separation Logic do not include <span class="inlinecode"><span class="id" title="var">triple_hexists</span></span>,
    but instead a rule called <span class="inlinecode"><span class="id" title="var">triple_hexists2</span></span> that includes an existential
    quantifier both in the precondition and the postcondition.

<div class="paragraph"> </div>

    As we show next, in the presence of the consequence rule,
    the two rules are equivalent.

<div class="paragraph"> </div>

    The formulation of <span class="inlinecode"><span class="id" title="var">triple_hexists</span></span> is not only more concise, it is
    also better suited for practical applications. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="AlternativeExistentialRule.triple_hexists2" class="idref" href="#AlternativeExistentialRule.triple_hexists2"><span class="id" title="lemma">triple_hexists2</span></a> : <span class="id" title="keyword">∀</span> <a id="A:300" class="idref" href="#A:300"><span class="id" title="binder">A</span></a> (<a id="Hof:301" class="idref" href="#Hof:301"><span class="id" title="binder">Hof</span></a>:<a class="idref" href="Himpl.html#A:300"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>) (<a id="Qof:302" class="idref" href="#Qof:302"><span class="id" title="binder">Qof</span></a>:<a class="idref" href="Himpl.html#A:300"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>) <a id="t:303" class="idref" href="#t:303"><span class="id" title="binder">t</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="x:304" class="idref" href="#x:304"><span class="id" title="binder">x</span></a>, <a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:303"><span class="id" title="variable">t</span></a> (<a class="idref" href="Himpl.html#Hof:301"><span class="id" title="variable">Hof</span></a> <a class="idref" href="Himpl.html#x:304"><span class="id" title="variable">x</span></a>) (<a class="idref" href="Himpl.html#Qof:302"><span class="id" title="variable">Qof</span></a> <a class="idref" href="Himpl.html#x:304"><span class="id" title="variable">x</span></a>)<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:303"><span class="id" title="variable">t</span></a> (<a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">∃</span></a> <a id="x:307" class="idref" href="#x:307"><span class="id" title="binder">x</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">,</span></a> <a class="idref" href="Himpl.html#Hof:301"><span class="id" title="variable">Hof</span></a> <a class="idref" href="Himpl.html#x:307"><span class="id" title="variable">x</span></a>) (<span class="id" title="keyword">fun</span> <a id="v:305" class="idref" href="#v:305"><span class="id" title="binder">v</span></a> ⇒ <a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">∃</span></a> <a id="x:306" class="idref" href="#x:306"><span class="id" title="binder">x</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">,</span></a> <a class="idref" href="Himpl.html#Qof:302"><span class="id" title="variable">Qof</span></a> <a class="idref" href="Himpl.html#x:306"><span class="id" title="variable">x</span></a> <a class="idref" href="Himpl.html#v:305"><span class="id" title="variable">v</span></a>).<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#triple_hexists"><span class="id" title="axiom">triple_hexists</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#triple_conseq"><span class="id" title="axiom">triple_conseq</span></a> (<span class="id" title="var">M</span> <span class="id" title="var">x</span>).<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#himpl_refl"><span class="id" title="lemma">himpl_refl</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span>. <span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#himpl_hexists_r"><span class="id" title="axiom">himpl_hexists_r</span></a> <span class="id" title="var">x</span>. <span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#himpl_refl"><span class="id" title="lemma">himpl_refl</span></a>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="AlternativeExistentialRule.triple_hexists_of_triple_hexists2" class="idref" href="#AlternativeExistentialRule.triple_hexists_of_triple_hexists2"><span class="id" title="lemma">triple_hexists_of_triple_hexists2</span></a> : <span class="id" title="keyword">∀</span> <a id="t:308" class="idref" href="#t:308"><span class="id" title="binder">t</span></a> (<a id="A:309" class="idref" href="#A:309"><span class="id" title="binder">A</span></a>:<span class="id" title="keyword">Type</span>) (<a id="Hof:310" class="idref" href="#Hof:310"><span class="id" title="binder">Hof</span></a>:<a class="idref" href="Himpl.html#A:309"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><a class="idref" href="Hprop.html#hprop"><span class="id" title="definition">hprop</span></a>) <a id="Q:311" class="idref" href="#Q:311"><span class="id" title="binder">Q</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="x:312" class="idref" href="#x:312"><span class="id" title="binder">x</span></a>, <a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:308"><span class="id" title="variable">t</span></a> (<a class="idref" href="Himpl.html#Hof:310"><span class="id" title="variable">Hof</span></a> <a class="idref" href="Himpl.html#x:312"><span class="id" title="variable">x</span></a>) <a class="idref" href="Himpl.html#Q:311"><span class="id" title="variable">Q</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Hprop.html#triple"><span class="id" title="definition">triple</span></a> <a class="idref" href="Himpl.html#t:308"><span class="id" title="variable">t</span></a> (<a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">∃</span></a> <a id="x:313" class="idref" href="#x:313"><span class="id" title="binder">x</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">,</span></a> <a class="idref" href="Himpl.html#Hof:310"><span class="id" title="variable">Hof</span></a> <a class="idref" href="Himpl.html#x:313"><span class="id" title="variable">x</span></a>) <a class="idref" href="Himpl.html#Q:311"><span class="id" title="variable">Q</span></a>.<br/>
<span class="id" title="keyword">Proof</span> <span class="id" title="keyword">using</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">introv</span> <span class="id" title="var">M</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#triple_conseq"><span class="id" title="axiom">triple_conseq</span></a> (<a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">∃</span></a> <a id="x:317" class="idref" href="#x:317"><span class="id" title="binder">x</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">,</span></a> <span class="id" title="var">Hof</span> <a class="idref" href="Himpl.html#x:314"><span class="id" title="variable">x</span></a>) (<span class="id" title="keyword">fun</span> (<a id="v:318" class="idref" href="#v:318"><span class="id" title="binder">v</span></a>:<a class="idref" href="LibSepReference.html#val"><span class="id" title="inductive">val</span></a>) ⇒ <a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">\</span></a><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">∃</span></a> <a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">(</span></a><a id="x:319" class="idref" href="#x:319"><span class="id" title="binder">x</span></a>:<span class="id" title="var">A</span><a class="idref" href="Hprop.html#427157b8047cdf158af6c4e7232eb7ce"><span class="id" title="notation">),</span></a> <span class="id" title="var">Q</span> <a class="idref" href="Himpl.html#v:315"><span class="id" title="variable">v</span></a>).<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#AlternativeExistentialRule.triple_hexists2"><span class="id" title="lemma">triple_hexists2</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>. <span class="id" title="var">applys</span> <span class="id" title="var">M</span>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#himpl_refl"><span class="id" title="lemma">himpl_refl</span></a>. }<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">intros</span> <span class="id" title="var">v</span>. <span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#himpl_hexists_l"><span class="id" title="axiom">himpl_hexists_l</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">_</span>. <span class="id" title="var">applys</span> <a class="idref" href="Himpl.html#himpl_refl"><span class="id" title="lemma">himpl_refl</span></a>. }<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">End</span> <a class="idref" href="Himpl.html#AlternativeExistentialRule"><span class="id" title="module">AlternativeExistentialRule</span></a>.<br/>
</div>

<div class="doc">
<a id="lab151"></a><h2 class="section">Historical Notes</h2>

<div class="paragraph"> </div>

 Nearly every project that aims for practical program verification using
    Separation Logic features, in one way or another, some amount of tooling
    for automatically simplifying Separation Logic assertion.

<div class="paragraph"> </div>

    The tactic used here, <span class="inlinecode"><span class="id" title="var">xsimpl</span></span>, was developed for the CFML tool.
    Its specification may be found in Appendix K from the paper:
    <a href='http://www.chargueraud.org/research/2020/seq_seplogic/seq_seplogic.pdf'>http://www.chargueraud.org/research/2020/seq_seplogic/seq_seplogic.pdf</a>
    though it makes sense to wait until chapter <a href="Wand.html"><span class="inlineref">Wand</span></a> for reading it. 
</div>
<div class="code">

<span class="comment">(*&nbsp;2021-10-06&nbsp;00:58&nbsp;*)</span><br/>
</div>
</div>

<div id="footer">
<hr/><a href="coqindex.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>